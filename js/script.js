!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t,i){"use strict";i.r(t),i.d(t,"ACESFilmicToneMapping",(function(){return ae})),i.d(t,"AddEquation",(function(){return C})),i.d(t,"AddOperation",(function(){return Q})),i.d(t,"AdditiveBlending",(function(){return M})),i.d(t,"AlphaFormat",(function(){return Be})),i.d(t,"AlwaysDepth",(function(){return V})),i.d(t,"AlwaysStencilFunc",(function(){return Si})),i.d(t,"AmbientLight",(function(){return hu})),i.d(t,"AmbientLightProbe",(function(){return Ou})),i.d(t,"AnimationClip",(function(){return vh})),i.d(t,"AnimationLoader",(function(){return Th})),i.d(t,"AnimationMixer",(function(){return cd})),i.d(t,"AnimationObjectGroup",(function(){return od})),i.d(t,"AnimationUtils",(function(){return rh})),i.d(t,"ArcCurve",(function(){return Oh})),i.d(t,"ArrayCamera",(function(){return Lo})),i.d(t,"ArrowHelper",(function(){return Jd})),i.d(t,"Audio",(function(){return ju})),i.d(t,"AudioAnalyser",(function(){return Yu})),i.d(t,"AudioContext",(function(){return Lu})),i.d(t,"AudioListener",(function(){return Uu})),i.d(t,"AudioLoader",(function(){return Au})),i.d(t,"AxesHelper",(function(){return Kd})),i.d(t,"AxisHelper",(function(){return om})),i.d(t,"BackSide",(function(){return v})),i.d(t,"BasicDepthPacking",(function(){return ai})),i.d(t,"BasicShadowMap",(function(){return d})),i.d(t,"BinaryTextureLoader",(function(){return dm})),i.d(t,"Bone",(function(){return sl})),i.d(t,"BooleanKeyframeTrack",(function(){return hh})),i.d(t,"BoundingBoxHelper",(function(){return lm})),i.d(t,"Box2",(function(){return yd})),i.d(t,"Box3",(function(){return Fn})),i.d(t,"Box3Helper",(function(){return qd})),i.d(t,"BoxBufferGeometry",(function(){return fa})),i.d(t,"BoxGeometry",(function(){return ma})),i.d(t,"BoxHelper",(function(){return Wd})),i.d(t,"BufferAttribute",(function(){return Mr})),i.d(t,"BufferGeometry",(function(){return Ur})),i.d(t,"BufferGeometryLoader",(function(){return gu})),i.d(t,"ByteType",(function(){return Le})),i.d(t,"Cache",(function(){return bh})),i.d(t,"Camera",(function(){return xa})),i.d(t,"CameraHelper",(function(){return Ud})),i.d(t,"CanvasRenderer",(function(){return fm})),i.d(t,"CanvasTexture",(function(){return Rl})),i.d(t,"CatmullRomCurve3",(function(){return Bh})),i.d(t,"CineonToneMapping",(function(){return re})),i.d(t,"CircleBufferGeometry",(function(){return Wc})),i.d(t,"CircleGeometry",(function(){return Vc})),i.d(t,"ClampToEdgeWrapping",(function(){return fe})),i.d(t,"Clock",(function(){return zu})),i.d(t,"ClosedSplineCurve3",(function(){return rm})),i.d(t,"Color",(function(){return mr})),i.d(t,"ColorKeyframeTrack",(function(){return uh})),i.d(t,"CompressedTexture",(function(){return Pl})),i.d(t,"CompressedTextureLoader",(function(){return Eh})),i.d(t,"ConeBufferGeometry",(function(){return jc})),i.d(t,"ConeGeometry",(function(){return Uc})),i.d(t,"CubeCamera",(function(){return _a})),i.d(t,"CubeGeometry",(function(){return ma})),i.d(t,"CubeReflectionMapping",(function(){return oe})),i.d(t,"CubeRefractionMapping",(function(){return le})),i.d(t,"CubeTexture",(function(){return qa})),i.d(t,"CubeTextureLoader",(function(){return Ah})),i.d(t,"CubeUVReflectionMapping",(function(){return de})),i.d(t,"CubeUVRefractionMapping",(function(){return pe})),i.d(t,"CubicBezierCurve",(function(){return jh})),i.d(t,"CubicBezierCurve3",(function(){return Vh})),i.d(t,"CubicInterpolant",(function(){return sh})),i.d(t,"CullFaceBack",(function(){return o})),i.d(t,"CullFaceFront",(function(){return l})),i.d(t,"CullFaceFrontBack",(function(){return c})),i.d(t,"CullFaceNone",(function(){return s})),i.d(t,"Curve",(function(){return Ph})),i.d(t,"CurvePath",(function(){return Jh})),i.d(t,"CustomBlending",(function(){return E})),i.d(t,"CylinderBufferGeometry",(function(){return Gc})),i.d(t,"CylinderGeometry",(function(){return Hc})),i.d(t,"Cylindrical",(function(){return gd})),i.d(t,"DataTexture",(function(){return Sa})),i.d(t,"DataTexture2DArray",(function(){return $a})),i.d(t,"DataTexture3D",(function(){return Xa})),i.d(t,"DataTextureLoader",(function(){return Ch})),i.d(t,"DecrementStencilOp",(function(){return pi})),i.d(t,"DecrementWrapStencilOp",(function(){return fi})),i.d(t,"DefaultLoadingManager",(function(){return wh})),i.d(t,"DepthFormat",(function(){return We})),i.d(t,"DepthStencilFormat",(function(){return qe})),i.d(t,"DepthTexture",(function(){return Ol})),i.d(t,"DirectionalLight",(function(){return cu})),i.d(t,"DirectionalLightHelper",(function(){return Bd})),i.d(t,"DirectionalLightShadow",(function(){return lu})),i.d(t,"DiscreteInterpolant",(function(){return lh})),i.d(t,"DodecahedronBufferGeometry",(function(){return ql})),i.d(t,"DodecahedronGeometry",(function(){return Wl})),i.d(t,"DoubleSide",(function(){return y})),i.d(t,"DstAlphaFactor",(function(){return F})),i.d(t,"DstColorFactor",(function(){return H})),i.d(t,"DynamicBufferAttribute",(function(){return Xp})),i.d(t,"DynamicCopyUsage",(function(){return Ri})),i.d(t,"DynamicDrawUsage",(function(){return Ei})),i.d(t,"DynamicReadUsage",(function(){return Ai})),i.d(t,"EdgesGeometry",(function(){return Bc})),i.d(t,"EdgesHelper",(function(){return cm})),i.d(t,"EllipseCurve",(function(){return Rh})),i.d(t,"EqualDepth",(function(){return $})),i.d(t,"EqualStencilFunc",(function(){return bi})),i.d(t,"EquirectangularReflectionMapping",(function(){return ce})),i.d(t,"EquirectangularRefractionMapping",(function(){return he})),i.d(t,"Euler",(function(){return ln})),i.d(t,"EventDispatcher",(function(){return Ii})),i.d(t,"ExtrudeBufferGeometry",(function(){return Tc})),i.d(t,"ExtrudeGeometry",(function(){return Sc})),i.d(t,"Face3",(function(){return yr})),i.d(t,"Face4",(function(){return Op})),i.d(t,"FaceColors",(function(){return zp})),i.d(t,"FileLoader",(function(){return Sh})),i.d(t,"FlatShading",(function(){return b})),i.d(t,"Float32Attribute",(function(){return im})),i.d(t,"Float32BufferAttribute",(function(){return Pr})),i.d(t,"Float64Attribute",(function(){return nm})),i.d(t,"Float64BufferAttribute",(function(){return Rr})),i.d(t,"FloatType",(function(){return Oe})),i.d(t,"Fog",(function(){return Oo})),i.d(t,"FogExp2",(function(){return Ro})),i.d(t,"Font",(function(){return Tu})),i.d(t,"FontLoader",(function(){return Cu})),i.d(t,"FrontFaceDirectionCCW",(function(){return u})),i.d(t,"FrontFaceDirectionCW",(function(){return h})),i.d(t,"FrontSide",(function(){return g})),i.d(t,"Frustum",(function(){return Ca})),i.d(t,"GammaEncoding",(function(){return Qt})),i.d(t,"Geometry",(function(){return pa})),i.d(t,"GeometryUtils",(function(){return mm})),i.d(t,"GreaterDepth",(function(){return Y})),i.d(t,"GreaterEqualDepth",(function(){return X})),i.d(t,"GreaterEqualStencilFunc",(function(){return Mi})),i.d(t,"GreaterStencilFunc",(function(){return wi})),i.d(t,"GridHelper",(function(){return Id})),i.d(t,"Group",(function(){return Ao})),i.d(t,"HalfFloatType",(function(){return Ie})),i.d(t,"HemisphereLight",(function(){return tu})),i.d(t,"HemisphereLightHelper",(function(){return Od})),i.d(t,"HemisphereLightProbe",(function(){return Ru})),i.d(t,"IcosahedronBufferGeometry",(function(){return Vl})),i.d(t,"IcosahedronGeometry",(function(){return jl})),i.d(t,"ImageBitmapLoader",(function(){return Mu})),i.d(t,"ImageLoader",(function(){return Lh})),i.d(t,"ImageUtils",(function(){return Gi})),i.d(t,"ImmediateRenderObject",(function(){return _d})),i.d(t,"IncrementStencilOp",(function(){return di})),i.d(t,"IncrementWrapStencilOp",(function(){return mi})),i.d(t,"InstancedBufferAttribute",(function(){return fu})),i.d(t,"InstancedBufferGeometry",(function(){return mu})),i.d(t,"InstancedInterleavedBuffer",(function(){return ud})),i.d(t,"InstancedMesh",(function(){return ul})),i.d(t,"Int16Attribute",(function(){return Kp})),i.d(t,"Int16BufferAttribute",(function(){return Cr})),i.d(t,"Int32Attribute",(function(){return em})),i.d(t,"Int32BufferAttribute",(function(){return Ar})),i.d(t,"Int8Attribute",(function(){return Yp})),i.d(t,"Int8BufferAttribute",(function(){return Sr})),i.d(t,"IntType",(function(){return Pe})),i.d(t,"InterleavedBuffer",(function(){return Io})),i.d(t,"InterleavedBufferAttribute",(function(){return zo})),i.d(t,"Interpolant",(function(){return ah})),i.d(t,"InterpolateDiscrete",(function(){return Ut})),i.d(t,"InterpolateLinear",(function(){return jt})),i.d(t,"InterpolateSmooth",(function(){return Vt})),i.d(t,"InvertStencilOp",(function(){return gi})),i.d(t,"JSONLoader",(function(){return gm})),i.d(t,"KeepStencilOp",(function(){return hi})),i.d(t,"KeyframeTrack",(function(){return ch})),i.d(t,"LOD",(function(){return tl})),i.d(t,"LatheBufferGeometry",(function(){return Dc})),i.d(t,"LatheGeometry",(function(){return Ic})),i.d(t,"Layers",(function(){return cn})),i.d(t,"LensFlare",(function(){return ym})),i.d(t,"LessDepth",(function(){return W})),i.d(t,"LessEqualDepth",(function(){return q})),i.d(t,"LessEqualStencilFunc",(function(){return xi})),i.d(t,"LessStencilFunc",(function(){return yi})),i.d(t,"Light",(function(){return eu})),i.d(t,"LightProbe",(function(){return Pu})),i.d(t,"LightShadow",(function(){return iu})),i.d(t,"Line",(function(){return yl})),i.d(t,"Line3",(function(){return wd})),i.d(t,"LineBasicMaterial",(function(){return dl})),i.d(t,"LineCurve",(function(){return Wh})),i.d(t,"LineCurve3",(function(){return qh})),i.d(t,"LineDashedMaterial",(function(){return ih})),i.d(t,"LineLoop",(function(){return _l})),i.d(t,"LinePieces",(function(){return Dp})),i.d(t,"LineSegments",(function(){return wl})),i.d(t,"LineStrip",(function(){return Ip})),i.d(t,"LinearEncoding",(function(){return Jt})),i.d(t,"LinearFilter",(function(){return _e})),i.d(t,"LinearInterpolant",(function(){return oh})),i.d(t,"LinearMipMapLinearFilter",(function(){return Ee})),i.d(t,"LinearMipMapNearestFilter",(function(){return Se})),i.d(t,"LinearMipmapLinearFilter",(function(){return Te})),i.d(t,"LinearMipmapNearestFilter",(function(){return Me})),i.d(t,"LinearToneMapping",(function(){return te})),i.d(t,"Loader",(function(){return _h})),i.d(t,"LoaderUtils",(function(){return pu})),i.d(t,"LoadingManager",(function(){return xh})),i.d(t,"LogLuvEncoding",(function(){return ti})),i.d(t,"LoopOnce",(function(){return Bt})),i.d(t,"LoopPingPong",(function(){return Gt})),i.d(t,"LoopRepeat",(function(){return Ht})),i.d(t,"LuminanceAlphaFormat",(function(){return je})),i.d(t,"LuminanceFormat",(function(){return Ue})),i.d(t,"MOUSE",(function(){return r})),i.d(t,"Material",(function(){return xr})),i.d(t,"MaterialLoader",(function(){return du})),i.d(t,"Math",(function(){return Fi})),i.d(t,"MathUtils",(function(){return Fi})),i.d(t,"Matrix3",(function(){return Hi})),i.d(t,"Matrix4",(function(){return an})),i.d(t,"MaxEquation",(function(){return P})),i.d(t,"Mesh",(function(){return sa})),i.d(t,"MeshBasicMaterial",(function(){return wr})),i.d(t,"MeshDepthMaterial",(function(){return _o})),i.d(t,"MeshDistanceMaterial",(function(){return Mo})),i.d(t,"MeshFaceMaterial",(function(){return Bp})),i.d(t,"MeshLambertMaterial",(function(){return eh})),i.d(t,"MeshMatcapMaterial",(function(){return th})),i.d(t,"MeshNormalMaterial",(function(){return Qc})),i.d(t,"MeshPhongMaterial",(function(){return Jc})),i.d(t,"MeshPhysicalMaterial",(function(){return Zc})),i.d(t,"MeshStandardMaterial",(function(){return Yc})),i.d(t,"MeshToonMaterial",(function(){return Kc})),i.d(t,"MinEquation",(function(){return k})),i.d(t,"MirroredRepeatWrapping",(function(){return ge})),i.d(t,"MixOperation",(function(){return K})),i.d(t,"MultiMaterial",(function(){return Hp})),i.d(t,"MultiplyBlending",(function(){return T})),i.d(t,"MultiplyOperation",(function(){return J})),i.d(t,"NearestFilter",(function(){return ve})),i.d(t,"NearestMipMapLinearFilter",(function(){return we})),i.d(t,"NearestMipMapNearestFilter",(function(){return be})),i.d(t,"NearestMipmapLinearFilter",(function(){return xe})),i.d(t,"NearestMipmapNearestFilter",(function(){return ye})),i.d(t,"NeverDepth",(function(){return j})),i.d(t,"NeverStencilFunc",(function(){return vi})),i.d(t,"NoBlending",(function(){return w})),i.d(t,"NoColors",(function(){return Np})),i.d(t,"NoToneMapping",(function(){return ee})),i.d(t,"NormalBlending",(function(){return _})),i.d(t,"NotEqualDepth",(function(){return Z})),i.d(t,"NotEqualStencilFunc",(function(){return _i})),i.d(t,"NumberKeyframeTrack",(function(){return dh})),i.d(t,"Object3D",(function(){return Mn})),i.d(t,"ObjectLoader",(function(){return yu})),i.d(t,"ObjectSpaceNormalMap",(function(){return li})),i.d(t,"OctahedronBufferGeometry",(function(){return Ul})),i.d(t,"OctahedronGeometry",(function(){return Gl})),i.d(t,"OneFactor",(function(){return O})),i.d(t,"OneMinusDstAlphaFactor",(function(){return B})),i.d(t,"OneMinusDstColorFactor",(function(){return G})),i.d(t,"OneMinusSrcAlphaFactor",(function(){return z})),i.d(t,"OneMinusSrcColorFactor",(function(){return D})),i.d(t,"OrthographicCamera",(function(){return ou})),i.d(t,"PCFShadowMap",(function(){return p})),i.d(t,"PCFSoftShadowMap",(function(){return m})),i.d(t,"PMREMGenerator",(function(){return xp})),i.d(t,"ParametricBufferGeometry",(function(){return Nl})),i.d(t,"ParametricGeometry",(function(){return Dl})),i.d(t,"Particle",(function(){return Up})),i.d(t,"ParticleBasicMaterial",(function(){return Wp})),i.d(t,"ParticleSystem",(function(){return jp})),i.d(t,"ParticleSystemMaterial",(function(){return qp})),i.d(t,"Path",(function(){return Kh})),i.d(t,"PerspectiveCamera",(function(){return wa})),i.d(t,"Plane",(function(){return Qn})),i.d(t,"PlaneBufferGeometry",(function(){return Ra})),i.d(t,"PlaneGeometry",(function(){return Pa})),i.d(t,"PlaneHelper",(function(){return $d})),i.d(t,"PointCloud",(function(){return Gp})),i.d(t,"PointCloudMaterial",(function(){return Vp})),i.d(t,"PointLight",(function(){return su})),i.d(t,"PointLightHelper",(function(){return Ad})),i.d(t,"Points",(function(){return Ll})),i.d(t,"PointsMaterial",(function(){return Ml})),i.d(t,"PolarGridHelper",(function(){return Dd})),i.d(t,"PolyhedronBufferGeometry",(function(){return Fl})),i.d(t,"PolyhedronGeometry",(function(){return zl})),i.d(t,"PositionalAudio",(function(){return Xu})),i.d(t,"PropertyBinding",(function(){return sd})),i.d(t,"PropertyMixer",(function(){return Zu})),i.d(t,"QuadraticBezierCurve",(function(){return $h})),i.d(t,"QuadraticBezierCurve3",(function(){return Xh})),i.d(t,"Quaternion",(function(){return $i})),i.d(t,"QuaternionKeyframeTrack",(function(){return mh})),i.d(t,"QuaternionLinearInterpolant",(function(){return ph})),i.d(t,"REVISION",(function(){return n})),i.d(t,"RGBADepthPacking",(function(){return si})),i.d(t,"RGBAFormat",(function(){return Ge})),i.d(t,"RGBAIntegerFormat",(function(){return Ke})),i.d(t,"RGBA_ASTC_10x10_Format",(function(){return wt})),i.d(t,"RGBA_ASTC_10x5_Format",(function(){return yt})),i.d(t,"RGBA_ASTC_10x6_Format",(function(){return bt})),i.d(t,"RGBA_ASTC_10x8_Format",(function(){return xt})),i.d(t,"RGBA_ASTC_12x10_Format",(function(){return _t})),i.d(t,"RGBA_ASTC_12x12_Format",(function(){return Mt})),i.d(t,"RGBA_ASTC_4x4_Format",(function(){return ht})),i.d(t,"RGBA_ASTC_5x4_Format",(function(){return ut})),i.d(t,"RGBA_ASTC_5x5_Format",(function(){return dt})),i.d(t,"RGBA_ASTC_6x5_Format",(function(){return pt})),i.d(t,"RGBA_ASTC_6x6_Format",(function(){return mt})),i.d(t,"RGBA_ASTC_8x5_Format",(function(){return ft})),i.d(t,"RGBA_ASTC_8x6_Format",(function(){return gt})),i.d(t,"RGBA_ASTC_8x8_Format",(function(){return vt})),i.d(t,"RGBA_BPTC_Format",(function(){return St})),i.d(t,"RGBA_ETC2_EAC_Format",(function(){return ct})),i.d(t,"RGBA_PVRTC_2BPPV1_Format",(function(){return st})),i.d(t,"RGBA_PVRTC_4BPPV1_Format",(function(){return at})),i.d(t,"RGBA_S3TC_DXT1_Format",(function(){return et})),i.d(t,"RGBA_S3TC_DXT3_Format",(function(){return tt})),i.d(t,"RGBA_S3TC_DXT5_Format",(function(){return it})),i.d(t,"RGBDEncoding",(function(){return ri})),i.d(t,"RGBEEncoding",(function(){return ei})),i.d(t,"RGBEFormat",(function(){return Ve})),i.d(t,"RGBFormat",(function(){return He})),i.d(t,"RGBIntegerFormat",(function(){return Je})),i.d(t,"RGBM16Encoding",(function(){return ni})),i.d(t,"RGBM7Encoding",(function(){return ii})),i.d(t,"RGB_ETC1_Format",(function(){return ot})),i.d(t,"RGB_ETC2_Format",(function(){return lt})),i.d(t,"RGB_PVRTC_2BPPV1_Format",(function(){return rt})),i.d(t,"RGB_PVRTC_4BPPV1_Format",(function(){return nt})),i.d(t,"RGB_S3TC_DXT1_Format",(function(){return Qe})),i.d(t,"RGFormat",(function(){return Ye})),i.d(t,"RGIntegerFormat",(function(){return Ze})),i.d(t,"RawShaderMaterial",(function(){return Xc})),i.d(t,"Ray",(function(){return Yn})),i.d(t,"Raycaster",(function(){return dd})),i.d(t,"RectAreaLight",(function(){return uu})),i.d(t,"RedFormat",(function(){return $e})),i.d(t,"RedIntegerFormat",(function(){return Xe})),i.d(t,"ReinhardToneMapping",(function(){return ie})),i.d(t,"RepeatWrapping",(function(){return me})),i.d(t,"ReplaceStencilOp",(function(){return ui})),i.d(t,"ReverseSubtractEquation",(function(){return A})),i.d(t,"RingBufferGeometry",(function(){return Oc})),i.d(t,"RingGeometry",(function(){return Rc})),i.d(t,"SRGB8_ALPHA8_ASTC_10x10_Format",(function(){return Nt})),i.d(t,"SRGB8_ALPHA8_ASTC_10x5_Format",(function(){return Ot})),i.d(t,"SRGB8_ALPHA8_ASTC_10x6_Format",(function(){return It})),i.d(t,"SRGB8_ALPHA8_ASTC_10x8_Format",(function(){return Dt})),i.d(t,"SRGB8_ALPHA8_ASTC_12x10_Format",(function(){return zt})),i.d(t,"SRGB8_ALPHA8_ASTC_12x12_Format",(function(){return Ft})),i.d(t,"SRGB8_ALPHA8_ASTC_4x4_Format",(function(){return Tt})),i.d(t,"SRGB8_ALPHA8_ASTC_5x4_Format",(function(){return Et})),i.d(t,"SRGB8_ALPHA8_ASTC_5x5_Format",(function(){return Ct})),i.d(t,"SRGB8_ALPHA8_ASTC_6x5_Format",(function(){return Lt})),i.d(t,"SRGB8_ALPHA8_ASTC_6x6_Format",(function(){return At})),i.d(t,"SRGB8_ALPHA8_ASTC_8x5_Format",(function(){return kt})),i.d(t,"SRGB8_ALPHA8_ASTC_8x6_Format",(function(){return Pt})),i.d(t,"SRGB8_ALPHA8_ASTC_8x8_Format",(function(){return Rt})),i.d(t,"Scene",(function(){return Sn})),i.d(t,"SceneUtils",(function(){return vm})),i.d(t,"ShaderChunk",(function(){return Oa})),i.d(t,"ShaderLib",(function(){return Ia})),i.d(t,"ShaderMaterial",(function(){return ba})),i.d(t,"ShadowMaterial",(function(){return $c})),i.d(t,"Shape",(function(){return Qh})),i.d(t,"ShapeBufferGeometry",(function(){return zc})),i.d(t,"ShapeGeometry",(function(){return Nc})),i.d(t,"ShapePath",(function(){return Su})),i.d(t,"ShapeUtils",(function(){return wc})),i.d(t,"ShortType",(function(){return Ae})),i.d(t,"Skeleton",(function(){return al})),i.d(t,"SkeletonHelper",(function(){return Ld})),i.d(t,"SkinnedMesh",(function(){return il})),i.d(t,"SmoothShading",(function(){return x})),i.d(t,"Sphere",(function(){return Gn})),i.d(t,"SphereBufferGeometry",(function(){return Pc})),i.d(t,"SphereGeometry",(function(){return kc})),i.d(t,"Spherical",(function(){return fd})),i.d(t,"SphericalHarmonics3",(function(){return ku})),i.d(t,"SphericalReflectionMapping",(function(){return ue})),i.d(t,"Spline",(function(){return sm})),i.d(t,"SplineCurve",(function(){return Yh})),i.d(t,"SplineCurve3",(function(){return am})),i.d(t,"SpotLight",(function(){return ru})),i.d(t,"SpotLightHelper",(function(){return Sd})),i.d(t,"SpotLightShadow",(function(){return nu})),i.d(t,"Sprite",(function(){return Jo})),i.d(t,"SpriteMaterial",(function(){return Fo})),i.d(t,"SrcAlphaFactor",(function(){return N})),i.d(t,"SrcAlphaSaturateFactor",(function(){return U})),i.d(t,"SrcColorFactor",(function(){return I})),i.d(t,"StaticCopyUsage",(function(){return Pi})),i.d(t,"StaticDrawUsage",(function(){return Ti})),i.d(t,"StaticReadUsage",(function(){return Li})),i.d(t,"StereoCamera",(function(){return Nu})),i.d(t,"StreamCopyUsage",(function(){return Oi})),i.d(t,"StreamDrawUsage",(function(){return Ci})),i.d(t,"StreamReadUsage",(function(){return ki})),i.d(t,"StringKeyframeTrack",(function(){return fh})),i.d(t,"SubtractEquation",(function(){return L})),i.d(t,"SubtractiveBlending",(function(){return S})),i.d(t,"TOUCH",(function(){return a})),i.d(t,"TangentSpaceNormalMap",(function(){return oi})),i.d(t,"TetrahedronBufferGeometry",(function(){return Hl})),i.d(t,"TetrahedronGeometry",(function(){return Bl})),i.d(t,"TextBufferGeometry",(function(){return Ac})),i.d(t,"TextGeometry",(function(){return Lc})),i.d(t,"Texture",(function(){return ji})),i.d(t,"TextureLoader",(function(){return kh})),i.d(t,"TorusBufferGeometry",(function(){return Kl})),i.d(t,"TorusGeometry",(function(){return Jl})),i.d(t,"TorusKnotBufferGeometry",(function(){return Zl})),i.d(t,"TorusKnotGeometry",(function(){return Yl})),i.d(t,"Triangle",(function(){return hr})),i.d(t,"TriangleFanDrawMode",(function(){return Zt})),i.d(t,"TriangleStripDrawMode",(function(){return Yt})),i.d(t,"TrianglesDrawMode",(function(){return Xt})),i.d(t,"TubeBufferGeometry",(function(){return Xl})),i.d(t,"TubeGeometry",(function(){return $l})),i.d(t,"UVMapping",(function(){return se})),i.d(t,"Uint16Attribute",(function(){return Qp})),i.d(t,"Uint16BufferAttribute",(function(){return Lr})),i.d(t,"Uint32Attribute",(function(){return tm})),i.d(t,"Uint32BufferAttribute",(function(){return kr})),i.d(t,"Uint8Attribute",(function(){return Zp})),i.d(t,"Uint8BufferAttribute",(function(){return Tr})),i.d(t,"Uint8ClampedAttribute",(function(){return Jp})),i.d(t,"Uint8ClampedBufferAttribute",(function(){return Er})),i.d(t,"Uncharted2ToneMapping",(function(){return ne})),i.d(t,"Uniform",(function(){return hd})),i.d(t,"UniformsLib",(function(){return La})),i.d(t,"UniformsUtils",(function(){return ya})),i.d(t,"UnsignedByteType",(function(){return Ce})),i.d(t,"UnsignedInt248Type",(function(){return Fe})),i.d(t,"UnsignedIntType",(function(){return Re})),i.d(t,"UnsignedShort4444Type",(function(){return De})),i.d(t,"UnsignedShort5551Type",(function(){return Ne})),i.d(t,"UnsignedShort565Type",(function(){return ze})),i.d(t,"UnsignedShortType",(function(){return ke})),i.d(t,"VSMShadowMap",(function(){return f})),i.d(t,"Vector2",(function(){return Bi})),i.d(t,"Vector3",(function(){return Zi})),i.d(t,"Vector4",(function(){return Vi})),i.d(t,"VectorKeyframeTrack",(function(){return gh})),i.d(t,"Vertex",(function(){return $p})),i.d(t,"VertexColors",(function(){return Fp})),i.d(t,"VideoTexture",(function(){return kl})),i.d(t,"WebGLCubeRenderTarget",(function(){return Ma})),i.d(t,"WebGLMultisampleRenderTarget",(function(){return qi})),i.d(t,"WebGLRenderTarget",(function(){return Wi})),i.d(t,"WebGLRenderTargetCube",(function(){return pm})),i.d(t,"WebGLRenderer",(function(){return Po})),i.d(t,"WebGLUtils",(function(){return Co})),i.d(t,"WireframeGeometry",(function(){return Il})),i.d(t,"WireframeHelper",(function(){return hm})),i.d(t,"WrapAroundEnding",(function(){return $t})),i.d(t,"XHRLoader",(function(){return um})),i.d(t,"ZeroCurvatureEnding",(function(){return Wt})),i.d(t,"ZeroFactor",(function(){return R})),i.d(t,"ZeroSlopeEnding",(function(){return qt})),i.d(t,"ZeroStencilOp",(function(){return ci})),i.d(t,"sRGBEncoding",(function(){return Kt})),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t});var n="115",r={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},a={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},s=0,o=1,l=2,c=3,h=0,u=1,d=0,p=1,m=2,f=3,g=0,v=1,y=2,b=1,x=2,w=0,_=1,M=2,S=3,T=4,E=5,C=100,L=101,A=102,k=103,P=104,R=200,O=201,I=202,D=203,N=204,z=205,F=206,B=207,H=208,G=209,U=210,j=0,V=1,W=2,q=3,$=4,X=5,Y=6,Z=7,J=0,K=1,Q=2,ee=0,te=1,ie=2,ne=3,re=4,ae=5,se=300,oe=301,le=302,ce=303,he=304,ue=305,de=306,pe=307,me=1e3,fe=1001,ge=1002,ve=1003,ye=1004,be=1004,xe=1005,we=1005,_e=1006,Me=1007,Se=1007,Te=1008,Ee=1008,Ce=1009,Le=1010,Ae=1011,ke=1012,Pe=1013,Re=1014,Oe=1015,Ie=1016,De=1017,Ne=1018,ze=1019,Fe=1020,Be=1021,He=1022,Ge=1023,Ue=1024,je=1025,Ve=Ge,We=1026,qe=1027,$e=1028,Xe=1029,Ye=1030,Ze=1031,Je=1032,Ke=1033,Qe=33776,et=33777,tt=33778,it=33779,nt=35840,rt=35841,at=35842,st=35843,ot=36196,lt=37492,ct=37496,ht=37808,ut=37809,dt=37810,pt=37811,mt=37812,ft=37813,gt=37814,vt=37815,yt=37816,bt=37817,xt=37818,wt=37819,_t=37820,Mt=37821,St=36492,Tt=37840,Et=37841,Ct=37842,Lt=37843,At=37844,kt=37845,Pt=37846,Rt=37847,Ot=37848,It=37849,Dt=37850,Nt=37851,zt=37852,Ft=37853,Bt=2200,Ht=2201,Gt=2202,Ut=2300,jt=2301,Vt=2302,Wt=2400,qt=2401,$t=2402,Xt=0,Yt=1,Zt=2,Jt=3e3,Kt=3001,Qt=3007,ei=3002,ti=3003,ii=3004,ni=3005,ri=3006,ai=3200,si=3201,oi=0,li=1,ci=0,hi=7680,ui=7681,di=7682,pi=7683,mi=34055,fi=34056,gi=5386,vi=512,yi=513,bi=514,xi=515,wi=516,_i=517,Mi=518,Si=519,Ti=35044,Ei=35048,Ci=35040,Li=35045,Ai=35049,ki=35041,Pi=35046,Ri=35050,Oi=35042;function Ii(){}Object.assign(Ii.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners[e];if(void 0!==i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var i=t.slice(0),n=0,r=i.length;n<r;n++)i[n].call(this,e)}}}});for(var Di=[],Ni=0;Ni<256;Ni++)Di[Ni]=(Ni<16?"0":"")+Ni.toString(16);var zi,Fi={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Di[255&e]+Di[e>>8&255]+Di[e>>16&255]+Di[e>>24&255]+"-"+Di[255&t]+Di[t>>8&255]+"-"+Di[t>>16&15|64]+Di[t>>24&255]+"-"+Di[63&i|128]+Di[i>>8&255]+"-"+Di[i>>16&255]+Di[i>>24&255]+Di[255&n]+Di[n>>8&255]+Di[n>>16&255]+Di[n>>24&255]).toUpperCase()},clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},lerp:function(e,t,i){return(1-i)*e+i*t},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Fi.DEG2RAD},radToDeg:function(e){return e*Fi.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,i,n,r){var a=Math.cos,s=Math.sin,o=a(i/2),l=s(i/2),c=a((t+n)/2),h=s((t+n)/2),u=a((t-n)/2),d=s((t-n)/2),p=a((n-t)/2),m=s((n-t)/2);"XYX"===r?e.set(o*h,l*u,l*d,o*c):"YZY"===r?e.set(l*d,o*h,l*u,o*c):"ZXZ"===r?e.set(l*u,l*d,o*h,o*c):"XZX"===r?e.set(o*h,l*m,l*p,o*c):"YXY"===r?e.set(l*p,o*h,l*m,o*c):"ZYZ"===r?e.set(l*m,l*p,o*h,o*c):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function Bi(e,t){this.x=e||0,this.y=t||0}function Hi(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Bi.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Bi.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,a=this.y-e.y;return this.x=r*i-a*n+e.x,this.y=r*n+a*i+e.y,this}}),Object.assign(Hi.prototype,{isMatrix3:!0,set:function(e,t,i,n,r,a,s,o,l){var c=this.elements;return c[0]=e,c[1]=n,c[2]=s,c[3]=t,c[4]=r,c[5]=o,c[6]=i,c[7]=a,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this},extractBasis:function(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,a=i[0],s=i[3],o=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],p=i[8],m=n[0],f=n[3],g=n[6],v=n[1],y=n[4],b=n[7],x=n[2],w=n[5],_=n[8];return r[0]=a*m+s*v+o*x,r[3]=a*f+s*y+o*w,r[6]=a*g+s*b+o*_,r[1]=l*m+c*v+h*x,r[4]=l*f+c*y+h*w,r[7]=l*g+c*b+h*_,r[2]=u*m+d*v+p*x,r[5]=u*f+d*y+p*w,r[8]=u*g+d*b+p*_,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8];return t*a*c-t*s*l-i*r*c+i*s*o+n*r*l-n*a*o},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var i=e.elements,n=this.elements,r=i[0],a=i[1],s=i[2],o=i[3],l=i[4],c=i[5],h=i[6],u=i[7],d=i[8],p=d*l-c*u,m=c*h-d*o,f=u*o-l*h,g=r*p+a*m+s*f;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);var v=1/g;return n[0]=p*v,n[1]=(s*u-d*a)*v,n[2]=(c*a-s*l)*v,n[3]=m*v,n[4]=(d*r-s*h)*v,n[5]=(s*o-c*r)*v,n[6]=f*v,n[7]=(a*h-u*r)*v,n[8]=(l*r-a*o)*v,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,i,n,r,a,s){var o=Math.cos(r),l=Math.sin(r);this.set(i*o,i*l,-i*(o*a+l*s)+a+e,-n*l,n*o,-n*(-l*a+o*s)+s+t,0,0,1)},scale:function(e,t){var i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this},rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=this.elements,r=n[0],a=n[3],s=n[6],o=n[1],l=n[4],c=n[7];return n[0]=t*r+i*o,n[3]=t*a+i*l,n[6]=t*s+i*c,n[1]=-i*r+t*o,n[4]=-i*a+t*l,n[7]=-i*s+t*c,this},translate:function(e,t){var i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<9;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}});var Gi={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===zi&&(zi=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),zi.width=e.width,zi.height=e.height;var i=zi.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=zi}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},Ui=0;function ji(e,t,i,n,r,a,s,o,l,c){Object.defineProperty(this,"id",{value:Ui++}),this.uuid=Fi.generateUUID(),this.name="",this.image=void 0!==e?e:ji.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:ji.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:fe,this.wrapT=void 0!==n?n:fe,this.magFilter=void 0!==r?r:_e,this.minFilter=void 0!==a?a:Te,this.anisotropy=void 0!==l?l:1,this.format=void 0!==s?s:Ge,this.internalFormat=null,this.type=void 0!==o?o:Ce,this.offset=new Bi(0,0),this.repeat=new Bi(1,1),this.center=new Bi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Hi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:Jt,this.version=0,this.onUpdate=null}function Vi(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==n?n:1}function Wi(e,t,i){this.width=e,this.height=t,this.scissor=new Vi(0,0,e,t),this.scissorTest=!1,this.viewport=new Vi(0,0,e,t),i=i||{},this.texture=new ji(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:_e,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function qi(e,t,i){Wi.call(this,e,t,i),this.samples=4}function $i(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._w=void 0!==n?n:1}ji.DEFAULT_IMAGE=void 0,ji.DEFAULT_MAPPING=se,ji.prototype=Object.assign(Object.create(Ii.prototype),{constructor:ji,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=Fi.generateUUID()),!t&&void 0===e.images[n.uuid]){var r;if(Array.isArray(n)){r=[];for(var a=0,s=n.length;a<s;a++)r.push(Gi.getDataURL(n[a]))}else r=Gi.getDataURL(n);e.images[n.uuid]={uuid:n.uuid,url:r}}i.image=n.uuid}return t||(e.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==se)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case me:e.x=e.x-Math.floor(e.x);break;case fe:e.x=e.x<0?0:1;break;case ge:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case me:e.y=e.y-Math.floor(e.y);break;case fe:e.y=e.y<0?0:1;break;case ge:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(ji.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(Vi.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(Vi.prototype,{isVector4:!0,set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*n+a[12]*r,this.y=a[1]*t+a[5]*i+a[9]*n+a[13]*r,this.z=a[2]*t+a[6]*i+a[10]*n+a[14]*r,this.w=a[3]*t+a[7]*i+a[11]*n+a[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,n,r,a=e.elements,s=a[0],o=a[4],l=a[8],c=a[1],h=a[5],u=a[9],d=a[2],p=a[6],m=a[10];if(Math.abs(o-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-p)<.01){if(Math.abs(o+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+p)<.1&&Math.abs(s+h+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var f=(s+1)/2,g=(h+1)/2,v=(m+1)/2,y=(o+c)/4,b=(l+d)/4,x=(u+p)/4;return f>g&&f>v?f<.01?(i=0,n=.707106781,r=.707106781):(n=y/(i=Math.sqrt(f)),r=b/i):g>v?g<.01?(i=.707106781,n=0,r=.707106781):(i=y/(n=Math.sqrt(g)),r=x/n):v<.01?(i=.707106781,n=.707106781,r=0):(i=b/(r=Math.sqrt(v)),n=x/r),this.set(i,n,r,t),this}var w=Math.sqrt((p-u)*(p-u)+(l-d)*(l-d)+(c-o)*(c-o));return Math.abs(w)<.001&&(w=1),this.x=(p-u)/w,this.y=(l-d)/w,this.z=(c-o)/w,this.w=Math.acos((s+h+m-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Wi.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Wi,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),qi.prototype=Object.assign(Object.create(Wi.prototype),{constructor:qi,isWebGLMultisampleRenderTarget:!0,copy:function(e){return Wi.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign($i,{slerp:function(e,t,i,n){return i.copy(e).slerp(t,n)},slerpFlat:function(e,t,i,n,r,a,s){var o=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3],u=r[a+0],d=r[a+1],p=r[a+2],m=r[a+3];if(h!==m||o!==u||l!==d||c!==p){var f=1-s,g=o*u+l*d+c*p+h*m,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,g*v);f=Math.sin(f*x)/b,s=Math.sin(s*x)/b}var w=s*v;if(o=o*f+u*w,l=l*f+d*w,c=c*f+p*w,h=h*f+m*w,f===1-s){var _=1/Math.sqrt(o*o+l*l+c*c+h*h);o*=_,l*=_,c*=_,h*=_}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=h}}),Object.defineProperties($i.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign($i.prototype,{isQuaternion:!0,set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=e._x,n=e._y,r=e._z,a=e.order,s=Math.cos,o=Math.sin,l=s(i/2),c=s(n/2),h=s(r/2),u=o(i/2),d=o(n/2),p=o(r/2);return"XYZ"===a?(this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p):"YXZ"===a?(this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p):"ZXY"===a?(this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p):"ZYX"===a?(this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p):"YZX"===a?(this._x=u*c*h+l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h-u*d*p):"XZY"===a&&(this._x=u*c*h-l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h+u*d*p),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,i=e.elements,n=i[0],r=i[4],a=i[8],s=i[1],o=i[5],l=i[9],c=i[2],h=i[6],u=i[10],d=n+o+u;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(h-l)*t,this._y=(a-c)*t,this._z=(s-r)*t):n>o&&n>u?(t=2*Math.sqrt(1+n-o-u),this._w=(h-l)/t,this._x=.25*t,this._y=(r+s)/t,this._z=(a+c)/t):o>u?(t=2*Math.sqrt(1+o-n-u),this._w=(a-c)/t,this._x=(r+s)/t,this._y=.25*t,this._z=(l+h)/t):(t=2*Math.sqrt(1+u-n-o),this._w=(s-r)/t,this._x=(a+c)/t,this._y=(l+h)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var i=e.dot(t)+1;return i<1e-6?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Fi.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var i=this.angleTo(e);if(0===i)return this;var n=Math.min(1,t/i);return this.slerp(e,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var i=e._x,n=e._y,r=e._z,a=e._w,s=t._x,o=t._y,l=t._z,c=t._w;return this._x=i*c+a*s+n*l-r*o,this._y=n*c+a*o+r*s-i*l,this._z=r*c+a*l+i*o-n*s,this._w=a*c-i*s-n*o-r*l,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var i=this._x,n=this._y,r=this._z,a=this._w,s=a*e._w+i*e._x+n*e._y+r*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=i,this._y=n,this._z=r,this;var o=1-s*s;if(o<=Number.EPSILON){var l=1-t;return this._w=l*a+t*this._w,this._x=l*i+t*this._x,this._y=l*n+t*this._y,this._z=l*r+t*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(o),h=Math.atan2(c,s),u=Math.sin((1-t)*h)/c,d=Math.sin(t*h)/c;return this._w=a*u+this._w*d,this._x=i*u+this._x*d,this._y=n*u+this._y*d,this._z=r*u+this._z*d,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},fromBufferAttribute:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var Xi=new Zi,Yi=new $i;function Zi(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0}Object.assign(Zi.prototype,{isVector3:!0,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Yi.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(Yi.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements,a=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*a,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*a,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*a,this},applyQuaternion:function(e){var t=this.x,i=this.y,n=this.z,r=e.x,a=e.y,s=e.z,o=e.w,l=o*t+a*n-s*i,c=o*i+s*t-r*n,h=o*n+r*i-a*t,u=-r*t-a*i-s*n;return this.x=l*o+u*-r+c*-s-h*-a,this.y=c*o+u*-a+h*-r-l*-s,this.z=h*o+u*-s+l*-a-c*-r,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var i=e.x,n=e.y,r=e.z,a=t.x,s=t.y,o=t.z;return this.x=n*o-r*s,this.y=r*a-i*o,this.z=i*s-n*a,this},projectOnVector:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)},projectOnPlane:function(e){return Xi.copy(this).projectOnVector(e),this.sub(Xi)},reflect:function(e){return this.sub(Xi.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var i=this.dot(e)/t;return Math.acos(Fi.clamp(i,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,i){var n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var Ji=new Zi,Ki=new an,Qi=new Zi(0,0,0),en=new Zi(1,1,1),tn=new Zi,nn=new Zi,rn=new Zi;function an(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(an.prototype,{isMatrix4:!0,set:function(e,t,i,n,r,a,s,o,l,c,h,u,d,p,m,f){var g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=n,g[1]=r,g[5]=a,g[9]=s,g[13]=o,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=m,g[15]=f,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new an).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractBasis:function(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,i=e.elements,n=1/Ji.setFromMatrixColumn(e,0).length(),r=1/Ji.setFromMatrixColumn(e,1).length(),a=1/Ji.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*a,t[9]=i[9]*a,t[10]=i[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,i=e.x,n=e.y,r=e.z,a=Math.cos(i),s=Math.sin(i),o=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if("XYZ"===e.order){var u=a*c,d=a*h,p=s*c,m=s*h;t[0]=o*c,t[4]=-o*h,t[8]=l,t[1]=d+p*l,t[5]=u-m*l,t[9]=-s*o,t[2]=m-u*l,t[6]=p+d*l,t[10]=a*o}else if("YXZ"===e.order){var f=o*c,g=o*h,v=l*c,y=l*h;t[0]=f+y*s,t[4]=v*s-g,t[8]=a*l,t[1]=a*h,t[5]=a*c,t[9]=-s,t[2]=g*s-v,t[6]=y+f*s,t[10]=a*o}else if("ZXY"===e.order){f=o*c,g=o*h,v=l*c,y=l*h;t[0]=f-y*s,t[4]=-a*h,t[8]=v+g*s,t[1]=g+v*s,t[5]=a*c,t[9]=y-f*s,t[2]=-a*l,t[6]=s,t[10]=a*o}else if("ZYX"===e.order){u=a*c,d=a*h,p=s*c,m=s*h;t[0]=o*c,t[4]=p*l-d,t[8]=u*l+m,t[1]=o*h,t[5]=m*l+u,t[9]=d*l-p,t[2]=-l,t[6]=s*o,t[10]=a*o}else if("YZX"===e.order){var b=a*o,x=a*l,w=s*o,_=s*l;t[0]=o*c,t[4]=_-b*h,t[8]=w*h+x,t[1]=h,t[5]=a*c,t[9]=-s*c,t[2]=-l*c,t[6]=x*h+w,t[10]=b-_*h}else if("XZY"===e.order){b=a*o,x=a*l,w=s*o,_=s*l;t[0]=o*c,t[4]=-h,t[8]=l*c,t[1]=b*h+_,t[5]=a*c,t[9]=x*h-w,t[2]=w*h-x,t[6]=s*c,t[10]=_*h+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(Qi,e,en)},lookAt:function(e,t,i){var n=this.elements;return rn.subVectors(e,t),0===rn.lengthSq()&&(rn.z=1),rn.normalize(),tn.crossVectors(i,rn),0===tn.lengthSq()&&(1===Math.abs(i.z)?rn.x+=1e-4:rn.z+=1e-4,rn.normalize(),tn.crossVectors(i,rn)),tn.normalize(),nn.crossVectors(rn,tn),n[0]=tn.x,n[4]=nn.x,n[8]=rn.x,n[1]=tn.y,n[5]=nn.y,n[9]=rn.y,n[2]=tn.z,n[6]=nn.z,n[10]=rn.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,a=i[0],s=i[4],o=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],p=i[2],m=i[6],f=i[10],g=i[14],v=i[3],y=i[7],b=i[11],x=i[15],w=n[0],_=n[4],M=n[8],S=n[12],T=n[1],E=n[5],C=n[9],L=n[13],A=n[2],k=n[6],P=n[10],R=n[14],O=n[3],I=n[7],D=n[11],N=n[15];return r[0]=a*w+s*T+o*A+l*O,r[4]=a*_+s*E+o*k+l*I,r[8]=a*M+s*C+o*P+l*D,r[12]=a*S+s*L+o*R+l*N,r[1]=c*w+h*T+u*A+d*O,r[5]=c*_+h*E+u*k+d*I,r[9]=c*M+h*C+u*P+d*D,r[13]=c*S+h*L+u*R+d*N,r[2]=p*w+m*T+f*A+g*O,r[6]=p*_+m*E+f*k+g*I,r[10]=p*M+m*C+f*P+g*D,r[14]=p*S+m*L+f*R+g*N,r[3]=v*w+y*T+b*A+x*O,r[7]=v*_+y*E+b*k+x*I,r[11]=v*M+y*C+b*P+x*D,r[15]=v*S+y*L+b*R+x*N,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],a=e[1],s=e[5],o=e[9],l=e[13],c=e[2],h=e[6],u=e[10],d=e[14];return e[3]*(+r*o*h-n*l*h-r*s*u+i*l*u+n*s*d-i*o*d)+e[7]*(+t*o*d-t*l*u+r*a*u-n*a*d+n*l*c-r*o*c)+e[11]*(+t*l*h-t*s*d-r*a*h+i*a*d+r*s*c-i*l*c)+e[15]*(-n*s*c-t*o*h+t*s*u+n*a*h-i*a*u+i*o*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,i){var n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var i=this.elements,n=e.elements,r=n[0],a=n[1],s=n[2],o=n[3],l=n[4],c=n[5],h=n[6],u=n[7],d=n[8],p=n[9],m=n[10],f=n[11],g=n[12],v=n[13],y=n[14],b=n[15],x=p*y*u-v*m*u+v*h*f-c*y*f-p*h*b+c*m*b,w=g*m*u-d*y*u-g*h*f+l*y*f+d*h*b-l*m*b,_=d*v*u-g*p*u+g*c*f-l*v*f-d*c*b+l*p*b,M=g*p*h-d*v*h-g*c*m+l*v*m+d*c*y-l*p*y,S=r*x+a*w+s*_+o*M;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var T=1/S;return i[0]=x*T,i[1]=(v*m*o-p*y*o-v*s*f+a*y*f+p*s*b-a*m*b)*T,i[2]=(c*y*o-v*h*o+v*s*u-a*y*u-c*s*b+a*h*b)*T,i[3]=(p*h*o-c*m*o-p*s*u+a*m*u+c*s*f-a*h*f)*T,i[4]=w*T,i[5]=(d*y*o-g*m*o+g*s*f-r*y*f-d*s*b+r*m*b)*T,i[6]=(g*h*o-l*y*o-g*s*u+r*y*u+l*s*b-r*h*b)*T,i[7]=(l*m*o-d*h*o+d*s*u-r*m*u-l*s*f+r*h*f)*T,i[8]=_*T,i[9]=(g*p*o-d*v*o-g*a*f+r*v*f+d*a*b-r*p*b)*T,i[10]=(l*v*o-g*c*o+g*a*u-r*v*u-l*a*b+r*c*b)*T,i[11]=(d*c*o-l*p*o-d*a*u+r*p*u+l*a*f-r*c*f)*T,i[12]=M*T,i[13]=(d*v*s-g*p*s+g*a*m-r*v*m-d*a*y+r*p*y)*T,i[14]=(g*c*s-l*v*s-g*a*h+r*v*h+l*a*y-r*c*y)*T,i[15]=(l*p*s-d*c*s+d*a*h-r*p*h-l*a*m+r*c*m)*T,this},scale:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=1-i,a=e.x,s=e.y,o=e.z,l=r*a,c=r*s;return this.set(l*a+i,l*s-n*o,l*o+n*s,0,l*s+n*o,c*s+i,c*o-n*a,0,l*o-n*s,c*o+n*a,r*o*o+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(e,t,i){return this.set(1,t,i,0,e,1,i,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,i){var n=this.elements,r=t._x,a=t._y,s=t._z,o=t._w,l=r+r,c=a+a,h=s+s,u=r*l,d=r*c,p=r*h,m=a*c,f=a*h,g=s*h,v=o*l,y=o*c,b=o*h,x=i.x,w=i.y,_=i.z;return n[0]=(1-(m+g))*x,n[1]=(d+b)*x,n[2]=(p-y)*x,n[3]=0,n[4]=(d-b)*w,n[5]=(1-(u+g))*w,n[6]=(f+v)*w,n[7]=0,n[8]=(p+y)*_,n[9]=(f-v)*_,n[10]=(1-(u+m))*_,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this},decompose:function(e,t,i){var n=this.elements,r=Ji.set(n[0],n[1],n[2]).length(),a=Ji.set(n[4],n[5],n[6]).length(),s=Ji.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],Ki.copy(this);var o=1/r,l=1/a,c=1/s;return Ki.elements[0]*=o,Ki.elements[1]*=o,Ki.elements[2]*=o,Ki.elements[4]*=l,Ki.elements[5]*=l,Ki.elements[6]*=l,Ki.elements[8]*=c,Ki.elements[9]*=c,Ki.elements[10]*=c,t.setFromRotationMatrix(Ki),i.x=r,i.y=a,i.z=s,this},makePerspective:function(e,t,i,n,r,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,o=2*r/(t-e),l=2*r/(i-n),c=(t+e)/(t-e),h=(i+n)/(i-n),u=-(a+r)/(a-r),d=-2*a*r/(a-r);return s[0]=o,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=l,s[9]=h,s[13]=0,s[2]=0,s[6]=0,s[10]=u,s[14]=d,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(e,t,i,n,r,a){var s=this.elements,o=1/(t-e),l=1/(i-n),c=1/(a-r),h=(t+e)*o,u=(i+n)*l,d=(a+r)*c;return s[0]=2*o,s[4]=0,s[8]=0,s[12]=-h,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-u,s[2]=0,s[6]=0,s[10]=-2*c,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<16;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}});var sn=new an,on=new $i;function ln(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._order=n||ln.DefaultOrder}function cn(){this.mask=1}ln.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ln.DefaultOrder="XYZ",Object.defineProperties(ln.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(ln.prototype,{isEuler:!0,set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._order=n||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,i){var n=Fi.clamp,r=e.elements,a=r[0],s=r[4],o=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],p=r[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(o,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-s,c)):(this._y=0,this._z=Math.atan2(l,a))):"ZYX"===t?(this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-s,c))):"YZX"===t?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,a)):(this._x=0,this._y=Math.atan2(o,p))):"XZY"===t?(this._z=Math.asin(-n(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(o,a)):(this._x=Math.atan2(-h,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==i&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,i){return sn.makeRotationFromQuaternion(e),this.setFromRotationMatrix(sn,t,i)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return on.setFromEuler(this),this.setFromQuaternion(on,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Zi(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(cn.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}});var hn=0,un=new Zi,dn=new $i,pn=new an,mn=new Zi,fn=new Zi,gn=new Zi,vn=new $i,yn=new Zi(1,0,0),bn=new Zi(0,1,0),xn=new Zi(0,0,1),wn={type:"added"},_n={type:"removed"};function Mn(){Object.defineProperty(this,"id",{value:hn++}),this.uuid=Fi.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Mn.DefaultUp.clone();var e=new Zi,t=new ln,i=new $i,n=new Zi(1,1,1);t._onChange((function(){i.setFromEuler(t,!1)})),i._onChange((function(){t.setFromQuaternion(i,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new an},normalMatrix:{value:new Hi}}),this.matrix=new an,this.matrixWorld=new an,this.matrixAutoUpdate=Mn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new cn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Sn(){Mn.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Mn.DefaultUp=new Zi(0,1,0),Mn.DefaultMatrixAutoUpdate=!0,Mn.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Mn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return dn.setFromAxisAngle(e,t),this.quaternion.multiply(dn),this},rotateOnWorldAxis:function(e,t){return dn.setFromAxisAngle(e,t),this.quaternion.premultiply(dn),this},rotateX:function(e){return this.rotateOnAxis(yn,e)},rotateY:function(e){return this.rotateOnAxis(bn,e)},rotateZ:function(e){return this.rotateOnAxis(xn,e)},translateOnAxis:function(e,t){return un.copy(e).applyQuaternion(this.quaternion),this.position.add(un.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(yn,e)},translateY:function(e){return this.translateOnAxis(bn,e)},translateZ:function(e){return this.translateOnAxis(xn,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(pn.getInverse(this.matrixWorld))},lookAt:function(e,t,i){e.isVector3?mn.copy(e):mn.set(e,t,i);var n=this.parent;this.updateWorldMatrix(!0,!1),fn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?pn.lookAt(fn,mn,this.up):pn.lookAt(mn,fn,this.up),this.quaternion.setFromRotationMatrix(pn),n&&(pn.extractRotation(n.matrixWorld),dn.setFromRotationMatrix(pn),this.quaternion.premultiply(dn.inverse()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(wn)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var i=this.children.indexOf(e);return-1!==i&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(_n)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),pn.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),pn.multiply(e.parent.matrixWorld)),e.applyMatrix4(pn),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Zi),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new $i),this.updateMatrixWorld(!0),this.matrixWorld.decompose(fn,e,gn),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Zi),this.updateMatrixWorld(!0),this.matrixWorld.decompose(fn,vn,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Zi),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var n=this.children,r=0,a=n.length;r<a;r++)n[r].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function r(t,i){return void 0===t[i.uuid]&&(t[i.uuid]=i.toJSON(e)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){n.geometry=r(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var s=a.shapes;if(Array.isArray(s))for(var o=0,l=s.length;o<l;o++){var c=s[o];r(e.shapes,c)}else r(e.shapes,s)}}if(void 0!==this.material)if(Array.isArray(this.material)){var h=[];for(o=0,l=this.material.length;o<l;o++)h.push(r(e.materials,this.material[o]));n.material=h}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(e).object)}if(t){var u=f(e.geometries),d=f(e.materials),p=f(e.textures),m=f(e.images);s=f(e.shapes);u.length>0&&(i.geometries=u),d.length>0&&(i.materials=d),p.length>0&&(i.textures=p),m.length>0&&(i.images=m),s.length>0&&(i.shapes=s)}return i.object=n,i;function f(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var i=0;i<e.children.length;i++){var n=e.children[i];this.add(n.clone())}return this}}),Sn.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Sn,isScene:!0,copy:function(e,t){return Mn.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Mn.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Tn=[new Zi,new Zi,new Zi,new Zi,new Zi,new Zi,new Zi,new Zi],En=new Zi,Cn=new Fn,Ln=new Zi,An=new Zi,kn=new Zi,Pn=new Zi,Rn=new Zi,On=new Zi,In=new Zi,Dn=new Zi,Nn=new Zi,zn=new Zi;function Fn(e,t){this.min=void 0!==e?e:new Zi(1/0,1/0,1/0),this.max=void 0!==t?t:new Zi(-1/0,-1/0,-1/0)}function Bn(e,t,i,n,r){var a,s;for(a=0,s=e.length-3;a<=s;a+=3){zn.fromArray(e,a);var o=r.x*Math.abs(zn.x)+r.y*Math.abs(zn.y)+r.z*Math.abs(zn.z),l=t.dot(zn),c=i.dot(zn),h=n.dot(zn);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>o)return!1}return!0}Object.assign(Fn.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,s=-1/0,o=0,l=e.length;o<l;o+=3){var c=e[o],h=e[o+1],u=e[o+2];c<t&&(t=c),h<i&&(i=h),u<n&&(n=u),c>r&&(r=c),h>a&&(a=h),u>s&&(s=u)}return this.min.set(t,i,n),this.max.set(r,a,s),this},setFromBufferAttribute:function(e){for(var t=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,s=-1/0,o=0,l=e.count;o<l;o++){var c=e.getX(o),h=e.getY(o),u=e.getZ(o);c<t&&(t=c),h<i&&(i=h),u<n&&(n=u),c>r&&(r=c),h>a&&(a=h),u>s&&(s=u)}return this.min.set(t,i,n),this.max.set(r,a,s),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var i=En.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Zi),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Zi),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),Cn.copy(t.boundingBox),Cn.applyMatrix4(e.matrixWorld),this.union(Cn));for(var i=e.children,n=0,r=i.length;n<r;n++)this.expandByObject(i[n]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Zi),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,En),En.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(In),Dn.subVectors(this.max,In),Ln.subVectors(e.a,In),An.subVectors(e.b,In),kn.subVectors(e.c,In),Pn.subVectors(An,Ln),Rn.subVectors(kn,An),On.subVectors(Ln,kn);var t=[0,-Pn.z,Pn.y,0,-Rn.z,Rn.y,0,-On.z,On.y,Pn.z,0,-Pn.x,Rn.z,0,-Rn.x,On.z,0,-On.x,-Pn.y,Pn.x,0,-Rn.y,Rn.x,0,-On.y,On.x,0];return!!Bn(t,Ln,An,kn,Dn)&&(!!Bn(t=[1,0,0,0,1,0,0,0,1],Ln,An,kn,Dn)&&(Nn.crossVectors(Pn,Rn),Bn(t=[Nn.x,Nn.y,Nn.z],Ln,An,kn,Dn)))},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Zi),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return En.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(En).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()||(Tn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Tn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Tn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Tn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Tn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Tn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Tn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Tn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Tn)),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Hn=new Fn;function Gn(e,t){this.center=void 0!==e?e:new Zi,this.radius=void 0!==t?t:0}Object.assign(Gn.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var i=this.center;void 0!==t?i.copy(t):Hn.setFromPoints(e).getCenter(i);for(var n=0,r=0,a=e.length;r<a;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var i=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Zi),t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Fn),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var Un=new Zi,jn=new Zi,Vn=new Zi,Wn=new Zi,qn=new Zi,$n=new Zi,Xn=new Zi;function Yn(e,t){this.origin=void 0!==e?e:new Zi,this.direction=void 0!==t?t:new Zi(0,0,-1)}Object.assign(Yn.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Zi),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,Un)),this},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Zi),t.subVectors(e,this.origin);var i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=Un.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Un.copy(this.direction).multiplyScalar(t).add(this.origin),Un.distanceToSquared(e))},distanceSqToSegment:function(e,t,i,n){jn.copy(e).add(t).multiplyScalar(.5),Vn.copy(t).sub(e).normalize(),Wn.copy(this.origin).sub(jn);var r,a,s,o,l=.5*e.distanceTo(t),c=-this.direction.dot(Vn),h=Wn.dot(this.direction),u=-Wn.dot(Vn),d=Wn.lengthSq(),p=Math.abs(1-c*c);if(p>0)if(a=c*h-u,o=l*p,(r=c*u-h)>=0)if(a>=-o)if(a<=o){var m=1/p;s=(r*=m)*(r+c*(a*=m)+2*h)+a*(c*r+a+2*u)+d}else a=l,s=-(r=Math.max(0,-(c*a+h)))*r+a*(a+2*u)+d;else a=-l,s=-(r=Math.max(0,-(c*a+h)))*r+a*(a+2*u)+d;else a<=-o?s=-(r=Math.max(0,-(-c*l+h)))*r+(a=r>0?-l:Math.min(Math.max(-l,-u),l))*(a+2*u)+d:a<=o?(r=0,s=(a=Math.min(Math.max(-l,-u),l))*(a+2*u)+d):s=-(r=Math.max(0,-(c*l+h)))*r+(a=r>0?l:Math.min(Math.max(-l,-u),l))*(a+2*u)+d;else a=c>0?-l:l,s=-(r=Math.max(0,-(c*a+h)))*r+a*(a+2*u)+d;return i&&i.copy(this.direction).multiplyScalar(r).add(this.origin),n&&n.copy(Vn).multiplyScalar(a).add(jn),s},intersectSphere:function(e,t){Un.subVectors(e.center,this.origin);var i=Un.dot(this.direction),n=Un.dot(Un)-i*i,r=e.radius*e.radius;if(n>r)return null;var a=Math.sqrt(r-n),s=i-a,o=i+a;return s<0&&o<0?null:s<0?this.at(o,t):this.at(s,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return null===i?null:this.at(i,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var i,n,r,a,s,o,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(i=(e.min.x-u.x)*l,n=(e.max.x-u.x)*l):(i=(e.max.x-u.x)*l,n=(e.min.x-u.x)*l),c>=0?(r=(e.min.y-u.y)*c,a=(e.max.y-u.y)*c):(r=(e.max.y-u.y)*c,a=(e.min.y-u.y)*c),i>a||r>n?null:((r>i||i!=i)&&(i=r),(a<n||n!=n)&&(n=a),h>=0?(s=(e.min.z-u.z)*h,o=(e.max.z-u.z)*h):(s=(e.max.z-u.z)*h,o=(e.min.z-u.z)*h),i>o||s>n?null:((s>i||i!=i)&&(i=s),(o<n||n!=n)&&(n=o),n<0?null:this.at(i>=0?i:n,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,Un)},intersectTriangle:function(e,t,i,n,r){qn.subVectors(t,e),$n.subVectors(i,e),Xn.crossVectors(qn,$n);var a,s=this.direction.dot(Xn);if(s>0){if(n)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}Wn.subVectors(this.origin,e);var o=a*this.direction.dot($n.crossVectors(Wn,$n));if(o<0)return null;var l=a*this.direction.dot(qn.cross(Wn));if(l<0)return null;if(o+l>s)return null;var c=-a*Wn.dot(Xn);return c<0?null:this.at(c/s,r)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var Zn=new Zi,Jn=new Zi,Kn=new Hi;function Qn(e,t){this.normal=void 0!==e?e:new Zi(1,0,0),this.constant=void 0!==t?t:0}Object.assign(Qn.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,i){var n=Zn.subVectors(i,t).cross(Jn.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Zi),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Zi);var i=e.delta(Zn),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?void 0:t.copy(i).multiplyScalar(r).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Zi),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var i=t||Kn.getNormalMatrix(e),n=this.coplanarPoint(Zn).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var er=new Zi,tr=new Zi,ir=new Zi,nr=new Zi,rr=new Zi,ar=new Zi,sr=new Zi,or=new Zi,lr=new Zi,cr=new Zi;function hr(e,t,i){this.a=void 0!==e?e:new Zi,this.b=void 0!==t?t:new Zi,this.c=void 0!==i?i:new Zi}Object.assign(hr,{getNormal:function(e,t,i,n){void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new Zi),n.subVectors(i,t),er.subVectors(e,t),n.cross(er);var r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)},getBarycoord:function(e,t,i,n,r){er.subVectors(n,t),tr.subVectors(i,t),ir.subVectors(e,t);var a=er.dot(er),s=er.dot(tr),o=er.dot(ir),l=tr.dot(tr),c=tr.dot(ir),h=a*l-s*s;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new Zi),0===h)return r.set(-2,-1,-1);var u=1/h,d=(l*o-s*c)*u,p=(a*c-s*o)*u;return r.set(1-d-p,p,d)},containsPoint:function(e,t,i,n){return hr.getBarycoord(e,t,i,n,nr),nr.x>=0&&nr.y>=0&&nr.x+nr.y<=1},getUV:function(e,t,i,n,r,a,s,o){return this.getBarycoord(e,t,i,n,nr),o.set(0,0),o.addScaledVector(r,nr.x),o.addScaledVector(a,nr.y),o.addScaledVector(s,nr.z),o},isFrontFacing:function(e,t,i,n){return er.subVectors(i,t),tr.subVectors(e,t),er.cross(tr).dot(n)<0}}),Object.assign(hr.prototype,{set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return er.subVectors(this.c,this.b),tr.subVectors(this.a,this.b),.5*er.cross(tr).length()},getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Zi),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return hr.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Qn),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return hr.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,i,n,r){return hr.getUV(e,this.a,this.b,this.c,t,i,n,r)},containsPoint:function(e){return hr.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return hr.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Zi);var i,n,r=this.a,a=this.b,s=this.c;rr.subVectors(a,r),ar.subVectors(s,r),or.subVectors(e,r);var o=rr.dot(or),l=ar.dot(or);if(o<=0&&l<=0)return t.copy(r);lr.subVectors(e,a);var c=rr.dot(lr),h=ar.dot(lr);if(c>=0&&h<=c)return t.copy(a);var u=o*h-c*l;if(u<=0&&o>=0&&c<=0)return i=o/(o-c),t.copy(r).addScaledVector(rr,i);cr.subVectors(e,s);var d=rr.dot(cr),p=ar.dot(cr);if(p>=0&&d<=p)return t.copy(s);var m=d*l-o*p;if(m<=0&&l>=0&&p<=0)return n=l/(l-p),t.copy(r).addScaledVector(ar,n);var f=c*p-d*h;if(f<=0&&h-c>=0&&d-p>=0)return sr.subVectors(s,a),n=(h-c)/(h-c+(d-p)),t.copy(a).addScaledVector(sr,n);var g=1/(f+m+u);return i=m*g,n=u*g,t.copy(r).addScaledVector(rr,i).addScaledVector(ar,n)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var ur={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dr={h:0,s:0,l:0},pr={h:0,s:0,l:0};function mr(e,t,i){return void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}function fr(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+6*(t-e)*(2/3-i):e}function gr(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function vr(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function yr(e,t,i,n,r,a){this.a=e,this.b=t,this.c=i,this.normal=n&&n.isVector3?n:new Zi,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new mr,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}Object.assign(mr.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(e,t,i){if(e=Fi.euclideanModulo(e,1),t=Fi.clamp(t,0,1),i=Fi.clamp(i,0,1),0===t)this.r=this.g=this.b=i;else{var n=i<=.5?i*(1+t):i+t-i*t,r=2*i-n;this.r=fr(r,n,e+1/3),this.g=fr(r,n,e),this.b=fr(r,n,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,r=i[1],a=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var s=parseFloat(n[1])/360,o=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(s,o,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c=i[1],h=c.length;if(3===h)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===h)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){var t=ur[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var i=t>0?1/t:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=gr(e.r),this.g=gr(e.g),this.b=gr(e.b),this},copyLinearToSRGB:function(e){return this.r=vr(e.r),this.g=vr(e.g),this.b=vr(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,i,n=this.r,r=this.g,a=this.b,s=Math.max(n,r,a),o=Math.min(n,r,a),l=(o+s)/2;if(o===s)t=0,i=0;else{var c=s-o;switch(i=l<=.5?c/(s+o):c/(2-s-o),s){case n:t=(r-a)/c+(r<a?6:0);break;case r:t=(a-n)/c+2;break;case a:t=(n-r)/c+4}t/=6}return e.h=t,e.s=i,e.l=l,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,i){return this.getHSL(dr),dr.h+=e,dr.s+=t,dr.l+=i,this.setHSL(dr.h,dr.s,dr.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(dr),e.getHSL(pr);var i=Fi.lerp(dr.h,pr.h,t),n=Fi.lerp(dr.s,pr.s,t),r=Fi.lerp(dr.l,pr.l,t);return this.setHSL(i,n,r),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),mr.NAMES=ur,Object.assign(yr.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var br=0;function xr(){Object.defineProperty(this,"id",{value:br++}),this.uuid=Fi.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=_,this.side=g,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=N,this.blendDst=z,this.blendEquation=C,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=q,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Si,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=hi,this.stencilZFail=hi,this.stencilZPass=hi,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function wr(e){xr.call(this),this.type="MeshBasicMaterial",this.color=new mr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}xr.prototype=Object.assign(Object.create(Ii.prototype),{constructor:xr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i)if("shading"!==t){var n=this[t];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===b;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(i.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,i.reflectivity=this.reflectivity,i.refractionRatio=this.refractionRatio,void 0!==this.combine&&(i.combine=this.combine),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==_&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),this.side!==g&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.morphNormals&&(i.morphNormals=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){var r=n(e.textures),a=n(e.images);r.length>0&&(i.textures=r),a.length>0&&(i.images=a)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,i=null;if(null!==t){var n=t.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(xr.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),wr.prototype=Object.create(xr.prototype),wr.prototype.constructor=wr,wr.prototype.isMeshBasicMaterial=!0,wr.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var _r=new Zi;function Mr(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.usage=Ti,this.updateRange={offset:0,count:-1},this.version=0}function Sr(e,t,i){Mr.call(this,new Int8Array(e),t,i)}function Tr(e,t,i){Mr.call(this,new Uint8Array(e),t,i)}function Er(e,t,i){Mr.call(this,new Uint8ClampedArray(e),t,i)}function Cr(e,t,i){Mr.call(this,new Int16Array(e),t,i)}function Lr(e,t,i){Mr.call(this,new Uint16Array(e),t,i)}function Ar(e,t,i){Mr.call(this,new Int32Array(e),t,i)}function kr(e,t,i){Mr.call(this,new Uint32Array(e),t,i)}function Pr(e,t,i){Mr.call(this,new Float32Array(e),t,i)}function Rr(e,t,i){Mr.call(this,new Float64Array(e),t,i)}function Or(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ir(e){if(0===e.length)return-1/0;for(var t=e[0],i=1,n=e.length;i<n;++i)e[i]>t&&(t=e[i]);return t}Object.defineProperty(Mr.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Mr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,i){e*=this.itemSize,i*=t.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new mr),t[i++]=a.r,t[i++]=a.g,t[i++]=a.b}return this},copyVector2sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new Bi),t[i++]=a.x,t[i++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new Zi),t[i++]=a.x,t[i++]=a.y,t[i++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new Vi),t[i++]=a.x,t[i++]=a.y,t[i++]=a.z,t[i++]=a.w}return this},applyMatrix3:function(e){for(var t=0,i=this.count;t<i;t++)_r.x=this.getX(t),_r.y=this.getY(t),_r.z=this.getZ(t),_r.applyMatrix3(e),this.setXYZ(t,_r.x,_r.y,_r.z);return this},applyMatrix4:function(e){for(var t=0,i=this.count;t<i;t++)_r.x=this.getX(t),_r.y=this.getY(t),_r.z=this.getZ(t),_r.applyMatrix4(e),this.setXYZ(t,_r.x,_r.y,_r.z);return this},applyNormalMatrix:function(e){for(var t=0,i=this.count;t<i;t++)_r.x=this.getX(t),_r.y=this.getY(t),_r.z=this.getZ(t),_r.applyNormalMatrix(e),this.setXYZ(t,_r.x,_r.y,_r.z);return this},transformDirection:function(e){for(var t=0,i=this.count;t<i;t++)_r.x=this.getX(t),_r.y=this.getY(t),_r.z=this.getZ(t),_r.transformDirection(e),this.setXYZ(t,_r.x,_r.y,_r.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Sr.prototype=Object.create(Mr.prototype),Sr.prototype.constructor=Sr,Tr.prototype=Object.create(Mr.prototype),Tr.prototype.constructor=Tr,Er.prototype=Object.create(Mr.prototype),Er.prototype.constructor=Er,Cr.prototype=Object.create(Mr.prototype),Cr.prototype.constructor=Cr,Lr.prototype=Object.create(Mr.prototype),Lr.prototype.constructor=Lr,Ar.prototype=Object.create(Mr.prototype),Ar.prototype.constructor=Ar,kr.prototype=Object.create(Mr.prototype),kr.prototype.constructor=kr,Pr.prototype=Object.create(Mr.prototype),Pr.prototype.constructor=Pr,Rr.prototype=Object.create(Mr.prototype),Rr.prototype.constructor=Rr,Object.assign(Or.prototype,{computeGroups:function(e){for(var t,i=[],n=void 0,r=e.faces,a=0;a<r.length;a++){var s=r[a];s.materialIndex!==n&&(n=s.materialIndex,void 0!==t&&(t.count=3*a-t.start,i.push(t)),t={start:3*a,materialIndex:n})}void 0!==t&&(t.count=3*a-t.start,i.push(t)),this.groups=i},fromGeometry:function(e){var t,i=e.faces,n=e.vertices,r=e.faceVertexUvs,a=r[0]&&r[0].length>0,s=r[1]&&r[1].length>0,o=e.morphTargets,l=o.length;if(l>0){t=[];for(var c=0;c<l;c++)t[c]={name:o[c].name,data:[]};this.morphTargets.position=t}var h,u=e.morphNormals,d=u.length;if(d>0){h=[];for(c=0;c<d;c++)h[c]={name:u[c].name,data:[]};this.morphTargets.normal=h}var p=e.skinIndices,m=e.skinWeights,f=p.length===n.length,g=m.length===n.length;n.length>0&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(c=0;c<i.length;c++){var v=i[c];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var x,w=v.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var _=v.color;this.colors.push(_,_,_)}if(!0===a)void 0!==(x=r[0][c])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new Bi,new Bi,new Bi));if(!0===s)void 0!==(x=r[1][c])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new Bi,new Bi,new Bi));for(var M=0;M<l;M++){var S=o[M].vertices;t[M].data.push(S[v.a],S[v.b],S[v.c])}for(M=0;M<d;M++){var T=u[M].vertexNormals[c];h[M].data.push(T.a,T.b,T.c)}f&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(m[v.a],m[v.b],m[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});var Dr=1,Nr=new an,zr=new Mn,Fr=new Zi,Br=new Fn,Hr=new Fn,Gr=new Zi;function Ur(){Object.defineProperty(this,"id",{value:Dr+=2}),this.uuid=Fi.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Ur.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Ur,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Ir(e)>65535?kr:Lr)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var i=this.attributes.normal;if(void 0!==i){var n=(new Hi).getNormalMatrix(e);i.applyNormalMatrix(n),i.needsUpdate=!0}var r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return Nr.makeRotationX(e),this.applyMatrix4(Nr),this},rotateY:function(e){return Nr.makeRotationY(e),this.applyMatrix4(Nr),this},rotateZ:function(e){return Nr.makeRotationZ(e),this.applyMatrix4(Nr),this},translate:function(e,t,i){return Nr.makeTranslation(e,t,i),this.applyMatrix4(Nr),this},scale:function(e,t,i){return Nr.makeScale(e,t,i),this.applyMatrix4(Nr),this},lookAt:function(e){return zr.lookAt(e),zr.updateMatrix(),this.applyMatrix4(zr.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fr).negate(),this.translate(Fr.x,Fr.y,Fr.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var i=new Pr(3*t.vertices.length,3),n=new Pr(3*t.colors.length,3);if(this.setAttribute("position",i.copyVector3sArray(t.vertices)),this.setAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new Pr(t.lineDistances.length,1);this.setAttribute("lineDistance",r.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Pr(t,3)),this},updateFromObject:function(e){var t,i=e.geometry;if(e.isMesh){var n=i.__directGeometry;if(!0===i.elementsNeedUpdate&&(n=void 0,i.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}return!0===i.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(i.vertices),t.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(i.normals),t.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(i.colors),t.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(i.uvs),t.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(i.lineDistances),t.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(e.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Or).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new Mr(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var i=new Float32Array(3*e.normals.length);this.setAttribute("normal",new Mr(i,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.setAttribute("color",new Mr(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var r=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new Mr(r,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new Mr(a,2).copyVector2sArray(e.uvs2))}for(var s in this.groups=e.groups,e.morphTargets){for(var o=[],l=e.morphTargets[s],c=0,h=l.length;c<h;c++){var u=l[c],d=new Pr(3*u.data.length,3);d.name=u.name,o.push(d.copyVector3sArray(u.data))}this.morphAttributes[s]=o}if(e.skinIndices.length>0){var p=new Pr(4*e.skinIndices.length,4);this.setAttribute("skinIndex",p.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var m=new Pr(4*e.skinWeights.length,4);this.setAttribute("skinWeight",m.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Fn);var e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var i=0,n=t.length;i<n;i++){var r=t[i];Br.setFromBufferAttribute(r),this.morphTargetsRelative?(Gr.addVectors(this.boundingBox.min,Br.min),this.boundingBox.expandByPoint(Gr),Gr.addVectors(this.boundingBox.max,Br.max),this.boundingBox.expandByPoint(Gr)):(this.boundingBox.expandByPoint(Br.min),this.boundingBox.expandByPoint(Br.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Gn);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var i=this.boundingSphere.center;if(Br.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var a=t[n];Hr.setFromBufferAttribute(a),this.morphTargetsRelative?(Gr.addVectors(Br.min,Hr.min),Br.expandByPoint(Gr),Gr.addVectors(Br.max,Hr.max),Br.expandByPoint(Gr)):(Br.expandByPoint(Hr.min),Br.expandByPoint(Hr.max))}Br.getCenter(i);var s=0;for(n=0,r=e.count;n<r;n++)Gr.fromBufferAttribute(e,n),s=Math.max(s,i.distanceToSquared(Gr));if(t)for(n=0,r=t.length;n<r;n++){a=t[n];for(var o=this.morphTargetsRelative,l=0,c=a.count;l<c;l++)Gr.fromBufferAttribute(a,l),o&&(Fr.fromBufferAttribute(e,l),Gr.add(Fr)),s=Math.max(s,i.distanceToSquared(Gr))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var i=t.position.array;if(void 0===t.normal)this.setAttribute("normal",new Mr(new Float32Array(i.length),3));else for(var n=t.normal.array,r=0,a=n.length;r<a;r++)n[r]=0;var s,o,l,c=t.normal.array,h=new Zi,u=new Zi,d=new Zi,p=new Zi,m=new Zi;if(e){var f=e.array;for(r=0,a=e.count;r<a;r+=3)s=3*f[r+0],o=3*f[r+1],l=3*f[r+2],h.fromArray(i,s),u.fromArray(i,o),d.fromArray(i,l),p.subVectors(d,u),m.subVectors(h,u),p.cross(m),c[s]+=p.x,c[s+1]+=p.y,c[s+2]+=p.z,c[o]+=p.x,c[o+1]+=p.y,c[o+2]+=p.z,c[l]+=p.x,c[l+1]+=p.y,c[l+2]+=p.z}else for(r=0,a=i.length;r<a;r+=9)h.fromArray(i,r),u.fromArray(i,r+3),d.fromArray(i,r+6),p.subVectors(d,u),m.subVectors(h,u),p.cross(m),c[r]=p.x,c[r+1]=p.y,c[r+2]=p.z,c[r+3]=p.x,c[r+4]=p.y,c[r+5]=p.z,c[r+6]=p.x,c[r+7]=p.y,c[r+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes;for(var n in i)if(void 0!==e.attributes[n])for(var r=i[n].array,a=e.attributes[n],s=a.array,o=a.itemSize*t,l=Math.min(s.length,r.length-o),c=0,h=o;c<l;c++,h++)r[h]=s[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,i=e.count;t<i;t++)Gr.x=e.getX(t),Gr.y=e.getY(t),Gr.z=e.getZ(t),Gr.normalize(),e.setXYZ(t,Gr.x,Gr.y,Gr.z)},toNonIndexed:function(){function e(e,t){for(var i=e.array,n=e.itemSize,r=new i.constructor(t.length*n),a=0,s=0,o=0,l=t.length;o<l;o++){a=t[o]*n;for(var c=0;c<n;c++)r[s++]=i[a++]}return new Mr(r,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Ur,i=this.index.array,n=this.attributes;for(var r in n){var a=e(n[r],i);t.setAttribute(r,a)}var s=this.morphAttributes;for(r in s){for(var o=[],l=s[r],c=0,h=l.length;c<h;c++){a=e(l[c],i);o.push(a)}t.morphAttributes[r]=o}t.morphTargetsRelative=this.morphTargetsRelative;for(var u=this.groups,d=(c=0,u.length);c<d;c++){var p=u[c];t.addGroup(p.start,p.count,p.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};var n=this.index;null!==n&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var r=this.attributes;for(var i in r){var a=(d=r[i]).toJSON();""!==d.name&&(a.name=d.name),e.data.attributes[i]=a}var s={},o=!1;for(var i in this.morphAttributes){for(var l=this.morphAttributes[i],c=[],h=0,u=l.length;h<u;h++){var d;a=(d=l[h]).toJSON();""!==d.name&&(a.name=d.name),c.push(a)}c.length>0&&(s[i]=c,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var p=this.groups;p.length>0&&(e.data.groups=JSON.parse(JSON.stringify(p)));var m=this.boundingSphere;return null!==m&&(e.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),e},clone:function(){return(new Ur).copy(this)},copy:function(e){var t,i,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.index;null!==r&&this.setIndex(r.clone());var a=e.attributes;for(t in a){var s=a[t];this.setAttribute(t,s.clone())}var o=e.morphAttributes;for(t in o){var l=[],c=o[t];for(i=0,n=c.length;i<n;i++)l.push(c[i].clone());this.morphAttributes[t]=l}this.morphTargetsRelative=e.morphTargetsRelative;var h=e.groups;for(i=0,n=h.length;i<n;i++){var u=h[i];this.addGroup(u.start,u.count,u.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var jr=new an,Vr=new Yn,Wr=new Gn,qr=new Zi,$r=new Zi,Xr=new Zi,Yr=new Zi,Zr=new Zi,Jr=new Zi,Kr=new Zi,Qr=new Zi,ea=new Zi,ta=new Bi,ia=new Bi,na=new Bi,ra=new Zi,aa=new Zi;function sa(e,t){Mn.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Ur,this.material=void 0!==t?t:new wr,this.updateMorphTargets()}function oa(e,t,i,n,r,a,s,o){if(null===(t.side===v?n.intersectTriangle(s,a,r,!0,o):n.intersectTriangle(r,a,s,t.side!==y,o)))return null;aa.copy(o),aa.applyMatrix4(e.matrixWorld);var l=i.ray.origin.distanceTo(aa);return l<i.near||l>i.far?null:{distance:l,point:aa.clone(),object:e}}function la(e,t,i,n,r,a,s,o,l,c,h,u){qr.fromBufferAttribute(r,c),$r.fromBufferAttribute(r,h),Xr.fromBufferAttribute(r,u);var d=e.morphTargetInfluences;if(t.morphTargets&&a&&d){Kr.set(0,0,0),Qr.set(0,0,0),ea.set(0,0,0);for(var p=0,m=a.length;p<m;p++){var f=d[p],g=a[p];0!==f&&(Yr.fromBufferAttribute(g,c),Zr.fromBufferAttribute(g,h),Jr.fromBufferAttribute(g,u),s?(Kr.addScaledVector(Yr,f),Qr.addScaledVector(Zr,f),ea.addScaledVector(Jr,f)):(Kr.addScaledVector(Yr.sub(qr),f),Qr.addScaledVector(Zr.sub($r),f),ea.addScaledVector(Jr.sub(Xr),f)))}qr.add(Kr),$r.add(Qr),Xr.add(ea)}var v=oa(e,t,i,n,qr,$r,Xr,ra);if(v){o&&(ta.fromBufferAttribute(o,c),ia.fromBufferAttribute(o,h),na.fromBufferAttribute(o,u),v.uv=hr.getUV(ra,qr,$r,Xr,ta,ia,na,new Bi)),l&&(ta.fromBufferAttribute(l,c),ia.fromBufferAttribute(l,h),na.fromBufferAttribute(l,u),v.uv2=hr.getUV(ra,qr,$r,Xr,ta,ia,na,new Bi));var y=new yr(c,h,u);hr.getNormal(qr,$r,Xr,y.normal),v.face=y}return v}sa.prototype=Object.assign(Object.create(Mn.prototype),{constructor:sa,isMesh:!0,copy:function(e){return Mn.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,a=Object.keys(r);if(a.length>0){var s=r[a[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)i=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}else{var o=n.morphTargets;void 0!==o&&o.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var i,n=this.geometry,r=this.material,a=this.matrixWorld;if(void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),Wr.copy(n.boundingSphere),Wr.applyMatrix4(a),!1!==e.ray.intersectsSphere(Wr)&&(jr.getInverse(a),Vr.copy(e.ray).applyMatrix4(jr),null===n.boundingBox||!1!==Vr.intersectsBox(n.boundingBox))))if(n.isBufferGeometry){var s,o,l,c,h,u,d,p,m,f=n.index,g=n.attributes.position,v=n.morphAttributes.position,y=n.morphTargetsRelative,b=n.attributes.uv,x=n.attributes.uv2,w=n.groups,_=n.drawRange;if(null!==f)if(Array.isArray(r))for(c=0,u=w.length;c<u;c++)for(m=r[(p=w[c]).materialIndex],h=Math.max(p.start,_.start),d=Math.min(p.start+p.count,_.start+_.count);h<d;h+=3)s=f.getX(h),o=f.getX(h+1),l=f.getX(h+2),(i=la(this,m,e,Vr,g,v,y,b,x,s,o,l))&&(i.faceIndex=Math.floor(h/3),i.face.materialIndex=p.materialIndex,t.push(i));else for(c=Math.max(0,_.start),u=Math.min(f.count,_.start+_.count);c<u;c+=3)s=f.getX(c),o=f.getX(c+1),l=f.getX(c+2),(i=la(this,r,e,Vr,g,v,y,b,x,s,o,l))&&(i.faceIndex=Math.floor(c/3),t.push(i));else if(void 0!==g)if(Array.isArray(r))for(c=0,u=w.length;c<u;c++)for(m=r[(p=w[c]).materialIndex],h=Math.max(p.start,_.start),d=Math.min(p.start+p.count,_.start+_.count);h<d;h+=3)(i=la(this,m,e,Vr,g,v,y,b,x,s=h,o=h+1,l=h+2))&&(i.faceIndex=Math.floor(h/3),i.face.materialIndex=p.materialIndex,t.push(i));else for(c=Math.max(0,_.start),u=Math.min(g.count,_.start+_.count);c<u;c+=3)(i=la(this,r,e,Vr,g,v,y,b,x,s=c,o=c+1,l=c+2))&&(i.faceIndex=Math.floor(c/3),t.push(i))}else if(n.isGeometry){var M,S,T,E,C=Array.isArray(r),L=n.vertices,A=n.faces,k=n.faceVertexUvs[0];k.length>0&&(E=k);for(var P=0,R=A.length;P<R;P++){var O=A[P],I=C?r[O.materialIndex]:r;if(void 0!==I&&(M=L[O.a],S=L[O.b],T=L[O.c],i=oa(this,I,e,Vr,M,S,T,ra))){if(E&&E[P]){var D=E[P];ta.copy(D[0]),ia.copy(D[1]),na.copy(D[2]),i.uv=hr.getUV(ra,M,S,T,ta,ia,na,new Bi)}i.face=O,i.faceIndex=P,t.push(i)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ca=0,ha=new an,ua=new Mn,da=new Zi;function pa(){Object.defineProperty(this,"id",{value:ca+=2}),this.uuid=Fi.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}pa.prototype=Object.assign(Object.create(Ii.prototype),{constructor:pa,isGeometry:!0,applyMatrix4:function(e){for(var t=(new Hi).getNormalMatrix(e),i=0,n=this.vertices.length;i<n;i++){this.vertices[i].applyMatrix4(e)}for(i=0,n=this.faces.length;i<n;i++){var r=this.faces[i];r.normal.applyMatrix3(t).normalize();for(var a=0,s=r.vertexNormals.length;a<s;a++)r.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return ha.makeRotationX(e),this.applyMatrix4(ha),this},rotateY:function(e){return ha.makeRotationY(e),this.applyMatrix4(ha),this},rotateZ:function(e){return ha.makeRotationZ(e),this.applyMatrix4(ha),this},translate:function(e,t,i){return ha.makeTranslation(e,t,i),this.applyMatrix4(ha),this},scale:function(e,t,i){return ha.makeScale(e,t,i),this.applyMatrix4(ha),this},lookAt:function(e){return ua.lookAt(e),ua.updateMatrix(),this.applyMatrix4(ua.matrix),this},fromBufferGeometry:function(e){var t=this,i=null!==e.index?e.index.array:void 0,n=e.attributes;if(void 0===n.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var r=n.position.array,a=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,o=void 0!==n.uv?n.uv.array:void 0,l=void 0!==n.uv2?n.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var c=0;c<r.length;c+=3)t.vertices.push((new Zi).fromArray(r,c)),void 0!==s&&t.colors.push((new mr).fromArray(s,c));function h(e,i,n,r){var c=void 0===s?[]:[t.colors[e].clone(),t.colors[i].clone(),t.colors[n].clone()],h=new yr(e,i,n,void 0===a?[]:[(new Zi).fromArray(a,3*e),(new Zi).fromArray(a,3*i),(new Zi).fromArray(a,3*n)],c,r);t.faces.push(h),void 0!==o&&t.faceVertexUvs[0].push([(new Bi).fromArray(o,2*e),(new Bi).fromArray(o,2*i),(new Bi).fromArray(o,2*n)]),void 0!==l&&t.faceVertexUvs[1].push([(new Bi).fromArray(l,2*e),(new Bi).fromArray(l,2*i),(new Bi).fromArray(l,2*n)])}var u=e.groups;if(u.length>0)for(c=0;c<u.length;c++)for(var d=u[c],p=d.start,m=p,f=p+d.count;m<f;m+=3)void 0!==i?h(i[m],i[m+1],i[m+2],d.materialIndex):h(m,m+1,m+2,d.materialIndex);else if(void 0!==i)for(c=0;c<i.length;c+=3)h(i[c],i[c+1],i[c+2]);else for(c=0;c<r.length/3;c+=3)h(c,c+1,c+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(da).negate(),this.translate(da.x,da.y,da.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,i=0===t?1:1/t,n=new an;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix4(n),this},computeFaceNormals:function(){for(var e=new Zi,t=new Zi,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],a=this.vertices[r.a],s=this.vertices[r.b],o=this.vertices[r.c];e.subVectors(o,s),t.subVectors(a,s),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,i,n,r,a,s;for(void 0===e&&(e=!0),s=new Array(this.vertices.length),t=0,i=this.vertices.length;t<i;t++)s[t]=new Zi;if(e){var o,l,c,h=new Zi,u=new Zi;for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],o=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c],h.subVectors(c,l),u.subVectors(o,l),h.cross(u),s[a.a].add(h),s[a.b].add(h),s[a.c].add(h)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;n<r;n++)s[(a=this.faces[n]).a].add(a.normal),s[a.b].add(a.normal),s[a.c].add(a.normal);for(t=0,i=this.vertices.length;t<i;t++)s[t].normalize();for(n=0,r=this.faces.length;n<r;n++){var d=(a=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(s[a.a]),d[1].copy(s[a.b]),d[2].copy(s[a.c])):(d[0]=s[a.a].clone(),d[1]=s[a.b].clone(),d[2]=s[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,i;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=(i=this.faces[e]).vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,i,n,r;for(i=0,n=this.faces.length;i<n;i++)for((r=this.faces[i]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var a=new pa;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var s=this.morphNormals[e].faceNormals,o=this.morphNormals[e].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)l=new Zi,c={a:new Zi,b:new Zi,c:new Zi},s.push(l),o.push(c)}var l,c,h=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),i=0,n=this.faces.length;i<n;i++)r=this.faces[i],l=h.faceNormals[i],c=h.vertexNormals[i],l.copy(r.normal),c.a.copy(r.vertexNormals[0]),c.b.copy(r.vertexNormals[1]),c.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)(r=this.faces[i]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Fn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Gn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,i){if(e&&e.isGeometry){var n,r=this.vertices.length,a=this.vertices,s=e.vertices,o=this.faces,l=e.faces,c=this.colors,h=e.colors;void 0===i&&(i=0),void 0!==t&&(n=(new Hi).getNormalMatrix(t));for(var u=0,d=s.length;u<d;u++){var p=s[u].clone();void 0!==t&&p.applyMatrix4(t),a.push(p)}for(u=0,d=h.length;u<d;u++)c.push(h[u].clone());for(u=0,d=l.length;u<d;u++){var m,f,g,v=l[u],y=v.vertexNormals,b=v.vertexColors;(m=new yr(v.a+r,v.b+r,v.c+r)).normal.copy(v.normal),void 0!==n&&m.normal.applyMatrix3(n).normalize();for(var x=0,w=y.length;x<w;x++)f=y[x].clone(),void 0!==n&&f.applyMatrix3(n).normalize(),m.vertexNormals.push(f);m.color.copy(v.color);for(x=0,w=b.length;x<w;x++)g=b[x],m.vertexColors.push(g.clone());m.materialIndex=v.materialIndex+i,o.push(m)}for(u=0,d=e.faceVertexUvs.length;u<d;u++){var _=e.faceVertexUvs[u];void 0===this.faceVertexUvs[u]&&(this.faceVertexUvs[u]=[]);for(x=0,w=_.length;x<w;x++){for(var M=_[x],S=[],T=0,E=M.length;T<E;T++)S.push(M[T].clone());this.faceVertexUvs[u].push(S)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,i,n,r,a,s,o,l={},c=[],h=[],u=Math.pow(10,4);for(i=0,n=this.vertices.length;i<n;i++)e=this.vertices[i],void 0===l[t=Math.round(e.x*u)+"_"+Math.round(e.y*u)+"_"+Math.round(e.z*u)]?(l[t]=i,c.push(this.vertices[i]),h[i]=c.length-1):h[i]=h[l[t]];var d=[];for(i=0,n=this.faces.length;i<n;i++){(r=this.faces[i]).a=h[r.a],r.b=h[r.b],r.c=h[r.c],a=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(a[p]===a[(p+1)%3]){d.push(i);break}}for(i=d.length-1;i>=0;i--){var m=d[i];for(this.faces.splice(m,1),s=0,o=this.faceVertexUvs.length;s<o;s++)this.faceVertexUvs[s].splice(m,1)}var f=this.vertices.length-c.length;return this.vertices=c,f},setFromPoints:function(e){this.vertices=[];for(var t=0,i=e.length;t<i;t++){var n=e[t];this.vertices.push(new Zi(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,i=0;i<t;i++)e[i]._id=i;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var n,r,a=this.faceVertexUvs[0],s=this.faceVertexUvs[1];a&&a.length===t&&(n=[]),s&&s.length===t&&(r=[]);for(i=0;i<t;i++){var o=e[i]._id;n&&n.push(a[o]),r&&r.push(s[o])}n&&(this.faceVertexUvs[0]=n),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}for(var n=[],r=0;r<this.vertices.length;r++){var a=this.vertices[r];n.push(a.x,a.y,a.z)}var s=[],o=[],l={},c=[],h={},u=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],m=void 0!==this.faceVertexUvs[0][r],f=p.normal.length()>0,g=p.vertexNormals.length>0,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=p.vertexColors.length>0,b=0;if(b=M(b,0,0),b=M(b,1,!0),b=M(b,2,!1),b=M(b,3,m),b=M(b,4,f),b=M(b,5,g),b=M(b,6,v),b=M(b,7,y),s.push(b),s.push(p.a,p.b,p.c),s.push(p.materialIndex),m){var x=this.faceVertexUvs[0][r];s.push(E(x[0]),E(x[1]),E(x[2]))}if(f&&s.push(S(p.normal)),g){var w=p.vertexNormals;s.push(S(w[0]),S(w[1]),S(w[2]))}if(v&&s.push(T(p.color)),y){var _=p.vertexColors;s.push(T(_[0]),T(_[1]),T(_[2]))}}function M(e,t,i){return i?e|1<<t:e&~(1<<t)}function S(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=o.length/3,o.push(e.x,e.y,e.z)),l[t]}function T(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==h[t]||(h[t]=c.length,c.push(e.getHex())),h[t]}function E(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=u.length/2,u.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=n,e.data.normals=o,c.length>0&&(e.data.colors=c),u.length>0&&(e.data.uvs=[u]),e.data.faces=s,e},clone:function(){return(new pa).copy(this)},copy:function(e){var t,i,n,r,a,s;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var o=e.vertices;for(t=0,i=o.length;t<i;t++)this.vertices.push(o[t].clone());var l=e.colors;for(t=0,i=l.length;t<i;t++)this.colors.push(l[t].clone());var c=e.faces;for(t=0,i=c.length;t<i;t++)this.faces.push(c[t].clone());for(t=0,i=e.faceVertexUvs.length;t<i;t++){var h=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,r=h.length;n<r;n++){var u=h[n],d=[];for(a=0,s=u.length;a<s;a++){var p=u[a];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var m=e.morphTargets;for(t=0,i=m.length;t<i;t++){var f={};if(f.name=m[t].name,void 0!==m[t].vertices)for(f.vertices=[],n=0,r=m[t].vertices.length;n<r;n++)f.vertices.push(m[t].vertices[n].clone());if(void 0!==m[t].normals)for(f.normals=[],n=0,r=m[t].normals.length;n<r;n++)f.normals.push(m[t].normals[n].clone());this.morphTargets.push(f)}var g=e.morphNormals;for(t=0,i=g.length;t<i;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],n=0,r=g[t].vertexNormals.length;n<r;n++){var y=g[t].vertexNormals[n],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],n=0,r=g[t].faceNormals.length;n<r;n++)v.faceNormals.push(g[t].faceNormals[n].clone());this.morphNormals.push(v)}var x=e.skinWeights;for(t=0,i=x.length;t<i;t++)this.skinWeights.push(x[t].clone());var w=e.skinIndices;for(t=0,i=w.length;t<i;t++)this.skinIndices.push(w[t].clone());var _=e.lineDistances;for(t=0,i=_.length;t<i;t++)this.lineDistances.push(_[t]);var M=e.boundingBox;null!==M&&(this.boundingBox=M.clone());var S=e.boundingSphere;return null!==S&&(this.boundingSphere=S.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class ma extends pa{constructor(e,t,i,n,r,a){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new fa(e,t,i,n,r,a)),this.mergeVertices()}}class fa extends Ur{constructor(e,t,i,n,r,a){super(),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:a};var s=this;e=e||1,t=t||1,i=i||1,n=Math.floor(n)||1,r=Math.floor(r)||1,a=Math.floor(a)||1;var o=[],l=[],c=[],h=[],u=0,d=0;function p(e,t,i,n,r,a,p,m,f,g,v){var y,b,x=a/f,w=p/g,_=a/2,M=p/2,S=m/2,T=f+1,E=g+1,C=0,L=0,A=new Zi;for(b=0;b<E;b++){var k=b*w-M;for(y=0;y<T;y++){var P=y*x-_;A[e]=P*n,A[t]=k*r,A[i]=S,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[i]=m>0?1:-1,c.push(A.x,A.y,A.z),h.push(y/f),h.push(1-b/g),C+=1}}for(b=0;b<g;b++)for(y=0;y<f;y++){var R=u+y+T*b,O=u+y+T*(b+1),I=u+(y+1)+T*(b+1),D=u+(y+1)+T*b;o.push(R,O,D),o.push(O,I,D),L+=6}s.addGroup(d,L,v),d+=L,u+=C}p("z","y","x",-1,-1,i,t,e,a,r,0),p("z","y","x",1,-1,i,t,-e,a,r,1),p("x","z","y",1,1,e,i,t,n,a,2),p("x","z","y",1,-1,e,i,-t,n,a,3),p("x","y","z",1,-1,e,t,i,n,r,4),p("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(o),this.setAttribute("position",new Pr(l,3)),this.setAttribute("normal",new Pr(c,3)),this.setAttribute("uv",new Pr(h,2))}}function ga(e){var t={};for(var i in e)for(var n in t[i]={},e[i]){var r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}return t}function va(e){for(var t={},i=0;i<e.length;i++){var n=ga(e[i]);for(var r in n)t[r]=n[r]}return t}var ya={clone:ga,merge:va};function ba(e){xr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function xa(){Mn.call(this),this.type="Camera",this.matrixWorldInverse=new an,this.projectionMatrix=new an,this.projectionMatrixInverse=new an}function wa(e,t,i,n){xa.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}ba.prototype=Object.create(xr.prototype),ba.prototype.constructor=ba,ba.prototype.isShaderMaterial=!0,ba.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ga(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},ba.prototype.toJSON=function(e){var t=xr.prototype.toJSON.call(this,e);for(var i in t.uniforms={},this.uniforms){var n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var r={};for(var a in this.extensions)!0===this.extensions[a]&&(r[a]=!0);return Object.keys(r).length>0&&(t.extensions=r),t},xa.prototype=Object.assign(Object.create(Mn.prototype),{constructor:xa,isCamera:!0,copy:function(e,t){return Mn.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Zi),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Mn.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){Mn.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),wa.prototype=Object.assign(Object.create(xa.prototype),{constructor:wa,isPerspectiveCamera:!0,copy:function(e,t){return xa.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Fi.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Fi.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Fi.RAD2DEG*Math.atan(Math.tan(.5*Fi.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,i,n,r,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Fi.DEG2RAD*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){var s=a.fullWidth,o=a.fullHeight;r+=a.offsetX*n/s,t-=a.offsetY*i/o,n*=a.width/s,i*=a.height/o}var l=this.filmOffset;0!==l&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Mn.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});function _a(e,t,i,n){Mn.call(this),this.type="CubeCamera";var r=new wa(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new Zi(1,0,0)),this.add(r);var a=new wa(90,1,e,t);a.up.set(0,-1,0),a.lookAt(new Zi(-1,0,0)),this.add(a);var s=new wa(90,1,e,t);s.up.set(0,0,1),s.lookAt(new Zi(0,1,0)),this.add(s);var o=new wa(90,1,e,t);o.up.set(0,0,-1),o.lookAt(new Zi(0,-1,0)),this.add(o);var l=new wa(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new Zi(0,0,1)),this.add(l);var c=new wa(90,1,e,t);c.up.set(0,-1,0),c.lookAt(new Zi(0,0,-1)),this.add(c),n=n||{format:He,magFilter:_e,minFilter:_e},this.renderTarget=new Ma(i,n),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var i=e.getRenderTarget(),n=this.renderTarget,h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,a),e.setRenderTarget(n,2),e.render(t,s),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(i)},this.clear=function(e,t,i,n){for(var r=e.getRenderTarget(),a=this.renderTarget,s=0;s<6;s++)e.setRenderTarget(a,s),e.clear(t,i,n);e.setRenderTarget(r)}}function Ma(e,t,i){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=i),Wi.call(this,e,e,t)}function Sa(e,t,i,n,r,a,s,o,l,c,h,u){ji.call(this,null,a,s,o,l,c,n,r,h,u),this.image={data:e||null,width:t||1,height:i||1},this.magFilter=void 0!==l?l:ve,this.minFilter=void 0!==c?c:ve,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}_a.prototype=Object.create(Mn.prototype),_a.prototype.constructor=_a,Ma.prototype=Object.create(Wi.prototype),Ma.prototype.constructor=Ma,Ma.prototype.isWebGLCubeRenderTarget=!0,Ma.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var i=new Sn,n={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},r=new ba({type:"CubemapFromEquirect",uniforms:ga(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:v,blending:w});r.uniforms.tEquirect.value=t;var a=new sa(new fa(5,5,5),r);i.add(a);var s=new _a(1,10,1);return s.renderTarget=this,s.renderTarget.texture.name="CubeCameraTexture",s.update(e,i),a.geometry.dispose(),a.material.dispose(),this},Sa.prototype=Object.create(ji.prototype),Sa.prototype.constructor=Sa,Sa.prototype.isDataTexture=!0;var Ta=new Gn,Ea=new Zi;function Ca(e,t,i,n,r,a){this.planes=[void 0!==e?e:new Qn,void 0!==t?t:new Qn,void 0!==i?i:new Qn,void 0!==n?n:new Qn,void 0!==r?r:new Qn,void 0!==a?a:new Qn]}Object.assign(Ca.prototype,{set:function(e,t,i,n,r,a){var s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(i),s[3].copy(n),s[4].copy(r),s[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,i=0;i<6;i++)t[i].copy(e.planes[i]);return this},setFromProjectionMatrix:function(e){var t=this.planes,i=e.elements,n=i[0],r=i[1],a=i[2],s=i[3],o=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],p=i[10],m=i[11],f=i[12],g=i[13],v=i[14],y=i[15];return t[0].setComponents(s-n,h-o,m-u,y-f).normalize(),t[1].setComponents(s+n,h+o,m+u,y+f).normalize(),t[2].setComponents(s+r,h+l,m+d,y+g).normalize(),t[3].setComponents(s-r,h-l,m-d,y-g).normalize(),t[4].setComponents(s-a,h-c,m-p,y-v).normalize(),t[5].setComponents(s+a,h+c,m+p,y+v).normalize(),this},intersectsObject:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ta.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ta)},intersectsSprite:function(e){return Ta.center.set(0,0,0),Ta.radius=.7071067811865476,Ta.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ta)},intersectsSphere:function(e){for(var t=this.planes,i=e.center,n=-e.radius,r=0;r<6;r++){if(t[r].distanceToPoint(i)<n)return!1}return!0},intersectsBox:function(e){for(var t=this.planes,i=0;i<6;i++){var n=t[i];if(Ea.x=n.normal.x>0?e.max.x:e.min.x,Ea.y=n.normal.y>0?e.max.y:e.min.y,Ea.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(Ea)<0)return!1}return!0},containsPoint:function(e){for(var t=this.planes,i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}});var La={common:{diffuse:{value:new mr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Hi},uv2Transform:{value:new Hi},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Bi(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new mr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new mr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Hi}},sprite:{diffuse:{value:new mr(15658734)},opacity:{value:1},center:{value:new Bi(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Hi}}};function Aa(){var e=null,t=!1,i=null;function n(r,a){!1!==t&&(i(r,a),e.requestAnimationFrame(n))}return{start:function(){!0!==t&&null!==i&&(e.requestAnimationFrame(n),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){i=e},setContext:function(t){e=t}}}function ka(e,t){var i=t.isWebGL2,n=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),n.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var i=n.get(t);i&&(e.deleteBuffer(i.buffer),n.delete(t))},update:function(t,r){t.isInterleavedBufferAttribute&&(t=t.data);var a=n.get(t);void 0===a?n.set(t,function(t,i){var n=t.array,r=t.usage,a=e.createBuffer();e.bindBuffer(i,a),e.bufferData(i,n,r),t.onUploadCallback();var s=5126;return n instanceof Float32Array?s=5126:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?s=5123:n instanceof Int16Array?s=5122:n instanceof Uint32Array?s=5125:n instanceof Int32Array?s=5124:n instanceof Int8Array?s=5120:n instanceof Uint8Array&&(s=5121),{buffer:a,type:s,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}(t,r)):a.version<t.version&&(!function(t,n,r){var a=n.array,s=n.updateRange;e.bindBuffer(r,t),-1===s.count?e.bufferSubData(r,0,a):(i?e.bufferSubData(r,s.offset*a.BYTES_PER_ELEMENT,a,s.offset,s.count):e.bufferSubData(r,s.offset*a.BYTES_PER_ELEMENT,a.subarray(s.offset,s.offset+s.count)),s.count=-1)}(a.buffer,t,r),a.version=t.version)}}}function Pa(e,t,i,n){pa.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new Ra(e,t,i,n)),this.mergeVertices()}function Ra(e,t,i,n){Ur.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};var r,a,s=(e=e||1)/2,o=(t=t||1)/2,l=Math.floor(i)||1,c=Math.floor(n)||1,h=l+1,u=c+1,d=e/l,p=t/c,m=[],f=[],g=[],v=[];for(a=0;a<u;a++){var y=a*p-o;for(r=0;r<h;r++){var b=r*d-s;f.push(b,-y,0),g.push(0,0,1),v.push(r/l),v.push(1-a/c)}}for(a=0;a<c;a++)for(r=0;r<l;r++){var x=r+h*a,w=r+h*(a+1),_=r+1+h*(a+1),M=r+1+h*a;m.push(x,w,M),m.push(w,_,M)}this.setIndex(m),this.setAttribute("position",new Pr(f,3)),this.setAttribute("normal",new Pr(g,3)),this.setAttribute("uv",new Pr(v,2))}Pa.prototype=Object.create(pa.prototype),Pa.prototype.constructor=Pa,Ra.prototype=Object.create(Ur.prototype),Ra.prototype.constructor=Ra;var Oa={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Ia={basic:{uniforms:va([La.common,La.specularmap,La.envmap,La.aomap,La.lightmap,La.fog]),vertexShader:Oa.meshbasic_vert,fragmentShader:Oa.meshbasic_frag},lambert:{uniforms:va([La.common,La.specularmap,La.envmap,La.aomap,La.lightmap,La.emissivemap,La.fog,La.lights,{emissive:{value:new mr(0)}}]),vertexShader:Oa.meshlambert_vert,fragmentShader:Oa.meshlambert_frag},phong:{uniforms:va([La.common,La.specularmap,La.envmap,La.aomap,La.lightmap,La.emissivemap,La.bumpmap,La.normalmap,La.displacementmap,La.fog,La.lights,{emissive:{value:new mr(0)},specular:{value:new mr(1118481)},shininess:{value:30}}]),vertexShader:Oa.meshphong_vert,fragmentShader:Oa.meshphong_frag},standard:{uniforms:va([La.common,La.envmap,La.aomap,La.lightmap,La.emissivemap,La.bumpmap,La.normalmap,La.displacementmap,La.roughnessmap,La.metalnessmap,La.fog,La.lights,{emissive:{value:new mr(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Oa.meshphysical_vert,fragmentShader:Oa.meshphysical_frag},toon:{uniforms:va([La.common,La.specularmap,La.aomap,La.lightmap,La.emissivemap,La.bumpmap,La.normalmap,La.displacementmap,La.gradientmap,La.fog,La.lights,{emissive:{value:new mr(0)},specular:{value:new mr(1118481)},shininess:{value:30}}]),vertexShader:Oa.meshtoon_vert,fragmentShader:Oa.meshtoon_frag},matcap:{uniforms:va([La.common,La.bumpmap,La.normalmap,La.displacementmap,La.fog,{matcap:{value:null}}]),vertexShader:Oa.meshmatcap_vert,fragmentShader:Oa.meshmatcap_frag},points:{uniforms:va([La.points,La.fog]),vertexShader:Oa.points_vert,fragmentShader:Oa.points_frag},dashed:{uniforms:va([La.common,La.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Oa.linedashed_vert,fragmentShader:Oa.linedashed_frag},depth:{uniforms:va([La.common,La.displacementmap]),vertexShader:Oa.depth_vert,fragmentShader:Oa.depth_frag},normal:{uniforms:va([La.common,La.bumpmap,La.normalmap,La.displacementmap,{opacity:{value:1}}]),vertexShader:Oa.normal_vert,fragmentShader:Oa.normal_frag},sprite:{uniforms:va([La.sprite,La.fog]),vertexShader:Oa.sprite_vert,fragmentShader:Oa.sprite_frag},background:{uniforms:{uvTransform:{value:new Hi},t2D:{value:null}},vertexShader:Oa.background_vert,fragmentShader:Oa.background_frag},cube:{uniforms:va([La.envmap,{opacity:{value:1}}]),vertexShader:Oa.cube_vert,fragmentShader:Oa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Oa.equirect_vert,fragmentShader:Oa.equirect_frag},distanceRGBA:{uniforms:va([La.common,La.displacementmap,{referencePosition:{value:new Zi},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Oa.distanceRGBA_vert,fragmentShader:Oa.distanceRGBA_frag},shadow:{uniforms:va([La.lights,La.fog,{color:{value:new mr(0)},opacity:{value:1}}]),vertexShader:Oa.shadow_vert,fragmentShader:Oa.shadow_frag}};function Da(e,t,i,n){var r,a,s=new mr(0),o=0,l=null,c=0,h=null;function u(e,i){t.buffers.color.setClear(e.r,e.g,e.b,i,n)}return{getClearColor:function(){return s},setClearColor:function(e,t){s.set(e),u(s,o=void 0!==t?t:1)},getClearAlpha:function(){return o},setClearAlpha:function(e){u(s,o=e)},render:function(t,n,d,p){var m=n.background,f=e.xr,y=f.getSession&&f.getSession();if(y&&"additive"===y.environmentBlendMode&&(m=null),null===m?u(s,o):m&&m.isColor&&(u(m,1),p=!0),(e.autoClear||p)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.isWebGLCubeRenderTarget||m.mapping===de)){void 0===a&&((a=new sa(new fa(1,1,1),new ba({type:"BackgroundCubeMaterial",uniforms:ga(Ia.cube.uniforms),vertexShader:Ia.cube.vertexShader,fragmentShader:Ia.cube.fragmentShader,side:v,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(e,t,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(a));var b=m.isWebGLCubeRenderTarget?m.texture:m;a.material.uniforms.envMap.value=b,a.material.uniforms.flipEnvMap.value=b.isCubeTexture?-1:1,l===m&&c===b.version&&h===e.toneMapping||(a.material.needsUpdate=!0,l=m,c=b.version,h=e.toneMapping),t.unshift(a,a.geometry,a.material,0,0,null)}else m&&m.isTexture&&(void 0===r&&((r=new sa(new Ra(2,2),new ba({type:"BackgroundMaterial",uniforms:ga(Ia.background.uniforms),vertexShader:Ia.background.vertexShader,fragmentShader:Ia.background.fragmentShader,side:g,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(r.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(r)),r.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),r.material.uniforms.uvTransform.value.copy(m.matrix),l===m&&c===m.version&&h===e.toneMapping||(r.material.needsUpdate=!0,l=m,c=m.version,h=e.toneMapping),t.unshift(r,r.geometry,r.material,0,0,null))}}}function Na(e,t,i,n){var r,a=n.isWebGL2;this.setMode=function(e){r=e},this.render=function(t,n){e.drawArrays(r,t,n),i.update(n,r)},this.renderInstances=function(n,s,o,l){if(0!==l){var c,h;if(a)c=e,h="drawArraysInstanced";else if(h="drawArraysInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](r,s,o,l),i.update(o,r,l)}}}function za(e,t,i){var n;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,s=void 0!==i.precision?i.precision:"highp",o=r(s);o!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",o,"instead."),s=o);var l=!0===i.logarithmicDepthBuffer,c=e.getParameter(34930),h=e.getParameter(35660),u=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),m=e.getParameter(36347),f=e.getParameter(36348),g=e.getParameter(36349),v=h>0,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==n)return n;var i=t.get("EXT_texture_filter_anisotropic");return n=null!==i?e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:s,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:h,maxTextureSize:u,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:m,maxVaryings:f,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0}}function Fa(){var e=this,t=null,i=0,n=!1,r=!1,a=new Qn,s=new Hi,o={value:null,needsUpdate:!1};function l(){o.value!==t&&(o.value=t,o.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function c(t,i,n,r){var l=null!==t?t.length:0,c=null;if(0!==l){if(c=o.value,!0!==r||null===c){var h=n+4*l,u=i.matrixWorldInverse;s.getNormalMatrix(u),(null===c||c.length<h)&&(c=new Float32Array(h));for(var d=0,p=n;d!==l;++d,p+=4)a.copy(t[d]).applyMatrix4(u,s),a.normal.toArray(c,p),c[p+3]=a.constant}o.value=c,o.needsUpdate=!0}return e.numPlanes=l,e.numIntersection=0,c}this.uniform=o,this.numPlanes=0,this.numIntersection=0,this.init=function(e,r,a){var s=0!==e.length||r||0!==i||n;return n=r,t=c(e,a,0),i=e.length,s},this.beginShadows=function(){r=!0,c(null)},this.endShadows=function(){r=!1,l()},this.setState=function(e,a,s,h,u,d){if(!n||null===e||0===e.length||r&&!s)r?c(null):l();else{var p=r?0:i,m=4*p,f=u.clippingState||null;o.value=f,f=c(e,h,m,d);for(var g=0;g!==m;++g)f[g]=t[g];u.clippingState=f,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=p}}}function Ba(e){var t={};return{get:function(i){if(void 0!==t[i])return t[i];var n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),t[i]=n,n}}}function Ha(e,t,i){var n=new WeakMap,r=new WeakMap;function a(e){var s=e.target,o=n.get(s);for(var l in null!==o.index&&t.remove(o.index),o.attributes)t.remove(o.attributes[l]);s.removeEventListener("dispose",a),n.delete(s);var c=r.get(o);c&&(t.remove(c),r.delete(o)),i.memory.geometries--}function s(e){var i=[],n=e.index,a=e.attributes.position,s=0;if(null!==n){var o=n.array;s=n.version;for(var l=0,c=o.length;l<c;l+=3){var h=o[l+0],u=o[l+1],d=o[l+2];i.push(h,u,u,d,d,h)}}else{o=a.array;s=a.version;for(l=0,c=o.length/3-1;l<c;l+=3){h=l+0,u=l+1,d=l+2;i.push(h,u,u,d,d,h)}}var p=new(Ir(i)>65535?kr:Lr)(i,1);p.version=s,t.update(p,34963);var m=r.get(e);m&&t.remove(m),r.set(e,p)}return{get:function(e,t){var r=n.get(t);return r||(t.addEventListener("dispose",a),t.isBufferGeometry?r=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Ur).setFromObject(e)),r=t._bufferGeometry),n.set(t,r),i.memory.geometries++,r)},update:function(e){var i=e.index,n=e.attributes;for(var r in null!==i&&t.update(i,34963),n)t.update(n[r],34962);var a=e.morphAttributes;for(var r in a)for(var s=a[r],o=0,l=s.length;o<l;o++)t.update(s[o],34962)},getWireframeAttribute:function(e){var t=r.get(e);if(t){var i=e.index;null!==i&&t.version<i.version&&s(e)}else s(e);return r.get(e)}}}function Ga(e,t,i,n){var r,a,s,o=n.isWebGL2;this.setMode=function(e){r=e},this.setIndex=function(e){a=e.type,s=e.bytesPerElement},this.render=function(t,n){e.drawElements(r,n,a,t*s),i.update(n,r)},this.renderInstances=function(n,l,c,h){if(0!==h){var u,d;if(o)u=e,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[d](r,c,a,l*s,h),i.update(c,r,h)}}}function Ua(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,i,n){switch(n=n||1,t.calls++,i){case 4:t.triangles+=n*(e/3);break;case 1:t.lines+=n*(e/2);break;case 3:t.lines+=n*(e-1);break;case 2:t.lines+=n*e;break;case 0:t.points+=n*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function ja(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Va(e){var t={},i=new Float32Array(8);return{update:function(n,r,a,s){var o=n.morphTargetInfluences,l=void 0===o?0:o.length,c=t[r.id];if(void 0===c){c=[];for(var h=0;h<l;h++)c[h]=[h,0];t[r.id]=c}var u=a.morphTargets&&r.morphAttributes.position,d=a.morphNormals&&r.morphAttributes.normal;for(h=0;h<l;h++){0!==(m=c[h])[1]&&(u&&r.deleteAttribute("morphTarget"+h),d&&r.deleteAttribute("morphNormal"+h))}for(h=0;h<l;h++){(m=c[h])[0]=h,m[1]=o[h]}c.sort(ja);var p=0;for(h=0;h<8;h++){var m;if(m=c[h]){var f=m[0],g=m[1];if(g){u&&r.setAttribute("morphTarget"+h,u[f]),d&&r.setAttribute("morphNormal"+h,d[f]),i[h]=g,p+=g;continue}}i[h]=0}var v=r.morphTargetsRelative?1:1-p;s.getUniforms().setValue(e,"morphTargetBaseInfluence",v),s.getUniforms().setValue(e,"morphTargetInfluences",i)}}}function Wa(e,t,i,n){var r=new WeakMap;return{update:function(e){var a=n.render.frame,s=e.geometry,o=t.get(e,s);return r.get(o)!==a&&(s.isGeometry&&o.updateFromObject(e),t.update(o),r.set(o,a)),e.isInstancedMesh&&i.update(e.instanceMatrix,34962),o},dispose:function(){r=new WeakMap}}}function qa(e,t,i,n,r,a,s,o,l,c){e=void 0!==e?e:[],t=void 0!==t?t:oe,s=void 0!==s?s:He,ji.call(this,e,t,i,n,r,a,s,o,l,c),this.flipY=!1}function $a(e,t,i,n){ji.call(this,null),this.image={data:e||null,width:t||1,height:i||1,depth:n||1},this.magFilter=ve,this.minFilter=ve,this.wrapR=fe,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Xa(e,t,i,n){ji.call(this,null),this.image={data:e||null,width:t||1,height:i||1,depth:n||1},this.magFilter=ve,this.minFilter=ve,this.wrapR=fe,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Ia.physical={uniforms:va([Ia.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Bi(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new mr(0)},transparency:{value:0}}]),vertexShader:Oa.meshphysical_vert,fragmentShader:Oa.meshphysical_frag},qa.prototype=Object.create(ji.prototype),qa.prototype.constructor=qa,qa.prototype.isCubeTexture=!0,Object.defineProperty(qa.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),$a.prototype=Object.create(ji.prototype),$a.prototype.constructor=$a,$a.prototype.isDataTexture2DArray=!0,Xa.prototype=Object.create(ji.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isDataTexture3D=!0;var Ya=new ji,Za=new $a,Ja=new Xa,Ka=new qa,Qa=[],es=[],ts=new Float32Array(16),is=new Float32Array(9),ns=new Float32Array(4);function rs(e,t,i){var n=e[0];if(n<=0||n>0)return e;var r=t*i,a=Qa[r];if(void 0===a&&(a=new Float32Array(r),Qa[r]=a),0!==t){n.toArray(a,0);for(var s=1,o=0;s!==t;++s)o+=i,e[s].toArray(a,o)}return a}function as(e,t){if(e.length!==t.length)return!1;for(var i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function ss(e,t){for(var i=0,n=t.length;i<n;i++)e[i]=t[i]}function os(e,t){var i=es[t];void 0===i&&(i=new Int32Array(t),es[t]=i);for(var n=0;n!==t;++n)i[n]=e.allocateTextureUnit();return i}function ls(e,t){var i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function cs(e,t){var i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(as(i,t))return;e.uniform2fv(this.addr,t),ss(i,t)}}function hs(e,t){var i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(void 0!==t.r)i[0]===t.r&&i[1]===t.g&&i[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(as(i,t))return;e.uniform3fv(this.addr,t),ss(i,t)}}function us(e,t){var i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z&&i[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(as(i,t))return;e.uniform4fv(this.addr,t),ss(i,t)}}function ds(e,t){var i=this.cache,n=t.elements;if(void 0===n){if(as(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),ss(i,t)}else{if(as(i,n))return;ns.set(n),e.uniformMatrix2fv(this.addr,!1,ns),ss(i,n)}}function ps(e,t){var i=this.cache,n=t.elements;if(void 0===n){if(as(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),ss(i,t)}else{if(as(i,n))return;is.set(n),e.uniformMatrix3fv(this.addr,!1,is),ss(i,n)}}function ms(e,t){var i=this.cache,n=t.elements;if(void 0===n){if(as(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),ss(i,t)}else{if(as(i,n))return;ts.set(n),e.uniformMatrix4fv(this.addr,!1,ts),ss(i,n)}}function fs(e,t,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.safeSetTexture2D(t||Ya,r)}function gs(e,t,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(t||Za,r)}function vs(e,t,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(t||Ja,r)}function ys(e,t,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.safeSetTextureCube(t||Ka,r)}function bs(e,t){var i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function xs(e,t){var i=this.cache;as(i,t)||(e.uniform2iv(this.addr,t),ss(i,t))}function ws(e,t){var i=this.cache;as(i,t)||(e.uniform3iv(this.addr,t),ss(i,t))}function _s(e,t){var i=this.cache;as(i,t)||(e.uniform4iv(this.addr,t),ss(i,t))}function Ms(e,t){var i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function Ss(e,t){e.uniform1fv(this.addr,t)}function Ts(e,t){e.uniform1iv(this.addr,t)}function Es(e,t){e.uniform2iv(this.addr,t)}function Cs(e,t){e.uniform3iv(this.addr,t)}function Ls(e,t){e.uniform4iv(this.addr,t)}function As(e,t){var i=rs(t,this.size,2);e.uniform2fv(this.addr,i)}function ks(e,t){var i=rs(t,this.size,3);e.uniform3fv(this.addr,i)}function Ps(e,t){var i=rs(t,this.size,4);e.uniform4fv(this.addr,i)}function Rs(e,t){var i=rs(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function Os(e,t){var i=rs(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function Is(e,t){var i=rs(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function Ds(e,t,i){var n=t.length,r=os(i,n);e.uniform1iv(this.addr,r);for(var a=0;a!==n;++a)i.safeSetTexture2D(t[a]||Ya,r[a])}function Ns(e,t,i){var n=t.length,r=os(i,n);e.uniform1iv(this.addr,r);for(var a=0;a!==n;++a)i.safeSetTextureCube(t[a]||Ka,r[a])}function zs(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function(e){switch(e){case 5126:return ls;case 35664:return cs;case 35665:return hs;case 35666:return us;case 35674:return ds;case 35675:return ps;case 35676:return ms;case 5124:case 35670:return bs;case 35667:case 35671:return xs;case 35668:case 35672:return ws;case 35669:case 35673:return _s;case 5125:return Ms;case 35678:case 36198:case 36298:case 36306:case 35682:return fs;case 35679:case 36299:case 36307:return vs;case 35680:case 36300:case 36308:case 36293:return ys;case 36289:case 36303:case 36311:case 36292:return gs}}(t.type)}function Fs(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ss;case 35664:return As;case 35665:return ks;case 35666:return Ps;case 35674:return Rs;case 35675:return Os;case 35676:return Is;case 5124:case 35670:return Ts;case 35667:case 35671:return Es;case 35668:case 35672:return Cs;case 35669:case 35673:return Ls;case 35678:case 36198:case 36298:case 36306:case 35682:return Ds;case 35680:case 36300:case 36308:case 36293:return Ns}}(t.type)}function Bs(e){this.id=e,this.seq=[],this.map={}}Fs.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),ss(t,e)},Bs.prototype.setValue=function(e,t,i){for(var n=this.seq,r=0,a=n.length;r!==a;++r){var s=n[r];s.setValue(e,t[s.id],i)}};var Hs=/([\w\d_]+)(\])?(\[|\.)?/g;function Gs(e,t){e.seq.push(t),e.map[t.id]=t}function Us(e,t,i){var n=e.name,r=n.length;for(Hs.lastIndex=0;;){var a=Hs.exec(n),s=Hs.lastIndex,o=a[1],l="]"===a[2],c=a[3];if(l&&(o|=0),void 0===c||"["===c&&s+2===r){Gs(i,void 0===c?new zs(o,e,t):new Fs(o,e,t));break}var h=i.map[o];void 0===h&&Gs(i,h=new Bs(o)),i=h}}function js(e,t){this.seq=[],this.map={};for(var i=e.getProgramParameter(t,35718),n=0;n<i;++n){var r=e.getActiveUniform(t,n);Us(r,e.getUniformLocation(t,r.name),this)}}function Vs(e,t,i){var n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),n}js.prototype.setValue=function(e,t,i,n){var r=this.map[t];void 0!==r&&r.setValue(e,i,n)},js.prototype.setOptional=function(e,t,i){var n=t[i];void 0!==n&&this.setValue(e,i,n)},js.upload=function(e,t,i,n){for(var r=0,a=t.length;r!==a;++r){var s=t[r],o=i[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,n)}},js.seqWithValue=function(e,t){for(var i=[],n=0,r=e.length;n!==r;++n){var a=e[n];a.id in t&&i.push(a)}return i};var Ws=0;function qs(e){switch(e){case Jt:return["Linear","( value )"];case Kt:return["sRGB","( value )"];case ei:return["RGBE","( value )"];case ii:return["RGBM","( value, 7.0 )"];case ni:return["RGBM","( value, 16.0 )"];case ri:return["RGBD","( value, 256.0 )"];case Qt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case ti:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function $s(e,t,i){var n=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();return n&&""===r?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+i+"\n"+r+function(e){for(var t=e.split("\n"),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join("\n")}(e.getShaderSource(t))}function Xs(e,t){var i=qs(t);return"vec4 "+e+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function Ys(e,t){var i;switch(t){case te:i="Linear";break;case ie:i="Reinhard";break;case ne:i="Uncharted2";break;case re:i="OptimizedCineon";break;case ae:i="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Zs(e){return""!==e}function Js(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Ks(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Qs=/^[ \t]*#include +<([\w\d./]+)>/gm;function eo(e){return e.replace(Qs,to)}function to(e,t){var i=Oa[t];if(void 0===i)throw new Error("Can not resolve #include <"+t+">");return eo(i)}var io=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,no=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function ro(e){return e.replace(no,so).replace(io,ao)}function ao(e,t,i,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),so(e,t,i,n)}function so(e,t,i,n){for(var r="",a=parseInt(t);a<parseInt(i);a++)r+=n.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}function oo(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function lo(e,t,i){var n,r,a,s,o,l=e.getContext(),c=i.defines,h=i.vertexShader,u=i.fragmentShader,d=function(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===p?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===m?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===f&&(t="SHADOWMAP_TYPE_VSM"),t}(i),g=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case oe:case le:t="ENVMAP_TYPE_CUBE";break;case de:case pe:t="ENVMAP_TYPE_CUBE_UV";break;case ce:case he:t="ENVMAP_TYPE_EQUIREC";break;case ue:t="ENVMAP_TYPE_SPHERE"}return t}(i),v=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case le:case he:t="ENVMAP_MODE_REFRACTION"}return t}(i),y=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case J:t="ENVMAP_BLENDING_MULTIPLY";break;case K:t="ENVMAP_BLENDING_MIX";break;case Q:t="ENVMAP_BLENDING_ADD"}return t}(i),b=e.gammaFactor>0?e.gammaFactor:1,x=i.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Zs).join("\n")}(i),w=function(e){var t=[];for(var i in e){var n=e[i];!1!==n&&t.push("#define "+i+" "+n)}return t.join("\n")}(c),_=l.createProgram();if(i.isRawShaderMaterial?((n=[w].filter(Zs).join("\n")).length>0&&(n+="\n"),(r=[x,w].filter(Zs).join("\n")).length>0&&(r+="\n")):(n=[oo(i),"#define SHADER_NAME "+i.shaderName,w,i.instancing?"#define USE_INSTANCING":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+v:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+d:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Zs).join("\n"),r=[x,oo(i),"#define SHADER_NAME "+i.shaderName,w,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+b,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+g:"",i.envMap?"#define "+v:"",i.envMap?"#define "+y:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+d:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==ee?"#define TONE_MAPPING":"",i.toneMapping!==ee?Oa.tonemapping_pars_fragment:"",i.toneMapping!==ee?Ys("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.outputEncoding||i.mapEncoding||i.matcapEncoding||i.envMapEncoding||i.emissiveMapEncoding||i.lightMapEncoding?Oa.encodings_pars_fragment:"",i.mapEncoding?Xs("mapTexelToLinear",i.mapEncoding):"",i.matcapEncoding?Xs("matcapTexelToLinear",i.matcapEncoding):"",i.envMapEncoding?Xs("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?Xs("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMapEncoding?Xs("lightMapTexelToLinear",i.lightMapEncoding):"",i.outputEncoding?(a="linearToOutputTexel",s=i.outputEncoding,o=qs(s),"vec4 "+a+"( vec4 value ) { return LinearTo"+o[0]+o[1]+"; }"):"",i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(Zs).join("\n")),h=Ks(h=Js(h=eo(h),i),i),u=Ks(u=Js(u=eo(u),i),i),h=ro(h),u=ro(u),i.isWebGL2&&!i.isRawShaderMaterial){var M=!1,S=/^\s*#version\s+300\s+es\s*\n/;i.isShaderMaterial&&null!==h.match(S)&&null!==u.match(S)&&(M=!0,h=h.replace(S,""),u=u.replace(S,"")),n=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+n,r=["#version 300 es\n","#define varying in",M?"":"out highp vec4 pc_fragColor;",M?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+r}var T,E,C=r+u,L=Vs(l,35633,n+h),A=Vs(l,35632,C);if(l.attachShader(_,L),l.attachShader(_,A),void 0!==i.index0AttributeName?l.bindAttribLocation(_,0,i.index0AttributeName):!0===i.morphTargets&&l.bindAttribLocation(_,0,"position"),l.linkProgram(_),e.debug.checkShaderErrors){var k=l.getProgramInfoLog(_).trim(),P=l.getShaderInfoLog(L).trim(),R=l.getShaderInfoLog(A).trim(),O=!0,I=!0;if(!1===l.getProgramParameter(_,35714)){O=!1;var D=$s(l,L,"vertex"),N=$s(l,A,"fragment");console.error("THREE.WebGLProgram: shader error: ",l.getError(),"35715",l.getProgramParameter(_,35715),"gl.getProgramInfoLog",k,D,N)}else""!==k?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",k):""!==P&&""!==R||(I=!1);I&&(this.diagnostics={runnable:O,programLog:k,vertexShader:{log:P,prefix:n},fragmentShader:{log:R,prefix:r}})}return l.detachShader(_,L),l.detachShader(_,A),l.deleteShader(L),l.deleteShader(A),this.getUniforms=function(){return void 0===T&&(T=new js(l,_)),T},this.getAttributes=function(){return void 0===E&&(E=function(e,t){for(var i={},n=e.getProgramParameter(t,35721),r=0;r<n;r++){var a=e.getActiveAttrib(t,r).name;i[a]=e.getAttribLocation(t,a)}return i}(l,_)),E},this.destroy=function(){l.deleteProgram(_),this.program=void 0},this.name=i.shaderName,this.id=Ws++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=L,this.fragmentShader=A,this}function co(e,t,i){var n=[],r=i.isWebGL2,a=i.logarithmicDepthBuffer,s=i.floatVertexTextures,o=i.precision,l=i.maxVertexUniforms,c=i.vertexTextures,h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},u=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function d(e){var t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=Jt,t}this.getParameters=function(n,u,p,m,f,g,b){var x=m.fog,w=n.isMeshStandardMaterial?m.environment:null,_=n.envMap||w,M=h[n.type],S=b.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(s)return 1024;var i=l,n=Math.floor((i-20)/4),r=Math.min(n,t.length);return r<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+r+"."),0):r}(b):0;null!==n.precision&&(o=i.getMaxPrecision(n.precision))!==n.precision&&console.warn("THREE.WebGLProgram.getParameters:",n.precision,"not supported, using",o,"instead.");var T=function(e,t){var i;if(t){var n=Ia[t];i={name:e.type,uniforms:ya.clone(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}}else i={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return i}(n,M);n.onBeforeCompile(T,e);var E=e.getRenderTarget();return{isWebGL2:r,shaderID:M,shaderName:T.name,uniforms:T.uniforms,vertexShader:T.vertexShader,fragmentShader:T.fragmentShader,defines:n.defines,isRawShaderMaterial:n.isRawShaderMaterial,isShaderMaterial:n.isShaderMaterial,precision:o,instancing:!0===b.isInstancedMesh,supportsVertexTextures:c,outputEncoding:null!==E?d(E.texture):e.outputEncoding,map:!!n.map,mapEncoding:d(n.map),matcap:!!n.matcap,matcapEncoding:d(n.matcap),envMap:!!_,envMapMode:_&&_.mapping,envMapEncoding:d(_),envMapCubeUV:!!_&&(_.mapping===de||_.mapping===pe),lightMap:!!n.lightMap,lightMapEncoding:d(n.lightMap),aoMap:!!n.aoMap,emissiveMap:!!n.emissiveMap,emissiveMapEncoding:d(n.emissiveMap),bumpMap:!!n.bumpMap,normalMap:!!n.normalMap,objectSpaceNormalMap:n.normalMapType===li,tangentSpaceNormalMap:n.normalMapType===oi,clearcoatMap:!!n.clearcoatMap,clearcoatRoughnessMap:!!n.clearcoatRoughnessMap,clearcoatNormalMap:!!n.clearcoatNormalMap,displacementMap:!!n.displacementMap,roughnessMap:!!n.roughnessMap,metalnessMap:!!n.metalnessMap,specularMap:!!n.specularMap,alphaMap:!!n.alphaMap,gradientMap:!!n.gradientMap,sheen:!!n.sheen,combine:n.combine,vertexTangents:n.normalMap&&n.vertexTangents,vertexColors:n.vertexColors,vertexUvs:!!(n.map||n.bumpMap||n.normalMap||n.specularMap||n.alphaMap||n.emissiveMap||n.roughnessMap||n.metalnessMap||n.clearcoatMap||n.clearcoatRoughnessMap||n.clearcoatNormalMap||n.displacementMap),uvsVertexOnly:!(n.map||n.bumpMap||n.normalMap||n.specularMap||n.alphaMap||n.emissiveMap||n.roughnessMap||n.metalnessMap||n.clearcoatNormalMap||!n.displacementMap),fog:!!x,useFog:n.fog,fogExp2:x&&x.isFogExp2,flatShading:n.flatShading,sizeAttenuation:n.sizeAttenuation,logarithmicDepthBuffer:a,skinning:n.skinning&&S>0,maxBones:S,useVertexTexture:s,morphTargets:n.morphTargets,morphNormals:n.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:u.directional.length,numPointLights:u.point.length,numSpotLights:u.spot.length,numRectAreaLights:u.rectArea.length,numHemiLights:u.hemi.length,numDirLightShadows:u.directionalShadowMap.length,numPointLightShadows:u.pointShadowMap.length,numSpotLightShadows:u.spotShadowMap.length,numClippingPlanes:f,numClipIntersection:g,dithering:n.dithering,shadowMapEnabled:e.shadowMap.enabled&&p.length>0,shadowMapType:e.shadowMap.type,toneMapping:n.toneMapped?e.toneMapping:ee,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:n.premultipliedAlpha,alphaTest:n.alphaTest,doubleSided:n.side===y,flipSided:n.side===v,depthPacking:void 0!==n.depthPacking&&n.depthPacking,index0AttributeName:n.index0AttributeName,extensionDerivatives:n.extensions&&n.extensions.derivatives,extensionFragDepth:n.extensions&&n.extensions.fragDepth,extensionDrawBuffers:n.extensions&&n.extensions.drawBuffers,extensionShaderTextureLOD:n.extensions&&n.extensions.shaderTextureLOD,rendererExtensionFragDepth:r||null!==t.get("EXT_frag_depth"),rendererExtensionDrawBuffers:r||null!==t.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:r||null!==t.get("EXT_shader_texture_lod"),onBeforeCompile:n.onBeforeCompile}},this.getProgramCacheKey=function(t){var i=[];if(t.shaderID?i.push(t.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);if(void 0===t.isRawShaderMaterial){for(var r=0;r<u.length;r++)i.push(t[u[r]]);i.push(e.outputEncoding),i.push(e.gammaFactor)}return i.push(t.onBeforeCompile.toString()),i.join()},this.acquireProgram=function(t,i){for(var r,a=0,s=n.length;a<s;a++){var o=n[a];if(o.cacheKey===i){++(r=o).usedTimes;break}}return void 0===r&&(r=new lo(e,i,t),n.push(r)),r},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=n.indexOf(e);n[t]=n[n.length-1],n.pop(),e.destroy()}},this.programs=n}function ho(){var e=new WeakMap;return{get:function(t){var i=e.get(t);return void 0===i&&(i={},e.set(t,i)),i},remove:function(t){e.delete(t)},update:function(t,i,n){e.get(t)[i]=n},dispose:function(){e=new WeakMap}}}function uo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function po(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function mo(){var e=[],t=0,i=[],n=[],r={id:-1};function a(i,n,a,s,o,l){var c=e[t];return void 0===c?(c={id:i.id,object:i,geometry:n,material:a,program:a.program||r,groupOrder:s,renderOrder:i.renderOrder,z:o,group:l},e[t]=c):(c.id=i.id,c.object=i,c.geometry=n,c.material=a,c.program=a.program||r,c.groupOrder=s,c.renderOrder=i.renderOrder,c.z=o,c.group=l),t++,c}return{opaque:i,transparent:n,init:function(){t=0,i.length=0,n.length=0},push:function(e,t,r,s,o,l){var c=a(e,t,r,s,o,l);(!0===r.transparent?n:i).push(c)},unshift:function(e,t,r,s,o,l){var c=a(e,t,r,s,o,l);(!0===r.transparent?n:i).unshift(c)},finish:function(){for(var i=t,n=e.length;i<n;i++){var r=e[i];if(null===r.id)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.program=null,r.group=null}},sort:function(e,t){i.length>1&&i.sort(e||uo),n.length>1&&n.sort(t||po)}}}function fo(){var e=new WeakMap;function t(i){var n=i.target;n.removeEventListener("dispose",t),e.delete(n)}return{get:function(i,n){var r,a=e.get(i);return void 0===a?(r=new mo,e.set(i,new WeakMap),e.get(i).set(n,r),i.addEventListener("dispose",t)):void 0===(r=a.get(n))&&(r=new mo,a.set(n,r)),r},dispose:function(){e=new WeakMap}}}function go(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var i;switch(t.type){case"DirectionalLight":i={direction:new Zi,color:new mr};break;case"SpotLight":i={position:new Zi,direction:new Zi,color:new mr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new Zi,color:new mr,distance:0,decay:0};break;case"HemisphereLight":i={direction:new Zi,skyColor:new mr,groundColor:new mr};break;case"RectAreaLight":i={color:new mr,position:new Zi,halfWidth:new Zi,halfHeight:new Zi}}return e[t.id]=i,i}}}var vo=0;function yo(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function bo(){for(var e,t=new go,i=(e={},{get:function(t){if(void 0!==e[t.id])return e[t.id];var i;switch(t.type){case"DirectionalLight":case"SpotLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new Bi};break;case"PointLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new Bi,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=i,i}}),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=0;r<9;r++)n.probe.push(new Zi);var a=new Zi,s=new an,o=new an;return{setup:function(e,r,l){for(var c=0,h=0,u=0,d=0;d<9;d++)n.probe[d].set(0,0,0);var p=0,m=0,f=0,g=0,v=0,y=0,b=0,x=0,w=l.matrixWorldInverse;e.sort(yo),d=0;for(var _=e.length;d<_;d++){var M=e[d],S=M.color,T=M.intensity,E=M.distance,C=M.shadow&&M.shadow.map?M.shadow.map.texture:null;if(M.isAmbientLight)c+=S.r*T,h+=S.g*T,u+=S.b*T;else if(M.isLightProbe)for(var L=0;L<9;L++)n.probe[L].addScaledVector(M.sh.coefficients[L],T);else if(M.isDirectionalLight){if((P=t.get(M)).color.copy(M.color).multiplyScalar(M.intensity),P.direction.setFromMatrixPosition(M.matrixWorld),a.setFromMatrixPosition(M.target.matrixWorld),P.direction.sub(a),P.direction.transformDirection(w),M.castShadow){var A=M.shadow;(k=i.get(M)).shadowBias=A.bias,k.shadowRadius=A.radius,k.shadowMapSize=A.mapSize,n.directionalShadow[p]=k,n.directionalShadowMap[p]=C,n.directionalShadowMatrix[p]=M.shadow.matrix,y++}n.directional[p]=P,p++}else if(M.isSpotLight){if((P=t.get(M)).position.setFromMatrixPosition(M.matrixWorld),P.position.applyMatrix4(w),P.color.copy(S).multiplyScalar(T),P.distance=E,P.direction.setFromMatrixPosition(M.matrixWorld),a.setFromMatrixPosition(M.target.matrixWorld),P.direction.sub(a),P.direction.transformDirection(w),P.coneCos=Math.cos(M.angle),P.penumbraCos=Math.cos(M.angle*(1-M.penumbra)),P.decay=M.decay,M.castShadow){A=M.shadow;(k=i.get(M)).shadowBias=A.bias,k.shadowRadius=A.radius,k.shadowMapSize=A.mapSize,n.spotShadow[f]=k,n.spotShadowMap[f]=C,n.spotShadowMatrix[f]=M.shadow.matrix,x++}n.spot[f]=P,f++}else if(M.isRectAreaLight){(P=t.get(M)).color.copy(S).multiplyScalar(T),P.position.setFromMatrixPosition(M.matrixWorld),P.position.applyMatrix4(w),o.identity(),s.copy(M.matrixWorld),s.premultiply(w),o.extractRotation(s),P.halfWidth.set(.5*M.width,0,0),P.halfHeight.set(0,.5*M.height,0),P.halfWidth.applyMatrix4(o),P.halfHeight.applyMatrix4(o),n.rectArea[g]=P,g++}else if(M.isPointLight){if((P=t.get(M)).position.setFromMatrixPosition(M.matrixWorld),P.position.applyMatrix4(w),P.color.copy(M.color).multiplyScalar(M.intensity),P.distance=M.distance,P.decay=M.decay,M.castShadow){var k;A=M.shadow;(k=i.get(M)).shadowBias=A.bias,k.shadowRadius=A.radius,k.shadowMapSize=A.mapSize,k.shadowCameraNear=A.camera.near,k.shadowCameraFar=A.camera.far,n.pointShadow[m]=k,n.pointShadowMap[m]=C,n.pointShadowMatrix[m]=M.shadow.matrix,b++}n.point[m]=P,m++}else if(M.isHemisphereLight){var P;(P=t.get(M)).direction.setFromMatrixPosition(M.matrixWorld),P.direction.transformDirection(w),P.direction.normalize(),P.skyColor.copy(M.color).multiplyScalar(T),P.groundColor.copy(M.groundColor).multiplyScalar(T),n.hemi[v]=P,v++}}n.ambient[0]=c,n.ambient[1]=h,n.ambient[2]=u;var R=n.hash;R.directionalLength===p&&R.pointLength===m&&R.spotLength===f&&R.rectAreaLength===g&&R.hemiLength===v&&R.numDirectionalShadows===y&&R.numPointShadows===b&&R.numSpotShadows===x||(n.directional.length=p,n.spot.length=f,n.rectArea.length=g,n.point.length=m,n.hemi.length=v,n.directionalShadow.length=y,n.directionalShadowMap.length=y,n.pointShadow.length=b,n.pointShadowMap.length=b,n.spotShadow.length=x,n.spotShadowMap.length=x,n.directionalShadowMatrix.length=y,n.pointShadowMatrix.length=b,n.spotShadowMatrix.length=x,R.directionalLength=p,R.pointLength=m,R.spotLength=f,R.rectAreaLength=g,R.hemiLength=v,R.numDirectionalShadows=y,R.numPointShadows=b,R.numSpotShadows=x,n.version=vo++)},state:n}}function xo(){var e=new bo,t=[],i=[];return{init:function(){t.length=0,i.length=0},state:{lightsArray:t,shadowsArray:i,lights:e},setupLights:function(n){e.setup(t,i,n)},pushLight:function(e){t.push(e)},pushShadow:function(e){i.push(e)}}}function wo(){var e=new WeakMap;function t(i){var n=i.target;n.removeEventListener("dispose",t),e.delete(n)}return{get:function(i,n){var r;return!1===e.has(i)?(r=new xo,e.set(i,new WeakMap),e.get(i).set(n,r),i.addEventListener("dispose",t)):!1===e.get(i).has(n)?(r=new xo,e.get(i).set(n,r)):r=e.get(i).get(n),r},dispose:function(){e=new WeakMap}}}function _o(e){xr.call(this),this.type="MeshDepthMaterial",this.depthPacking=ai,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function Mo(e){xr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Zi,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}_o.prototype=Object.create(xr.prototype),_o.prototype.constructor=_o,_o.prototype.isMeshDepthMaterial=!0,_o.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Mo.prototype=Object.create(xr.prototype),Mo.prototype.constructor=Mo,Mo.prototype.isMeshDistanceMaterial=!0,Mo.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function So(e,t,i){var n=new Ca,r=new Bi,a=new Bi,s=new Vi,o=[],l=[],c={},h={0:v,1:g,2:y},u=new ba({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Bi},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=u.clone();d.defines.HORIZONAL_PASS=1;var m=new Ur;m.setAttribute("position",new Mr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var b=new sa(m,u),x=this;function _(i,n){var r=t.update(b);u.uniforms.shadow_pass.value=i.map.texture,u.uniforms.resolution.value=i.mapSize,u.uniforms.radius.value=i.radius,e.setRenderTarget(i.mapPass),e.clear(),e.renderBufferDirect(n,null,r,u,b,null),d.uniforms.shadow_pass.value=i.mapPass.texture,d.uniforms.resolution.value=i.mapSize,d.uniforms.radius.value=i.radius,e.setRenderTarget(i.map),e.clear(),e.renderBufferDirect(n,null,r,d,b,null)}function M(e,t,i){var n=e<<0|t<<1|i<<2,r=o[n];return void 0===r&&(r=new _o({depthPacking:si,morphTargets:e,skinning:t}),o[n]=r),r}function S(e,t,i){var n=e<<0|t<<1|i<<2,r=l[n];return void 0===r&&(r=new Mo({morphTargets:e,skinning:t}),l[n]=r),r}function T(t,i,n,r,a,s){var o=t.geometry,l=null,u=M,d=t.customDepthMaterial;if(!0===n.isPointLight&&(u=S,d=t.customDistanceMaterial),void 0===d){var p=!1;!0===i.morphTargets&&(!0===o.isBufferGeometry?p=o.morphAttributes&&o.morphAttributes.position&&o.morphAttributes.position.length>0:!0===o.isGeometry&&(p=o.morphTargets&&o.morphTargets.length>0));var m=!1;!0===t.isSkinnedMesh&&(!0===i.skinning?m=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),l=u(p,m,!0===t.isInstancedMesh)}else l=d;if(e.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){var g=l.uuid,v=i.uuid,y=c[g];void 0===y&&(y={},c[g]=y);var b=y[v];void 0===b&&(b=l.clone(),y[v]=b),l=b}return l.visible=i.visible,l.wireframe=i.wireframe,l.side=s===f?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:h[i.side],l.clipShadows=i.clipShadows,l.clippingPlanes=i.clippingPlanes,l.clipIntersection=i.clipIntersection,l.wireframeLinewidth=i.wireframeLinewidth,l.linewidth=i.linewidth,!0===n.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(n.matrixWorld),l.nearDistance=r,l.farDistance=a),l}function E(i,r,a,s,o){if(!1!==i.visible){if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&o===f)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,i.matrixWorld);var l=t.update(i),c=i.material;if(Array.isArray(c))for(var h=l.groups,u=0,d=h.length;u<d;u++){var p=h[u],m=c[p.materialIndex];if(m&&m.visible){var g=T(i,m,s,a.near,a.far,o);e.renderBufferDirect(a,null,l,g,i,p)}}else if(c.visible){g=T(i,c,s,a.near,a.far,o);e.renderBufferDirect(a,null,l,g,i,null)}}for(var v=i.children,y=0,b=v.length;y<b;y++)E(v[y],r,a,s,o)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=p,this.render=function(t,o,l){if(!1!==x.enabled&&(!1!==x.autoUpdate||!1!==x.needsUpdate)&&0!==t.length){var c=e.getRenderTarget(),h=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),d=e.state;d.setBlending(w),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var p=0,m=t.length;p<m;p++){var g=t[p],v=g.shadow;if(void 0!==v){r.copy(v.mapSize);var y=v.getFrameExtents();if(r.multiply(y),a.copy(v.mapSize),(r.x>i||r.y>i)&&(console.warn("THREE.WebGLShadowMap:",g,"has shadow exceeding max texture size, reducing"),r.x>i&&(a.x=Math.floor(i/y.x),r.x=a.x*y.x,v.mapSize.x=a.x),r.y>i&&(a.y=Math.floor(i/y.y),r.y=a.y*y.y,v.mapSize.y=a.y)),null===v.map&&!v.isPointLightShadow&&this.type===f){var b={minFilter:_e,magFilter:_e,format:Ge};v.map=new Wi(r.x,r.y,b),v.map.texture.name=g.name+".shadowMap",v.mapPass=new Wi(r.x,r.y,b),v.camera.updateProjectionMatrix()}if(null===v.map){b={minFilter:ve,magFilter:ve,format:Ge};v.map=new Wi(r.x,r.y,b),v.map.texture.name=g.name+".shadowMap",v.camera.updateProjectionMatrix()}e.setRenderTarget(v.map),e.clear();for(var M=v.getViewportCount(),S=0;S<M;S++){var T=v.getViewport(S);s.set(a.x*T.x,a.y*T.y,a.x*T.z,a.y*T.w),d.viewport(s),v.updateMatrices(g,S),n=v.getFrustum(),E(o,l,v.camera,g,this.type)}v.isPointLightShadow||this.type!==f||_(v,l)}else console.warn("THREE.WebGLShadowMap:",g,"has no shadow.")}x.needsUpdate=!1,e.setRenderTarget(c,h,u)}}}function To(e,t,i){var n=i.isWebGL2;var r=new function(){var t=!1,i=new Vi,n=null,r=new Vi(0,0,0,0);return{setMask:function(i){n===i||t||(e.colorMask(i,i,i,i),n=i)},setLocked:function(e){t=e},setClear:function(t,n,a,s,o){!0===o&&(t*=s,n*=s,a*=s),i.set(t,n,a,s),!1===r.equals(i)&&(e.clearColor(t,n,a,s),r.copy(i))},reset:function(){t=!1,n=null,r.set(-1,0,0,0)}}},a=new function(){var t=!1,i=null,n=null,r=null;return{setTest:function(e){e?be(2929):xe(2929)},setMask:function(n){i===n||t||(e.depthMask(n),i=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case j:e.depthFunc(512);break;case V:e.depthFunc(519);break;case W:e.depthFunc(513);break;case q:e.depthFunc(515);break;case $:e.depthFunc(514);break;case X:e.depthFunc(518);break;case Y:e.depthFunc(516);break;case Z:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);n=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,i=null,n=null,r=null}}},c=new function(){var t=!1,i=null,n=null,r=null,a=null,s=null,o=null,l=null,c=null;return{setTest:function(e){t||(e?be(2960):xe(2960))},setMask:function(n){i===n||t||(e.stencilMask(n),i=n)},setFunc:function(t,i,s){n===t&&r===i&&a===s||(e.stencilFunc(t,i,s),n=t,r=i,a=s)},setOp:function(t,i,n){s===t&&o===i&&l===n||(e.stencilOp(t,i,n),s=t,o=i,l=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,i=null,n=null,r=null,a=null,s=null,o=null,l=null,c=null}}},h=e.getParameter(34921),u=new Uint8Array(h),d=new Uint8Array(h),p=new Uint8Array(h),m={},f=null,g=null,b=null,x=null,J=null,K=null,Q=null,ee=null,te=null,ie=!1,ne=null,re=null,ae=null,se=null,oe=null,le=e.getParameter(35661),ce=!1,he=0,ue=e.getParameter(7938);-1!==ue.indexOf("WebGL")?(he=parseFloat(/^WebGL\ ([0-9])/.exec(ue)[1]),ce=he>=1):-1!==ue.indexOf("OpenGL ES")&&(he=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(ue)[1]),ce=he>=2);var de=null,pe={},me=new Vi,fe=new Vi;function ge(t,i,n){var r=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var s=0;s<n;s++)e.texImage2D(i+s,0,6408,1,1,0,6408,5121,r);return a}var ve={};function ye(i,r){(u[i]=1,0===d[i]&&(e.enableVertexAttribArray(i),d[i]=1),p[i]!==r)&&((n?e:t.get("ANGLE_instanced_arrays"))[n?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,r),p[i]=r)}function be(t){!0!==m[t]&&(e.enable(t),m[t]=!0)}function xe(t){!1!==m[t]&&(e.disable(t),m[t]=!1)}ve[3553]=ge(3553,3553,1),ve[34067]=ge(34067,34069,6),r.setClear(0,0,0,1),a.setClear(1),c.setClear(0),be(2929),a.setFunc(q),Te(!1),Ee(o),be(2884),Se(w);var we={[C]:32774,[L]:32778,[A]:32779};if(n)we[k]=32775,we[P]=32776;else{var _e=t.get("EXT_blend_minmax");null!==_e&&(we[k]=_e.MIN_EXT,we[P]=_e.MAX_EXT)}var Me={[R]:0,[O]:1,[I]:768,[N]:770,[U]:776,[H]:774,[F]:772,[D]:769,[z]:771,[G]:775,[B]:773};function Se(t,i,n,r,a,s,o,l){if(t!==w){if(g||(be(3042),g=!0),t===E)a=a||i,s=s||n,o=o||r,i===x&&a===Q||(e.blendEquationSeparate(we[i],we[a]),x=i,Q=a),n===J&&r===K&&s===ee&&o===te||(e.blendFuncSeparate(Me[n],Me[r],Me[s],Me[o]),J=n,K=r,ee=s,te=o),b=t,ie=null;else if(t!==b||l!==ie){if(x===C&&Q===C||(e.blendEquation(32774),x=C,Q=C),l)switch(t){case _:e.blendFuncSeparate(1,771,1,771);break;case M:e.blendFunc(1,1);break;case S:e.blendFuncSeparate(0,0,769,771);break;case T:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case _:e.blendFuncSeparate(770,771,1,771);break;case M:e.blendFunc(770,1);break;case S:e.blendFunc(0,769);break;case T:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}J=null,K=null,ee=null,te=null,b=t,ie=l}}else g&&(xe(3042),g=!1)}function Te(t){ne!==t&&(t?e.frontFace(2304):e.frontFace(2305),ne=t)}function Ee(t){t!==s?(be(2884),t!==re&&(t===o?e.cullFace(1029):t===l?e.cullFace(1028):e.cullFace(1032))):xe(2884),re=t}function Ce(t,i,n){t?(be(32823),se===i&&oe===n||(e.polygonOffset(i,n),se=i,oe=n)):xe(32823)}function Le(t){void 0===t&&(t=33984+le-1),de!==t&&(e.activeTexture(t),de=t)}return{buffers:{color:r,depth:a,stencil:c},initAttributes:function(){for(var e=0,t=u.length;e<t;e++)u[e]=0},enableAttribute:function(e){ye(e,0)},enableAttributeAndDivisor:ye,disableUnusedAttributes:function(){for(var t=0,i=d.length;t!==i;++t)d[t]!==u[t]&&(e.disableVertexAttribArray(t),d[t]=0)},enable:be,disable:xe,useProgram:function(t){return f!==t&&(e.useProgram(t),f=t,!0)},setBlending:Se,setMaterial:function(e,t){e.side===y?xe(2884):be(2884);var i=e.side===v;t&&(i=!i),Te(i),e.blending===_&&!1===e.transparent?Se(w):Se(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),r.setMask(e.colorWrite);var n=e.stencilWrite;c.setTest(n),n&&(c.setMask(e.stencilWriteMask),c.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),c.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Ce(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:Te,setCullFace:Ee,setLineWidth:function(t){t!==ae&&(ce&&e.lineWidth(t),ae=t)},setPolygonOffset:Ce,setScissorTest:function(e){e?be(3089):xe(3089)},activeTexture:Le,bindTexture:function(t,i){null===de&&Le();var n=pe[de];void 0===n&&(n={type:void 0,texture:void 0},pe[de]=n),n.type===t&&n.texture===i||(e.bindTexture(t,i||ve[t]),n.type=t,n.texture=i)},unbindTexture:function(){var t=pe[de];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===me.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),me.copy(t))},viewport:function(t){!1===fe.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),fe.copy(t))},reset:function(){for(var t=0;t<d.length;t++)1===d[t]&&(e.disableVertexAttribArray(t),d[t]=0);m={},de=null,pe={},f=null,b=null,ne=null,re=null,r.reset(),a.reset(),c.reset()}}}function Eo(e,t,i,n,r,a,s){var o,l=r.isWebGL2,c=r.maxTextures,h=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,p=new WeakMap,m=!1;try{m="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function f(e,t){return m?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(e,t,i,n){var r=1;if((e.width>n||e.height>n)&&(r=n/Math.max(e.width,e.height)),r<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?Fi.floorPowerOfTwo:Math.floor,s=a(r*e.width),l=a(r*e.height);void 0===o&&(o=f(s,l));var c=i?f(s,l):o;return c.width=s,c.height=l,c.getContext("2d").drawImage(e,0,0,s,l),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+s+"x"+l+")."),c}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return Fi.isPowerOfTwo(e.width)&&Fi.isPowerOfTwo(e.height)}function y(e,t){return e.generateMipmaps&&t&&e.minFilter!==ve&&e.minFilter!==_e}function b(t,i,r,a){e.generateMipmap(t),n.get(i).__maxMipLevel=Math.log(Math.max(r,a))*Math.LOG2E}function x(i,n,r){if(!1===l)return n;if(null!==i){if(void 0!==e[i])return e[i];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+i+"'")}var a=n;return 6403===n&&(5126===r&&(a=33326),5131===r&&(a=33325),5121===r&&(a=33321)),6407===n&&(5126===r&&(a=34837),5131===r&&(a=34843),5121===r&&(a=32849)),6408===n&&(5126===r&&(a=34836),5131===r&&(a=34842),5121===r&&(a=32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||t.get("EXT_color_buffer_float"),a}function w(e){return e===ve||e===ye||e===xe?9728:9729}function _(t){var i=t.target;i.removeEventListener("dispose",_),function(t){var i=n.get(t);if(void 0===i.__webglInit)return;e.deleteTexture(i.__webglTexture),n.remove(t)}(i),i.isVideoTexture&&p.delete(i),s.memory.textures--}function M(t){var i=t.target;i.removeEventListener("dispose",M),function(t){var i=n.get(t),r=n.get(t.texture);if(!t)return;void 0!==r.__webglTexture&&e.deleteTexture(r.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)e.deleteFramebuffer(i.__webglFramebuffer[a]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[a]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);n.remove(t.texture),n.remove(t)}(i),s.memory.textures--}var S=0;function T(e,t){var r=n.get(e);if(e.isVideoTexture&&function(e){var t=s.render.frame;p.get(e)!==t&&(p.set(e,t),e.update())}(e),e.version>0&&r.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void R(r,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.activeTexture(33984+t),i.bindTexture(3553,r.__webglTexture)}function E(t,r){if(6===t.image.length){var s=n.get(t);if(t.version>0&&s.__version!==t.version){P(s,t),i.activeTexture(33984+r),i.bindTexture(34067,s.__webglTexture),e.pixelStorei(37440,t.flipY);for(var o=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture),c=t.image[0]&&t.image[0].isDataTexture,u=[],d=0;d<6;d++)u[d]=o||c?c?t.image[d].image:t.image[d]:g(t.image[d],!1,!0,h);var p,m=u[0],f=v(m)||l,w=a.convert(t.format),_=a.convert(t.type),M=x(t.internalFormat,w,_);if(k(34067,t,f),o){for(d=0;d<6;d++){p=u[d].mipmaps;for(var S=0;S<p.length;S++){var T=p[S];t.format!==Ge&&t.format!==He?null!==w?i.compressedTexImage2D(34069+d,S,M,T.width,T.height,0,T.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+d,S,M,T.width,T.height,0,w,_,T.data)}}s.__maxMipLevel=p.length-1}else{p=t.mipmaps;for(d=0;d<6;d++)if(c){i.texImage2D(34069+d,0,M,u[d].width,u[d].height,0,w,_,u[d].data);for(S=0;S<p.length;S++){var E=(T=p[S]).image[d].image;i.texImage2D(34069+d,S+1,M,E.width,E.height,0,w,_,E.data)}}else{i.texImage2D(34069+d,0,M,w,_,u[d]);for(S=0;S<p.length;S++){T=p[S];i.texImage2D(34069+d,S+1,M,w,_,T.image[d])}}s.__maxMipLevel=p.length}y(t,f)&&b(34067,t,m.width,m.height),s.__version=t.version,t.onUpdate&&t.onUpdate(t)}else i.activeTexture(33984+r),i.bindTexture(34067,s.__webglTexture)}}function C(e,t){i.activeTexture(33984+t),i.bindTexture(34067,n.get(e).__webglTexture)}var L={[me]:10497,[fe]:33071,[ge]:33648},A={[ve]:9728,[ye]:9984,[xe]:9986,[_e]:9729,[Me]:9985,[Te]:9987};function k(i,a,s){s?(e.texParameteri(i,10242,L[a.wrapS]),e.texParameteri(i,10243,L[a.wrapT]),32879!==i&&35866!==i||e.texParameteri(i,32882,L[a.wrapR]),e.texParameteri(i,10240,A[a.magFilter]),e.texParameteri(i,10241,A[a.minFilter])):(e.texParameteri(i,10242,33071),e.texParameteri(i,10243,33071),32879!==i&&35866!==i||e.texParameteri(i,32882,33071),a.wrapS===fe&&a.wrapT===fe||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(i,10240,w(a.magFilter)),e.texParameteri(i,10241,w(a.minFilter)),a.minFilter!==ve&&a.minFilter!==_e&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var o=t.get("EXT_texture_filter_anisotropic");if(o){if(a.type===Oe&&null===t.get("OES_texture_float_linear"))return;if(a.type===Ie&&null===(l||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(e.texParameterf(i,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function P(t,i){void 0===t.__webglInit&&(t.__webglInit=!0,i.addEventListener("dispose",_),t.__webglTexture=e.createTexture(),s.memory.textures++)}function R(t,n,r){var s=3553;n.isDataTexture2DArray&&(s=35866),n.isDataTexture3D&&(s=32879),P(t,n),i.activeTexture(33984+r),i.bindTexture(s,t.__webglTexture),e.pixelStorei(37440,n.flipY),e.pixelStorei(37441,n.premultiplyAlpha),e.pixelStorei(3317,n.unpackAlignment);var o=function(e){return!l&&(e.wrapS!==fe||e.wrapT!==fe||e.minFilter!==ve&&e.minFilter!==_e)}(n)&&!1===v(n.image),c=g(n.image,o,!1,u),h=v(c)||l,d=a.convert(n.format),p=a.convert(n.type),m=x(n.internalFormat,d,p);k(s,n,h);var f,w=n.mipmaps;if(n.isDepthTexture)m=6402,l?m=n.type===Oe?36012:n.type===Re?33190:n.type===Fe?35056:33189:n.type===Oe&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),n.format===We&&6402===m&&n.type!==ke&&n.type!==Re&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=ke,p=a.convert(n.type)),n.format===qe&&6402===m&&(m=34041,n.type!==Fe&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=Fe,p=a.convert(n.type))),i.texImage2D(3553,0,m,c.width,c.height,0,d,p,null);else if(n.isDataTexture)if(w.length>0&&h){for(var _=0,M=w.length;_<M;_++)f=w[_],i.texImage2D(3553,_,m,f.width,f.height,0,d,p,f.data);n.generateMipmaps=!1,t.__maxMipLevel=w.length-1}else i.texImage2D(3553,0,m,c.width,c.height,0,d,p,c.data),t.__maxMipLevel=0;else if(n.isCompressedTexture){for(_=0,M=w.length;_<M;_++)f=w[_],n.format!==Ge&&n.format!==He?null!==d?i.compressedTexImage2D(3553,_,m,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,_,m,f.width,f.height,0,d,p,f.data);t.__maxMipLevel=w.length-1}else if(n.isDataTexture2DArray)i.texImage3D(35866,0,m,c.width,c.height,c.depth,0,d,p,c.data),t.__maxMipLevel=0;else if(n.isDataTexture3D)i.texImage3D(32879,0,m,c.width,c.height,c.depth,0,d,p,c.data),t.__maxMipLevel=0;else if(w.length>0&&h){for(_=0,M=w.length;_<M;_++)f=w[_],i.texImage2D(3553,_,m,d,p,f);n.generateMipmaps=!1,t.__maxMipLevel=w.length-1}else i.texImage2D(3553,0,m,d,p,c),t.__maxMipLevel=0;y(n,h)&&b(s,n,c.width,c.height),t.__version=n.version,n.onUpdate&&n.onUpdate(n)}function O(t,r,s,o){var l=a.convert(r.texture.format),c=a.convert(r.texture.type),h=x(r.texture.internalFormat,l,c);i.texImage2D(o,0,h,r.width,r.height,0,l,c,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,s,o,n.get(r.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function I(t,i,n){if(e.bindRenderbuffer(36161,t),i.depthBuffer&&!i.stencilBuffer){var r=33189;if(n){var s=i.depthTexture;s&&s.isDepthTexture&&(s.type===Oe?r=36012:s.type===Re&&(r=33190));var o=N(i);e.renderbufferStorageMultisample(36161,o,r,i.width,i.height)}else e.renderbufferStorage(36161,r,i.width,i.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(i.depthBuffer&&i.stencilBuffer){if(n){o=N(i);e.renderbufferStorageMultisample(36161,o,35056,i.width,i.height)}else e.renderbufferStorage(36161,34041,i.width,i.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var l=a.convert(i.texture.format),c=a.convert(i.texture.type);r=x(i.texture.internalFormat,l,c);if(n){o=N(i);e.renderbufferStorageMultisample(36161,o,r,i.width,i.height)}else e.renderbufferStorage(36161,r,i.width,i.height)}e.bindRenderbuffer(36161,null)}function D(t){var i=n.get(t),r=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),T(i.depthTexture,0);var r=n.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===We)e.framebufferTexture2D(36160,36096,3553,r,0);else{if(i.depthTexture.format!==qe)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,r,0)}}(i.__webglFramebuffer,t)}else if(r){i.__webglDepthbuffer=[];for(var a=0;a<6;a++)e.bindFramebuffer(36160,i.__webglFramebuffer[a]),i.__webglDepthbuffer[a]=e.createRenderbuffer(),I(i.__webglDepthbuffer[a],t,!1)}else e.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),I(i.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}function N(e){return l&&e.isWebGLMultisampleRenderTarget?Math.min(d,e.samples):0}var z=!1,F=!1;this.allocateTextureUnit=function(){var e=S;return e>=c&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+c),S+=1,e},this.resetTextureUnits=function(){S=0},this.setTexture2D=T,this.setTexture2DArray=function(e,t){var r=n.get(e);e.version>0&&r.__version!==e.version?R(r,e,t):(i.activeTexture(33984+t),i.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(e,t){var r=n.get(e);e.version>0&&r.__version!==e.version?R(r,e,t):(i.activeTexture(33984+t),i.bindTexture(32879,r.__webglTexture))},this.setTextureCube=E,this.setTextureCubeDynamic=C,this.setupRenderTarget=function(t){var r=n.get(t),o=n.get(t.texture);t.addEventListener("dispose",M),o.__webglTexture=e.createTexture(),s.memory.textures++;var c=!0===t.isWebGLCubeRenderTarget,h=!0===t.isWebGLMultisampleRenderTarget,u=v(t)||l;if(!l||t.texture.format!==He||t.texture.type!==Oe&&t.texture.type!==Ie||(t.texture.format=Ge,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),c){r.__webglFramebuffer=[];for(var d=0;d<6;d++)r.__webglFramebuffer[d]=e.createFramebuffer()}else if(r.__webglFramebuffer=e.createFramebuffer(),h)if(l){r.__webglMultisampledFramebuffer=e.createFramebuffer(),r.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,r.__webglColorRenderbuffer);var p=a.convert(t.texture.format),m=a.convert(t.texture.type),f=x(t.texture.internalFormat,p,m),g=N(t);e.renderbufferStorageMultisample(36161,g,f,t.width,t.height),e.bindFramebuffer(36160,r.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,r.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(r.__webglDepthRenderbuffer=e.createRenderbuffer(),I(r.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(c){i.bindTexture(34067,o.__webglTexture),k(34067,t.texture,u);for(d=0;d<6;d++)O(r.__webglFramebuffer[d],t,36064,34069+d);y(t.texture,u)&&b(34067,t.texture,t.width,t.height),i.bindTexture(34067,null)}else i.bindTexture(3553,o.__webglTexture),k(3553,t.texture,u),O(r.__webglFramebuffer,t,36064,3553),y(t.texture,u)&&b(3553,t.texture,t.width,t.height),i.bindTexture(3553,null);t.depthBuffer&&D(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(y(t,v(e)||l)){var r=e.isWebGLCubeRenderTarget?34067:3553,a=n.get(t).__webglTexture;i.bindTexture(r,a),b(r,t,e.width,e.height),i.bindTexture(r,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(l){var i=n.get(t);e.bindFramebuffer(36008,i.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,i.__webglFramebuffer);var r=t.width,a=t.height,s=16384;t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024),e.blitFramebuffer(0,0,r,a,0,0,r,a,s,9728),e.bindFramebuffer(36160,i.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),z=!0),e=e.texture),T(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?E(e,t):C(e,t)}}function Co(e,t,i){var n=i.isWebGL2;return{convert:function(e){var i;if(e===Ce)return 5121;if(e===De)return 32819;if(e===Ne)return 32820;if(e===ze)return 33635;if(e===Le)return 5120;if(e===Ae)return 5122;if(e===ke)return 5123;if(e===Pe)return 5124;if(e===Re)return 5125;if(e===Oe)return 5126;if(e===Ie)return n?5131:null!==(i=t.get("OES_texture_half_float"))?i.HALF_FLOAT_OES:null;if(e===Be)return 6406;if(e===He)return 6407;if(e===Ge)return 6408;if(e===Ue)return 6409;if(e===je)return 6410;if(e===We)return 6402;if(e===qe)return 34041;if(e===$e)return 6403;if(e===Xe)return 36244;if(e===Ye)return 33319;if(e===Ze)return 33320;if(e===Je)return 36248;if(e===Ke)return 36249;if(e===Qe||e===et||e===tt||e===it){if(null===(i=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===Qe)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===et)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===tt)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===it)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===nt||e===rt||e===at||e===st){if(null===(i=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===nt)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===rt)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===at)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===st)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===ot)return null!==(i=t.get("WEBGL_compressed_texture_etc1"))?i.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===lt||e===ct)&&null!==(i=t.get("WEBGL_compressed_texture_etc"))){if(e===lt)return i.COMPRESSED_RGB8_ETC2;if(e===ct)return i.COMPRESSED_RGBA8_ETC2_EAC}return e===ht||e===ut||e===dt||e===pt||e===mt||e===ft||e===gt||e===vt||e===yt||e===bt||e===xt||e===wt||e===_t||e===Mt||e===Tt||e===Et||e===Ct||e===Lt||e===At||e===kt||e===Pt||e===Rt||e===Ot||e===It||e===Dt||e===Nt||e===zt||e===Ft?null!==(i=t.get("WEBGL_compressed_texture_astc"))?e:null:e===St?null!==(i=t.get("EXT_texture_compression_bptc"))?e:null:e===Fe?n?34042:null!==(i=t.get("WEBGL_depth_texture"))?i.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Lo(e){wa.call(this),this.cameras=e||[]}function Ao(){Mn.call(this),this.type="Group"}function ko(e,t){var i=this,n=null,r=1,a=null,s="local-floor",o=null,l=[],c=new Map,h=new wa;h.layers.enable(1),h.viewport=new Vi;var u=new wa;u.layers.enable(2),u.viewport=new Vi;var d=new Lo([h,u]);d.layers.enable(1),d.layers.enable(2);var p=null,m=null;function f(e){var t=c.get(e.inputSource);t&&(t.targetRay&&t.targetRay.dispatchEvent({type:e.type}),t.grip&&t.grip.dispatchEvent({type:e.type}))}function g(){c.forEach((function(e,t){e.targetRay&&(e.targetRay.dispatchEvent({type:"disconnected",data:t}),e.targetRay.visible=!1),e.grip&&(e.grip.dispatchEvent({type:"disconnected",data:t}),e.grip.visible=!1)})),c.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),M.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function v(e){a=e,M.setContext(n),M.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}function y(e){for(var t=n.inputSources,i=0;i<l.length;i++)c.set(t[i],l[i]);for(i=0;i<e.removed.length;i++){var r=e.removed[i];(a=c.get(r))&&(a.targetRay&&a.targetRay.dispatchEvent({type:"disconnected",data:r}),a.grip&&a.grip.dispatchEvent({type:"disconnected",data:r}),c.delete(r))}for(i=0;i<e.added.length;i++){var a;r=e.added[i];(a=c.get(r))&&(a.targetRay&&a.targetRay.dispatchEvent({type:"connected",data:r}),a.grip&&a.grip.dispatchEvent({type:"connected",data:r}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=l[e];return void 0===t&&(t={},l[e]=t),void 0===t.targetRay&&(t.targetRay=new Ao,t.targetRay.matrixAutoUpdate=!1,t.targetRay.visible=!1),t.targetRay},this.getControllerGrip=function(e){var t=l[e];return void 0===t&&(t={},l[e]=t),void 0===t.grip&&(t.grip=new Ao,t.grip.matrixAutoUpdate=!1,t.grip.visible=!1),t.grip},this.setFramebufferScaleFactor=function(e){r=e,1==i.isPresenting&&console.warn("WebXRManager: Cannot change framebuffer scale while presenting VR content")},this.setReferenceSpaceType=function(e){s=e},this.getReferenceSpace=function(){return a},this.getSession=function(){return n},this.setSession=function(e){if(null!==(n=e)){n.addEventListener("select",f),n.addEventListener("selectstart",f),n.addEventListener("selectend",f),n.addEventListener("squeeze",f),n.addEventListener("squeezestart",f),n.addEventListener("squeezeend",f),n.addEventListener("end",g);var i=t.getContextAttributes(),a={antialias:i.antialias,alpha:i.alpha,depth:i.depth,stencil:i.stencil,framebufferScaleFactor:r},o=new XRWebGLLayer(n,t,a);n.updateRenderState({baseLayer:o}),n.requestReferenceSpace(s).then(v),n.addEventListener("inputsourceschange",y)}};var b=new Zi,x=new Zi;function w(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){d.near=u.near=h.near=e.near,d.far=u.far=h.far=e.far,p===d.near&&m===d.far||(n.updateRenderState({depthNear:d.near,depthFar:d.far}),p=d.near,m=d.far);var t=e.parent,i=d.cameras;w(d,t);for(var r=0;r<i.length;r++)w(i[r],t);e.matrixWorld.copy(d.matrixWorld);for(var a=e.children,s=(r=0,a.length);r<s;r++)a[r].updateMatrixWorld(!0);return function(e,t,i){b.setFromMatrixPosition(t.matrixWorld),x.setFromMatrixPosition(i.matrixWorld);var n=b.distanceTo(x),r=t.projectionMatrix.elements,a=i.projectionMatrix.elements,s=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],h=(r[8]-1)/r[0],u=(a[8]+1)/a[0],d=s*h,p=s*u,m=n/(-h+u),f=m*-h;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(m),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var g=s+m,v=o+m,y=d-f,w=p+(n-f),_=l*o/v*g,M=c*o/v*g;e.projectionMatrix.makePerspective(y,w,_,M,g,v)}(d,h,u),d};var _=null;var M=new Aa;M.setAnimationLoop((function(t,i){if(null!==(o=i.getViewerPose(a))){var r=o.views,s=n.renderState.baseLayer;e.setFramebuffer(s.framebuffer);for(var c=0;c<r.length;c++){var h=r[c],u=s.getViewport(h),p=d.cameras[c];p.matrix.fromArray(h.transform.matrix),p.projectionMatrix.fromArray(h.projectionMatrix),p.viewport.set(u.x,u.y,u.width,u.height),0===c&&d.matrix.copy(p.matrix)}}var m=n.inputSources;for(c=0;c<l.length;c++){var f=l[c],g=m[c],v=null,y=null;g&&(f.targetRay&&null!==(v=i.getPose(g.targetRaySpace,a))&&(f.targetRay.matrix.fromArray(v.transform.matrix),f.targetRay.matrix.decompose(f.targetRay.position,f.targetRay.rotation,f.targetRay.scale)),f.grip&&g.gripSpace&&null!==(y=i.getPose(g.gripSpace,a))&&(f.grip.matrix.fromArray(y.transform.matrix),f.grip.matrix.decompose(f.grip.position,f.grip.rotation,f.grip.scale))),f.targetRay&&(f.targetRay.visible=null!==v),f.grip&&(f.grip.visible=null!==y)}_&&_(t,i)})),this.setAnimationLoop=function(e){_=e},this.dispose=function(){}}function Po(e){var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,o=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",h=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,u=null,d=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Jt,this.physicallyCorrectLights=!1,this.toneMapping=te,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p,m,f,g,y,b,x,w,_,M,S,T,E,C,L,A,k,P,R=this,O=!1,I=null,D=0,N=0,z=null,F=null,B=-1,H={geometry:null,program:null,wireframe:!1},G=null,U=null,j=new Vi,V=new Vi,W=null,q=t.width,$=t.height,X=1,Y=null,Z=null,J=new Vi(0,0,q,$),K=new Vi(0,0,q,$),Q=!1,ee=new Ca,ie=new Fa,ne=!1,re=!1,ae=new an,se=new Zi;function oe(){return null===z?X:1}try{var le={alpha:n,depth:r,stencil:a,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:h,xrCompatible:!0};if(t.addEventListener("webglcontextlost",de,!1),t.addEventListener("webglcontextrestored",pe,!1),null===(p=i||t.getContext("webgl",le)||t.getContext("experimental-webgl",le)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===p.getShaderPrecisionFormat&&(p.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function ce(){m=new Ba(p),!1===(f=new za(p,m,e)).isWebGL2&&(m.get("WEBGL_depth_texture"),m.get("OES_texture_float"),m.get("OES_texture_half_float"),m.get("OES_texture_half_float_linear"),m.get("OES_standard_derivatives"),m.get("OES_element_index_uint"),m.get("ANGLE_instanced_arrays")),m.get("OES_texture_float_linear"),P=new Co(p,m,f),(g=new To(p,m,f)).scissor(V.copy(K).multiplyScalar(X).floor()),g.viewport(j.copy(J).multiplyScalar(X).floor()),y=new Ua(p),b=new ho,x=new Eo(p,m,g,b,f,P,y),w=new ka(p,f),_=new Ha(p,w,y),M=new Wa(p,_,w,y),L=new Va(p),S=new co(R,m,f),T=new fo,E=new wo,C=new Da(R,g,M,o),A=new Na(p,m,y,f),k=new Ga(p,m,y,f),y.programs=S.programs,R.capabilities=f,R.extensions=m,R.properties=b,R.renderLists=T,R.state=g,R.info=y}ce();var he=new ko(R,p);this.xr=he;var ue=new So(R,M,f.maxTextureSize);function de(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),O=!0}function pe(){console.log("THREE.WebGLRenderer: Context Restored."),O=!1,ce()}function me(e){var t=e.target;t.removeEventListener("dispose",me),function(e){fe(e),b.remove(e)}(t)}function fe(e){var t=b.get(e).program;e.program=void 0,void 0!==t&&S.releaseProgram(t)}this.shadowMap=ue,this.getContext=function(){return p},this.getContextAttributes=function(){return p.getContextAttributes()},this.forceContextLoss=function(){var e=m.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=m.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(e){void 0!==e&&(X=e,this.setSize(q,$,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Bi),e.set(q,$)},this.setSize=function(e,i,n){he.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(q=e,$=i,t.width=Math.floor(e*X),t.height=Math.floor(i*X),!1!==n&&(t.style.width=e+"px",t.style.height=i+"px"),this.setViewport(0,0,e,i))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Bi),e.set(q*X,$*X).floor()},this.setDrawingBufferSize=function(e,i,n){q=e,$=i,X=n,t.width=Math.floor(e*n),t.height=Math.floor(i*n),this.setViewport(0,0,e,i)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Vi),e.copy(j)},this.getViewport=function(e){return e.copy(J)},this.setViewport=function(e,t,i,n){e.isVector4?J.set(e.x,e.y,e.z,e.w):J.set(e,t,i,n),g.viewport(j.copy(J).multiplyScalar(X).floor())},this.getScissor=function(e){return e.copy(K)},this.setScissor=function(e,t,i,n){e.isVector4?K.set(e.x,e.y,e.z,e.w):K.set(e,t,i,n),g.scissor(V.copy(K).multiplyScalar(X).floor())},this.getScissorTest=function(){return Q},this.setScissorTest=function(e){g.setScissorTest(Q=e)},this.setOpaqueSort=function(e){Y=e},this.setTransparentSort=function(e){Z=e},this.getClearColor=function(){return C.getClearColor()},this.setClearColor=function(){C.setClearColor.apply(C,arguments)},this.getClearAlpha=function(){return C.getClearAlpha()},this.setClearAlpha=function(){C.setClearAlpha.apply(C,arguments)},this.clear=function(e,t,i){var n=0;(void 0===e||e)&&(n|=16384),(void 0===t||t)&&(n|=256),(void 0===i||i)&&(n|=1024),p.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",de,!1),t.removeEventListener("webglcontextrestored",pe,!1),T.dispose(),E.dispose(),b.dispose(),M.dispose(),he.dispose(),ye.stop(),this.forceContextLoss()},this.renderBufferImmediate=function(e,t){g.initAttributes();var i=b.get(e);e.hasPositions&&!i.position&&(i.position=p.createBuffer()),e.hasNormals&&!i.normal&&(i.normal=p.createBuffer()),e.hasUvs&&!i.uv&&(i.uv=p.createBuffer()),e.hasColors&&!i.color&&(i.color=p.createBuffer());var n=t.getAttributes();e.hasPositions&&(p.bindBuffer(34962,i.position),p.bufferData(34962,e.positionArray,35048),g.enableAttribute(n.position),p.vertexAttribPointer(n.position,3,5126,!1,0,0)),e.hasNormals&&(p.bindBuffer(34962,i.normal),p.bufferData(34962,e.normalArray,35048),g.enableAttribute(n.normal),p.vertexAttribPointer(n.normal,3,5126,!1,0,0)),e.hasUvs&&(p.bindBuffer(34962,i.uv),p.bufferData(34962,e.uvArray,35048),g.enableAttribute(n.uv),p.vertexAttribPointer(n.uv,2,5126,!1,0,0)),e.hasColors&&(p.bindBuffer(34962,i.color),p.bufferData(34962,e.colorArray,35048),g.enableAttribute(n.color),p.vertexAttribPointer(n.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),p.drawArrays(4,0,e.count),e.count=0};var ge=new Sn;this.renderBufferDirect=function(e,t,i,n,r,a){null===t&&(t=ge);var s=r.isMesh&&r.matrixWorld.determinant()<0,o=Me(e,t,n,r);g.setMaterial(n,s);var l=!1;H.geometry===i.id&&H.program===o.id&&H.wireframe===(!0===n.wireframe)||(H.geometry=i.id,H.program=o.id,H.wireframe=!0===n.wireframe,l=!0),(n.morphTargets||n.morphNormals)&&(L.update(r,i,n,o),l=!0);var c=i.index,h=i.attributes.position;if(null===c){if(void 0===h||0===h.count)return}else if(0===c.count)return;var u,d=1;!0===n.wireframe&&(c=_.getWireframeAttribute(i),d=2);var v=A;null!==c&&(u=w.get(c),(v=k).setIndex(u)),l&&(!function(e,t,i,n){if(!1===f.isWebGL2&&(e.isInstancedMesh||t.isInstancedBufferGeometry)&&null===m.get("ANGLE_instanced_arrays"))return;g.initAttributes();var r=t.attributes,a=n.getAttributes(),s=i.defaultAttributeValues;for(var o in a){var l=a[o];if(l>=0){var c=r[o];if(void 0!==c){var h=c.normalized,u=c.itemSize;if(void 0===(M=w.get(c)))continue;var d=M.buffer,v=M.type,y=M.bytesPerElement;if(c.isInterleavedBufferAttribute){var b=c.data,x=b.stride,_=c.offset;b&&b.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(l,b.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=b.meshPerAttribute*b.count)):g.enableAttribute(l),p.bindBuffer(34962,d),p.vertexAttribPointer(l,u,v,h,x*y,_*y)}else c.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(l,c.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=c.meshPerAttribute*c.count)):g.enableAttribute(l),p.bindBuffer(34962,d),p.vertexAttribPointer(l,u,v,h,0,0)}else if("instanceMatrix"===o){var M;if(void 0===(M=w.get(e.instanceMatrix)))continue;d=M.buffer,v=M.type;g.enableAttributeAndDivisor(l+0,1),g.enableAttributeAndDivisor(l+1,1),g.enableAttributeAndDivisor(l+2,1),g.enableAttributeAndDivisor(l+3,1),p.bindBuffer(34962,d),p.vertexAttribPointer(l+0,4,v,!1,64,0),p.vertexAttribPointer(l+1,4,v,!1,64,16),p.vertexAttribPointer(l+2,4,v,!1,64,32),p.vertexAttribPointer(l+3,4,v,!1,64,48)}else if(void 0!==s){var S=s[o];if(void 0!==S)switch(S.length){case 2:p.vertexAttrib2fv(l,S);break;case 3:p.vertexAttrib3fv(l,S);break;case 4:p.vertexAttrib4fv(l,S);break;default:p.vertexAttrib1fv(l,S)}}}}g.disableUnusedAttributes()}(r,i,n,o),null!==c&&p.bindBuffer(34963,u.buffer));var y=null!==c?c.count:h.count,b=i.drawRange.start*d,x=i.drawRange.count*d,M=null!==a?a.start*d:0,S=null!==a?a.count*d:1/0,T=Math.max(b,M),E=Math.min(y,b+x,M+S)-1,C=Math.max(0,E-T+1);if(0!==C){if(r.isMesh)!0===n.wireframe?(g.setLineWidth(n.wireframeLinewidth*oe()),v.setMode(1)):v.setMode(4);else if(r.isLine){var P=n.linewidth;void 0===P&&(P=1),g.setLineWidth(P*oe()),r.isLineSegments?v.setMode(1):r.isLineLoop?v.setMode(2):v.setMode(3)}else r.isPoints?v.setMode(0):r.isSprite&&v.setMode(4);r.isInstancedMesh?v.renderInstances(i,T,C,r.count):i.isInstancedBufferGeometry?v.renderInstances(i,T,C,i.maxInstancedCount):v.render(T,C)}},this.compile=function(e,t){(d=E.get(e,t)).init(),e.traverse((function(e){e.isLight&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(t);var i={};e.traverse((function(t){if(t.material)if(Array.isArray(t.material))for(var n=0;n<t.material.length;n++)t.material[n].uuid in i==!1&&(_e(t.material[n],e,t),i[t.material[n].uuid]=!0);else t.material.uuid in i==!1&&(_e(t.material,e,t),i[t.material.uuid]=!0)}))};var ve=null;var ye=new Aa;function be(e,t,i,n){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)i=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||ee.intersectsSprite(e)){n&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae);var r=M.update(e);(a=e.material).visible&&u.push(e,r,a,i,se.z,null)}}else if(e.isImmediateRenderObject)n&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae),u.push(e,null,e.material,i,se.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==y.render.frame&&(e.skeleton.update(),e.skeleton.frame=y.render.frame),!e.frustumCulled||ee.intersectsObject(e))){n&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae);r=M.update(e);var a=e.material;if(Array.isArray(a))for(var s=r.groups,o=0,l=s.length;o<l;o++){var c=s[o],h=a[c.materialIndex];h&&h.visible&&u.push(e,r,h,i,se.z,c)}else a.visible&&u.push(e,r,a,i,se.z,null)}var p=e.children;for(o=0,l=p.length;o<l;o++)be(p[o],t,i,n)}}function xe(e,t,i,n){for(var r=0,a=e.length;r<a;r++){var s=e[r],o=s.object,l=s.geometry,c=void 0===n?s.material:n,h=s.group;if(i.isArrayCamera){U=i;for(var u=i.cameras,p=0,m=u.length;p<m;p++){var f=u[p];o.layers.test(f.layers)&&(g.viewport(j.copy(f.viewport)),d.setupLights(f),we(o,t,f,l,c,h))}}else U=null,we(o,t,i,l,c,h)}}function we(e,t,i,n,r,a){if(e.onBeforeRender(R,t,i,n,r,a),d=E.get(t,U||i),e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var s=Me(i,t,r,e);g.setMaterial(r),H.geometry=null,H.program=null,H.wireframe=!1,function(e,t){e.render((function(e){R.renderBufferImmediate(e,t)}))}(e,s)}else R.renderBufferDirect(i,t,n,r,e,a);e.onAfterRender(R,t,i,n,r,a),d=E.get(t,U||i)}function _e(e,t,i){var n=b.get(e),r=d.state.lights,a=d.state.shadowsArray,s=r.state.version,o=S.getParameters(e,r.state,a,t,ie.numPlanes,ie.numIntersection,i),l=S.getProgramCacheKey(o),c=n.program,h=!0;if(void 0===c)e.addEventListener("dispose",me);else if(c.cacheKey!==l)fe(e);else if(n.lightsStateVersion!==s)n.lightsStateVersion=s,h=!1;else{if(void 0!==o.shaderID)return;h=!1}h&&(c=S.acquireProgram(o,l),n.program=c,n.uniforms=o.uniforms,n.environment=e.isMeshStandardMaterial?t.environment:null,n.outputEncoding=R.outputEncoding,e.program=c);var u=c.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var p=0;p<R.maxMorphTargets;p++)u["morphTarget"+p]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(p=0;p<R.maxMorphNormals;p++)u["morphNormal"+p]>=0&&e.numSupportedMorphNormals++}var m=n.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=ie.numPlanes,n.numIntersection=ie.numIntersection,m.clippingPlanes=ie.uniform),n.fog=t.fog,n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=s,n.needsLights&&(m.ambientLightColor.value=r.state.ambient,m.lightProbe.value=r.state.probe,m.directionalLights.value=r.state.directional,m.directionalLightShadows.value=r.state.directionalShadow,m.spotLights.value=r.state.spot,m.spotLightShadows.value=r.state.spotShadow,m.rectAreaLights.value=r.state.rectArea,m.pointLights.value=r.state.point,m.pointLightShadows.value=r.state.pointShadow,m.hemisphereLights.value=r.state.hemi,m.directionalShadowMap.value=r.state.directionalShadowMap,m.directionalShadowMatrix.value=r.state.directionalShadowMatrix,m.spotShadowMap.value=r.state.spotShadowMap,m.spotShadowMatrix.value=r.state.spotShadowMatrix,m.pointShadowMap.value=r.state.pointShadowMap,m.pointShadowMatrix.value=r.state.pointShadowMatrix);var f=n.program.getUniforms(),g=js.seqWithValue(f.seq,m);n.uniformsList=g}function Me(e,t,i,n){x.resetTextureUnits();var r=t.fog,a=i.isMeshStandardMaterial?t.environment:null,s=b.get(i),o=d.state.lights;if(ne&&(re||e!==G)){var l=e===G&&i.id===B;ie.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,e,s,l)}i.version===s.__version?void 0===s.program||i.fog&&s.fog!==r||s.environment!==a||s.needsLights&&s.lightsStateVersion!==o.state.version?_e(i,t,n):void 0===s.numClippingPlanes||s.numClippingPlanes===ie.numPlanes&&s.numIntersection===ie.numIntersection?s.outputEncoding!==R.outputEncoding&&_e(i,t,n):_e(i,t,n):(_e(i,t,n),s.__version=i.version);var c,h,u=!1,m=!1,y=!1,w=s.program,_=w.getUniforms(),M=s.uniforms;if(g.useProgram(w.program)&&(u=!0,m=!0,y=!0),i.id!==B&&(B=i.id,m=!0),u||G!==e){if(_.setValue(p,"projectionMatrix",e.projectionMatrix),f.logarithmicDepthBuffer&&_.setValue(p,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),G!==e&&(G=e,m=!0,y=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){var S=_.map.cameraPosition;void 0!==S&&S.setValue(p,se.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&_.setValue(p,"isOrthographic",!0===e.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&_.setValue(p,"viewMatrix",e.matrixWorldInverse)}if(i.skinning){_.setOptional(p,n,"bindMatrix"),_.setOptional(p,n,"bindMatrixInverse");var T=n.skeleton;if(T){var E=T.bones;if(f.floatVertexTextures){if(void 0===T.boneTexture){var C=Math.sqrt(4*E.length);C=Fi.ceilPowerOfTwo(C),C=Math.max(C,4);var L=new Float32Array(C*C*4);L.set(T.boneMatrices);var A=new Sa(L,C,C,Ge,Oe);T.boneMatrices=L,T.boneTexture=A,T.boneTextureSize=C}_.setValue(p,"boneTexture",T.boneTexture,x),_.setValue(p,"boneTextureSize",T.boneTextureSize)}else _.setOptional(p,T,"boneMatrices")}}return(m||s.receiveShadow!==n.receiveShadow)&&(s.receiveShadow=n.receiveShadow,_.setValue(p,"receiveShadow",n.receiveShadow)),m&&(_.setValue(p,"toneMappingExposure",R.toneMappingExposure),_.setValue(p,"toneMappingWhitePoint",R.toneMappingWhitePoint),s.needsLights&&(h=y,(c=M).ambientLightColor.needsUpdate=h,c.lightProbe.needsUpdate=h,c.directionalLights.needsUpdate=h,c.directionalLightShadows.needsUpdate=h,c.pointLights.needsUpdate=h,c.pointLightShadows.needsUpdate=h,c.spotLights.needsUpdate=h,c.spotLightShadows.needsUpdate=h,c.rectAreaLights.needsUpdate=h,c.hemisphereLights.needsUpdate=h),r&&i.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(M,r),i.isMeshBasicMaterial?Se(M,i):i.isMeshLambertMaterial?(Se(M,i),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(M,i)):i.isMeshToonMaterial?(Se(M,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===v&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===v&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(M,i)):i.isMeshPhongMaterial?(Se(M,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===v&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===v&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(M,i)):i.isMeshStandardMaterial?(Se(M,i,a),i.isMeshPhysicalMaterial?function(e,t,i){Te(e,t,i),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===v&&e.clearcoatNormalScale.value.negate());e.transparency.value=t.transparency}(M,i,a):Te(M,i,a)):i.isMeshMatcapMaterial?(Se(M,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===v&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===v&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(M,i)):i.isMeshDepthMaterial?(Se(M,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(M,i)):i.isMeshDistanceMaterial?(Se(M,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(M,i)):i.isMeshNormalMaterial?(Se(M,i),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===v&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===v&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(M,i)):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(M,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(M,i)):i.isPointsMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*X,e.scale.value=.5*$,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(M,i):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(M,i):i.isShadowMaterial&&(M.color.value.copy(i.color),M.opacity.value=i.opacity),void 0!==M.ltc_1&&(M.ltc_1.value=La.LTC_1),void 0!==M.ltc_2&&(M.ltc_2.value=La.LTC_2),js.upload(p,s.uniformsList,M,x),i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(js.upload(p,s.uniformsList,M,x),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&_.setValue(p,"center",n.center),_.setValue(p,"modelViewMatrix",n.modelViewMatrix),_.setValue(p,"normalMatrix",n.normalMatrix),_.setValue(p,"modelMatrix",n.matrixWorld),w}function Se(e,t,i){e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap);var n,r,a=t.envMap||i;a&&(e.envMap.value=a,e.flipEnvMap.value=a.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=b.get(a).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix)),t.aoMap?r=t.aoMap:t.lightMap&&(r=t.lightMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uv2Transform.value.copy(r.matrix))}function Te(e,t,i){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===v&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===v&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),(t.envMap||i)&&(e.envMapIntensity.value=t.envMapIntensity)}ye.setAnimationLoop((function(e){he.isPresenting||ve&&ve(e)})),"undefined"!=typeof window&&ye.setContext(window),this.setAnimationLoop=function(e){ve=e,he.setAnimationLoop(e),ye.start()},this.render=function(e,t){var i,n;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),i=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),n=arguments[3]),t&&t.isCamera){if(!O){H.geometry=null,H.program=null,H.wireframe=!1,B=-1,G=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),he.enabled&&he.isPresenting&&(t=he.getCamera(t)),(d=E.get(e,t)).init(),e.onBeforeRender(R,e,t,i||z),ae.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ee.setFromProjectionMatrix(ae),re=this.localClippingEnabled,ne=ie.init(this.clippingPlanes,re,t),(u=T.get(e,t)).init(),be(e,t,0,R.sortObjects),u.finish(),!0===R.sortObjects&&u.sort(Y,Z),ne&&ie.beginShadows();var r=d.state.shadowsArray;ue.render(r,e,t),d.setupLights(t),ne&&ie.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),C.render(u,e,t,n);var a=u.opaque,s=u.transparent;if(e.overrideMaterial){var o=e.overrideMaterial;a.length&&xe(a,e,t,o),s.length&&xe(s,e,t,o)}else a.length&&xe(a,e,t),s.length&&xe(s,e,t);e.onAfterRender(R,e,t),null!==z&&(x.updateRenderTargetMipmap(z),x.updateMultisampleRenderTarget(z)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),u=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){I!==e&&null===z&&p.bindFramebuffer(36160,e),I=e},this.getActiveCubeFace=function(){return D},this.getActiveMipmapLevel=function(){return N},this.getRenderTarget=function(){return z},this.setRenderTarget=function(e,t,i){z=e,D=t,N=i,e&&void 0===b.get(e).__webglFramebuffer&&x.setupRenderTarget(e);var n=I,r=!1;if(e){var a=b.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(n=a[t||0],r=!0):n=e.isWebGLMultisampleRenderTarget?b.get(e).__webglMultisampledFramebuffer:a,j.copy(e.viewport),V.copy(e.scissor),W=e.scissorTest}else j.copy(J).multiplyScalar(X).floor(),V.copy(K).multiplyScalar(X).floor(),W=Q;if(F!==n&&(p.bindFramebuffer(36160,n),F=n),g.viewport(j),g.scissor(V),g.setScissorTest(W),r){var s=b.get(e.texture);p.framebufferTexture2D(36160,36064,34069+(t||0),s.__webglTexture,i||0)}},this.readRenderTargetPixels=function(e,t,i,n,r,a,s){if(e&&e.isWebGLRenderTarget){var o=b.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(o=o[s]),o){var l=!1;o!==F&&(p.bindFramebuffer(36160,o),l=!0);try{var c=e.texture,h=c.format,u=c.type;if(h!==Ge&&P.convert(h)!==p.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(u===Ce||P.convert(u)===p.getParameter(35738)||u===Oe&&(f.isWebGL2||m.get("OES_texture_float")||m.get("WEBGL_color_buffer_float"))||u===Ie&&(f.isWebGL2?m.get("EXT_color_buffer_float"):m.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===p.checkFramebufferStatus(36160)?t>=0&&t<=e.width-n&&i>=0&&i<=e.height-r&&p.readPixels(t,i,n,r,P.convert(h),P.convert(u),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&p.bindFramebuffer(36160,F)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,i){void 0===i&&(i=0);var n=Math.pow(2,-i),r=Math.floor(t.image.width*n),a=Math.floor(t.image.height*n),s=P.convert(t.format);x.setTexture2D(t,0),p.copyTexImage2D(3553,i,s,e.x,e.y,r,a,0),g.unbindTexture()},this.copyTextureToTexture=function(e,t,i,n){var r=t.image.width,a=t.image.height,s=P.convert(i.format),o=P.convert(i.type);x.setTexture2D(i,0),t.isDataTexture?p.texSubImage2D(3553,n||0,e.x,e.y,r,a,s,o,t.image.data):p.texSubImage2D(3553,n||0,e.x,e.y,s,o,t.image),g.unbindTexture()},this.initTexture=function(e){x.setTexture2D(e,0),g.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Ro(e,t){this.name="",this.color=new mr(e),this.density=void 0!==t?t:25e-5}function Oo(e,t,i){this.name="",this.color=new mr(e),this.near=void 0!==t?t:1,this.far=void 0!==i?i:1e3}function Io(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Ti,this.updateRange={offset:0,count:-1},this.version=0}Lo.prototype=Object.assign(Object.create(wa.prototype),{constructor:Lo,isArrayCamera:!0}),Ao.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Ao,isGroup:!0}),Object.assign(ko.prototype,Ii.prototype),Object.assign(Ro.prototype,{isFogExp2:!0,clone:function(){return new Ro(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Oo.prototype,{isFog:!0,clone:function(){return new Oo(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Io.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Io.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,i){e*=this.stride,i*=t.stride;for(var n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var Do,No=new Zi;function zo(e,t,i,n){this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===n}function Fo(e){xr.call(this),this.type="SpriteMaterial",this.color=new mr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Object.defineProperties(zo.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(zo.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,i=this.data.count;t<i;t++)No.x=this.getX(t),No.y=this.getY(t),No.z=this.getZ(t),No.applyMatrix4(e),this.setXYZ(t,No.x,No.y,No.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}}),Fo.prototype=Object.create(xr.prototype),Fo.prototype.constructor=Fo,Fo.prototype.isSpriteMaterial=!0,Fo.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Bo=new Zi,Ho=new Zi,Go=new Zi,Uo=new Bi,jo=new Bi,Vo=new an,Wo=new Zi,qo=new Zi,$o=new Zi,Xo=new Bi,Yo=new Bi,Zo=new Bi;function Jo(e){if(Mn.call(this),this.type="Sprite",void 0===Do){Do=new Ur;var t=new Io(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Do.setIndex([0,1,2,0,2,3]),Do.setAttribute("position",new zo(t,3,0,!1)),Do.setAttribute("uv",new zo(t,2,3,!1))}this.geometry=Do,this.material=void 0!==e?e:new Fo,this.center=new Bi(.5,.5)}function Ko(e,t,i,n,r,a){Uo.subVectors(e,i).addScalar(.5).multiply(n),void 0!==r?(jo.x=a*Uo.x-r*Uo.y,jo.y=r*Uo.x+a*Uo.y):jo.copy(Uo),e.copy(t),e.x+=jo.x,e.y+=jo.y,e.applyMatrix4(Vo)}Jo.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Jo,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ho.setFromMatrixScale(this.matrixWorld),Vo.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Go.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ho.multiplyScalar(-Go.z);var i,n,r=this.material.rotation;0!==r&&(n=Math.cos(r),i=Math.sin(r));var a=this.center;Ko(Wo.set(-.5,-.5,0),Go,a,Ho,i,n),Ko(qo.set(.5,-.5,0),Go,a,Ho,i,n),Ko($o.set(.5,.5,0),Go,a,Ho,i,n),Xo.set(0,0),Yo.set(1,0),Zo.set(1,1);var s=e.ray.intersectTriangle(Wo,qo,$o,!1,Bo);if(null!==s||(Ko(qo.set(-.5,.5,0),Go,a,Ho,i,n),Yo.set(0,1),null!==(s=e.ray.intersectTriangle(Wo,$o,qo,!1,Bo)))){var o=e.ray.origin.distanceTo(Bo);o<e.near||o>e.far||t.push({distance:o,point:Bo.clone(),uv:hr.getUV(Bo,Wo,qo,$o,Xo,Yo,Zo,new Bi),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Mn.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}});var Qo=new Zi,el=new Zi;function tl(){Mn.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function il(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),sa.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new an,this.bindMatrixInverse=new an}tl.prototype=Object.assign(Object.create(Mn.prototype),{constructor:tl,isLOD:!0,copy:function(e){Mn.prototype.copy.call(this,e,!1);for(var t=e.levels,i=0,n=t.length;i<n;i++){var r=t[i];this.addLevel(r.object.clone(),r.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var i=this.levels,n=0;n<i.length&&!(t<i[n].distance);n++);return i.splice(n,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var t=this.levels;if(t.length>0){for(var i=1,n=t.length;i<n&&!(e<t[i].distance);i++);return t[i-1].object}return null},raycast:function(e,t){if(this.levels.length>0){Qo.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(Qo);this.getObjectForDistance(i).raycast(e,t)}},update:function(e){var t=this.levels;if(t.length>1){Qo.setFromMatrixPosition(e.matrixWorld),el.setFromMatrixPosition(this.matrixWorld);var i=Qo.distanceTo(el)/e.zoom;t[0].object.visible=!0;for(var n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}},toJSON:function(e){var t=Mn.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var i=this.levels,n=0,r=i.length;n<r;n++){var a=i[n];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}),il.prototype=Object.assign(Object.create(sa.prototype),{constructor:il,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Vi,t=this.geometry.attributes.skinWeight,i=0,n=t.count;i<n;i++){e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.w=t.getW(i);var r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){sa.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var nl=new an,rl=new an;function al(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new an)}}function sl(){Mn.call(this),this.type="Bone"}Object.assign(al.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var i=new an;this.bones[e]&&i.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(i)}},pose:function(){var e,t,i;for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,t=this.boneInverses,i=this.boneMatrices,n=this.boneTexture,r=0,a=e.length;r<a;r++){var s=e[r]?e[r].matrixWorld:rl;nl.multiplyMatrices(s,t[r]),nl.toArray(i,16*r)}void 0!==n&&(n.needsUpdate=!0)},clone:function(){return new al(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,i=this.bones.length;t<i;t++){var n=this.bones[t];if(n.name===e)return n}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),sl.prototype=Object.assign(Object.create(Mn.prototype),{constructor:sl,isBone:!0});var ol=new an,ll=new an,cl=[],hl=new sa;function ul(e,t,i){sa.call(this,e,t),this.instanceMatrix=new Mr(new Float32Array(16*i),16),this.count=i,this.frustumCulled=!1}function dl(e){xr.call(this),this.type="LineBasicMaterial",this.color=new mr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}ul.prototype=Object.assign(Object.create(sa.prototype),{constructor:ul,isInstancedMesh:!0,getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var i=this.matrixWorld,n=this.count;if(hl.geometry=this.geometry,hl.material=this.material,void 0!==hl.material)for(var r=0;r<n;r++)this.getMatrixAt(r,ol),ll.multiplyMatrices(i,ol),hl.matrixWorld=ll,hl.raycast(e,cl),cl.length>0&&(cl[0].instanceId=r,cl[0].object=this,t.push(cl[0]),cl.length=0)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),dl.prototype=Object.create(xr.prototype),dl.prototype.constructor=dl,dl.prototype.isLineBasicMaterial=!0,dl.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};var pl=new Zi,ml=new Zi,fl=new an,gl=new Yn,vl=new Gn;function yl(e,t,i){1===i&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Mn.call(this),this.type="Line",this.geometry=void 0!==e?e:new Ur,this.material=void 0!==t?t:new dl}yl.prototype=Object.assign(Object.create(Mn.prototype),{constructor:yl,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,i=[0],n=1,r=t.count;n<r;n++)pl.fromBufferAttribute(t,n-1),ml.fromBufferAttribute(t,n),i[n]=i[n-1],i[n]+=pl.distanceTo(ml);e.setAttribute("lineDistance",new Pr(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;(i=e.lineDistances)[0]=0;for(n=1,r=a.length;n<r;n++)i[n]=i[n-1],i[n]+=a[n-1].distanceTo(a[n])}return this},raycast:function(e,t){var i=this.geometry,n=this.matrixWorld,r=e.params.Line.threshold;if(null===i.boundingSphere&&i.computeBoundingSphere(),vl.copy(i.boundingSphere),vl.applyMatrix4(n),vl.radius+=r,!1!==e.ray.intersectsSphere(vl)){fl.getInverse(n),gl.copy(e.ray).applyMatrix4(fl);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,o=new Zi,l=new Zi,c=new Zi,h=new Zi,u=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var d=i.index,p=i.attributes.position.array;if(null!==d)for(var m=d.array,f=0,g=m.length-1;f<g;f+=u){var v=m[f],y=m[f+1];if(o.fromArray(p,3*v),l.fromArray(p,3*y),!(gl.distanceSqToSegment(o,l,h,c)>s))h.applyMatrix4(this.matrixWorld),(w=e.ray.origin.distanceTo(h))<e.near||w>e.far||t.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this})}else for(f=0,g=p.length/3-1;f<g;f+=u){if(o.fromArray(p,3*f),l.fromArray(p,3*f+3),!(gl.distanceSqToSegment(o,l,h,c)>s))h.applyMatrix4(this.matrixWorld),(w=e.ray.origin.distanceTo(h))<e.near||w>e.far||t.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this})}}else if(i.isGeometry){var b=i.vertices,x=b.length;for(f=0;f<x-1;f+=u){var w;if(!(gl.distanceSqToSegment(b[f],b[f+1],h,c)>s))h.applyMatrix4(this.matrixWorld),(w=e.ray.origin.distanceTo(h))<e.near||w>e.far||t.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var bl=new Zi,xl=new Zi;function wl(e,t){yl.call(this,e,t),this.type="LineSegments"}function _l(e,t){yl.call(this,e,t),this.type="LineLoop"}function Ml(e){xr.call(this),this.type="PointsMaterial",this.color=new mr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}wl.prototype=Object.assign(Object.create(yl.prototype),{constructor:wl,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,i=[],n=0,r=t.count;n<r;n+=2)bl.fromBufferAttribute(t,n),xl.fromBufferAttribute(t,n+1),i[n]=0===n?0:i[n-1],i[n+1]=i[n]+bl.distanceTo(xl);e.setAttribute("lineDistance",new Pr(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;for(i=e.lineDistances,n=0,r=a.length;n<r;n+=2)bl.copy(a[n]),xl.copy(a[n+1]),i[n]=0===n?0:i[n-1],i[n+1]=i[n]+bl.distanceTo(xl)}return this}}),_l.prototype=Object.assign(Object.create(yl.prototype),{constructor:_l,isLineLoop:!0}),Ml.prototype=Object.create(xr.prototype),Ml.prototype.constructor=Ml,Ml.prototype.isPointsMaterial=!0,Ml.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var Sl=new an,Tl=new Yn,El=new Gn,Cl=new Zi;function Ll(e,t){Mn.call(this),this.type="Points",this.geometry=void 0!==e?e:new Ur,this.material=void 0!==t?t:new Ml,this.updateMorphTargets()}function Al(e,t,i,n,r,a,s){var o=Tl.distanceSqToPoint(e);if(o<i){var l=new Zi;Tl.closestPointToPoint(e,l),l.applyMatrix4(n);var c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;a.push({distance:c,distanceToRay:Math.sqrt(o),point:l,index:t,face:null,object:s})}}function kl(e,t,i,n,r,a,s,o,l){ji.call(this,e,t,i,n,r,a,s,o,l),this.format=void 0!==s?s:He,this.minFilter=void 0!==a?a:_e,this.magFilter=void 0!==r?r:_e,this.generateMipmaps=!1}function Pl(e,t,i,n,r,a,s,o,l,c,h,u){ji.call(this,null,a,s,o,l,c,n,r,h,u),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Rl(e,t,i,n,r,a,s,o,l){ji.call(this,e,t,i,n,r,a,s,o,l),this.needsUpdate=!0}function Ol(e,t,i,n,r,a,s,o,l,c){if((c=void 0!==c?c:We)!==We&&c!==qe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&c===We&&(i=ke),void 0===i&&c===qe&&(i=Fe),ji.call(this,null,n,r,a,s,o,c,i,l),this.image={width:e,height:t},this.magFilter=void 0!==s?s:ve,this.minFilter=void 0!==o?o:ve,this.flipY=!1,this.generateMipmaps=!1}function Il(e){Ur.call(this),this.type="WireframeGeometry";var t,i,n,r,a,s,o,l,c,h,u=[],d=[0,0],p={},m=["a","b","c"];if(e&&e.isGeometry){var f=e.faces;for(t=0,n=f.length;t<n;t++){var g=f[t];for(i=0;i<3;i++)o=g[m[i]],l=g[m[(i+1)%3]],d[0]=Math.min(o,l),d[1]=Math.max(o,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]})}for(c in p)s=p[c],h=e.vertices[s.index1],u.push(h.x,h.y,h.z),h=e.vertices[s.index2],u.push(h.x,h.y,h.z)}else if(e&&e.isBufferGeometry){var v,y,b,x,w,_,M;if(h=new Zi,null!==e.index){for(v=e.attributes.position,y=e.index,0===(b=e.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),r=0,a=b.length;r<a;++r)for(t=w=(x=b[r]).start,n=w+x.count;t<n;t+=3)for(i=0;i<3;i++)o=y.getX(t+i),l=y.getX(t+(i+1)%3),d[0]=Math.min(o,l),d[1]=Math.max(o,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]});for(c in p)s=p[c],h.fromBufferAttribute(v,s.index1),u.push(h.x,h.y,h.z),h.fromBufferAttribute(v,s.index2),u.push(h.x,h.y,h.z)}else for(t=0,n=(v=e.attributes.position).count/3;t<n;t++)for(i=0;i<3;i++)_=3*t+i,h.fromBufferAttribute(v,_),u.push(h.x,h.y,h.z),M=3*t+(i+1)%3,h.fromBufferAttribute(v,M),u.push(h.x,h.y,h.z)}this.setAttribute("position",new Pr(u,3))}function Dl(e,t,i){pa.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:i},this.fromBufferGeometry(new Nl(e,t,i)),this.mergeVertices()}function Nl(e,t,i){Ur.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:i};var n,r,a=[],s=[],o=[],l=[],c=1e-5,h=new Zi,u=new Zi,d=new Zi,p=new Zi,m=new Zi;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var f=t+1;for(n=0;n<=i;n++){var g=n/i;for(r=0;r<=t;r++){var v=r/t;e(v,g,u),s.push(u.x,u.y,u.z),v-c>=0?(e(v-c,g,d),p.subVectors(u,d)):(e(v+c,g,d),p.subVectors(d,u)),g-c>=0?(e(v,g-c,d),m.subVectors(u,d)):(e(v,g+c,d),m.subVectors(d,u)),h.crossVectors(p,m).normalize(),o.push(h.x,h.y,h.z),l.push(v,g)}}for(n=0;n<i;n++)for(r=0;r<t;r++){var y=n*f+r,b=n*f+r+1,x=(n+1)*f+r+1,w=(n+1)*f+r;a.push(y,b,w),a.push(b,x,w)}this.setIndex(a),this.setAttribute("position",new Pr(s,3)),this.setAttribute("normal",new Pr(o,3)),this.setAttribute("uv",new Pr(l,2))}function zl(e,t,i,n){pa.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},this.fromBufferGeometry(new Fl(e,t,i,n)),this.mergeVertices()}function Fl(e,t,i,n){Ur.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},i=i||1;var r=[],a=[];function s(e,t,i,n){var r,a,s=Math.pow(2,n),l=[];for(r=0;r<=s;r++){l[r]=[];var c=e.clone().lerp(i,r/s),h=t.clone().lerp(i,r/s),u=s-r;for(a=0;a<=u;a++)l[r][a]=0===a&&r===s?c:c.clone().lerp(h,a/u)}for(r=0;r<s;r++)for(a=0;a<2*(s-r)-1;a++){var d=Math.floor(a/2);a%2==0?(o(l[r][d+1]),o(l[r+1][d]),o(l[r][d])):(o(l[r][d+1]),o(l[r+1][d+1]),o(l[r+1][d]))}}function o(e){r.push(e.x,e.y,e.z)}function l(t,i){var n=3*t;i.x=e[n+0],i.y=e[n+1],i.z=e[n+2]}function c(e,t,i,n){n<0&&1===e.x&&(a[t]=e.x-1),0===i.x&&0===i.z&&(a[t]=n/2/Math.PI+.5)}function h(e){return Math.atan2(e.z,-e.x)}!function(e){for(var i=new Zi,n=new Zi,r=new Zi,a=0;a<t.length;a+=3)l(t[a+0],i),l(t[a+1],n),l(t[a+2],r),s(i,n,r,e)}(n=n||0),function(e){for(var t=new Zi,i=0;i<r.length;i+=3)t.x=r[i+0],t.y=r[i+1],t.z=r[i+2],t.normalize().multiplyScalar(e),r[i+0]=t.x,r[i+1]=t.y,r[i+2]=t.z}(i),function(){for(var e=new Zi,t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];var i=h(e)/2/Math.PI+.5,n=(s=e,Math.atan2(-s.y,Math.sqrt(s.x*s.x+s.z*s.z))/Math.PI+.5);a.push(i,1-n)}var s;(function(){for(var e=new Zi,t=new Zi,i=new Zi,n=new Zi,s=new Bi,o=new Bi,l=new Bi,u=0,d=0;u<r.length;u+=9,d+=6){e.set(r[u+0],r[u+1],r[u+2]),t.set(r[u+3],r[u+4],r[u+5]),i.set(r[u+6],r[u+7],r[u+8]),s.set(a[d+0],a[d+1]),o.set(a[d+2],a[d+3]),l.set(a[d+4],a[d+5]),n.copy(e).add(t).add(i).divideScalar(3);var p=h(n);c(s,d+0,e,p),c(o,d+2,t,p),c(l,d+4,i,p)}})(),function(){for(var e=0;e<a.length;e+=6){var t=a[e+0],i=a[e+2],n=a[e+4],r=Math.max(t,i,n),s=Math.min(t,i,n);r>.9&&s<.1&&(t<.2&&(a[e+0]+=1),i<.2&&(a[e+2]+=1),n<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new Pr(r,3)),this.setAttribute("normal",new Pr(r.slice(),3)),this.setAttribute("uv",new Pr(a,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function Bl(e,t){pa.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Hl(e,t)),this.mergeVertices()}function Hl(e,t){Fl.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Gl(e,t){pa.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ul(e,t)),this.mergeVertices()}function Ul(e,t){Fl.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function jl(e,t){pa.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Vl(e,t)),this.mergeVertices()}function Vl(e,t){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];Fl.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Wl(e,t){pa.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ql(e,t)),this.mergeVertices()}function ql(e,t){var i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n];Fl.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function $l(e,t,i,n,r,a){pa.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:n,closed:r},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var s=new Xl(e,t,i,n,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals,this.fromBufferGeometry(s),this.mergeVertices()}function Xl(e,t,i,n,r){Ur.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:n,closed:r},t=t||64,i=i||1,n=n||8,r=r||!1;var a=e.computeFrenetFrames(t,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var s,o,l=new Zi,c=new Zi,h=new Bi,u=new Zi,d=[],p=[],m=[],f=[];function g(r){u=e.getPointAt(r/t,u);var s=a.normals[r],h=a.binormals[r];for(o=0;o<=n;o++){var m=o/n*Math.PI*2,f=Math.sin(m),g=-Math.cos(m);c.x=g*s.x+f*h.x,c.y=g*s.y+f*h.y,c.z=g*s.z+f*h.z,c.normalize(),p.push(c.x,c.y,c.z),l.x=u.x+i*c.x,l.y=u.y+i*c.y,l.z=u.z+i*c.z,d.push(l.x,l.y,l.z)}}!function(){for(s=0;s<t;s++)g(s);g(!1===r?t:0),function(){for(s=0;s<=t;s++)for(o=0;o<=n;o++)h.x=s/t,h.y=o/n,m.push(h.x,h.y)}(),function(){for(o=1;o<=t;o++)for(s=1;s<=n;s++){var e=(n+1)*(o-1)+(s-1),i=(n+1)*o+(s-1),r=(n+1)*o+s,a=(n+1)*(o-1)+s;f.push(e,i,a),f.push(i,r,a)}}()}(),this.setIndex(f),this.setAttribute("position",new Pr(d,3)),this.setAttribute("normal",new Pr(p,3)),this.setAttribute("uv",new Pr(m,2))}function Yl(e,t,i,n,r,a,s){pa.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:a},void 0!==s&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Zl(e,t,i,n,r,a)),this.mergeVertices()}function Zl(e,t,i,n,r,a){Ur.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:a},e=e||1,t=t||.4,i=Math.floor(i)||64,n=Math.floor(n)||8,r=r||2,a=a||3;var s,o,l=[],c=[],h=[],u=[],d=new Zi,p=new Zi,m=new Zi,f=new Zi,g=new Zi,v=new Zi,y=new Zi;for(s=0;s<=i;++s){var b=s/i*r*Math.PI*2;for(C(b,r,a,e,m),C(b+.01,r,a,e,f),v.subVectors(f,m),y.addVectors(f,m),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),o=0;o<=n;++o){var x=o/n*Math.PI*2,w=-t*Math.cos(x),_=t*Math.sin(x);d.x=m.x+(w*y.x+_*g.x),d.y=m.y+(w*y.y+_*g.y),d.z=m.z+(w*y.z+_*g.z),c.push(d.x,d.y,d.z),p.subVectors(d,m).normalize(),h.push(p.x,p.y,p.z),u.push(s/i),u.push(o/n)}}for(o=1;o<=i;o++)for(s=1;s<=n;s++){var M=(n+1)*(o-1)+(s-1),S=(n+1)*o+(s-1),T=(n+1)*o+s,E=(n+1)*(o-1)+s;l.push(M,S,E),l.push(S,T,E)}function C(e,t,i,n,r){var a=Math.cos(e),s=Math.sin(e),o=i/t*e,l=Math.cos(o);r.x=n*(2+l)*.5*a,r.y=n*(2+l)*s*.5,r.z=n*Math.sin(o)*.5}this.setIndex(l),this.setAttribute("position",new Pr(c,3)),this.setAttribute("normal",new Pr(h,3)),this.setAttribute("uv",new Pr(u,2))}function Jl(e,t,i,n,r){pa.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new Kl(e,t,i,n,r)),this.mergeVertices()}function Kl(e,t,i,n,r){Ur.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},e=e||1,t=t||.4,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var a,s,o=[],l=[],c=[],h=[],u=new Zi,d=new Zi,p=new Zi;for(a=0;a<=i;a++)for(s=0;s<=n;s++){var m=s/n*r,f=a/i*Math.PI*2;d.x=(e+t*Math.cos(f))*Math.cos(m),d.y=(e+t*Math.cos(f))*Math.sin(m),d.z=t*Math.sin(f),l.push(d.x,d.y,d.z),u.x=e*Math.cos(m),u.y=e*Math.sin(m),p.subVectors(d,u).normalize(),c.push(p.x,p.y,p.z),h.push(s/n),h.push(a/i)}for(a=1;a<=i;a++)for(s=1;s<=n;s++){var g=(n+1)*a+s-1,v=(n+1)*(a-1)+s-1,y=(n+1)*(a-1)+s,b=(n+1)*a+s;o.push(g,v,b),o.push(v,y,b)}this.setIndex(o),this.setAttribute("position",new Pr(l,3)),this.setAttribute("normal",new Pr(c,3)),this.setAttribute("uv",new Pr(h,2))}Ll.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Ll,isPoints:!0,raycast:function(e,t){var i=this.geometry,n=this.matrixWorld,r=e.params.Points.threshold;if(null===i.boundingSphere&&i.computeBoundingSphere(),El.copy(i.boundingSphere),El.applyMatrix4(n),El.radius+=r,!1!==e.ray.intersectsSphere(El)){Sl.getInverse(n),Tl.copy(e.ray).applyMatrix4(Sl);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a;if(i.isBufferGeometry){var o=i.index,l=i.attributes.position.array;if(null!==o)for(var c=o.array,h=0,u=c.length;h<u;h++){var d=c[h];Cl.fromArray(l,3*d),Al(Cl,d,s,n,e,t,this)}else{h=0;for(var p=l.length/3;h<p;h++)Cl.fromArray(l,3*h),Al(Cl,h,s,n,e,t,this)}}else{var m=i.vertices;for(h=0,p=m.length;h<p;h++)Al(m[h],h,s,n,e,t,this)}}},updateMorphTargets:function(){var e,t,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,a=Object.keys(r);if(a.length>0){var s=r[a[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)i=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}else{var o=n.morphTargets;void 0!==o&&o.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),kl.prototype=Object.assign(Object.create(ji.prototype),{constructor:kl,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Pl.prototype=Object.create(ji.prototype),Pl.prototype.constructor=Pl,Pl.prototype.isCompressedTexture=!0,Rl.prototype=Object.create(ji.prototype),Rl.prototype.constructor=Rl,Rl.prototype.isCanvasTexture=!0,Ol.prototype=Object.create(ji.prototype),Ol.prototype.constructor=Ol,Ol.prototype.isDepthTexture=!0,Il.prototype=Object.create(Ur.prototype),Il.prototype.constructor=Il,Dl.prototype=Object.create(pa.prototype),Dl.prototype.constructor=Dl,Nl.prototype=Object.create(Ur.prototype),Nl.prototype.constructor=Nl,zl.prototype=Object.create(pa.prototype),zl.prototype.constructor=zl,Fl.prototype=Object.create(Ur.prototype),Fl.prototype.constructor=Fl,Bl.prototype=Object.create(pa.prototype),Bl.prototype.constructor=Bl,Hl.prototype=Object.create(Fl.prototype),Hl.prototype.constructor=Hl,Gl.prototype=Object.create(pa.prototype),Gl.prototype.constructor=Gl,Ul.prototype=Object.create(Fl.prototype),Ul.prototype.constructor=Ul,jl.prototype=Object.create(pa.prototype),jl.prototype.constructor=jl,Vl.prototype=Object.create(Fl.prototype),Vl.prototype.constructor=Vl,Wl.prototype=Object.create(pa.prototype),Wl.prototype.constructor=Wl,ql.prototype=Object.create(Fl.prototype),ql.prototype.constructor=ql,$l.prototype=Object.create(pa.prototype),$l.prototype.constructor=$l,Xl.prototype=Object.create(Ur.prototype),Xl.prototype.constructor=Xl,Xl.prototype.toJSON=function(){var e=Ur.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},Yl.prototype=Object.create(pa.prototype),Yl.prototype.constructor=Yl,Zl.prototype=Object.create(Ur.prototype),Zl.prototype.constructor=Zl,Jl.prototype=Object.create(pa.prototype),Jl.prototype.constructor=Jl,Kl.prototype=Object.create(Ur.prototype),Kl.prototype.constructor=Kl;var Ql=function(e,t,i){i=i||2;var n,r,a,s,o,l,c,h=t&&t.length,u=h?t[0]*i:e.length,d=ec(e,0,u,i,!0),p=[];if(!d||d.next===d.prev)return p;if(h&&(d=function(e,t,i,n){var r,a,s,o,l,c=[];for(r=0,a=t.length;r<a;r++)s=t[r]*n,o=r<a-1?t[r+1]*n:e.length,(l=ec(e,s,o,n,!1))===l.next&&(l.steiner=!0),c.push(hc(l));for(c.sort(oc),r=0;r<c.length;r++)lc(c[r],i),i=tc(i,i.next);return i}(e,t,d,i)),e.length>80*i){n=a=e[0],r=s=e[1];for(var m=i;m<u;m+=i)(o=e[m])<n&&(n=o),(l=e[m+1])<r&&(r=l),o>a&&(a=o),l>s&&(s=l);c=0!==(c=Math.max(a-n,s-r))?1/c:0}return ic(d,p,i,n,r,c),p};function ec(e,t,i,n,r){var a,s;if(r===function(e,t,i,n){for(var r=0,a=t,s=i-n;a<i;a+=n)r+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return r}(e,t,i,n)>0)for(a=t;a<i;a+=n)s=yc(a,e[a],e[a+1],s);else for(a=i-n;a>=t;a-=n)s=yc(a,e[a],e[a+1],s);return s&&mc(s,s.next)&&(bc(s),s=s.next),s}function tc(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!mc(n,n.next)&&0!==pc(n.prev,n,n.next))n=n.next;else{if(bc(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}function ic(e,t,i,n,r,a,s){if(e){!s&&a&&function(e,t,i,n){var r=e;do{null===r.z&&(r.z=cc(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,a,s,o,l,c=1;do{for(i=e,e=null,a=null,s=0;i;){for(s++,n=i,o=0,t=0;t<c&&(o++,n=n.nextZ);t++);for(l=c;o>0||l>0&&n;)0!==o&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,o--):(r=n,n=n.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;i=n}a.nextZ=null,c*=2}while(s>1)}(r)}(e,n,r,a);for(var o,l,c=e;e.prev!==e.next;)if(o=e.prev,l=e.next,a?rc(e,n,r,a):nc(e))t.push(o.i/i),t.push(e.i/i),t.push(l.i/i),bc(e),e=l.next,c=l.next;else if((e=l)===c){s?1===s?ic(e=ac(e,t,i),t,i,n,r,a,2):2===s&&sc(e,t,i,n,r,a):ic(tc(e),t,i,n,r,a,1);break}}}function nc(e){var t=e.prev,i=e,n=e.next;if(pc(t,i,n)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(uc(t.x,t.y,i.x,i.y,n.x,n.y,r.x,r.y)&&pc(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function rc(e,t,i,n){var r=e.prev,a=e,s=e.next;if(pc(r,a,s)>=0)return!1;for(var o=r.x<a.x?r.x<s.x?r.x:s.x:a.x<s.x?a.x:s.x,l=r.y<a.y?r.y<s.y?r.y:s.y:a.y<s.y?a.y:s.y,c=r.x>a.x?r.x>s.x?r.x:s.x:a.x>s.x?a.x:s.x,h=r.y>a.y?r.y>s.y?r.y:s.y:a.y>s.y?a.y:s.y,u=cc(o,l,t,i,n),d=cc(c,h,t,i,n),p=e.prevZ,m=e.nextZ;p&&p.z>=u&&m&&m.z<=d;){if(p!==e.prev&&p!==e.next&&uc(r.x,r.y,a.x,a.y,s.x,s.y,p.x,p.y)&&pc(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,m!==e.prev&&m!==e.next&&uc(r.x,r.y,a.x,a.y,s.x,s.y,m.x,m.y)&&pc(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;p&&p.z>=u;){if(p!==e.prev&&p!==e.next&&uc(r.x,r.y,a.x,a.y,s.x,s.y,p.x,p.y)&&pc(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;m&&m.z<=d;){if(m!==e.prev&&m!==e.next&&uc(r.x,r.y,a.x,a.y,s.x,s.y,m.x,m.y)&&pc(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function ac(e,t,i){var n=e;do{var r=n.prev,a=n.next.next;!mc(r,a)&&fc(r,n,n.next,a)&&gc(r,a)&&gc(a,r)&&(t.push(r.i/i),t.push(n.i/i),t.push(a.i/i),bc(n),bc(n.next),n=e=a),n=n.next}while(n!==e);return n}function sc(e,t,i,n,r,a){var s=e;do{for(var o=s.next.next;o!==s.prev;){if(s.i!==o.i&&dc(s,o)){var l=vc(s,o);return s=tc(s,s.next),l=tc(l,l.next),ic(s,t,i,n,r,a),void ic(l,t,i,n,r,a)}o=o.next}s=s.next}while(s!==e)}function oc(e,t){return e.x-t.x}function lc(e,t){if(t=function(e,t){var i,n=t,r=e.x,a=e.y,s=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var o=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>s){if(s=o,o===r){if(a===n.y)return n;if(a===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!i)return null;if(r===s)return i.prev;var l,c=i,h=i.x,u=i.y,d=1/0;n=i.next;for(;n!==c;)r>=n.x&&n.x>=h&&r!==n.x&&uc(a<u?r:s,a,h,u,a<u?s:r,a,n.x,n.y)&&((l=Math.abs(a-n.y)/(r-n.x))<d||l===d&&n.x>i.x)&&gc(n,e)&&(i=n,d=l),n=n.next;return i}(e,t)){var i=vc(t,e);tc(i,i.next)}}function cc(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function hc(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function uc(e,t,i,n,r,a,s,o){return(r-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(n-o)-(i-s)*(t-o)>=0&&(i-s)*(a-o)-(r-s)*(n-o)>=0}function dc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&fc(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&gc(e,t)&&gc(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)}function pc(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function mc(e,t){return e.x===t.x&&e.y===t.y}function fc(e,t,i,n){return!!(mc(e,i)&&mc(t,n)||mc(e,n)&&mc(i,t))||pc(e,t,i)>0!=pc(e,t,n)>0&&pc(i,n,e)>0!=pc(i,n,t)>0}function gc(e,t){return pc(e.prev,e,e.next)<0?pc(e,t,e.next)>=0&&pc(e,e.prev,t)>=0:pc(e,t,e.prev)<0||pc(e,e.next,t)<0}function vc(e,t){var i=new xc(e.i,e.x,e.y),n=new xc(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function yc(e,t,i,n){var r=new xc(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function bc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function xc(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var wc={area:function(e){for(var t=e.length,i=0,n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return.5*i},isClockWise:function(e){return wc.area(e)<0},triangulateShape:function(e,t){var i=[],n=[],r=[];_c(e),Mc(i,e);var a=e.length;t.forEach(_c);for(var s=0;s<t.length;s++)n.push(a),a+=t[s].length,Mc(i,t[s]);var o=Ql(i,n);for(s=0;s<o.length;s+=3)r.push(o.slice(s,s+3));return r}};function _c(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Mc(e,t){for(var i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}function Sc(e,t){pa.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Tc(e,t)),this.mergeVertices()}function Tc(e,t){Ur.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var i=this,n=[],r=[],a=0,s=e.length;a<s;a++){o(e[a])}function o(e){var a=[],s=void 0!==t.curveSegments?t.curveSegments:12,o=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:100,c=void 0===t.bevelEnabled||t.bevelEnabled,h=void 0!==t.bevelThickness?t.bevelThickness:6,u=void 0!==t.bevelSize?t.bevelSize:h-2,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3,m=t.extrudePath,f=void 0!==t.UVGenerator?t.UVGenerator:Ec;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);var g,v,y,b,x,w,_,M,S=!1;m&&(g=m.getSpacedPoints(o),S=!0,c=!1,v=m.computeFrenetFrames(o,!1),y=new Zi,b=new Zi,x=new Zi),c||(p=0,h=0,u=0,d=0);var T=e.extractPoints(s),E=T.shape,C=T.holes;if(!wc.isClockWise(E))for(E=E.reverse(),_=0,M=C.length;_<M;_++)w=C[_],wc.isClockWise(w)&&(C[_]=w.reverse());var L=wc.triangulateShape(E,C),A=E;for(_=0,M=C.length;_<M;_++)w=C[_],E=E.concat(w);function k(e,t,i){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(i).add(e)}var P,R,O,I,D,N,z=E.length,F=L.length;function B(e,t,i){var n,r,a,s=e.x-t.x,o=e.y-t.y,l=i.x-e.x,c=i.y-e.y,h=s*s+o*o,u=s*c-o*l;if(Math.abs(u)>Number.EPSILON){var d=Math.sqrt(h),p=Math.sqrt(l*l+c*c),m=t.x-o/d,f=t.y+s/d,g=((i.x-c/p-m)*c-(i.y+l/p-f)*l)/(s*c-o*l),v=(n=m+s*g-e.x)*n+(r=f+o*g-e.y)*r;if(v<=2)return new Bi(n,r);a=Math.sqrt(v/2)}else{var y=!1;s>Number.EPSILON?l>Number.EPSILON&&(y=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(o)===Math.sign(c)&&(y=!0),y?(n=-o,r=s,a=Math.sqrt(h)):(n=s,r=o,a=Math.sqrt(h/2))}return new Bi(n/a,r/a)}for(var H=[],G=0,U=A.length,j=U-1,V=G+1;G<U;G++,j++,V++)j===U&&(j=0),V===U&&(V=0),H[G]=B(A[G],A[j],A[V]);var W,q,$=[],X=H.concat();for(_=0,M=C.length;_<M;_++){for(w=C[_],W=[],G=0,j=(U=w.length)-1,V=G+1;G<U;G++,j++,V++)j===U&&(j=0),V===U&&(V=0),W[G]=B(w[G],w[j],w[V]);$.push(W),X=X.concat(W)}for(P=0;P<p;P++){for(O=P/p,I=h*Math.cos(O*Math.PI/2),R=u*Math.sin(O*Math.PI/2)+d,G=0,U=A.length;G<U;G++)Z((D=k(A[G],H[G],R)).x,D.y,-I);for(_=0,M=C.length;_<M;_++)for(w=C[_],W=$[_],G=0,U=w.length;G<U;G++)Z((D=k(w[G],W[G],R)).x,D.y,-I)}for(R=u+d,G=0;G<z;G++)D=c?k(E[G],X[G],R):E[G],S?(b.copy(v.normals[0]).multiplyScalar(D.x),y.copy(v.binormals[0]).multiplyScalar(D.y),x.copy(g[0]).add(b).add(y),Z(x.x,x.y,x.z)):Z(D.x,D.y,0);for(q=1;q<=o;q++)for(G=0;G<z;G++)D=c?k(E[G],X[G],R):E[G],S?(b.copy(v.normals[q]).multiplyScalar(D.x),y.copy(v.binormals[q]).multiplyScalar(D.y),x.copy(g[q]).add(b).add(y),Z(x.x,x.y,x.z)):Z(D.x,D.y,l/o*q);for(P=p-1;P>=0;P--){for(O=P/p,I=h*Math.cos(O*Math.PI/2),R=u*Math.sin(O*Math.PI/2)+d,G=0,U=A.length;G<U;G++)Z((D=k(A[G],H[G],R)).x,D.y,l+I);for(_=0,M=C.length;_<M;_++)for(w=C[_],W=$[_],G=0,U=w.length;G<U;G++)D=k(w[G],W[G],R),S?Z(D.x,D.y+g[o-1].y,g[o-1].x+I):Z(D.x,D.y,l+I)}function Y(e,t){var i,n;for(G=e.length;--G>=0;){i=G,(n=G-1)<0&&(n=e.length-1);var r=0,a=o+2*p;for(r=0;r<a;r++){var s=z*r,l=z*(r+1);K(t+i+s,t+n+s,t+n+l,t+i+l)}}}function Z(e,t,i){a.push(e),a.push(t),a.push(i)}function J(e,t,r){Q(e),Q(t),Q(r);var a=n.length/3,s=f.generateTopUV(i,n,a-3,a-2,a-1);ee(s[0]),ee(s[1]),ee(s[2])}function K(e,t,r,a){Q(e),Q(t),Q(a),Q(t),Q(r),Q(a);var s=n.length/3,o=f.generateSideWallUV(i,n,s-6,s-3,s-2,s-1);ee(o[0]),ee(o[1]),ee(o[3]),ee(o[1]),ee(o[2]),ee(o[3])}function Q(e){n.push(a[3*e+0]),n.push(a[3*e+1]),n.push(a[3*e+2])}function ee(e){r.push(e.x),r.push(e.y)}!function(){var e=n.length/3;if(c){var t=0,r=z*t;for(G=0;G<F;G++)J((N=L[G])[2]+r,N[1]+r,N[0]+r);for(r=z*(t=o+2*p),G=0;G<F;G++)J((N=L[G])[0]+r,N[1]+r,N[2]+r)}else{for(G=0;G<F;G++)J((N=L[G])[2],N[1],N[0]);for(G=0;G<F;G++)J((N=L[G])[0]+z*o,N[1]+z*o,N[2]+z*o)}i.addGroup(e,n.length/3-e,0)}(),function(){var e=n.length/3,t=0;for(Y(A,t),t+=A.length,_=0,M=C.length;_<M;_++)Y(w=C[_],t),t+=w.length;i.addGroup(e,n.length/3-e,1)}()}this.setAttribute("position",new Pr(n,3)),this.setAttribute("uv",new Pr(r,2)),this.computeVertexNormals()}Sc.prototype=Object.create(pa.prototype),Sc.prototype.constructor=Sc,Sc.prototype.toJSON=function(){var e=pa.prototype.toJSON.call(this);return Cc(this.parameters.shapes,this.parameters.options,e)},Tc.prototype=Object.create(Ur.prototype),Tc.prototype.constructor=Tc,Tc.prototype.toJSON=function(){var e=Ur.prototype.toJSON.call(this);return Cc(this.parameters.shapes,this.parameters.options,e)};var Ec={generateTopUV:function(e,t,i,n,r){var a=t[3*i],s=t[3*i+1],o=t[3*n],l=t[3*n+1],c=t[3*r],h=t[3*r+1];return[new Bi(a,s),new Bi(o,l),new Bi(c,h)]},generateSideWallUV:function(e,t,i,n,r,a){var s=t[3*i],o=t[3*i+1],l=t[3*i+2],c=t[3*n],h=t[3*n+1],u=t[3*n+2],d=t[3*r],p=t[3*r+1],m=t[3*r+2],f=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(o-h)<.01?[new Bi(s,1-l),new Bi(c,1-u),new Bi(d,1-m),new Bi(f,1-v)]:[new Bi(o,1-l),new Bi(h,1-u),new Bi(p,1-m),new Bi(g,1-v)]}};function Cc(e,t,i){if(i.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var a=e[n];i.shapes.push(a.uuid)}else i.shapes.push(e.uuid);return void 0!==t.extrudePath&&(i.options.extrudePath=t.extrudePath.toJSON()),i}function Lc(e,t){pa.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Ac(e,t)),this.mergeVertices()}function Ac(e,t){var i=(t=t||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new pa;var n=i.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Tc.call(this,n,t),this.type="TextBufferGeometry"}function kc(e,t,i,n,r,a,s){pa.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Pc(e,t,i,n,r,a,s)),this.mergeVertices()}function Pc(e,t,i,n,r,a,s){Ur.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:s},e=e||1,t=Math.max(3,Math.floor(t)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,a=void 0!==a?a:0,s=void 0!==s?s:Math.PI;var o,l,c=Math.min(a+s,Math.PI),h=0,u=[],d=new Zi,p=new Zi,m=[],f=[],g=[],v=[];for(l=0;l<=i;l++){var y=[],b=l/i,x=0;for(0==l&&0==a?x=.5/t:l==i&&c==Math.PI&&(x=-.5/t),o=0;o<=t;o++){var w=o/t;d.x=-e*Math.cos(n+w*r)*Math.sin(a+b*s),d.y=e*Math.cos(a+b*s),d.z=e*Math.sin(n+w*r)*Math.sin(a+b*s),f.push(d.x,d.y,d.z),p.copy(d).normalize(),g.push(p.x,p.y,p.z),v.push(w+x,1-b),y.push(h++)}u.push(y)}for(l=0;l<i;l++)for(o=0;o<t;o++){var _=u[l][o+1],M=u[l][o],S=u[l+1][o],T=u[l+1][o+1];(0!==l||a>0)&&m.push(_,M,T),(l!==i-1||c<Math.PI)&&m.push(M,S,T)}this.setIndex(m),this.setAttribute("position",new Pr(f,3)),this.setAttribute("normal",new Pr(g,3)),this.setAttribute("uv",new Pr(v,2))}function Rc(e,t,i,n,r,a){pa.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new Oc(e,t,i,n,r,a)),this.mergeVertices()}function Oc(e,t,i,n,r,a){Ur.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},e=e||.5,t=t||1,r=void 0!==r?r:0,a=void 0!==a?a:2*Math.PI,i=void 0!==i?Math.max(3,i):8;var s,o,l,c=[],h=[],u=[],d=[],p=e,m=(t-e)/(n=void 0!==n?Math.max(1,n):1),f=new Zi,g=new Bi;for(o=0;o<=n;o++){for(l=0;l<=i;l++)s=r+l/i*a,f.x=p*Math.cos(s),f.y=p*Math.sin(s),h.push(f.x,f.y,f.z),u.push(0,0,1),g.x=(f.x/t+1)/2,g.y=(f.y/t+1)/2,d.push(g.x,g.y);p+=m}for(o=0;o<n;o++){var v=o*(i+1);for(l=0;l<i;l++){var y=s=l+v,b=s+i+1,x=s+i+2,w=s+1;c.push(y,b,w),c.push(b,x,w)}}this.setIndex(c),this.setAttribute("position",new Pr(h,3)),this.setAttribute("normal",new Pr(u,3)),this.setAttribute("uv",new Pr(d,2))}function Ic(e,t,i,n){pa.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},this.fromBufferGeometry(new Dc(e,t,i,n)),this.mergeVertices()}function Dc(e,t,i,n){Ur.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=Math.floor(t)||12,i=i||0,n=n||2*Math.PI,n=Fi.clamp(n,0,2*Math.PI);var r,a,s,o=[],l=[],c=[],h=1/t,u=new Zi,d=new Bi;for(a=0;a<=t;a++){var p=i+a*h*n,m=Math.sin(p),f=Math.cos(p);for(s=0;s<=e.length-1;s++)u.x=e[s].x*m,u.y=e[s].y,u.z=e[s].x*f,l.push(u.x,u.y,u.z),d.x=a/t,d.y=s/(e.length-1),c.push(d.x,d.y)}for(a=0;a<t;a++)for(s=0;s<e.length-1;s++){var g=r=s+a*e.length,v=r+e.length,y=r+e.length+1,b=r+1;o.push(g,v,b),o.push(v,y,b)}if(this.setIndex(o),this.setAttribute("position",new Pr(l,3)),this.setAttribute("uv",new Pr(c,2)),this.computeVertexNormals(),n===2*Math.PI){var x=this.attributes.normal.array,w=new Zi,_=new Zi,M=new Zi;for(r=t*e.length*3,a=0,s=0;a<e.length;a++,s+=3)w.x=x[s+0],w.y=x[s+1],w.z=x[s+2],_.x=x[r+s+0],_.y=x[r+s+1],_.z=x[r+s+2],M.addVectors(w,_).normalize(),x[s+0]=x[r+s+0]=M.x,x[s+1]=x[r+s+1]=M.y,x[s+2]=x[r+s+2]=M.z}}function Nc(e,t){pa.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new zc(e,t)),this.mergeVertices()}function zc(e,t){Ur.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var i=[],n=[],r=[],a=[],s=0,o=0;if(!1===Array.isArray(e))c(e);else for(var l=0;l<e.length;l++)c(e[l]),this.addGroup(s,o,l),s+=o,o=0;function c(e){var s,l,c,h=n.length/3,u=e.extractPoints(t),d=u.shape,p=u.holes;for(!1===wc.isClockWise(d)&&(d=d.reverse()),s=0,l=p.length;s<l;s++)c=p[s],!0===wc.isClockWise(c)&&(p[s]=c.reverse());var m=wc.triangulateShape(d,p);for(s=0,l=p.length;s<l;s++)c=p[s],d=d.concat(c);for(s=0,l=d.length;s<l;s++){var f=d[s];n.push(f.x,f.y,0),r.push(0,0,1),a.push(f.x,f.y)}for(s=0,l=m.length;s<l;s++){var g=m[s],v=g[0]+h,y=g[1]+h,b=g[2]+h;i.push(v,y,b),o+=3}}this.setIndex(i),this.setAttribute("position",new Pr(n,3)),this.setAttribute("normal",new Pr(r,3)),this.setAttribute("uv",new Pr(a,2))}function Fc(e,t){if(t.shapes=[],Array.isArray(e))for(var i=0,n=e.length;i<n;i++){var r=e[i];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}function Bc(e,t){Ur.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var i,n,r,a,s=[],o=Math.cos(Fi.DEG2RAD*t),l=[0,0],c={},h=["a","b","c"];e.isBufferGeometry?(a=new pa).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var u=a.vertices,d=a.faces,p=0,m=d.length;p<m;p++)for(var f=d[p],g=0;g<3;g++)i=f[h[g]],n=f[h[(g+1)%3]],l[0]=Math.min(i,n),l[1]=Math.max(i,n),void 0===c[r=l[0]+","+l[1]]?c[r]={index1:l[0],index2:l[1],face1:p,face2:void 0}:c[r].face2=p;for(r in c){var v=c[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=o){var y=u[v.index1];s.push(y.x,y.y,y.z),y=u[v.index2],s.push(y.x,y.y,y.z)}}this.setAttribute("position",new Pr(s,3))}function Hc(e,t,i,n,r,a,s,o){pa.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:s,thetaLength:o},this.fromBufferGeometry(new Gc(e,t,i,n,r,a,s,o)),this.mergeVertices()}function Gc(e,t,i,n,r,a,s,o){Ur.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:s,thetaLength:o};var l=this;e=void 0!==e?e:1,t=void 0!==t?t:1,i=i||1,n=Math.floor(n)||8,r=Math.floor(r)||1,a=void 0!==a&&a,s=void 0!==s?s:0,o=void 0!==o?o:2*Math.PI;var c=[],h=[],u=[],d=[],p=0,m=[],f=i/2,g=0;function v(i){var r,a,m,v=new Bi,y=new Zi,b=0,x=!0===i?e:t,w=!0===i?1:-1;for(a=p,r=1;r<=n;r++)h.push(0,f*w,0),u.push(0,w,0),d.push(.5,.5),p++;for(m=p,r=0;r<=n;r++){var _=r/n*o+s,M=Math.cos(_),S=Math.sin(_);y.x=x*S,y.y=f*w,y.z=x*M,h.push(y.x,y.y,y.z),u.push(0,w,0),v.x=.5*M+.5,v.y=.5*S*w+.5,d.push(v.x,v.y),p++}for(r=0;r<n;r++){var T=a+r,E=m+r;!0===i?c.push(E,E+1,T):c.push(E+1,E,T),b+=3}l.addGroup(g,b,!0===i?1:2),g+=b}!function(){var a,v,y=new Zi,b=new Zi,x=0,w=(t-e)/i;for(v=0;v<=r;v++){var _=[],M=v/r,S=M*(t-e)+e;for(a=0;a<=n;a++){var T=a/n,E=T*o+s,C=Math.sin(E),L=Math.cos(E);b.x=S*C,b.y=-M*i+f,b.z=S*L,h.push(b.x,b.y,b.z),y.set(C,w,L).normalize(),u.push(y.x,y.y,y.z),d.push(T,1-M),_.push(p++)}m.push(_)}for(a=0;a<n;a++)for(v=0;v<r;v++){var A=m[v][a],k=m[v+1][a],P=m[v+1][a+1],R=m[v][a+1];c.push(A,k,R),c.push(k,P,R),x+=6}l.addGroup(g,x,0),g+=x}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new Pr(h,3)),this.setAttribute("normal",new Pr(u,3)),this.setAttribute("uv",new Pr(d,2))}function Uc(e,t,i,n,r,a,s){Hc.call(this,0,e,t,i,n,r,a,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:s}}function jc(e,t,i,n,r,a,s){Gc.call(this,0,e,t,i,n,r,a,s),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:s}}function Vc(e,t,i,n){pa.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new Wc(e,t,i,n)),this.mergeVertices()}function Wc(e,t,i,n){Ur.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},e=e||1,t=void 0!==t?Math.max(3,t):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r,a,s=[],o=[],l=[],c=[],h=new Zi,u=new Bi;for(o.push(0,0,0),l.push(0,0,1),c.push(.5,.5),a=0,r=3;a<=t;a++,r+=3){var d=i+a/t*n;h.x=e*Math.cos(d),h.y=e*Math.sin(d),o.push(h.x,h.y,h.z),l.push(0,0,1),u.x=(o[r]/e+1)/2,u.y=(o[r+1]/e+1)/2,c.push(u.x,u.y)}for(r=1;r<=t;r++)s.push(r,r+1,0);this.setIndex(s),this.setAttribute("position",new Pr(o,3)),this.setAttribute("normal",new Pr(l,3)),this.setAttribute("uv",new Pr(c,2))}Lc.prototype=Object.create(pa.prototype),Lc.prototype.constructor=Lc,Ac.prototype=Object.create(Tc.prototype),Ac.prototype.constructor=Ac,kc.prototype=Object.create(pa.prototype),kc.prototype.constructor=kc,Pc.prototype=Object.create(Ur.prototype),Pc.prototype.constructor=Pc,Rc.prototype=Object.create(pa.prototype),Rc.prototype.constructor=Rc,Oc.prototype=Object.create(Ur.prototype),Oc.prototype.constructor=Oc,Ic.prototype=Object.create(pa.prototype),Ic.prototype.constructor=Ic,Dc.prototype=Object.create(Ur.prototype),Dc.prototype.constructor=Dc,Nc.prototype=Object.create(pa.prototype),Nc.prototype.constructor=Nc,Nc.prototype.toJSON=function(){var e=pa.prototype.toJSON.call(this);return Fc(this.parameters.shapes,e)},zc.prototype=Object.create(Ur.prototype),zc.prototype.constructor=zc,zc.prototype.toJSON=function(){var e=Ur.prototype.toJSON.call(this);return Fc(this.parameters.shapes,e)},Bc.prototype=Object.create(Ur.prototype),Bc.prototype.constructor=Bc,Hc.prototype=Object.create(pa.prototype),Hc.prototype.constructor=Hc,Gc.prototype=Object.create(Ur.prototype),Gc.prototype.constructor=Gc,Uc.prototype=Object.create(Hc.prototype),Uc.prototype.constructor=Uc,jc.prototype=Object.create(Gc.prototype),jc.prototype.constructor=jc,Vc.prototype=Object.create(pa.prototype),Vc.prototype.constructor=Vc,Wc.prototype=Object.create(Ur.prototype),Wc.prototype.constructor=Wc;var qc=Object.freeze({__proto__:null,WireframeGeometry:Il,ParametricGeometry:Dl,ParametricBufferGeometry:Nl,TetrahedronGeometry:Bl,TetrahedronBufferGeometry:Hl,OctahedronGeometry:Gl,OctahedronBufferGeometry:Ul,IcosahedronGeometry:jl,IcosahedronBufferGeometry:Vl,DodecahedronGeometry:Wl,DodecahedronBufferGeometry:ql,PolyhedronGeometry:zl,PolyhedronBufferGeometry:Fl,TubeGeometry:$l,TubeBufferGeometry:Xl,TorusKnotGeometry:Yl,TorusKnotBufferGeometry:Zl,TorusGeometry:Jl,TorusBufferGeometry:Kl,TextGeometry:Lc,TextBufferGeometry:Ac,SphereGeometry:kc,SphereBufferGeometry:Pc,RingGeometry:Rc,RingBufferGeometry:Oc,PlaneGeometry:Pa,PlaneBufferGeometry:Ra,LatheGeometry:Ic,LatheBufferGeometry:Dc,ShapeGeometry:Nc,ShapeBufferGeometry:zc,ExtrudeGeometry:Sc,ExtrudeBufferGeometry:Tc,EdgesGeometry:Bc,ConeGeometry:Uc,ConeBufferGeometry:jc,CylinderGeometry:Hc,CylinderBufferGeometry:Gc,CircleGeometry:Vc,CircleBufferGeometry:Wc,BoxGeometry:ma,BoxBufferGeometry:fa});function $c(e){xr.call(this),this.type="ShadowMaterial",this.color=new mr(0),this.transparent=!0,this.setValues(e)}function Xc(e){ba.call(this,e),this.type="RawShaderMaterial"}function Yc(e){xr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new mr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oi,this.normalScale=new Bi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function Zc(e){Yc.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Bi(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(e)}function Jc(e){xr.call(this),this.type="MeshPhongMaterial",this.color=new mr(16777215),this.specular=new mr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oi,this.normalScale=new Bi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Kc(e){xr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new mr(16777215),this.specular=new mr(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oi,this.normalScale=new Bi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Qc(e){xr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oi,this.normalScale=new Bi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function eh(e){xr.call(this),this.type="MeshLambertMaterial",this.color=new mr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function th(e){xr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new mr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oi,this.normalScale=new Bi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ih(e){dl.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}$c.prototype=Object.create(xr.prototype),$c.prototype.constructor=$c,$c.prototype.isShadowMaterial=!0,$c.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this},Xc.prototype=Object.create(ba.prototype),Xc.prototype.constructor=Xc,Xc.prototype.isRawShaderMaterial=!0,Yc.prototype=Object.create(xr.prototype),Yc.prototype.constructor=Yc,Yc.prototype.isMeshStandardMaterial=!0,Yc.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},Zc.prototype=Object.create(Yc.prototype),Zc.prototype.constructor=Zc,Zc.prototype.isMeshPhysicalMaterial=!0,Zc.prototype.copy=function(e){return Yc.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new mr).copy(e.sheen):this.sheen=null,this.transparency=e.transparency,this},Jc.prototype=Object.create(xr.prototype),Jc.prototype.constructor=Jc,Jc.prototype.isMeshPhongMaterial=!0,Jc.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Kc.prototype=Object.create(xr.prototype),Kc.prototype.constructor=Kc,Kc.prototype.isMeshToonMaterial=!0,Kc.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Qc.prototype=Object.create(xr.prototype),Qc.prototype.constructor=Qc,Qc.prototype.isMeshNormalMaterial=!0,Qc.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},eh.prototype=Object.create(xr.prototype),eh.prototype.constructor=eh,eh.prototype.isMeshLambertMaterial=!0,eh.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},th.prototype=Object.create(xr.prototype),th.prototype.constructor=th,th.prototype.isMeshMatcapMaterial=!0,th.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ih.prototype=Object.create(dl.prototype),ih.prototype.constructor=ih,ih.prototype.isLineDashedMaterial=!0,ih.prototype.copy=function(e){return dl.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var nh=Object.freeze({__proto__:null,ShadowMaterial:$c,SpriteMaterial:Fo,RawShaderMaterial:Xc,ShaderMaterial:ba,PointsMaterial:Ml,MeshPhysicalMaterial:Zc,MeshStandardMaterial:Yc,MeshPhongMaterial:Jc,MeshToonMaterial:Kc,MeshNormalMaterial:Qc,MeshLambertMaterial:eh,MeshDepthMaterial:_o,MeshDistanceMaterial:Mo,MeshBasicMaterial:wr,MeshMatcapMaterial:th,LineDashedMaterial:ih,LineBasicMaterial:dl,Material:xr}),rh={arraySlice:function(e,t,i){return rh.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==i?i:e.length)):e.slice(t,i)},convertArray:function(e,t,i){return!e||!i&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,i=new Array(t),n=0;n!==t;++n)i[n]=n;return i.sort((function(t,i){return e[t]-e[i]})),i},sortedArray:function(e,t,i){for(var n=e.length,r=new e.constructor(n),a=0,s=0;s!==n;++a)for(var o=i[a]*t,l=0;l!==t;++l)r[s++]=e[o+l];return r},flattenJSON:function(e,t,i,n){for(var r=1,a=e[0];void 0!==a&&void 0===a[n];)a=e[r++];if(void 0!==a){var s=a[n];if(void 0!==s)if(Array.isArray(s))do{void 0!==(s=a[n])&&(t.push(a.time),i.push.apply(i,s)),a=e[r++]}while(void 0!==a);else if(void 0!==s.toArray)do{void 0!==(s=a[n])&&(t.push(a.time),s.toArray(i,i.length)),a=e[r++]}while(void 0!==a);else do{void 0!==(s=a[n])&&(t.push(a.time),i.push(s)),a=e[r++]}while(void 0!==a)}},subclip:function(e,t,i,n,r){r=r||30;var a=e.clone();a.name=t;for(var s=[],o=0;o<a.tracks.length;++o){for(var l=a.tracks[o],c=l.getValueSize(),h=[],u=[],d=0;d<l.times.length;++d){var p=l.times[d]*r;if(!(p<i||p>=n)){h.push(l.times[d]);for(var m=0;m<c;++m)u.push(l.values[d*c+m])}}0!==h.length&&(l.times=rh.convertArray(h,l.times.constructor),l.values=rh.convertArray(u,l.values.constructor),s.push(l))}a.tracks=s;var f=1/0;for(o=0;o<a.tracks.length;++o)f>a.tracks[o].times[0]&&(f=a.tracks[o].times[0]);for(o=0;o<a.tracks.length;++o)a.tracks[o].shift(-1*f);return a.resetDuration(),a}};function ah(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i}function sh(e,t,i,n){ah.call(this,e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function oh(e,t,i,n){ah.call(this,e,t,i,n)}function lh(e,t,i,n){ah.call(this,e,t,i,n)}function ch(e,t,i,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=rh.convertArray(t,this.TimeBufferType),this.values=rh.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function hh(e,t,i){ch.call(this,e,t,i)}function uh(e,t,i,n){ch.call(this,e,t,i,n)}function dh(e,t,i,n){ch.call(this,e,t,i,n)}function ph(e,t,i,n){ah.call(this,e,t,i,n)}function mh(e,t,i,n){ch.call(this,e,t,i,n)}function fh(e,t,i,n){ch.call(this,e,t,i,n)}function gh(e,t,i,n){ch.call(this,e,t,i,n)}function vh(e,t,i){this.name=e,this.tracks=i,this.duration=void 0!==t?t:-1,this.uuid=Fi.generateUUID(),this.duration<0&&this.resetDuration()}function yh(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return dh;case"vector":case"vector2":case"vector3":case"vector4":return gh;case"color":return uh;case"quaternion":return mh;case"bool":case"boolean":return hh;case"string":return fh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var i=[],n=[];rh.flattenJSON(e.keys,i,n,"value"),e.times=i,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(ah.prototype,{evaluate:function(e){var t=this.parameterPositions,i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{var a;i:{n:if(!(e<n)){for(var s=i+2;;){if(void 0===n){if(e<r)break n;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,r)}if(i===s)break;if(r=n,e<(n=t[++i]))break t}a=t.length;break i}if(e>=r)break e;var o=t[1];e<o&&(i=2,r=o);for(s=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(i===s)break;if(n=r,e>=(r=t[--i-1]))break t}a=i,i=0}for(;i<a;){var l=i+a>>>1;e<t[l]?a=l:i=l+1}if(n=t[i],void 0===(r=t[i-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,r,e)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n,a=0;a!==n;++a)t[a]=i[r+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(ah.prototype,{beforeStart_:ah.prototype.copySampleValue_,afterEnd_:ah.prototype.copySampleValue_}),sh.prototype=Object.assign(Object.create(ah.prototype),{constructor:sh,DefaultSettings_:{endingStart:Wt,endingEnd:Wt},intervalChanged_:function(e,t,i){var n=this.parameterPositions,r=e-2,a=e+1,s=n[r],o=n[a];if(void 0===s)switch(this.getSettings_().endingStart){case qt:r=e,s=2*t-i;break;case $t:s=t+n[r=n.length-2]-n[r+1];break;default:r=e,s=i}if(void 0===o)switch(this.getSettings_().endingEnd){case qt:a=e,o=2*i-t;break;case $t:a=1,o=i+n[1]-n[0];break;default:a=e-1,o=t}var l=.5*(i-t),c=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(o-i),this._offsetPrev=r*c,this._offsetNext=a*c},interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-t)/(n-t),m=p*p,f=m*p,g=-u*f+2*u*m-u*p,v=(1+u)*f+(-1.5-2*u)*m+(-.5+u)*p+1,y=(-1-d)*f+(1.5+d)*m+.5*p,b=d*f-d*m,x=0;x!==s;++x)r[x]=g*a[c+x]+v*a[l+x]+y*a[o+x]+b*a[h+x];return r}}),oh.prototype=Object.assign(Object.create(ah.prototype),{constructor:oh,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=(i-t)/(n-t),h=1-c,u=0;u!==s;++u)r[u]=a[l+u]*h+a[o+u]*c;return r}}),lh.prototype=Object.assign(Object.create(ah.prototype),{constructor:lh,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(ch,{toJSON:function(e){var t,i=e.constructor;if(void 0!==i.toJSON)t=i.toJSON(e);else{t={name:e.name,times:rh.convertArray(e.times,Array),values:rh.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t}}),Object.assign(ch.prototype,{constructor:ch,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:jt,InterpolantFactoryMethodDiscrete:function(e){return new lh(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new oh(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new sh(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case Ut:t=this.InterpolantFactoryMethodDiscrete;break;case jt:t=this.InterpolantFactoryMethodLinear;break;case Vt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ut;case this.InterpolantFactoryMethodLinear:return jt;case this.InterpolantFactoryMethodSmooth:return Vt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]*=e;return this},trim:function(e,t){for(var i=this.times,n=i.length,r=0,a=n-1;r!==n&&i[r]<e;)++r;for(;-1!==a&&i[a]>t;)--a;if(++a,0!==r||a!==n){r>=a&&(r=(a=Math.max(a,1))-1);var s=this.getValueSize();this.times=rh.arraySlice(i,r,a),this.values=rh.arraySlice(this.values,r*s,a*s)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,s=0;s!==r;s++){var o=i[s];if("number"==typeof o&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,o),e=!1;break}if(null!==a&&a>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,o,a),e=!1;break}a=o}if(void 0!==n&&rh.isTypedArray(n)){s=0;for(var l=n.length;s!==l;++s){var c=n[s];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,c),e=!1;break}}}return e},optimize:function(){for(var e=rh.arraySlice(this.times),t=rh.arraySlice(this.values),i=this.getValueSize(),n=this.getInterpolation()===Vt,r=1,a=e.length-1,s=1;s<a;++s){var o=!1,l=e[s];if(l!==e[s+1]&&(1!==s||l!==l[0]))if(n)o=!0;else for(var c=s*i,h=c-i,u=c+i,d=0;d!==i;++d){var p=t[c+d];if(p!==t[h+d]||p!==t[u+d]){o=!0;break}}if(o){if(s!==r){e[r]=e[s];var m=s*i,f=r*i;for(d=0;d!==i;++d)t[f+d]=t[m+d]}++r}}if(a>0){e[r]=e[a];for(m=a*i,f=r*i,d=0;d!==i;++d)t[f+d]=t[m+d];++r}return r!==e.length?(this.times=rh.arraySlice(e,0,r),this.values=rh.arraySlice(t,0,r*i)):(this.times=e,this.values=t),this},clone:function(){var e=rh.arraySlice(this.times,0),t=rh.arraySlice(this.values,0),i=new(0,this.constructor)(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}),hh.prototype=Object.assign(Object.create(ch.prototype),{constructor:hh,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ut,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),uh.prototype=Object.assign(Object.create(ch.prototype),{constructor:uh,ValueTypeName:"color"}),dh.prototype=Object.assign(Object.create(ch.prototype),{constructor:dh,ValueTypeName:"number"}),ph.prototype=Object.assign(Object.create(ah.prototype),{constructor:ph,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=(i-t)/(n-t),c=o+s;o!==c;o+=4)$i.slerpFlat(r,0,a,o-s,a,o,l);return r}}),mh.prototype=Object.assign(Object.create(ch.prototype),{constructor:mh,ValueTypeName:"quaternion",DefaultInterpolation:jt,InterpolantFactoryMethodLinear:function(e){return new ph(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),fh.prototype=Object.assign(Object.create(ch.prototype),{constructor:fh,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ut,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),gh.prototype=Object.assign(Object.create(ch.prototype),{constructor:gh,ValueTypeName:"vector"}),Object.assign(vh,{parse:function(e){for(var t=[],i=e.tracks,n=1/(e.fps||1),r=0,a=i.length;r!==a;++r)t.push(yh(i[r]).scale(n));return new vh(e.name,e.duration,t)},toJSON:function(e){for(var t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},r=0,a=i.length;r!==a;++r)t.push(ch.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(e,t,i,n){for(var r=t.length,a=[],s=0;s<r;s++){var o=[],l=[];o.push((s+r-1)%r,s,(s+1)%r),l.push(0,1,0);var c=rh.getKeyframeOrder(o);o=rh.sortedArray(o,1,c),l=rh.sortedArray(l,1,c),n||0!==o[0]||(o.push(r),l.push(l[0])),a.push(new dh(".morphTargetInfluences["+t[s].name+"]",o,l).scale(1/i))}return new vh(e,-1,a)},findByName:function(e,t){var i=e;if(!Array.isArray(e)){var n=e;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,a=0,s=e.length;a<s;a++){var o=e[a],l=o.name.match(r);if(l&&l.length>1){var c=n[u=l[1]];c||(n[u]=c=[]),c.push(o)}}var h=[];for(var u in n)h.push(vh.CreateFromMorphTargetSequence(u,n[u],t,i));return h},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i=function(e,t,i,n,r){if(0!==i.length){var a=[],s=[];rh.flattenJSON(i,a,s,n),0!==a.length&&r.push(new e(t,a,s))}},n=[],r=e.name||"default",a=e.length||-1,s=e.fps||30,o=e.hierarchy||[],l=0;l<o.length;l++){var c=o[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var h={},u=0;u<c.length;u++)if(c[u].morphTargets)for(var d=0;d<c[u].morphTargets.length;d++)h[c[u].morphTargets[d]]=-1;for(var p in h){var m=[],f=[];for(d=0;d!==c[u].morphTargets.length;++d){var g=c[u];m.push(g.time),f.push(g.morphTarget===p?1:0)}n.push(new dh(".morphTargetInfluence["+p+"]",m,f))}a=h.length*(s||1)}else{var v=".bones["+t[l].name+"]";i(gh,v+".position",c,"pos",n),i(mh,v+".quaternion",c,"rot",n),i(gh,v+".scale",c,"scl",n)}}return 0===n.length?null:new vh(r,a,n)}}),Object.assign(vh.prototype,{resetDuration:function(){for(var e=0,t=0,i=this.tracks.length;t!==i;++t){var n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new vh(this.name,this.duration,e)}});var bh={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function xh(e,t,i){var n=this,r=!1,a=0,s=0,o=void 0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){s++,!1===r&&void 0!==n.onStart&&n.onStart(e,a,s),r=!0},this.itemEnd=function(e){a++,void 0!==n.onProgress&&n.onProgress(e,a,s),a===s&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return o?o(e):e},this.setURLModifier=function(e){return o=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){var t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(var t=0,i=l.length;t<i;t+=2){var n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}var wh=new xh;function _h(e){this.manager=void 0!==e?e:wh,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(_h.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var Mh={};function Sh(e){_h.call(this,e)}function Th(e){_h.call(this,e)}function Eh(e){_h.call(this,e)}function Ch(e){_h.call(this,e)}function Lh(e){_h.call(this,e)}function Ah(e){_h.call(this,e)}function kh(e){_h.call(this,e)}function Ph(){this.type="Curve",this.arcLengthDivisions=200}function Rh(e,t,i,n,r,a,s,o){Ph.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=i||1,this.yRadius=n||1,this.aStartAngle=r||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=s||!1,this.aRotation=o||0}function Oh(e,t,i,n,r,a){Rh.call(this,e,t,i,i,n,r,a),this.type="ArcCurve"}function Ih(){var e=0,t=0,i=0,n=0;function r(r,a,s,o){e=r,t=s,i=-3*r+3*a-2*s-o,n=2*r-2*a+s+o}return{initCatmullRom:function(e,t,i,n,a){r(t,i,a*(i-e),a*(n-t))},initNonuniformCatmullRom:function(e,t,i,n,a,s,o){var l=(t-e)/a-(i-e)/(a+s)+(i-t)/s,c=(i-t)/s-(n-t)/(s+o)+(n-i)/o;r(t,i,l*=s,c*=s)},calc:function(r){var a=r*r;return e+t*r+i*a+n*(a*r)}}}Sh.prototype=Object.assign(Object.create(_h.prototype),{constructor:Sh,load:function(e,t,i,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=bh.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout((function(){t&&t(a),r.manager.itemEnd(e)}),0),a;if(void 0===Mh[e]){var s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var o=s[1],l=!!s[2],c=s[3];c=decodeURIComponent(c),l&&(c=atob(c));try{var h,u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":for(var d=new Uint8Array(c.length),p=0;p<c.length;p++)d[p]=c.charCodeAt(p);h="blob"===u?new Blob([d.buffer],{type:o}):d.buffer;break;case"document":var m=new DOMParser;h=m.parseFromString(c,o);break;case"json":h=JSON.parse(c);break;default:h=c}setTimeout((function(){t&&t(h),r.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)}),0)}}else{Mh[e]=[],Mh[e].push({onLoad:t,onProgress:i,onError:n});var f=new XMLHttpRequest;for(var g in f.open("GET",e,!0),f.addEventListener("load",(function(t){var i=this.response,n=Mh[e];if(delete Mh[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),bh.add(e,i);for(var a=0,s=n.length;a<s;a++){(o=n[a]).onLoad&&o.onLoad(i)}r.manager.itemEnd(e)}else{for(a=0,s=n.length;a<s;a++){var o;(o=n[a]).onError&&o.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}}),!1),f.addEventListener("progress",(function(t){for(var i=Mh[e],n=0,r=i.length;n<r;n++){var a=i[n];a.onProgress&&a.onProgress(t)}}),!1),f.addEventListener("error",(function(t){var i=Mh[e];delete Mh[e];for(var n=0,a=i.length;n<a;n++){var s=i[n];s.onError&&s.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),f.addEventListener("abort",(function(t){var i=Mh[e];delete Mh[e];for(var n=0,a=i.length;n<a;n++){var s=i[n];s.onError&&s.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(f.responseType=this.responseType),void 0!==this.withCredentials&&(f.withCredentials=this.withCredentials),f.overrideMimeType&&f.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)f.setRequestHeader(g,this.requestHeader[g]);f.send(null)}return r.manager.itemStart(e),f}Mh[e].push({onLoad:t,onProgress:i,onError:n})},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Th.prototype=Object.assign(Object.create(_h.prototype),{constructor:Th,load:function(e,t,i,n){var r=this,a=new Sh(r.manager);a.setPath(r.path),a.load(e,(function(e){t(r.parse(JSON.parse(e)))}),i,n)},parse:function(e){for(var t=[],i=0;i<e.length;i++){var n=vh.parse(e[i]);t.push(n)}return t}}),Eh.prototype=Object.assign(Object.create(_h.prototype),{constructor:Eh,load:function(e,t,i,n){var r=this,a=[],s=new Pl;s.image=a;var o=new Sh(this.manager);function l(l){o.load(e[l],(function(e){var i=r.parse(e,!0);a[l]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},6===(c+=1)&&(1===i.mipmapCount&&(s.minFilter=_e),s.format=i.format,s.needsUpdate=!0,t&&t(s))}),i,n)}if(o.setPath(this.path),o.setResponseType("arraybuffer"),Array.isArray(e))for(var c=0,h=0,u=e.length;h<u;++h)l(h);else o.load(e,(function(e){var i=r.parse(e,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,o=0;o<n;o++){a[o]={mipmaps:[]};for(var l=0;l<i.mipmapCount;l++)a[o].mipmaps.push(i.mipmaps[o*i.mipmapCount+l]),a[o].format=i.format,a[o].width=i.width,a[o].height=i.height}else s.image.width=i.width,s.image.height=i.height,s.mipmaps=i.mipmaps;1===i.mipmapCount&&(s.minFilter=_e),s.format=i.format,s.needsUpdate=!0,t&&t(s)}),i,n);return s}}),Ch.prototype=Object.assign(Object.create(_h.prototype),{constructor:Ch,load:function(e,t,i,n){var r=this,a=new Sa,s=new Sh(this.manager);return s.setResponseType("arraybuffer"),s.setPath(this.path),s.load(e,(function(e){var i=r.parse(e);i&&(void 0!==i.image?a.image=i.image:void 0!==i.data&&(a.image.width=i.width,a.image.height=i.height,a.image.data=i.data),a.wrapS=void 0!==i.wrapS?i.wrapS:fe,a.wrapT=void 0!==i.wrapT?i.wrapT:fe,a.magFilter=void 0!==i.magFilter?i.magFilter:_e,a.minFilter=void 0!==i.minFilter?i.minFilter:_e,a.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(a.format=i.format),void 0!==i.type&&(a.type=i.type),void 0!==i.mipmaps&&(a.mipmaps=i.mipmaps,a.minFilter=Te),1===i.mipmapCount&&(a.minFilter=_e),a.needsUpdate=!0,t&&t(a,i))}),i,n),a}}),Lh.prototype=Object.assign(Object.create(_h.prototype),{constructor:Lh,load:function(e,t,i,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=bh.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout((function(){t&&t(a),r.manager.itemEnd(e)}),0),a;var s=document.createElementNS("http://www.w3.org/1999/xhtml","img");function o(){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1),bh.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1),n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)}return s.addEventListener("load",o,!1),s.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),r.manager.itemStart(e),s.src=e,s}}),Ah.prototype=Object.assign(Object.create(_h.prototype),{constructor:Ah,load:function(e,t,i,n){var r=new qa,a=new Lh(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var s=0;function o(i){a.load(e[i],(function(e){r.images[i]=e,6===++s&&(r.needsUpdate=!0,t&&t(r))}),void 0,n)}for(var l=0;l<e.length;++l)o(l);return r}}),kh.prototype=Object.assign(Object.create(_h.prototype),{constructor:kh,load:function(e,t,i,n){var r=new ji,a=new Lh(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(i){r.image=i;var n=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);r.format=n?He:Ge,r.needsUpdate=!0,void 0!==t&&t(r)}),i,n),r}}),Object.assign(Ph.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var i=this.getUtoTmapping(e);return this.getPoint(i,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,i,n=[],r=this.getPoint(0),a=0;for(n.push(0),i=1;i<=e;i++)a+=(t=this.getPoint(i/e)).distanceTo(r),n.push(a),r=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var i,n=this.getLengths(),r=0,a=n.length;i=t||e*n[a-1];for(var s,o=0,l=a-1;o<=l;)if((s=n[r=Math.floor(o+(l-o)/2)]-i)<0)o=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(n[r=l]===i)return r/(a-1);var c=n[r];return(r+(i-c)/(n[r+1]-c))/(a-1)},getTangent:function(e){var t=e-1e-4,i=e+1e-4;t<0&&(t=0),i>1&&(i=1);var n=this.getPoint(t);return this.getPoint(i).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var i,n,r,a=new Zi,s=[],o=[],l=[],c=new Zi,h=new an;for(i=0;i<=e;i++)n=i/e,s[i]=this.getTangentAt(n),s[i].normalize();o[0]=new Zi,l[0]=new Zi;var u=Number.MAX_VALUE,d=Math.abs(s[0].x),p=Math.abs(s[0].y),m=Math.abs(s[0].z);for(d<=u&&(u=d,a.set(1,0,0)),p<=u&&(u=p,a.set(0,1,0)),m<=u&&a.set(0,0,1),c.crossVectors(s[0],a).normalize(),o[0].crossVectors(s[0],c),l[0].crossVectors(s[0],o[0]),i=1;i<=e;i++)o[i]=o[i-1].clone(),l[i]=l[i-1].clone(),c.crossVectors(s[i-1],s[i]),c.length()>Number.EPSILON&&(c.normalize(),r=Math.acos(Fi.clamp(s[i-1].dot(s[i]),-1,1)),o[i].applyMatrix4(h.makeRotationAxis(c,r))),l[i].crossVectors(s[i],o[i]);if(!0===t)for(r=Math.acos(Fi.clamp(o[0].dot(o[e]),-1,1)),r/=e,s[0].dot(c.crossVectors(o[0],o[e]))>0&&(r=-r),i=1;i<=e;i++)o[i].applyMatrix4(h.makeRotationAxis(s[i],r*i)),l[i].crossVectors(s[i],o[i]);return{tangents:s,normals:o,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),Rh.prototype=Object.create(Ph.prototype),Rh.prototype.constructor=Rh,Rh.prototype.isEllipseCurve=!0,Rh.prototype.getPoint=function(e,t){for(var i=t||new Bi,n=2*Math.PI,r=this.aEndAngle-this.aStartAngle,a=Math.abs(r)<Number.EPSILON;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=a?0:n),!0!==this.aClockwise||a||(r===n?r=-n:r-=n);var s=this.aStartAngle+e*r,o=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){var c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=o-this.aX,d=l-this.aY;o=u*c-d*h+this.aX,l=u*h+d*c+this.aY}return i.set(o,l)},Rh.prototype.copy=function(e){return Ph.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Rh.prototype.toJSON=function(){var e=Ph.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Rh.prototype.fromJSON=function(e){return Ph.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Oh.prototype=Object.create(Rh.prototype),Oh.prototype.constructor=Oh,Oh.prototype.isArcCurve=!0;var Dh=new Zi,Nh=new Ih,zh=new Ih,Fh=new Ih;function Bh(e,t,i,n){Ph.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=i||"centripetal",this.tension=n||.5}function Hh(e,t,i,n,r){var a=.5*(n-t),s=.5*(r-i),o=e*e;return(2*i-2*n+a+s)*(e*o)+(-3*i+3*n-2*a-s)*o+a*e+i}function Gh(e,t,i,n){return function(e,t){var i=1-e;return i*i*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,i)+function(e,t){return e*e*t}(e,n)}function Uh(e,t,i,n,r){return function(e,t){var i=1-e;return i*i*i*t}(e,t)+function(e,t){var i=1-e;return 3*i*i*e*t}(e,i)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,r)}function jh(e,t,i,n){Ph.call(this),this.type="CubicBezierCurve",this.v0=e||new Bi,this.v1=t||new Bi,this.v2=i||new Bi,this.v3=n||new Bi}function Vh(e,t,i,n){Ph.call(this),this.type="CubicBezierCurve3",this.v0=e||new Zi,this.v1=t||new Zi,this.v2=i||new Zi,this.v3=n||new Zi}function Wh(e,t){Ph.call(this),this.type="LineCurve",this.v1=e||new Bi,this.v2=t||new Bi}function qh(e,t){Ph.call(this),this.type="LineCurve3",this.v1=e||new Zi,this.v2=t||new Zi}function $h(e,t,i){Ph.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Bi,this.v1=t||new Bi,this.v2=i||new Bi}function Xh(e,t,i){Ph.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Zi,this.v1=t||new Zi,this.v2=i||new Zi}function Yh(e){Ph.call(this),this.type="SplineCurve",this.points=e||[]}Bh.prototype=Object.create(Ph.prototype),Bh.prototype.constructor=Bh,Bh.prototype.isCatmullRomCurve3=!0,Bh.prototype.getPoint=function(e,t){var i,n,r,a,s=t||new Zi,o=this.points,l=o.length,c=(l-(this.closed?0:1))*e,h=Math.floor(c),u=c-h;if(this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/l)+1)*l:0===u&&h===l-1&&(h=l-2,u=1),this.closed||h>0?i=o[(h-1)%l]:(Dh.subVectors(o[0],o[1]).add(o[0]),i=Dh),n=o[h%l],r=o[(h+1)%l],this.closed||h+2<l?a=o[(h+2)%l]:(Dh.subVectors(o[l-1],o[l-2]).add(o[l-1]),a=Dh),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(i.distanceToSquared(n),d),m=Math.pow(n.distanceToSquared(r),d),f=Math.pow(r.distanceToSquared(a),d);m<1e-4&&(m=1),p<1e-4&&(p=m),f<1e-4&&(f=m),Nh.initNonuniformCatmullRom(i.x,n.x,r.x,a.x,p,m,f),zh.initNonuniformCatmullRom(i.y,n.y,r.y,a.y,p,m,f),Fh.initNonuniformCatmullRom(i.z,n.z,r.z,a.z,p,m,f)}else"catmullrom"===this.curveType&&(Nh.initCatmullRom(i.x,n.x,r.x,a.x,this.tension),zh.initCatmullRom(i.y,n.y,r.y,a.y,this.tension),Fh.initCatmullRom(i.z,n.z,r.z,a.z,this.tension));return s.set(Nh.calc(u),zh.calc(u),Fh.calc(u)),s},Bh.prototype.copy=function(e){Ph.prototype.copy.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Bh.prototype.toJSON=function(){var e=Ph.prototype.toJSON.call(this);e.points=[];for(var t=0,i=this.points.length;t<i;t++){var n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Bh.prototype.fromJSON=function(e){Ph.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var n=e.points[t];this.points.push((new Zi).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},jh.prototype=Object.create(Ph.prototype),jh.prototype.constructor=jh,jh.prototype.isCubicBezierCurve=!0,jh.prototype.getPoint=function(e,t){var i=t||new Bi,n=this.v0,r=this.v1,a=this.v2,s=this.v3;return i.set(Uh(e,n.x,r.x,a.x,s.x),Uh(e,n.y,r.y,a.y,s.y)),i},jh.prototype.copy=function(e){return Ph.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},jh.prototype.toJSON=function(){var e=Ph.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},jh.prototype.fromJSON=function(e){return Ph.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Vh.prototype=Object.create(Ph.prototype),Vh.prototype.constructor=Vh,Vh.prototype.isCubicBezierCurve3=!0,Vh.prototype.getPoint=function(e,t){var i=t||new Zi,n=this.v0,r=this.v1,a=this.v2,s=this.v3;return i.set(Uh(e,n.x,r.x,a.x,s.x),Uh(e,n.y,r.y,a.y,s.y),Uh(e,n.z,r.z,a.z,s.z)),i},Vh.prototype.copy=function(e){return Ph.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Vh.prototype.toJSON=function(){var e=Ph.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Vh.prototype.fromJSON=function(e){return Ph.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Wh.prototype=Object.create(Ph.prototype),Wh.prototype.constructor=Wh,Wh.prototype.isLineCurve=!0,Wh.prototype.getPoint=function(e,t){var i=t||new Bi;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i},Wh.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Wh.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Wh.prototype.copy=function(e){return Ph.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Wh.prototype.toJSON=function(){var e=Ph.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Wh.prototype.fromJSON=function(e){return Ph.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},qh.prototype=Object.create(Ph.prototype),qh.prototype.constructor=qh,qh.prototype.isLineCurve3=!0,qh.prototype.getPoint=function(e,t){var i=t||new Zi;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i},qh.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},qh.prototype.copy=function(e){return Ph.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},qh.prototype.toJSON=function(){var e=Ph.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},qh.prototype.fromJSON=function(e){return Ph.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},$h.prototype=Object.create(Ph.prototype),$h.prototype.constructor=$h,$h.prototype.isQuadraticBezierCurve=!0,$h.prototype.getPoint=function(e,t){var i=t||new Bi,n=this.v0,r=this.v1,a=this.v2;return i.set(Gh(e,n.x,r.x,a.x),Gh(e,n.y,r.y,a.y)),i},$h.prototype.copy=function(e){return Ph.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},$h.prototype.toJSON=function(){var e=Ph.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},$h.prototype.fromJSON=function(e){return Ph.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Xh.prototype=Object.create(Ph.prototype),Xh.prototype.constructor=Xh,Xh.prototype.isQuadraticBezierCurve3=!0,Xh.prototype.getPoint=function(e,t){var i=t||new Zi,n=this.v0,r=this.v1,a=this.v2;return i.set(Gh(e,n.x,r.x,a.x),Gh(e,n.y,r.y,a.y),Gh(e,n.z,r.z,a.z)),i},Xh.prototype.copy=function(e){return Ph.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Xh.prototype.toJSON=function(){var e=Ph.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Xh.prototype.fromJSON=function(e){return Ph.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Yh.prototype=Object.create(Ph.prototype),Yh.prototype.constructor=Yh,Yh.prototype.isSplineCurve=!0,Yh.prototype.getPoint=function(e,t){var i=t||new Bi,n=this.points,r=(n.length-1)*e,a=Math.floor(r),s=r-a,o=n[0===a?a:a-1],l=n[a],c=n[a>n.length-2?n.length-1:a+1],h=n[a>n.length-3?n.length-1:a+2];return i.set(Hh(s,o.x,l.x,c.x,h.x),Hh(s,o.y,l.y,c.y,h.y)),i},Yh.prototype.copy=function(e){Ph.prototype.copy.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var n=e.points[t];this.points.push(n.clone())}return this},Yh.prototype.toJSON=function(){var e=Ph.prototype.toJSON.call(this);e.points=[];for(var t=0,i=this.points.length;t<i;t++){var n=this.points[t];e.points.push(n.toArray())}return e},Yh.prototype.fromJSON=function(e){Ph.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var n=e.points[t];this.points.push((new Bi).fromArray(n))}return this};var Zh=Object.freeze({__proto__:null,ArcCurve:Oh,CatmullRomCurve3:Bh,CubicBezierCurve:jh,CubicBezierCurve3:Vh,EllipseCurve:Rh,LineCurve:Wh,LineCurve3:qh,QuadraticBezierCurve:$h,QuadraticBezierCurve3:Xh,SplineCurve:Yh});function Jh(){Ph.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Kh(e){Jh.call(this),this.type="Path",this.currentPoint=new Bi,e&&this.setFromPoints(e)}function Qh(e){Kh.call(this,e),this.uuid=Fi.generateUUID(),this.type="Shape",this.holes=[]}function eu(e,t){Mn.call(this),this.type="Light",this.color=new mr(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function tu(e,t,i){eu.call(this,e,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Mn.DefaultUp),this.updateMatrix(),this.groundColor=new mr(t)}function iu(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Bi(512,512),this.map=null,this.mapPass=null,this.matrix=new an,this._frustum=new Ca,this._frameExtents=new Bi(1,1),this._viewportCount=1,this._viewports=[new Vi(0,0,1,1)]}function nu(){iu.call(this,new wa(50,1,.5,500))}function ru(e,t,i,n,r,a){eu.call(this,e,t),this.type="SpotLight",this.position.copy(Mn.DefaultUp),this.updateMatrix(),this.target=new Mn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new nu}function au(){iu.call(this,new wa(90,1,.5,500)),this._frameExtents=new Bi(4,2),this._viewportCount=6,this._viewports=[new Vi(2,1,1,1),new Vi(0,1,1,1),new Vi(3,1,1,1),new Vi(1,1,1,1),new Vi(3,0,1,1),new Vi(1,0,1,1)],this._cubeDirections=[new Zi(1,0,0),new Zi(-1,0,0),new Zi(0,0,1),new Zi(0,0,-1),new Zi(0,1,0),new Zi(0,-1,0)],this._cubeUps=[new Zi(0,1,0),new Zi(0,1,0),new Zi(0,1,0),new Zi(0,1,0),new Zi(0,0,1),new Zi(0,0,-1)]}function su(e,t,i,n){eu.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new au}function ou(e,t,i,n,r,a){xa.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==i?i:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function lu(){iu.call(this,new ou(-5,5,5,-5,.5,500))}function cu(e,t){eu.call(this,e,t),this.type="DirectionalLight",this.position.copy(Mn.DefaultUp),this.updateMatrix(),this.target=new Mn,this.shadow=new lu}function hu(e,t){eu.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function uu(e,t,i,n){eu.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}function du(e){_h.call(this,e),this.textures={}}Jh.prototype=Object.assign(Object.create(Ph.prototype),{constructor:Jh,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Wh(t,e))},getPoint:function(e){for(var t=e*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=t){var r=i[n]-t,a=this.curves[n],s=a.getLength(),o=0===s?0:1-r/s;return a.getPointAt(o)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,i=0,n=this.curves.length;i<n;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,i=[],n=0,r=this.curves;n<r.length;n++)for(var a=r[n],s=a&&a.isEllipseCurve?2*e:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,o=a.getPoints(s),l=0;l<o.length;l++){var c=o[l];t&&t.equals(c)||(i.push(c),t=c)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(e){Ph.prototype.copy.call(this,e),this.curves=[];for(var t=0,i=e.curves.length;t<i;t++){var n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=Ph.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,i=this.curves.length;t<i;t++){var n=this.curves[t];e.curves.push(n.toJSON())}return e},fromJSON:function(e){Ph.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,i=e.curves.length;t<i;t++){var n=e.curves[t];this.curves.push((new Zh[n.type]).fromJSON(n))}return this}}),Kh.prototype=Object.assign(Object.create(Jh.prototype),{constructor:Kh,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){var i=new Wh(this.currentPoint.clone(),new Bi(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,i,n){var r=new $h(this.currentPoint.clone(),new Bi(e,t),new Bi(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this},bezierCurveTo:function(e,t,i,n,r,a){var s=new jh(this.currentPoint.clone(),new Bi(e,t),new Bi(i,n),new Bi(r,a));return this.curves.push(s),this.currentPoint.set(r,a),this},splineThru:function(e){var t=new Yh([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,i,n,r,a){var s=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+s,t+o,i,n,r,a),this},absarc:function(e,t,i,n,r,a){return this.absellipse(e,t,i,i,n,r,a),this},ellipse:function(e,t,i,n,r,a,s,o){var l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,i,n,r,a,s,o),this},absellipse:function(e,t,i,n,r,a,s,o){var l=new Rh(e,t,i,n,r,a,s,o);if(this.curves.length>0){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var h=l.getPoint(1);return this.currentPoint.copy(h),this},copy:function(e){return Jh.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Jh.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Jh.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Qh.prototype=Object.assign(Object.create(Kh.prototype),{constructor:Qh,getPointsHoles:function(e){for(var t=[],i=0,n=this.holes.length;i<n;i++)t[i]=this.holes[i].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Kh.prototype.copy.call(this,e),this.holes=[];for(var t=0,i=e.holes.length;t<i;t++){var n=e.holes[t];this.holes.push(n.clone())}return this},toJSON:function(){var e=Kh.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,i=this.holes.length;t<i;t++){var n=this.holes[t];e.holes.push(n.toJSON())}return e},fromJSON:function(e){Kh.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,i=e.holes.length;t<i;t++){var n=e.holes[t];this.holes.push((new Kh).fromJSON(n))}return this}}),eu.prototype=Object.assign(Object.create(Mn.prototype),{constructor:eu,isLight:!0,copy:function(e){return Mn.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Mn.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),tu.prototype=Object.assign(Object.create(eu.prototype),{constructor:tu,isHemisphereLight:!0,copy:function(e){return eu.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(iu.prototype,{_projScreenMatrix:new an,_lightPositionWorld:new Zi,_lookTarget:new Zi,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,i=this.matrix,n=this._projScreenMatrix,r=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(e.matrixWorld),t.position.copy(a),r.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(r),t.updateMatrixWorld(),n.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),nu.prototype=Object.assign(Object.create(iu.prototype),{constructor:nu,isSpotLightShadow:!0,updateMatrices:function(e){var t=this.camera,i=2*Fi.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;i===t.fov&&n===t.aspect&&r===t.far||(t.fov=i,t.aspect=n,t.far=r,t.updateProjectionMatrix()),iu.prototype.updateMatrices.call(this,e)}}),ru.prototype=Object.assign(Object.create(eu.prototype),{constructor:ru,isSpotLight:!0,copy:function(e){return eu.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),au.prototype=Object.assign(Object.create(iu.prototype),{constructor:au,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);var i=this.camera,n=this.matrix,r=this._lightPositionWorld,a=this._lookTarget,s=this._projScreenMatrix;r.setFromMatrixPosition(e.matrixWorld),i.position.copy(r),a.copy(i.position),a.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(a),i.updateMatrixWorld(),n.makeTranslation(-r.x,-r.y,-r.z),s.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(s)}}),su.prototype=Object.assign(Object.create(eu.prototype),{constructor:su,isPointLight:!0,copy:function(e){return eu.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),ou.prototype=Object.assign(Object.create(xa.prototype),{constructor:ou,isOrthographicCamera:!0,copy:function(e,t){return xa.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,i,n,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-e,a=i+e,s=n+t,o=n-t;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(r+=l*this.view.offsetX)+l*this.view.width,o=(s-=c*this.view.offsetY)-c*this.view.height}this.projectionMatrix.makeOrthographic(r,a,s,o,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Mn.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),lu.prototype=Object.assign(Object.create(iu.prototype),{constructor:lu,isDirectionalLightShadow:!0,updateMatrices:function(e){iu.prototype.updateMatrices.call(this,e)}}),cu.prototype=Object.assign(Object.create(eu.prototype),{constructor:cu,isDirectionalLight:!0,copy:function(e){return eu.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),hu.prototype=Object.assign(Object.create(eu.prototype),{constructor:hu,isAmbientLight:!0}),uu.prototype=Object.assign(Object.create(eu.prototype),{constructor:uu,isRectAreaLight:!0,copy:function(e){return eu.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=eu.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),du.prototype=Object.assign(Object.create(_h.prototype),{constructor:du,load:function(e,t,i,n){var r=this,a=new Sh(r.manager);a.setPath(r.path),a.load(e,(function(e){t(r.parse(JSON.parse(e)))}),i,n)},parse:function(e){var t=this.textures;function i(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var n=new nh[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.sheen&&(n.sheen=(new mr).setHex(e.sheen)),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearcoat&&(n.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(n.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.combine&&(n.combine=e.combine),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(n.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(n.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(n.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(n.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(n.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(n.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(n.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(n.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),1!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(n.morphNormals=e.morphNormals),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.vertexTangents&&(n.vertexTangents=e.vertexTangents),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.toneMapped&&(n.toneMapped=e.toneMapped),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var r in e.uniforms){var a=e.uniforms[r];switch(n.uniforms[r]={},a.type){case"t":n.uniforms[r].value=i(a.value);break;case"c":n.uniforms[r].value=(new mr).setHex(a.value);break;case"v2":n.uniforms[r].value=(new Bi).fromArray(a.value);break;case"v3":n.uniforms[r].value=(new Zi).fromArray(a.value);break;case"v4":n.uniforms[r].value=(new Vi).fromArray(a.value);break;case"m3":n.uniforms[r].value=(new Hi).fromArray(a.value);case"m4":n.uniforms[r].value=(new an).fromArray(a.value);break;default:n.uniforms[r].value=a.value}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var s in e.extensions)n.extensions[s]=e.extensions[s];if(void 0!==e.shading&&(n.flatShading=1===e.shading),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=i(e.map)),void 0!==e.matcap&&(n.matcap=i(e.matcap)),void 0!==e.alphaMap&&(n.alphaMap=i(e.alphaMap)),void 0!==e.bumpMap&&(n.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=i(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){var o=e.normalScale;!1===Array.isArray(o)&&(o=[o,o]),n.normalScale=(new Bi).fromArray(o)}return void 0!==e.displacementMap&&(n.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=i(e.specularMap)),void 0!==e.envMap&&(n.envMap=i(e.envMap)),void 0!==e.envMapIntensity&&(n.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(n.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(n.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=i(e.gradientMap)),void 0!==e.clearcoatMap&&(n.clearcoatMap=i(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(n.clearcoatNormalMap=i(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(n.clearcoatNormalScale=(new Bi).fromArray(e.clearcoatNormalScale)),n},setTextures:function(e){return this.textures=e,this}});var pu={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",i=0,n=e.length;i<n;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function mu(){Ur.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function fu(e,t,i,n){"number"==typeof i&&(n=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Mr.call(this,e,t,i),this.meshPerAttribute=n||1}function gu(e){_h.call(this,e)}mu.prototype=Object.assign(Object.create(Ur.prototype),{constructor:mu,isInstancedBufferGeometry:!0,copy:function(e){return Ur.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=Ur.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),fu.prototype=Object.assign(Object.create(Mr.prototype),{constructor:fu,isInstancedBufferAttribute:!0,copy:function(e){return Mr.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Mr.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),gu.prototype=Object.assign(Object.create(_h.prototype),{constructor:gu,load:function(e,t,i,n){var r=this,a=new Sh(r.manager);a.setPath(r.path),a.load(e,(function(e){t(r.parse(JSON.parse(e)))}),i,n)},parse:function(e){var t=e.isInstancedBufferGeometry?new mu:new Ur,i=e.data.index;if(void 0!==i){var n=new vu[i.type](i.array);t.setIndex(new Mr(n,1))}var r=e.data.attributes;for(var a in r){var s=r[a],o=(n=new vu[s.type](s.array),new(s.isInstancedBufferAttribute?fu:Mr)(n,s.itemSize,s.normalized));void 0!==s.name&&(o.name=s.name),t.setAttribute(a,o)}var l=e.data.morphAttributes;if(l)for(var a in l){for(var c=l[a],h=[],u=0,d=c.length;u<d;u++){s=c[u],o=new Mr(n=new vu[s.type](s.array),s.itemSize,s.normalized);void 0!==s.name&&(o.name=s.name),h.push(o)}t.morphAttributes[a]=h}e.data.morphTargetsRelative&&(t.morphTargetsRelative=!0);var p=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==p){u=0;for(var m=p.length;u!==m;++u){var f=p[u];t.addGroup(f.start,f.count,f.materialIndex)}}var g=e.data.boundingSphere;if(void 0!==g){var v=new Zi;void 0!==g.center&&v.fromArray(g.center),t.boundingSphere=new Gn(v,g.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t}});var vu={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function yu(e){_h.call(this,e)}yu.prototype=Object.assign(Object.create(_h.prototype),{constructor:yu,load:function(e,t,i,n){var r=this,a=""===this.path?pu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var s=new Sh(r.manager);s.setPath(this.path),s.load(e,(function(i){var a=null;try{a=JSON.parse(i)}catch(t){return void 0!==n&&n(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var s=a.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?r.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),i,n)},parse:function(e,t){var i=this.parseShape(e.shapes),n=this.parseGeometries(e.geometries,i),r=this.parseImages(e.images,(function(){void 0!==t&&t(o)})),a=this.parseTextures(e.textures,r),s=this.parseMaterials(e.materials,a),o=this.parseObject(e.object,n,s);return e.animations&&(o.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(o),o},parseShape:function(e){var t={};if(void 0!==e)for(var i=0,n=e.length;i<n;i++){var r=(new Qh).fromJSON(e[i]);t[r.uuid]=r}return t},parseGeometries:function(e,t){var i={};if(void 0!==e)for(var n=new gu,r=0,a=e.length;r<a;r++){var s,o=e[r];switch(o.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new qc[o.type](o.width,o.height,o.widthSegments,o.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new qc[o.type](o.width,o.height,o.depth,o.widthSegments,o.heightSegments,o.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new qc[o.type](o.radius,o.segments,o.thetaStart,o.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new qc[o.type](o.radiusTop,o.radiusBottom,o.height,o.radialSegments,o.heightSegments,o.openEnded,o.thetaStart,o.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new qc[o.type](o.radius,o.height,o.radialSegments,o.heightSegments,o.openEnded,o.thetaStart,o.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new qc[o.type](o.radius,o.widthSegments,o.heightSegments,o.phiStart,o.phiLength,o.thetaStart,o.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new qc[o.type](o.radius,o.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new qc[o.type](o.innerRadius,o.outerRadius,o.thetaSegments,o.phiSegments,o.thetaStart,o.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new qc[o.type](o.radius,o.tube,o.radialSegments,o.tubularSegments,o.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new qc[o.type](o.radius,o.tube,o.tubularSegments,o.radialSegments,o.p,o.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new qc[o.type]((new Zh[o.path.type]).fromJSON(o.path),o.tubularSegments,o.radius,o.radialSegments,o.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new qc[o.type](o.points,o.segments,o.phiStart,o.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new qc[o.type](o.vertices,o.indices,o.radius,o.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],c=0,h=o.shapes.length;c<h;c++){var u=t[o.shapes[c]];l.push(u)}s=new qc[o.type](l,o.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(l=[],c=0,h=o.shapes.length;c<h;c++){u=t[o.shapes[c]];l.push(u)}var d=o.options.extrudePath;void 0!==d&&(o.options.extrudePath=(new Zh[d.type]).fromJSON(d)),s=new qc[o.type](l,o.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=n.parse(o);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+o.type+'"');continue}s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),!0===s.isBufferGeometry&&void 0!==o.userData&&(s.userData=o.userData),i[o.uuid]=s}return i},parseMaterials:function(e,t){var i={},n={};if(void 0!==e){var r=new du;r.setTextures(t);for(var a=0,s=e.length;a<s;a++){var o=e[a];if("MultiMaterial"===o.type){for(var l=[],c=0;c<o.materials.length;c++){var h=o.materials[c];void 0===i[h.uuid]&&(i[h.uuid]=r.parse(h)),l.push(i[h.uuid])}n[o.uuid]=l}else void 0===i[o.uuid]&&(i[o.uuid]=r.parse(o)),n[o.uuid]=i[o.uuid]}}return n},parseAnimations:function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i],r=vh.parse(n);void 0!==n.uuid&&(r.uuid=n.uuid),t.push(r)}return t},parseImages:function(e,t){var i=this,n={};function r(e){return i.manager.itemStart(e),a.load(e,(function(){i.manager.itemEnd(e)}),void 0,(function(){i.manager.itemError(e),i.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){var a=new Lh(new xh(t));a.setCrossOrigin(this.crossOrigin);for(var s=0,o=e.length;s<o;s++){var l=e[s],c=l.url;if(Array.isArray(c)){n[l.uuid]=[];for(var h=0,u=c.length;h<u;h++){var d=c[h],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:i.resourcePath+d;n[l.uuid].push(r(p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:i.resourcePath+l.url;n[l.uuid]=r(p)}}}return n},parseTextures:function(e,t){function i(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var r=0,a=e.length;r<a;r++){var s,o=e[r];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image),(s=Array.isArray(t[o.image])?new qa(t[o.image]):new ji(t[o.image])).needsUpdate=!0,s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=i(o.mapping,xu)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=i(o.wrap[0],wu),s.wrapT=i(o.wrap[1],wu)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=i(o.minFilter,_u)),void 0!==o.magFilter&&(s.magFilter=i(o.magFilter,_u)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),n[o.uuid]=s}return n},parseObject:function(e,t,i){var n;function r(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function a(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n];void 0===i[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(i[a])}return t}return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),i[e]}}switch(e.type){case"Scene":n=new Sn,void 0!==e.background&&Number.isInteger(e.background)&&(n.background=new mr(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?n.fog=new Oo(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(n.fog=new Ro(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":n=new wa(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(n.focus=e.focus),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.filmGauge&&(n.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(n.filmOffset=e.filmOffset),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"OrthographicCamera":n=new ou(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"AmbientLight":n=new hu(e.color,e.intensity);break;case"DirectionalLight":n=new cu(e.color,e.intensity);break;case"PointLight":n=new su(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":n=new uu(e.color,e.intensity,e.width,e.height);break;case"SpotLight":n=new ru(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":n=new tu(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":n=new sa(s=r(e.geometry),o=a(e.material));break;case"InstancedMesh":var s=r(e.geometry),o=a(e.material),l=e.count,c=e.instanceMatrix;(n=new ul(s,o,l)).instanceMatrix=new Mr(new Float32Array(c.array),16);break;case"LOD":n=new tl;break;case"Line":n=new yl(r(e.geometry),a(e.material),e.mode);break;case"LineLoop":n=new _l(r(e.geometry),a(e.material));break;case"LineSegments":n=new wl(r(e.geometry),a(e.material));break;case"PointCloud":case"Points":n=new Ll(r(e.geometry),a(e.material));break;case"Sprite":n=new Jo(a(e.material));break;case"Group":n=new Ao;break;default:n=new Mn}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(n.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(n.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&n.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(n.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.layers&&(n.layers.mask=e.layers),void 0!==e.children)for(var h=e.children,u=0;u<h.length;u++)n.add(this.parseObject(h[u],t,i));if("LOD"===e.type){void 0!==e.autoUpdate&&(n.autoUpdate=e.autoUpdate);for(var d=e.levels,p=0;p<d.length;p++){var m=d[p],f=n.getObjectByProperty("uuid",m.object);void 0!==f&&n.addLevel(f,m.distance)}}return n}});var bu,xu={UVMapping:se,CubeReflectionMapping:oe,CubeRefractionMapping:le,EquirectangularReflectionMapping:ce,EquirectangularRefractionMapping:he,SphericalReflectionMapping:ue,CubeUVReflectionMapping:de,CubeUVRefractionMapping:pe},wu={RepeatWrapping:me,ClampToEdgeWrapping:fe,MirroredRepeatWrapping:ge},_u={NearestFilter:ve,NearestMipmapNearestFilter:ye,NearestMipmapLinearFilter:xe,LinearFilter:_e,LinearMipmapNearestFilter:Me,LinearMipmapLinearFilter:Te};function Mu(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),_h.call(this,e),this.options=void 0}function Su(){this.type="ShapePath",this.color=new mr,this.subPaths=[],this.currentPath=null}function Tu(e){this.type="Font",this.data=e}function Eu(e,t,i,n,r){var a=r.glyphs[e]||r.glyphs["?"];if(a){var s,o,l,c,h,u,d,p,m=new Su;if(a.o)for(var f=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=f.length;g<v;){switch(f[g++]){case"m":s=f[g++]*t+i,o=f[g++]*t+n,m.moveTo(s,o);break;case"l":s=f[g++]*t+i,o=f[g++]*t+n,m.lineTo(s,o);break;case"q":l=f[g++]*t+i,c=f[g++]*t+n,h=f[g++]*t+i,u=f[g++]*t+n,m.quadraticCurveTo(h,u,l,c);break;case"b":l=f[g++]*t+i,c=f[g++]*t+n,h=f[g++]*t+i,u=f[g++]*t+n,d=f[g++]*t+i,p=f[g++]*t+n,m.bezierCurveTo(h,u,d,p,l,c)}}return{offsetX:a.ha*t,path:m}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+r.familyName+".")}function Cu(e){_h.call(this,e)}Mu.prototype=Object.assign(Object.create(_h.prototype),{constructor:Mu,setOptions:function(e){return this.options=e,this},load:function(e,t,i,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=bh.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout((function(){t&&t(a),r.manager.itemEnd(e)}),0),a;fetch(e).then((function(e){return e.blob()})).then((function(e){return void 0===r.options?createImageBitmap(e):createImageBitmap(e,r.options)})).then((function(i){bh.add(e,i),t&&t(i),r.manager.itemEnd(e)})).catch((function(t){n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)})),r.manager.itemStart(e)}}),Object.assign(Su.prototype,{moveTo:function(e,t){return this.currentPath=new Kh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,i,n){return this.currentPath.quadraticCurveTo(e,t,i,n),this},bezierCurveTo:function(e,t,i,n,r,a){return this.currentPath.bezierCurveTo(e,t,i,n,r,a),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function i(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i],a=new Qh;a.curves=r.curves,t.push(a)}return t}function n(e,t){for(var i=t.length,n=!1,r=i-1,a=0;a<i;r=a++){var s=t[r],o=t[a],l=o.x-s.x,c=o.y-s.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(s=t[a],l=-l,o=t[r],c=-c),e.y<s.y||e.y>o.y)continue;if(e.y===s.y){if(e.x===s.x)return!0}else{var h=c*(e.x-s.x)-l*(e.y-s.y);if(0===h)return!0;if(h<0)continue;n=!n}}else{if(e.y!==s.y)continue;if(o.x<=e.x&&e.x<=s.x||s.x<=e.x&&e.x<=o.x)return!0}}return n}var r=wc.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return i(a);var s,o,l,c=[];if(1===a.length)return o=a[0],(l=new Qh).curves=o.curves,c.push(l),c;var h=!r(a[0].getPoints());h=e?!h:h;var u,d,p=[],m=[],f=[],g=0;m[g]=void 0,f[g]=[];for(var v=0,y=a.length;v<y;v++)s=r(u=(o=a[v]).getPoints()),(s=e?!s:s)?(!h&&m[g]&&g++,m[g]={s:new Qh,p:u},m[g].s.curves=o.curves,h&&g++,f[g]=[]):f[g].push({h:o,p:u[0]});if(!m[0])return i(a);if(m.length>1){for(var b=!1,x=[],w=0,_=m.length;w<_;w++)p[w]=[];for(w=0,_=m.length;w<_;w++)for(var M=f[w],S=0;S<M.length;S++){for(var T=M[S],E=!0,C=0;C<m.length;C++)n(T.p,m[C].p)&&(w!==C&&x.push({froms:w,tos:C,hole:S}),E?(E=!1,p[C].push(T)):b=!0);E&&p[w].push(T)}x.length>0&&(b||(f=p))}v=0;for(var L=m.length;v<L;v++){l=m[v].s,c.push(l);for(var A=0,k=(d=f[v]).length;A<k;A++)l.holes.push(d[A].h)}return c}}),Object.assign(Tu.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var i=[],n=function(e,t,i){for(var n=Array.from?Array.from(e):String(e).split(""),r=t/i.resolution,a=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*r,s=[],o=0,l=0,c=0;c<n.length;c++){var h=n[c];if("\n"===h)o=0,l-=a;else{var u=Eu(h,r,o,l,i);o+=u.offsetX,s.push(u.path)}}return s}(e,t,this.data),r=0,a=n.length;r<a;r++)Array.prototype.push.apply(i,n[r].toShapes());return i}}),Cu.prototype=Object.assign(Object.create(_h.prototype),{constructor:Cu,load:function(e,t,i,n){var r=this,a=new Sh(this.manager);a.setPath(this.path),a.load(e,(function(e){var i;try{i=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(e.substring(65,e.length-2))}var n=r.parse(i);t&&t(n)}),i,n)},parse:function(e){return new Tu(e)}});var Lu={getContext:function(){return void 0===bu&&(bu=new(window.AudioContext||window.webkitAudioContext)),bu},setContext:function(e){bu=e}};function Au(e){_h.call(this,e)}function ku(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new Zi)}function Pu(e,t){eu.call(this,void 0,t),this.sh=void 0!==e?e:new ku}function Ru(e,t,i){Pu.call(this,void 0,i);var n=(new mr).set(e),r=(new mr).set(t),a=new Zi(n.r,n.g,n.b),s=new Zi(r.r,r.g,r.b),o=Math.sqrt(Math.PI),l=o*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(s).multiplyScalar(o),this.sh.coefficients[1].copy(a).sub(s).multiplyScalar(l)}function Ou(e,t){Pu.call(this,void 0,t);var i=(new mr).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}Au.prototype=Object.assign(Object.create(_h.prototype),{constructor:Au,load:function(e,t,i,n){var r=new Sh(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(e,(function(e){var i=e.slice(0);Lu.getContext().decodeAudioData(i,(function(e){t(e)}))}),i,n)}}),Object.assign(ku.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var i=e.x,n=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*n),t.addScaledVector(a[2],.488603*r),t.addScaledVector(a[3],.488603*i),t.addScaledVector(a[4],i*n*1.092548),t.addScaledVector(a[5],n*r*1.092548),t.addScaledVector(a[6],.315392*(3*r*r-1)),t.addScaledVector(a[7],i*r*1.092548),t.addScaledVector(a[8],.546274*(i*i-n*n)),t},getIrradianceAt:function(e,t){var i=e.x,n=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*n),t.addScaledVector(a[2],1.023328*r),t.addScaledVector(a[3],1.023328*i),t.addScaledVector(a[4],.858086*i*n),t.addScaledVector(a[5],.858086*n*r),t.addScaledVector(a[6],.743125*r*r-.247708),t.addScaledVector(a[7],.858086*i*r),t.addScaledVector(a[8],.429043*(i*i-n*n)),t},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},addScaledSH:function(e,t){for(var i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e,t){void 0===t&&(t=0);for(var i=this.coefficients,n=0;n<9;n++)i[n].fromArray(e,t+3*n);return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var i=this.coefficients,n=0;n<9;n++)i[n].toArray(e,t+3*n);return e}}),Object.assign(ku,{getBasisAt:function(e,t){var i=e.x,n=e.y,r=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*r,t[3]=.488603*i,t[4]=1.092548*i*n,t[5]=1.092548*n*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*i*r,t[8]=.546274*(i*i-n*n)}}),Pu.prototype=Object.assign(Object.create(eu.prototype),{constructor:Pu,isLightProbe:!0,copy:function(e){return eu.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return eu.prototype.toJSON.call(this,e)}}),Ru.prototype=Object.assign(Object.create(Pu.prototype),{constructor:Ru,isHemisphereLightProbe:!0,copy:function(e){return Pu.prototype.copy.call(this,e),this},toJSON:function(e){return Pu.prototype.toJSON.call(this,e)}}),Ou.prototype=Object.assign(Object.create(Pu.prototype),{constructor:Ou,isAmbientLightProbe:!0,copy:function(e){return Pu.prototype.copy.call(this,e),this},toJSON:function(e){return Pu.prototype.toJSON.call(this,e)}});var Iu=new an,Du=new an;function Nu(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new wa,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new wa,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function zu(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(Nu.prototype,{update:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var i,n,r=e.projectionMatrix.clone(),a=t.eyeSep/2,s=a*t.near/t.focus,o=t.near*Math.tan(Fi.DEG2RAD*t.fov*.5)/t.zoom;Du.elements[12]=-a,Iu.elements[12]=a,i=-o*t.aspect+s,n=o*t.aspect+s,r.elements[0]=2*t.near/(n-i),r.elements[8]=(n+i)/(n-i),this.cameraL.projectionMatrix.copy(r),i=-o*t.aspect-s,n=o*t.aspect-s,r.elements[0]=2*t.near/(n-i),r.elements[8]=(n+i)/(n-i),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Du),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Iu)}}),Object.assign(zu.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});var Fu=new Zi,Bu=new $i,Hu=new Zi,Gu=new Zi;function Uu(){Mn.call(this),this.type="AudioListener",this.context=Lu.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new zu}function ju(e){Mn.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}Uu.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Uu,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){Mn.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Fu,Bu,Hu),Gu.set(0,0,-1).applyQuaternion(Bu),t.positionX){var n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Fu.x,n),t.positionY.linearRampToValueAtTime(Fu.y,n),t.positionZ.linearRampToValueAtTime(Fu.z,n),t.forwardX.linearRampToValueAtTime(Gu.x,n),t.forwardY.linearRampToValueAtTime(Gu.y,n),t.forwardZ.linearRampToValueAtTime(Gu.z,n),t.upX.linearRampToValueAtTime(i.x,n),t.upY.linearRampToValueAtTime(i.y,n),t.upZ.linearRampToValueAtTime(i.z,n)}else t.setPosition(Fu.x,Fu.y,Fu.z),t.setOrientation(Gu.x,Gu.y,Gu.z,i.x,i.y,i.z)}}),ju.prototype=Object.assign(Object.create(Mn.prototype),{constructor:ju,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(void 0===e&&(e=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var Vu=new Zi,Wu=new $i,qu=new Zi,$u=new Zi;function Xu(e){ju.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Yu(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Zu(e,t,i){this.binding=e,this.valueSize=i;var n,r=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Xu.prototype=Object.assign(Object.create(ju.prototype),{constructor:Xu,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this},updateMatrixWorld:function(e){if(Mn.prototype.updateMatrixWorld.call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Vu,Wu,qu),$u.set(0,0,1).applyQuaternion(Wu);var t=this.panner;if(t.positionX){var i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Vu.x,i),t.positionY.linearRampToValueAtTime(Vu.y,i),t.positionZ.linearRampToValueAtTime(Vu.z,i),t.orientationX.linearRampToValueAtTime($u.x,i),t.orientationY.linearRampToValueAtTime($u.y,i),t.orientationZ.linearRampToValueAtTime($u.z,i)}else t.setPosition(Vu.x,Vu.y,Vu.z),t.setOrientation($u.x,$u.y,$u.z)}}}),Object.assign(Yu.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),i=0;i<t.length;i++)e+=t[i];return e/t.length}}),Object.assign(Zu.prototype,{accumulate:function(e,t){var i=this.buffer,n=this.valueSize,r=e*n+n,a=this.cumulativeWeight;if(0===a){for(var s=0;s!==n;++s)i[r+s]=i[s];a=t}else{var o=t/(a+=t);this._mixBufferRegion(i,r,0,o,n)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,i=this.buffer,n=e*t+t,r=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,r<1){var s=3*t;this._mixBufferRegion(i,n,s,1-r,t)}for(var o=t,l=t+t;o!==l;++o)if(i[o]!==i[o+t]){a.setValue(i,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,i=this.valueSize,n=3*i;e.getValue(t,n);for(var r=i,a=n;r!==a;++r)t[r]=t[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,i,n,r){if(n>=.5)for(var a=0;a!==r;++a)e[t+a]=e[i+a]},_slerp:function(e,t,i,n){$i.slerpFlat(e,t,e,t,e,i,n)},_lerp:function(e,t,i,n,r){for(var a=1-n,s=0;s!==r;++s){var o=t+s;e[o]=e[o]*a+e[i+s]*n}}});var Ju=new RegExp("[\\[\\]\\.:\\/]","g"),Ku="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Qu=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),ed=/(WCOD+)?/.source.replace("WCOD",Ku),td=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),id=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),nd=new RegExp("^"+Qu+ed+td+id+"$"),rd=["material","materials","bones"];function ad(e,t,i){var n=i||sd.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function sd(e,t,i){this.path=t,this.parsedPath=i||sd.parseTrackName(t),this.node=sd.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function od(){this.uuid=Fi.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,i=arguments.length;t!==i;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function ld(e,t,i){this._mixer=e,this._clip=t,this._localRoot=i||null;for(var n=t.tracks,r=n.length,a=new Array(r),s={endingStart:Wt,endingEnd:Wt},o=0;o!==r;++o){var l=n[o].createInterpolant(null);a[o]=l,l.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ht,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function cd(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function hd(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function ud(e,t,i){Io.call(this,e,t),this.meshPerAttribute=i||1}function dd(e,t,i,n){this.ray=new Yn(e,t),this.near=i||0,this.far=n||1/0,this.camera=null,this.layers=new cn,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function pd(e,t){return e.distance-t.distance}function md(e,t,i,n){if(e.layers.test(t.layers)&&e.raycast(t,i),!0===n)for(var r=e.children,a=0,s=r.length;a<s;a++)md(r[a],t,i,!0)}function fd(e,t,i){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==i?i:0,this}function gd(e,t,i){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==i?i:0,this}Object.assign(ad.prototype,{getValue:function(e,t){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}),Object.assign(sd,{Composite:ad,create:function(e,t,i){return e&&e.isAnimationObjectGroup?new sd.Composite(e,t,i):new sd(e,t,i)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Ju,"")},parseTrackName:function(e){var t=nd.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var r=i.nodeName.substring(n+1);-1!==rd.indexOf(r)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var i=e.skeleton.getBoneByName(t);if(void 0!==i)return i}if(e.children){var n=function(e){for(var i=0;i<e.length;i++){var r=e[i];if(r.name===t||r.uuid===t)return r;var a=n(r.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null}}),Object.assign(sd.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)e[t++]=i[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,i=t.objectName,n=t.propertyName,r=t.propertyIndex;if(e||(e=sd.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(i){var a=t.objectIndex;switch(i){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var s=0;s<e.length;s++)if(e[s].name===a){a=s;break}break;default:if(void 0===e[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[i]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var o=e[n];if(void 0!==o){var l=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(s=0;s<this.node.geometry.morphAttributes.position.length;s++)if(e.geometry.morphAttributes.position[s].name===r){r=s;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(s=0;s<this.node.geometry.morphTargets.length;s++)if(e.geometry.morphTargets[s].name===r){r=s;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+n+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(sd.prototype,{_getValue_unbound:sd.prototype.getValue,_setValue_unbound:sd.prototype.setValue}),Object.assign(od.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._paths,a=this._parsedPaths,s=this._bindings,o=s.length,l=void 0,c=0,h=arguments.length;c!==h;++c){var u=arguments[c],d=u.uuid,p=n[d];if(void 0===p){p=t++,n[d]=p,e.push(u);for(var m=0,f=o;m!==f;++m)s[m].push(new sd(u,r[m],a[m]))}else if(p<i){l=e[p];var g=--i,v=e[g];n[v.uuid]=p,e[p]=v,n[d]=g,e[g]=u;for(m=0,f=o;m!==f;++m){var y=s[m],b=y[g],x=y[p];y[p]=b,void 0===x&&(x=new sd(u,r[m],a[m])),y[g]=x}}else e[p]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,r=n.length,a=0,s=arguments.length;a!==s;++a){var o=arguments[a],l=o.uuid,c=i[l];if(void 0!==c&&c>=t){var h=t++,u=e[h];i[u.uuid]=c,e[c]=u,i[l]=h,e[h]=o;for(var d=0,p=r;d!==p;++d){var m=n[d],f=m[h],g=m[c];m[c]=f,m[h]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,a=r.length,s=0,o=arguments.length;s!==o;++s){var l=arguments[s],c=l.uuid,h=n[c];if(void 0!==h)if(delete n[c],h<i){var u=--i,d=e[u],p=e[y=--t];n[d.uuid]=h,e[h]=d,n[p.uuid]=u,e[u]=p,e.pop();for(var m=0,f=a;m!==f;++m){var g=(b=r[m])[u],v=b[y];b[h]=g,b[u]=v,b.pop()}}else{var y;n[(p=e[y=--t]).uuid]=h,e[h]=p,e.pop();for(m=0,f=a;m!==f;++m){var b;(b=r[m])[h]=b[y],b.pop()}}}this.nCachedObjects_=i},subscribe_:function(e,t){var i=this._bindingsIndicesByPath,n=i[e],r=this._bindings;if(void 0!==n)return r[n];var a=this._paths,s=this._parsedPaths,o=this._objects,l=o.length,c=this.nCachedObjects_,h=new Array(l);n=r.length,i[e]=n,a.push(e),s.push(t),r.push(h);for(var u=c,d=o.length;u!==d;++u){var p=o[u];h[u]=new sd(p,e,t)}return h},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,i=t[e];if(void 0!==i){var n=this._paths,r=this._parsedPaths,a=this._bindings,s=a.length-1,o=a[s];t[e[s]]=i,a[i]=o,a.pop(),r[i]=r[s],r.pop(),n[i]=n[s],n.pop()}}}),Object.assign(ld.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){var n=this._clip.duration,r=e._clip.duration,a=r/n,s=n/r;e.warp(1,a,t),this.warp(s,1,t)}return this},crossFadeTo:function(e,t,i){return e.crossFadeFrom(this,t,i)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,i){var n=this._mixer,r=n.time,a=this._timeScaleInterpolant,s=this.timeScale;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);var o=a.parameterPositions,l=a.sampleValues;return o[0]=r,o[1]=r+i,l[0]=e/s,l[1]=t/s,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,i,n){if(this.enabled){var r=this._startTime;if(null!==r){var a=(e-r)*i;if(a<0||0===i)return;this._startTime=null,t=i*a}t*=this._updateTimeScale(e);var s=this._updateTime(t),o=this._updateWeight(e);if(o>0)for(var l=this._interpolants,c=this._propertyBindings,h=0,u=l.length;h!==u;++h)l[h].evaluate(s),c[h].accumulate(n,o)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(e)[0];t*=n,e>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i)t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,i=this._clip.duration,n=this.loop,r=this._loopCount,a=n===Gt;if(0===e)return-1===r?t:a&&1==(1&r)?i-t:t;if(n===Bt){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=i)t=i;else{if(!(t<0)){this.time=t;break e}t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),t>=i||t<0){var s=Math.floor(t/i);t-=i*s,r+=Math.abs(s);var o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?i:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){var l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}else this.time=t;if(a&&1==(1&r))return i-t}return t},_setEndings:function(e,t,i){var n=this._interpolantSettings;i?(n.endingStart=qt,n.endingEnd=qt):(n.endingStart=e?this.zeroSlopeAtStart?qt:Wt:$t,n.endingEnd=t?this.zeroSlopeAtEnd?qt:Wt:$t)},_scheduleFading:function(e,t,i){var n=this._mixer,r=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);var s=a.parameterPositions,o=a.sampleValues;return s[0]=r,o[0]=t,s[1]=r+e,o[1]=i,this}}),cd.prototype=Object.assign(Object.create(Ii.prototype),{constructor:cd,_bindAction:function(e,t){var i=e._localRoot||this._root,n=e._clip.tracks,r=n.length,a=e._propertyBindings,s=e._interpolants,o=i.uuid,l=this._bindingsByRootAndName,c=l[o];void 0===c&&(c={},l[o]=c);for(var h=0;h!==r;++h){var u=n[h],d=u.name,p=c[d];if(void 0!==p)a[h]=p;else{if(void 0!==(p=a[h])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,o,d));continue}var m=t&&t._propertyBindings[h].binding.parsedPath;++(p=new Zu(sd.create(i,d,m),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(p,o,d),a[h]=p}s[h].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,t)}for(var r=e._propertyBindings,a=0,s=r.length;a!==s;++a){var o=r[a];0==o.useCount++&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,i){var n=this._actions,r=this._actionsByClip,a=r[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=a;else{var s=a.knownActions;e._byClipCacheIndex=s.length,s.push(e)}e._cacheIndex=n.length,n.push(e),a.actionByRoot[i]=e},_removeInactiveAction:function(e){var t=this._actions,i=t[t.length-1],n=e._cacheIndex;i._cacheIndex=n,t[n]=i,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,a=this._actionsByClip,s=a[r],o=s.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null,delete s.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete a[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,i=e._cacheIndex,n=this._nActiveActions++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_takeBackAction:function(e){var t=this._actions,i=e._cacheIndex,n=--this._nActiveActions,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_addInactiveBinding:function(e,t,i){var n=this._bindingsByRootAndName,r=n[t],a=this._bindings;void 0===r&&(r={},n[t]=r),r[i]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,i=e.binding,n=i.rootNode.uuid,r=i.path,a=this._bindingsByRootAndName,s=a[n],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete s[r],0===Object.keys(s).length&&delete a[n]},_lendBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=this._nActiveBindings++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_takeBackBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=--this._nActiveBindings,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return void 0===i&&((i=new oh(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=i),i},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,i=e.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];e.__cacheIndex=n,t[n]=e,r.__cacheIndex=i,t[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?vh.findByName(i,e):e,a=null!==r?r.uuid:e,s=this._actionsByClip[a],o=null;if(void 0!==s){var l=s.actionByRoot[n];if(void 0!==l)return l;o=s.knownActions[0],null===r&&(r=o._clip)}if(null===r)return null;var c=new ld(this,r,t);return this._bindAction(c,o),this._addInactiveAction(c,a,n),c},existingAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?vh.findByName(i,e):e,a=r?r.uuid:e,s=this._actionsByClip[a];return void 0!==s&&s.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==t;++r)e[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,i=this._nActiveActions,n=this.time+=e,r=Math.sign(e),a=this._accuIndex^=1,s=0;s!==i;++s){t[s]._update(n,e,r,a)}var o=this._bindings,l=this._nActiveBindings;for(s=0;s!==l;++s)o[s].apply(a);return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,i=e.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var a=r.knownActions,s=0,o=a.length;s!==o;++s){var l=a[s];this._deactivateAction(l);var c=l._cacheIndex,h=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,h._cacheIndex=c,t[c]=h,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}},uncacheRoot:function(e){var t=e.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var s in a){var o=a[s];o.restoreOriginalState(),this._removeInactiveBinding(o)}},uncacheAction:function(e,t){var i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),hd.prototype.clone=function(){return new hd(void 0===this.value.clone?this.value:this.value.clone())},ud.prototype=Object.assign(Object.create(Io.prototype),{constructor:ud,isInstancedInterleavedBuffer:!0,copy:function(e){return Io.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(dd.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,i){var n=i||[];return md(e,this,n,t),n.sort(pd),n},intersectObjects:function(e,t,i){var n=i||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var r=0,a=e.length;r<a;r++)md(e[r],this,n,t);return n.sort(pd),n}}),Object.assign(fd.prototype,{set:function(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Fi.clamp(t/this.radius,-1,1))),this}}),Object.assign(gd.prototype,{set:function(e,t,i){return this.radius=e,this.theta=t,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}});var vd=new Bi;function yd(e,t){this.min=void 0!==e?e:new Bi(1/0,1/0),this.max=void 0!==t?t:new Bi(-1/0,-1/0)}Object.assign(yd.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var i=vd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Bi),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Bi),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Bi),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Bi),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return vd.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var bd=new Zi,xd=new Zi;function wd(e,t){this.start=void 0!==e?e:new Zi,this.end=void 0!==t?t:new Zi}function _d(e){Mn.call(this),this.material=e,this.render=function(){}}Object.assign(wd.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Zi),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Zi),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Zi),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){bd.subVectors(e,this.start),xd.subVectors(this.end,this.start);var i=xd.dot(xd),n=xd.dot(bd)/i;return t&&(n=Fi.clamp(n,0,1)),n},closestPointToPoint:function(e,t,i){var n=this.closestPointToPointParameter(e,t);return void 0===i&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new Zi),this.delta(i).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),_d.prototype=Object.create(Mn.prototype),_d.prototype.constructor=_d,_d.prototype.isImmediateRenderObject=!0;var Md=new Zi;function Sd(e,t){Mn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var i=new Ur,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,a=1;r<32;r++,a++){var s=r/32*Math.PI*2,o=a/32*Math.PI*2;n.push(Math.cos(s),Math.sin(s),1,Math.cos(o),Math.sin(o),1)}i.setAttribute("position",new Pr(n,3));var l=new dl({fog:!1,toneMapped:!1});this.cone=new wl(i,l),this.add(this.cone),this.update()}Sd.prototype=Object.create(Mn.prototype),Sd.prototype.constructor=Sd,Sd.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Sd.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Md.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Md),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Td=new Zi,Ed=new an,Cd=new an;function Ld(e){for(var t=function e(t){var i=[];t&&t.isBone&&i.push(t);for(var n=0;n<t.children.length;n++)i.push.apply(i,e(t.children[n]));return i}(e),i=new Ur,n=[],r=[],a=new mr(0,0,1),s=new mr(0,1,0),o=0;o<t.length;o++){var l=t[o];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(a.r,a.g,a.b),r.push(s.r,s.g,s.b))}i.setAttribute("position",new Pr(n,3)),i.setAttribute("color",new Pr(r,3));var c=new dl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});wl.call(this,i,c),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Ad(e,t,i){this.light=e,this.light.updateMatrixWorld(),this.color=i;var n=new Pc(t,4,2),r=new wr({wireframe:!0,fog:!1,toneMapped:!1});sa.call(this,n,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}Ld.prototype=Object.create(wl.prototype),Ld.prototype.constructor=Ld,Ld.prototype.isSkeletonHelper=!0,Ld.prototype.updateMatrixWorld=function(e){var t=this.bones,i=this.geometry,n=i.getAttribute("position");Cd.getInverse(this.root.matrixWorld);for(var r=0,a=0;r<t.length;r++){var s=t[r];s.parent&&s.parent.isBone&&(Ed.multiplyMatrices(Cd,s.matrixWorld),Td.setFromMatrixPosition(Ed),n.setXYZ(a,Td.x,Td.y,Td.z),Ed.multiplyMatrices(Cd,s.parent.matrixWorld),Td.setFromMatrixPosition(Ed),n.setXYZ(a+1,Td.x,Td.y,Td.z),a+=2)}i.getAttribute("position").needsUpdate=!0,Mn.prototype.updateMatrixWorld.call(this,e)},Ad.prototype=Object.create(sa.prototype),Ad.prototype.constructor=Ad,Ad.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ad.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var kd=new Zi,Pd=new mr,Rd=new mr;function Od(e,t,i){Mn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;var n=new Ul(t);n.rotateY(.5*Math.PI),this.material=new wr({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);var r=n.getAttribute("position"),a=new Float32Array(3*r.count);n.setAttribute("color",new Mr(a,3)),this.add(new sa(n,this.material)),this.update()}function Id(e,t,i,n){e=e||10,t=t||10,i=new mr(void 0!==i?i:4473924),n=new mr(void 0!==n?n:8947848);for(var r=t/2,a=e/t,s=e/2,o=[],l=[],c=0,h=0,u=-s;c<=t;c++,u+=a){o.push(-s,0,u,s,0,u),o.push(u,0,-s,u,0,s);var d=c===r?i:n;d.toArray(l,h),h+=3,d.toArray(l,h),h+=3,d.toArray(l,h),h+=3,d.toArray(l,h),h+=3}var p=new Ur;p.setAttribute("position",new Pr(o,3)),p.setAttribute("color",new Pr(l,3));var m=new dl({vertexColors:!0,toneMapped:!1});wl.call(this,p,m)}function Dd(e,t,i,n,r,a){e=e||10,t=t||16,i=i||8,n=n||64,r=new mr(void 0!==r?r:4473924),a=new mr(void 0!==a?a:8947848);var s,o,l,c,h,u,d,p=[],m=[];for(c=0;c<=t;c++)l=c/t*(2*Math.PI),s=Math.sin(l)*e,o=Math.cos(l)*e,p.push(0,0,0),p.push(s,0,o),d=1&c?r:a,m.push(d.r,d.g,d.b),m.push(d.r,d.g,d.b);for(c=0;c<=i;c++)for(d=1&c?r:a,u=e-e/i*c,h=0;h<n;h++)l=h/n*(2*Math.PI),s=Math.sin(l)*u,o=Math.cos(l)*u,p.push(s,0,o),m.push(d.r,d.g,d.b),l=(h+1)/n*(2*Math.PI),s=Math.sin(l)*u,o=Math.cos(l)*u,p.push(s,0,o),m.push(d.r,d.g,d.b);var f=new Ur;f.setAttribute("position",new Pr(p,3)),f.setAttribute("color",new Pr(m,3));var g=new dl({vertexColors:!0,toneMapped:!1});wl.call(this,f,g)}Od.prototype=Object.create(Mn.prototype),Od.prototype.constructor=Od,Od.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Od.prototype.update=function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");Pd.copy(this.light.color),Rd.copy(this.light.groundColor);for(var i=0,n=t.count;i<n;i++){var r=i<n/2?Pd:Rd;t.setXYZ(i,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(kd.setFromMatrixPosition(this.light.matrixWorld).negate())},Id.prototype=Object.assign(Object.create(wl.prototype),{constructor:Id,copy:function(e){return wl.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),Dd.prototype=Object.create(wl.prototype),Dd.prototype.constructor=Dd;var Nd=new Zi,zd=new Zi,Fd=new Zi;function Bd(e,t,i){Mn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===t&&(t=1);var n=new Ur;n.setAttribute("position",new Pr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var r=new dl({fog:!1,toneMapped:!1});this.lightPlane=new yl(n,r),this.add(this.lightPlane),(n=new Ur).setAttribute("position",new Pr([0,0,0,0,0,1],3)),this.targetLine=new yl(n,r),this.add(this.targetLine),this.update()}Bd.prototype=Object.create(Mn.prototype),Bd.prototype.constructor=Bd,Bd.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Bd.prototype.update=function(){Nd.setFromMatrixPosition(this.light.matrixWorld),zd.setFromMatrixPosition(this.light.target.matrixWorld),Fd.subVectors(zd,Nd),this.lightPlane.lookAt(zd),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(zd),this.targetLine.scale.z=Fd.length()};var Hd=new Zi,Gd=new xa;function Ud(e){var t=new Ur,i=new dl({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],a={},s=new mr(16755200),o=new mr(16711680),l=new mr(43775),c=new mr(16777215),h=new mr(3355443);function u(e,t,i){d(e,i),d(t,i)}function d(e,t){n.push(0,0,0),r.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(n.length/3-1)}u("n1","n2",s),u("n2","n4",s),u("n4","n3",s),u("n3","n1",s),u("f1","f2",s),u("f2","f4",s),u("f4","f3",s),u("f3","f1",s),u("n1","f1",s),u("n2","f2",s),u("n3","f3",s),u("n4","f4",s),u("p","n1",o),u("p","n2",o),u("p","n3",o),u("p","n4",o),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l),u("c","t",c),u("p","c",h),u("cn1","cn2",h),u("cn3","cn4",h),u("cf1","cf2",h),u("cf3","cf4",h),t.setAttribute("position",new Pr(n,3)),t.setAttribute("color",new Pr(r,3)),wl.call(this,t,i),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function jd(e,t,i,n,r,a,s){Hd.set(r,a,s).unproject(n);var o=t[e];if(void 0!==o)for(var l=i.getAttribute("position"),c=0,h=o.length;c<h;c++)l.setXYZ(o[c],Hd.x,Hd.y,Hd.z)}Ud.prototype=Object.create(wl.prototype),Ud.prototype.constructor=Ud,Ud.prototype.update=function(){var e=this.geometry,t=this.pointMap;Gd.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),jd("c",t,e,Gd,0,0,-1),jd("t",t,e,Gd,0,0,1),jd("n1",t,e,Gd,-1,-1,-1),jd("n2",t,e,Gd,1,-1,-1),jd("n3",t,e,Gd,-1,1,-1),jd("n4",t,e,Gd,1,1,-1),jd("f1",t,e,Gd,-1,-1,1),jd("f2",t,e,Gd,1,-1,1),jd("f3",t,e,Gd,-1,1,1),jd("f4",t,e,Gd,1,1,1),jd("u1",t,e,Gd,.7,1.1,-1),jd("u2",t,e,Gd,-.7,1.1,-1),jd("u3",t,e,Gd,0,2,-1),jd("cf1",t,e,Gd,-1,0,1),jd("cf2",t,e,Gd,1,0,1),jd("cf3",t,e,Gd,0,-1,1),jd("cf4",t,e,Gd,0,1,1),jd("cn1",t,e,Gd,-1,0,-1),jd("cn2",t,e,Gd,1,0,-1),jd("cn3",t,e,Gd,0,-1,-1),jd("cn4",t,e,Gd,0,1,-1),e.getAttribute("position").needsUpdate=!0};var Vd=new Fn;function Wd(e,t){this.object=e,void 0===t&&(t=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new Ur;r.setIndex(new Mr(i,1)),r.setAttribute("position",new Mr(n,3)),wl.call(this,r,new dl({color:t,toneMapped:!1})),this.matrixAutoUpdate=!1,this.update()}function qd(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Ur;n.setIndex(new Mr(i,1)),n.setAttribute("position",new Pr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),wl.call(this,n,new dl({color:t,toneMapped:!1})),this.geometry.computeBoundingSphere()}function $d(e,t,i){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var n=void 0!==i?i:16776960,r=new Ur;r.setAttribute("position",new Pr([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),yl.call(this,r,new dl({color:n,toneMapped:!1}));var a=new Ur;a.setAttribute("position",new Pr([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new sa(a,new wr({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}Wd.prototype=Object.create(wl.prototype),Wd.prototype.constructor=Wd,Wd.prototype.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Vd.setFromObject(this.object),!Vd.isEmpty()){var t=Vd.min,i=Vd.max,n=this.geometry.attributes.position,r=n.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=t.x,r[4]=i.y,r[5]=i.z,r[6]=t.x,r[7]=t.y,r[8]=i.z,r[9]=i.x,r[10]=t.y,r[11]=i.z,r[12]=i.x,r[13]=i.y,r[14]=t.z,r[15]=t.x,r[16]=i.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=i.x,r[22]=t.y,r[23]=t.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Wd.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Wd.prototype.copy=function(e){return wl.prototype.copy.call(this,e),this.object=e.object,this},Wd.prototype.clone=function(){return(new this.constructor).copy(this)},qd.prototype=Object.create(wl.prototype),qd.prototype.constructor=qd,qd.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Mn.prototype.updateMatrixWorld.call(this,e))},$d.prototype=Object.create(yl.prototype),$d.prototype.constructor=$d,$d.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?v:g,this.lookAt(this.plane.normal),Mn.prototype.updateMatrixWorld.call(this,e)};var Xd,Yd,Zd=new Zi;function Jd(e,t,i,n,r,a){Mn.call(this),void 0===e&&(e=new Zi(0,0,1)),void 0===t&&(t=new Zi(0,0,0)),void 0===i&&(i=1),void 0===n&&(n=16776960),void 0===r&&(r=.2*i),void 0===a&&(a=.2*r),void 0===Xd&&((Xd=new Ur).setAttribute("position",new Pr([0,0,0,0,1,0],3)),(Yd=new Gc(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new yl(Xd,new dl({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new sa(Yd,new wr({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,r,a)}function Kd(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new Ur;i.setAttribute("position",new Pr(t,3)),i.setAttribute("color",new Pr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new dl({vertexColors:!0,toneMapped:!1});wl.call(this,i,n)}Jd.prototype=Object.create(Mn.prototype),Jd.prototype.constructor=Jd,Jd.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Zd.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Zd,t)}},Jd.prototype.setLength=function(e,t,i){void 0===t&&(t=.2*e),void 0===i&&(i=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()},Jd.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},Jd.prototype.copy=function(e){return Mn.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},Jd.prototype.clone=function(){return(new this.constructor).copy(this)},Kd.prototype=Object.create(wl.prototype),Kd.prototype.constructor=Kd;var Qd,ep,tp,ip,np=Math.pow(2,8),rp=[.125,.215,.35,.446,.526,.582],ap=5+rp.length,sp={[Jt]:0,[Kt]:1,[ei]:2,[ii]:3,[ni]:4,[ri]:5,[Qt]:6},op=new ou,lp=(Qd=20,ep=new Float32Array(Qd),tp=new Zi(0,1,0),(ip=new Xc({defines:{n:Qd},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:ep},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:tp},inputEncoding:{value:sp[Jt]},outputEncoding:{value:sp[Jt]}},vertexShader:Pp(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n${Rp()}\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:w,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",ip),cp=null,hp=null,{_lodPlanes:up,_sizeLods:dp,_sigmas:pp}=function(){for(var e=[],t=[],i=[],n=8,r=0;r<ap;r++){var a=Math.pow(2,n);t.push(a);var s=1/a;r>4?s=rp[r-8+4-1]:0==r&&(s=0),i.push(s);for(var o=1/(a-1),l=-o/2,c=1+o/2,h=[l,l,c,l,c,c,l,l,c,c,l,c],u=new Float32Array(108),d=new Float32Array(72),p=new Float32Array(36),m=0;m<6;m++){var f=m%3*2/3-1,g=m>2?0:-1,v=[f,g,0,f+2/3,g,0,f+2/3,g+1,0,f,g,0,f+2/3,g+1,0,f,g+1,0];u.set(v,18*m),d.set(h,12*m);var y=[m,m,m,m,m,m];p.set(y,6*m)}var b=new Ur;b.setAttribute("position",new Mr(u,3)),b.setAttribute("uv",new Mr(d,2)),b.setAttribute("faceIndex",new Mr(p,1)),e.push(b),n>4&&n--}return{_lodPlanes:e,_sizeLods:t,_sigmas:i}}(),mp=null,fp=null,gp=null,vp=(1+Math.sqrt(5))/2,yp=1/vp,bp=[new Zi(1,1,1),new Zi(-1,1,1),new Zi(1,1,-1),new Zi(-1,1,-1),new Zi(0,vp,yp),new Zi(0,vp,-yp),new Zi(yp,0,vp),new Zi(-yp,0,vp),new Zi(vp,yp,0),new Zi(-vp,yp,0)];function xp(e){fp=e,Mp(lp)}function wp(e){var t={magFilter:ve,minFilter:ve,generateMipmaps:!1,type:e?e.type:Ce,format:e?e.format:Ve,encoding:e?e.encoding:ei,depthBuffer:!1,stencilBuffer:!1},i=Sp(t);return i.depthBuffer=!e,mp=Sp(t),i}function _p(e){mp.dispose(),fp.setRenderTarget(gp),e.scissorTest=!1,e.setSize(e.width,e.height)}function Mp(e){var t=new Sn;t.add(new sa(up[0],e)),fp.compile(t,op)}function Sp(e){var t=new Wi(3*np,3*np,e);return t.texture.mapping=de,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Tp(e,t,i,n,r){e.viewport.set(t,i,n,r),e.scissor.set(t,i,n,r)}function Ep(e){var t=fp.autoClear;fp.autoClear=!1;for(var i=1;i<ap;i++){Cp(e,i-1,i,Math.sqrt(pp[i]*pp[i]-pp[i-1]*pp[i-1]),bp[(i-1)%bp.length])}fp.autoClear=t}function Cp(e,t,i,n,r){Lp(e,mp,t,i,n,"latitudinal",r),Lp(mp,e,i,i,n,"longitudinal",r)}function Lp(e,t,i,n,r,a,s){"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var o=new Sn;o.add(new sa(up[n],lp));var l=lp.uniforms,c=dp[i]-1,h=isFinite(r)?Math.PI/(2*c):2*Math.PI/39,u=r/h,d=isFinite(r)?1+Math.floor(3*u):20;d>20&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${d} samples when the maximum is set to 20`);for(var p=[],m=0,f=0;f<20;++f){var g=f/u,v=Math.exp(-g*g/2);p.push(v),0==f?m+=v:f<d&&(m+=2*v)}for(f=0;f<p.length;f++)p[f]=p[f]/m;l.envMap.value=e.texture,l.samples.value=d,l.weights.value=p,l.latitudinal.value="latitudinal"===a,s&&(l.poleAxis.value=s),l.dTheta.value=h,l.mipInt.value=8-i,l.inputEncoding.value=sp[e.texture.encoding],l.outputEncoding.value=sp[e.texture.encoding];var y=dp[n];Tp(t,g=3*Math.max(0,np-2*y),(0===n?0:2*np)+2*y*(n>4?n-8+4:0),3*y,2*y),fp.setRenderTarget(t),fp.render(o,op)}function Ap(){var e=new Xc({uniforms:{envMap:{value:null},texelSize:{value:new Bi(1,1)},inputEncoding:{value:sp[Jt]},outputEncoding:{value:sp[Jt]}},vertexShader:Pp(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n${Rp()}\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:w,depthTest:!1,depthWrite:!1});return e.type="EquirectangularToCubeUV",e}function kp(){var e=new Xc({uniforms:{envMap:{value:null},inputEncoding:{value:sp[Jt]},outputEncoding:{value:sp[Jt]}},vertexShader:Pp(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n${Rp()}\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:w,depthTest:!1,depthWrite:!1});return e.type="CubemapToCubeUV",e}function Pp(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function Rp(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}function Op(e,t,i,n,r,a,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new yr(e,t,i,r,a,s)}xp.prototype={constructor:xp,fromScene:function(e,t=0,i=.1,n=100){gp=fp.getRenderTarget();var r=wp();return function(e,t,i,n){var r=new wa(90,1,t,i),a=[1,1,1,1,-1,1],s=[1,1,-1,-1,-1,1],o=fp.outputEncoding,l=fp.toneMapping,c=fp.toneMappingExposure,h=fp.getClearColor(),u=fp.getClearAlpha();fp.toneMapping=te,fp.toneMappingExposure=1,fp.outputEncoding=Jt,e.scale.z*=-1;var d=e.background;if(d&&d.isColor){d.convertSRGBToLinear();var p=Math.max(d.r,d.g,d.b),m=Math.min(Math.max(Math.ceil(Math.log2(p)),-128),127);d=d.multiplyScalar(Math.pow(2,-m));var f=(m+128)/255;fp.setClearColor(d,f),e.background=null}for(var g=0;g<6;g++){var v=g%3;0==v?(r.up.set(0,a[g],0),r.lookAt(s[g],0,0)):1==v?(r.up.set(0,0,a[g]),r.lookAt(0,s[g],0)):(r.up.set(0,a[g],0),r.lookAt(0,0,s[g])),Tp(n,v*np,g>2?np:0,np,np),fp.setRenderTarget(n),fp.render(e,r)}fp.toneMapping=l,fp.toneMappingExposure=c,fp.outputEncoding=o,fp.setClearColor(h,u),e.scale.z*=-1}(e,i,n,r),t>0&&Cp(r,0,0,t),Ep(r),_p(r),r},fromEquirectangular:function(e){return e.magFilter=ve,e.minFilter=ve,e.generateMipmaps=!1,this.fromCubemap(e)},fromCubemap:function(e){gp=fp.getRenderTarget();var t=wp(e);return function(e,t){var i=new Sn;e.isCubeTexture?null==hp&&(hp=kp()):null==cp&&(cp=Ap());var n=e.isCubeTexture?hp:cp;i.add(new sa(up[0],n));var r=n.uniforms;r.envMap.value=e,e.isCubeTexture||r.texelSize.value.set(1/e.image.width,1/e.image.height);r.inputEncoding.value=sp[e.encoding],r.outputEncoding.value=sp[e.encoding],Tp(t,0,0,3*np,2*np),fp.setRenderTarget(t),fp.render(i,op)}(e,t),Ep(t),_p(t),t},compileCubemapShader:function(){null==hp&&Mp(hp=kp())},compileEquirectangularShader:function(){null==cp&&Mp(cp=Ap())},dispose:function(){lp.dispose(),null!=hp&&hp.dispose(),null!=cp&&cp.dispose();for(var e=0;e<up.length;e++)up[e].dispose()}};var Ip=0,Dp=1,Np=0,zp=1,Fp=2;function Bp(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function Hp(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function Gp(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ll(e,t)}function Up(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Jo(e)}function jp(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ll(e,t)}function Vp(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ml(e)}function Wp(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ml(e)}function qp(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ml(e)}function $p(e,t,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Zi(e,t,i)}function Xp(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Mr(e,t).setUsage(Ei)}function Yp(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Sr(e,t)}function Zp(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Tr(e,t)}function Jp(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Er(e,t)}function Kp(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Cr(e,t)}function Qp(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Lr(e,t)}function em(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Ar(e,t)}function tm(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new kr(e,t)}function im(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Pr(e,t)}function nm(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Rr(e,t)}function rm(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Bh.call(this,e),this.type="catmullrom",this.closed=!0}function am(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Bh.call(this,e),this.type="catmullrom"}function sm(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Bh.call(this,e),this.type="catmullrom"}function om(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Kd(e)}function lm(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Wd(e,t)}function cm(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new wl(new Bc(e.geometry),new dl({color:void 0!==t?t:16777215}))}function hm(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new wl(new Il(e.geometry),new dl({color:void 0!==t?t:16777215}))}function um(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Sh(e)}function dm(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Ch(e)}function pm(e,t,i){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Ma(e,i)}Ph.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Ph.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Jh.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new pa,i=0,n=e.length;i<n;i++){var r=e[i];t.vertices.push(new Zi(r.x,r.y,r.z||0))}return t}}),Object.assign(Kh.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),rm.prototype=Object.create(Bh.prototype),am.prototype=Object.create(Bh.prototype),sm.prototype=Object.create(Bh.prototype),Object.assign(sm.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Id.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ld.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(_h.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),pu.extractUrlBase(e)}}),_h.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(yu.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(yd.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Fn.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Ca.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},wd.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Fi,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Fi.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Fi.ceilPowerOfTwo(e)}}),Object.assign(Hi.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(an.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Zi).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,i,n,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,i,r,a)}}),Qn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},$i.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Yn.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(hr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(hr,{barycoordFromPoint:function(e,t,i,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),hr.getBarycoord(e,t,i,n,r)},normal:function(e,t,i,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),hr.getNormal(e,t,i,n)}}),Object.assign(Qh.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Sc(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Nc(this,e)}}),Object.assign(Bi.prototype,{fromAttribute:function(e,t,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Zi.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Vi.prototype,{fromAttribute:function(e,t,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(pa.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(Mn.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Mn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(sa.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(sa.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Xt},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(tl.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(al.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),il.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Ph.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),wa.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(eu.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Mr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Ei},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Ei)}}}),Object.assign(Mr.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Ei:Ti),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ur.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new Mr(arguments[1],arguments[2])))},addDrawCall:function(e,t,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Ur.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(dd.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(Io.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Ei},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(Io.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Ei:Ti),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Tc.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(hd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(xr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new mr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===b}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Jc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ba.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Po.prototype,{clearTarget:function(e,t,i,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,i,n)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Po.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?Kt:Jt}}}),Object.defineProperties(So.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Wi.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(ju.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Au).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Yu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},_a.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var mm={merge:function(e,t,i){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,i)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};function fm(){console.error("THREE.CanvasRenderer has been removed")}function gm(){console.error("THREE.JSONLoader has been removed.")}Gi.crossOrigin=void 0,Gi.loadTexture=function(e,t,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new kh;r.setCrossOrigin(this.crossOrigin);var a=r.load(e,i,void 0,n);return t&&(a.mapping=t),a},Gi.loadTextureCube=function(e,t,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Ah;r.setCrossOrigin(this.crossOrigin);var a=r.load(e,i,void 0,n);return t&&(a.mapping=t),a},Gi.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Gi.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var vm={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function ym(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}}))},function(e,t,i){window,e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){e.exports=(e,t={})=>{const{ScrollSpy:n}=i(1),r=new n(e,t);return window.onload=r.onScroll(),window.addEventListener("scroll",()=>r.onScroll()),r}},function(e,t,i){"use strict";i.r(t),i.d(t,"ScrollSpy",(function(){return n}));class n{constructor(e,t={}){if(!e)throw new Error("First argument is query selector to your navigation.");if("object"!=typeof t)throw new Error("Second argument must be instance of Object.");this.menuList=e instanceof HTMLElement?e:document.querySelector(e),this.options=Object.assign({},{sectionClass:".scrollspy",menuActiveTarget:"li > a",offset:0,hrefAttribute:"href",activeClass:"active"},t),this.sections=document.querySelectorAll(this.options.sectionClass)}onScroll(){const e=this.getSectionInView(),t=this.getMenuItemBySection(e);t&&(this.removeCurrentActive({ignore:t}),this.setActive(t))}getMenuItemBySection(e){if(!e)return;const t=e.getAttribute("id");return this.menuList.querySelector(`[${this.options.hrefAttribute}="#${t}"]`)}getSectionInView(){for(let e=0;e<this.sections.length;e++){const t=this.sections[e].offsetTop,i=t+this.sections[e].offsetHeight,n=(document.documentElement.scrollTop||document.body.scrollTop)+this.options.offset;if(n>t&&n<=i)return this.sections[e]}}setActive(e){e.classList.contains(this.options.activeClass)||e.classList.add(this.options.activeClass)}removeCurrentActive({ignore:e}){const{hrefAttribute:t,menuActiveTarget:i}=this.options,n=`${i}.active:not([${t}="${e.getAttribute(t)}"])`;this.menuList.querySelectorAll(n).forEach(e=>e.classList.remove(this.options.activeClass))}}}])},function(e,t,i){i(6),i(4),e.exports=i(5)},function(e,t,i){var n,r,a;
/*! picturefill - v3.0.2 - 2016-02-12
 * https://scottjehl.github.io/picturefill/
 * Copyright (c) 2016 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT
 */r=window,a=navigator.userAgent,r.HTMLPictureElement&&/ecko/.test(a)&&a.match(/rv\:(\d+)/)&&RegExp.$1<45&&addEventListener("resize",function(){var e,t=document.createElement("source"),i=function(e){var i,n,r=e.parentNode;"PICTURE"===r.nodeName.toUpperCase()?(i=t.cloneNode(),r.insertBefore(i,r.firstElementChild),setTimeout((function(){r.removeChild(i)}))):(!e._pfLastSize||e.offsetWidth>e._pfLastSize)&&(e._pfLastSize=e.offsetWidth,n=e.sizes,e.sizes+=",100vw",setTimeout((function(){e.sizes=n})))},n=function(){var e,t=document.querySelectorAll("picture > img, img[srcset][sizes]");for(e=0;e<t.length;e++)i(t[e])},a=function(){clearTimeout(e),e=setTimeout(n,99)},s=r.matchMedia&&matchMedia("(orientation: landscape)"),o=function(){a(),s&&s.addListener&&s.addListener(a)};return t.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?o():document.addEventListener("DOMContentLoaded",o),a}()),function(r,a,s){"use strict";function o(e){return" "===e||"\t"===e||"\n"===e||"\f"===e||"\r"===e}function l(e,t,i,n){var r,a,s;return"saveData"===S.algorithm?e>2.7?s=i+1:(a=(t-i)*(r=Math.pow(e-.6,1.5)),n&&(a+=.1*r),s=e+a):s=i>1?Math.sqrt(e*t):e,s>i}function c(e,t){return e.res-t.res}function h(e,t,i){var n;return!i&&t&&(i=(i=e[f.ns].sets)&&i[i.length-1]),(n=u(t,i))&&(t=f.makeUrl(t),e[f.ns].curSrc=t,e[f.ns].curCan=n,n.res||Z(n,n.set.sizes)),n}function u(e,t){var i,n,r;if(e&&t)for(r=f.parseSet(t),e=f.makeUrl(e),i=0;i<r.length;i++)if(e===f.makeUrl(r[i].url)){n=r[i];break}return n}a.createElement("picture");var d,p,m,f={},g=!1,v=function(){},y=a.createElement("img"),b=y.getAttribute,x=y.setAttribute,w=y.removeAttribute,_=a.documentElement,M={},S={algorithm:""},T="data-pfsrc",E=T+"set",C=navigator.userAgent,L=/rident/.test(C)||/ecko/.test(C)&&C.match(/rv\:(\d+)/)&&RegExp.$1>35,A="currentSrc",k=/\s+\+?\d+(e\d+)?w/,P=/(\([^)]+\))?\s*(.+)/,R=r.picturefillCFG,O="font-size:100%!important;",I=!0,D={},N={},z=r.devicePixelRatio,F={px:1,in:96},B=a.createElement("a"),H=!1,G=/^[ \t\n\r\u000c]+/,U=/^[, \t\n\r\u000c]+/,j=/^[^ \t\n\r\u000c]+/,V=/[,]+$/,W=/^\d+$/,q=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,$=function(e,t,i,n){e.addEventListener?e.addEventListener(t,i,n||!1):e.attachEvent&&e.attachEvent("on"+t,i)},X=function(e){var t={};return function(i){return i in t||(t[i]=e(i)),t[i]}},Y=function(){var e=/^([\d\.]+)(em|vw|px)$/,t=X((function(e){return"return "+function(){for(var e=arguments,t=0,i=e[0];++t in e;)i=i.replace(e[t],e[++t]);return i}((e||"").toLowerCase(),/\band\b/g,"&&",/,/g,"||",/min-([a-z-\s]+):/g,"e.$1>=",/max-([a-z-\s]+):/g,"e.$1<=",/calc([^)]+)/g,"($1)",/(\d+[\.]*[\d]*)([a-z]+)/g,"($1 * e.$2)",/^(?!(e.[a-z]|[0-9\.&=|><\+\-\*\(\)\/])).*/gi,"")+";"}));return function(i,n){var r;if(!(i in D))if(D[i]=!1,n&&(r=i.match(e)))D[i]=r[1]*F[r[2]];else try{D[i]=new Function("e",t(i))(F)}catch(e){}return D[i]}}(),Z=function(e,t){return e.w?(e.cWidth=f.calcListLength(t||"100vw"),e.res=e.w/e.cWidth):e.res=e.d,e},J=function(e){if(g){var t,i,n,r=e||{};if(r.elements&&1===r.elements.nodeType&&("IMG"===r.elements.nodeName.toUpperCase()?r.elements=[r.elements]:(r.context=r.elements,r.elements=null)),n=(t=r.elements||f.qsa(r.context||a,r.reevaluate||r.reselect?f.sel:f.selShort)).length){for(f.setupRun(r),H=!0,i=0;n>i;i++)f.fillImg(t[i],r);f.teardownRun(r)}}};r.console&&console.warn,A in y||(A="src"),M["image/jpeg"]=!0,M["image/gif"]=!0,M["image/png"]=!0,M["image/svg+xml"]=a.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),f.ns=("pf"+(new Date).getTime()).substr(0,9),f.supSrcset="srcset"in y,f.supSizes="sizes"in y,f.supPicture=!!r.HTMLPictureElement,f.supSrcset&&f.supPicture&&!f.supSizes&&function(e){y.srcset="data:,a",e.src="data:,a",f.supSrcset=y.complete===e.complete,f.supPicture=f.supSrcset&&f.supPicture}(a.createElement("img")),f.supSrcset&&!f.supSizes?function(){var e="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",t=a.createElement("img"),i=function(){2===t.width&&(f.supSizes=!0),p=f.supSrcset&&!f.supSizes,g=!0,setTimeout(J)};t.onload=i,t.onerror=i,t.setAttribute("sizes","9px"),t.srcset=e+" 1w,data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw== 9w",t.src=e}():g=!0,f.selShort="picture>img,img[srcset]",f.sel=f.selShort,f.cfg=S,f.DPR=z||1,f.u=F,f.types=M,f.setSize=v,f.makeUrl=X((function(e){return B.href=e,B.href})),f.qsa=function(e,t){return"querySelector"in e?e.querySelectorAll(t):[]},f.matchesMedia=function(){return r.matchMedia&&(matchMedia("(min-width: 0.1em)")||{}).matches?f.matchesMedia=function(e){return!e||matchMedia(e).matches}:f.matchesMedia=f.mMQ,f.matchesMedia.apply(this,arguments)},f.mMQ=function(e){return!e||Y(e)},f.calcLength=function(e){var t=Y(e,!0)||!1;return 0>t&&(t=!1),t},f.supportsType=function(e){return!e||M[e]},f.parseSize=X((function(e){var t=(e||"").match(P);return{media:t&&t[1],length:t&&t[2]}})),f.parseSet=function(e){return e.cands||(e.cands=function(e,t){function i(t){var i,n=t.exec(e.substring(d));return n?(i=n[0],d+=i.length,i):void 0}function n(){var e,i,n,r,o,l,c,h,u,d=!1,m={};for(r=0;r<s.length;r++)l=(o=s[r])[o.length-1],c=o.substring(0,o.length-1),h=parseInt(c,10),u=parseFloat(c),W.test(c)&&"w"===l?((e||i)&&(d=!0),0===h?d=!0:e=h):q.test(c)&&"x"===l?((e||i||n)&&(d=!0),0>u?d=!0:i=u):W.test(c)&&"h"===l?((n||i)&&(d=!0),0===h?d=!0:n=h):d=!0;d||(m.url=a,e&&(m.w=e),i&&(m.d=i),n&&(m.h=n),n||i||e||(m.d=1),1===m.d&&(t.has1x=!0),m.set=t,p.push(m))}function r(){for(i(G),l="",c="in descriptor";;){if(h=e.charAt(d),"in descriptor"===c)if(o(h))l&&(s.push(l),l="",c="after descriptor");else{if(","===h)return d+=1,l&&s.push(l),void n();if("("===h)l+=h,c="in parens";else{if(""===h)return l&&s.push(l),void n();l+=h}}else if("in parens"===c)if(")"===h)l+=h,c="in descriptor";else{if(""===h)return s.push(l),void n();l+=h}else if("after descriptor"===c)if(o(h));else{if(""===h)return void n();c="in descriptor",d-=1}d+=1}}for(var a,s,l,c,h,u=e.length,d=0,p=[];;){if(i(U),d>=u)return p;a=i(j),s=[],","===a.slice(-1)?(a=a.replace(V,""),n()):r()}}(e.srcset,e)),e.cands},f.getEmValue=function(){var e;if(!d&&(e=a.body)){var t=a.createElement("div"),i=_.style.cssText,n=e.style.cssText;t.style.cssText="position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)",_.style.cssText=O,e.style.cssText=O,e.appendChild(t),d=t.offsetWidth,e.removeChild(t),d=parseFloat(d,10),_.style.cssText=i,e.style.cssText=n}return d||16},f.calcListLength=function(e){if(!(e in N)||S.uT){var t=f.calcLength(function(e){function t(e){return!!(c.test(e)&&parseFloat(e)>=0)||(!!h.test(e)||("0"===e||"-0"===e||"+0"===e))}var i,n,r,a,s,l,c=/^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i,h=/^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;for(n=function(e){function t(){r&&(a.push(r),r="")}function i(){a[0]&&(s.push(a),a=[])}for(var n,r="",a=[],s=[],l=0,c=0,h=!1;;){if(""===(n=e.charAt(c)))return t(),i(),s;if(h){if("*"===n&&"/"===e[c+1]){h=!1,c+=2,t();continue}c+=1}else{if(o(n)){if(e.charAt(c-1)&&o(e.charAt(c-1))||!r){c+=1;continue}if(0===l){t(),c+=1;continue}n=" "}else if("("===n)l+=1;else if(")"===n)l-=1;else{if(","===n){t(),i(),c+=1;continue}if("/"===n&&"*"===e.charAt(c+1)){h=!0,c+=2;continue}}r+=n,c+=1}}}(e),r=n.length,i=0;r>i;i++)if(t(s=(a=n[i])[a.length-1])){if(l=s,a.pop(),0===a.length)return l;if(a=a.join(" "),f.matchesMedia(a))return l}return"100vw"}(e));N[e]=t||F.width}return N[e]},f.setRes=function(e){var t;if(e)for(var i=0,n=(t=f.parseSet(e)).length;n>i;i++)Z(t[i],e.sizes);return t},f.setRes.res=Z,f.applySetCandidate=function(e,t){if(e.length){var i,n,r,a,s,o,u,d,p,m=t[f.ns],g=f.DPR;if(o=m.curSrc||t[A],(u=m.curCan||h(t,o,e[0].set))&&u.set===e[0].set&&((p=L&&!t.complete&&u.res-.1>g)||(u.cached=!0,u.res>=g&&(s=u))),!s)for(e.sort(c),s=e[(a=e.length)-1],n=0;a>n;n++)if((i=e[n]).res>=g){s=e[r=n-1]&&(p||o!==f.makeUrl(i.url))&&l(e[r].res,i.res,g,e[r].cached)?e[r]:i;break}s&&(d=f.makeUrl(s.url),m.curSrc=d,m.curCan=s,d!==o&&f.setSrc(t,s),f.setSize(t))}},f.setSrc=function(e,t){var i;e.src=t.url,"image/svg+xml"===t.set.type&&(i=e.style.width,e.style.width=e.offsetWidth+1+"px",e.offsetWidth+1&&(e.style.width=i))},f.getSet=function(e){var t,i,n,r=!1,a=e[f.ns].sets;for(t=0;t<a.length&&!r;t++)if((i=a[t]).srcset&&f.matchesMedia(i.media)&&(n=f.supportsType(i.type))){"pending"===n&&(i=n),r=i;break}return r},f.parseSets=function(e,t,i){var n,r,a,o,l=t&&"PICTURE"===t.nodeName.toUpperCase(),c=e[f.ns];(c.src===s||i.src)&&(c.src=b.call(e,"src"),c.src?x.call(e,T,c.src):w.call(e,T)),(c.srcset===s||i.srcset||!f.supSrcset||e.srcset)&&(n=b.call(e,"srcset"),c.srcset=n,o=!0),c.sets=[],l&&(c.pic=!0,function(e,t){var i,n,r,a,s=e.getElementsByTagName("source");for(i=0,n=s.length;n>i;i++)(r=s[i])[f.ns]=!0,(a=r.getAttribute("srcset"))&&t.push({srcset:a,media:r.getAttribute("media"),type:r.getAttribute("type"),sizes:r.getAttribute("sizes")})}(t,c.sets)),c.srcset?(r={srcset:c.srcset,sizes:b.call(e,"sizes")},c.sets.push(r),(a=(p||c.src)&&k.test(c.srcset||""))||!c.src||u(c.src,r)||r.has1x||(r.srcset+=", "+c.src,r.cands.push({url:c.src,d:1,set:r}))):c.src&&c.sets.push({srcset:c.src,sizes:null}),c.curCan=null,c.curSrc=s,c.supported=!(l||r&&!f.supSrcset||a&&!f.supSizes),o&&f.supSrcset&&!c.supported&&(n?(x.call(e,E,n),e.srcset=""):w.call(e,E)),c.supported&&!c.srcset&&(!c.src&&e.src||e.src!==f.makeUrl(c.src))&&(null===c.src?e.removeAttribute("src"):e.src=c.src),c.parsed=!0},f.fillImg=function(e,t){var i,n=t.reselect||t.reevaluate;e[f.ns]||(e[f.ns]={}),i=e[f.ns],(n||i.evaled!==m)&&((!i.parsed||t.reevaluate)&&f.parseSets(e,e.parentNode,t),i.supported?i.evaled=m:function(e){var t,i=f.getSet(e),n=!1;"pending"!==i&&(n=m,i&&(t=f.setRes(i),f.applySetCandidate(t,e))),e[f.ns].evaled=n}(e))},f.setupRun=function(){(!H||I||z!==r.devicePixelRatio)&&(I=!1,z=r.devicePixelRatio,D={},N={},f.DPR=z||1,F.width=Math.max(r.innerWidth||0,_.clientWidth),F.height=Math.max(r.innerHeight||0,_.clientHeight),F.vw=F.width/100,F.vh=F.height/100,m=[F.height,F.width,z].join("-"),F.em=f.getEmValue(),F.rem=F.em)},f.supPicture?(J=v,f.fillImg=v):function(){var e,t=r.attachEvent?/d$|^c/:/d$|^c|^i/,i=function(){var r=a.readyState||"";n=setTimeout(i,"loading"===r?200:999),a.body&&(f.fillImgs(),(e=e||t.test(r))&&clearTimeout(n))},n=setTimeout(i,a.body?9:99),s=_.clientHeight;$(r,"resize",function(e,t){var i,n,r=function(){var a=new Date-n;t>a?i=setTimeout(r,t-a):(i=null,e())};return function(){n=new Date,i||(i=setTimeout(r,t))}}((function(){I=Math.max(r.innerWidth||0,_.clientWidth)!==F.width||_.clientHeight!==s,s=_.clientHeight,I&&f.fillImgs()}),99)),$(a,"readystatechange",i)}(),f.picturefill=J,f.fillImgs=J,f.teardownRun=v,J._=f,r.picturefillCFG={pf:f,push:function(e){var t=e.shift();"function"==typeof f[t]?f[t].apply(f,e):(S[t]=e[0],H&&f.fillImgs({reselect:!0}))}};for(;R&&R.length;)r.picturefillCFG.push(R.shift());r.picturefill=J,"object"==typeof e.exports?e.exports=J:void 0!==(n=function(){return J}.call(t,i,t,e))&&(e.exports=n),f.supPicture||(M["image/webp"]=function(e,t){var i=new r.Image;return i.onerror=function(){M[e]=!1,J()},i.onload=function(){M[e]=1===i.width,J()},i.src=t,"pending"}("image/webp","data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA=="))}(window,document)},function(e,t,i){},function(e,t){e.exports='<!doctype html> <html lang=ru> <head> <meta charset=UTF-8> <meta name=description content=""> <meta name=viewport content="width=device-width,initial-scale=1"> <meta http-equiv=X-UA-Compatible content="ie=edge"> <title>Illusion</title> </head> <body> <div class=global-wrapper> <header class="page-header js-header"> <div class=page-header__wrapper> <div class=page-header__period>13—19<span class=desktop>.04.2020</span><span class=mobile>апреля</span></div> <a class=page-header__logo>иллюзион</a> <div class=page-header__nav> <ul class=page-header__social> <li> <a href=# target=_blank class=social-btn aria-label="Мы в Facebook"> <span>fb</span> </a> </li> <li> <a href=# target=_blank class=social-btn aria-label="Мы ВКонтакте"> <span>vk</span> </a> </li> </ul> <div class=page-header__cart> <a href=# class="page-header__btn btn" aria-label="Перейти к корзине"> <svg width=260 height=250 viewbox="0 0 26 25" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M25 7.37378H1V23.9565H25V7.37378Z" stroke=currentColor stroke-miterlimit=10></path> <path d="M6.6571 7.37382C6.6571 3.85471 9.49787 1 12.9998 1C16.5017 1 19.3424 3.85471 19.3424 7.37382" stroke=currentColor stroke-miterlimit=10></path> <circle cx=13 cy=16 r=2.50001 id=eye_apple class=eye_apple fill=currentColor mask=url(#upper_eyelid_mask)></circle> <path class="upper_eyelid temp" id=upper_eyelid stroke=currentColor d="M6.5 16 C 7.5 10.5, 18.5 10.5 19.5 16 C18.5 21.5 7.5 21.5 6.5 15.5Z"></path> <mask id=upper_eyelid_mask fill=#fff> <use xlink:href=#upper_eyelid></use> </mask> <animate id=eye_apple_move xlink:href=#eye_apple attributename=cx values="13; 16; 16; 13; 10; 10; 13; 13; 13; 13; 16; 16; 13; 10; 10; 13; 16; 16; 13; 13" keytimes="0; 0.01; 0.04; 0.05; 0.06; 0.1; 0.12; 0.16; 0.18; 0.5; 0.51; 0.54; 0.55; 0.56; 0.6; 0.63; 0.65; 0.71; 0.73; 1" begin=4.2s;eye_apple_move.begin+23s dur=20s></animate> <animate xlink:href=#eye_apple attributename=cy values="16; 16; 16; 16; 16; 16; 18; 18; 16; 16; 16; 16; 16; 16; 16; 16; 17; 17; 16; 16" keytimes="0; 0.01; 0.04; 0.05; 0.06; 0.1; 0.12; 0.16; 0.18; 0.5; 0.51; 0.54; 0.55; 0.56; 0.6; 0.63; 0.65; 0.71; 0.73; 1" begin=4.2s;eye_apple_move.begin+23s dur=20s></animate> <animate xlink:href=#eye_apple attributename=r values="2.6; 2.0; 2.0; 2.6; 2.0; 2.0; 2.0; 2.0; 2.6; 2.6; 2.0; 2.0; 2.6; 2.0; 2.0; 2.2; 2.0; 2.0; 2.6; 2.6" keytimes="0; 0.01; 0.04; 0.05; 0.06; 0.1; 0.12; 0.16; 0.18; 0.5; 0.51; 0.54; 0.55; 0.56; 0.6; 0.63; 0.65; 0.71; 0.73; 1" begin=4.2s;eye_apple_move.begin+23s dur=20s></animate> <animate id=upper_eyelid_close xlink:href=#upper_eyelid attributename=d to="M6.5 16 C 7.5 18.5, 18.5 18.5 19.5 16 C18.5 21.5 7.5 21.5 6.5 15.5Z" begin=250ms;1500ms;2000ms;4000ms;7000ms;8250ms;10500ms;13300ms;15700ms;16300ms;upper_eyelid_close.begin+19300ms dur=75ms fill=freeze></animate> <animate id=upper_eyelid_open xlink:href=#upper_eyelid attributename=d to="M6.5 16 C 7.5 10.5, 18.5 10.5 19.5 16 C18.5 21.5 7.5 21.5 6.5 15.5Z" dur=75ms begin="upper_eyelid_close.end + 30ms" fill=freeze></animate> </svg> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <div class=page-header__cart-number>0</div> </a> </div> </div> </div> </header> <div class="main-menu js-menu" id=menu> <a class=main-menu__logo>иллюзион</a> <div class="main-menu__overlay js-overlay"></div> <button class="btn main-menu__toggler js-menu-toggler" type=button aria-label="Управление меню"> <span class=main-menu__toggler-line></span> </button> <ul class=main-menu__list> <li class=main-menu__item> <a href=#top data-href=top class="main-menu__link js-menu-link" data-scrollspy=#top> <span class=main-menu__link-icon> <svg width=25 height=24 viewbox="0 0 27 26" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M1 13.1932L13.6029 1L26 13.1932" stroke=currentColor stroke-dasharray=35 stroke-dashoffset=35></path> <path d="M13.5837 1L3.38037 10.8685V25H23.6197V10.8685L13.5837 1Z" stroke=currentColor stroke-dasharray=77 stroke-dashoffset=77></path> <path d="M16.9547 12.6497H10.0453V19.6827H16.9547V12.6497Z" stroke=currentColor stroke-dasharray=27 stroke-dashoffset=27></path> </svg> </span> <span class=main-menu__link-text>Главная</span> </a> </li> <li class=main-menu__item> <a href=#about data-href=about class="main-menu__link js-menu-link" data-scrollspy=#about> <span class=main-menu__link-icon> <svg width=24 height=19 viewbox="0 0 26 21" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M20.8683 1H5.13171V20H20.8683V1Z" stroke=currentColor stroke-dasharray=70 stroke-dashoffset=70></path> <path d="M0 1H26" stroke=currentColor class=active-purple stroke-dasharray=26 stroke-dashoffset=26></path> <path d="M5.13171 5.2229H20.8683" stroke=currentColor stroke-dasharray=16 stroke-dashoffset=16></path> </svg> </span> <span class=main-menu__link-text>о фестивале</span> </a> </li> <li class=main-menu__item> <a href=#show data-href=show class="main-menu__link js-menu-link" data-scrollspy=#show> <span class=main-menu__link-icon> <svg width=29 height=28 viewbox="0 0 31 30" fill=none xmlns=http://www.w3.org/2000/svg> <path class=active-purple d="M15.4974 2L18.6881 11.9328H29L20.6559 18.0672L23.8415 28L15.4974 21.8655L7.15338 28L10.3441 18.0672L2 11.9328H12.3119L15.4974 2Z" stroke=currentColor stroke-dasharray=104 stroke-dashoffset=104></path> </svg> </span> <span class=main-menu__link-text>шоу-программа</span> </a> </li> <li class=main-menu__item> <a href=#mc data-href=mc class="main-menu__link js-menu-link" data-scrollspy=#mc> <span class=main-menu__link-icon> <svg width=27 height=24 viewbox="0 0 24 19" fill=none xmlns=http://www.w3.org/2000/svg> <path class=active-purple d="M22.3148 14.1561C22.8829 13.1022 23.1315 11.8583 22.9318 10.5452C22.5323 7.93214 20.3129 5.88486 17.6097 5.61707C16.1405 5.47022 14.7689 5.84167 13.6548 6.55865C12.8647 7.06831 11.5997 7.42248 10.5521 7.35769C10.2858 7.34042 10.0816 7.09854 10.1349 6.84371C10.2104 6.47658 10.237 5.88054 9.96179 5.07286C10.6853 4.93896 11.4355 4.72301 12.1945 4.41634C14.1031 3.64321 15.599 2.49432 16.3758 1.32814C14.9776 1.0474 13.0822 1.26767 11.178 2.03649C10.2814 2.39929 9.47797 2.84849 8.79441 3.34087C8.17742 2.84849 7.39177 2.55478 6.53066 2.55478C3.09952 2.55478 1 5.6905 1 6.70982C1 8.42453 2.30499 9.30132 5.35883 9.46976C5.66067 9.48704 5.85153 9.78938 5.73168 10.0572C5.37215 10.8346 5.23011 11.7287 5.3899 12.6659C5.71837 14.6096 7.35182 16.1472 9.35813 16.4107C9.41139 16.4193 9.46465 16.4193 9.51792 16.4236V16.6007H7.8312C7.03667 16.6007 6.39306 17.227 6.39306 18.0001H18.9236C19.4163 18.0001 19.7758 17.5984 19.7803 17.119C19.7847 16.821 19.9445 16.5489 20.2019 16.3891C20.3395 16.3027 20.4771 16.2077 20.6059 16.1126C20.9033 16.4668 21.3782 16.6741 21.902 16.5791C22.4613 16.4798 22.9051 16.0219 22.9806 15.4734C23.0649 14.9033 22.772 14.4066 22.3148 14.1561Z" stroke=currentColor stroke-dasharray=87 stroke-dashoffset=87 stroke-linejoin=round></path> </svg> </span> <span class=main-menu__link-text>мастер-классы</span> </a> </li> <li class=main-menu__item> <a href=#map data-href=map class="main-menu__link js-menu-link" data-scrollspy=#map> <span class=main-menu__link-icon> <svg width=24 height=24 viewbox="0 0 27 27" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M13.5 26C20.4036 26 26 20.4035 26 13.5C26 6.59643 20.4036 1 13.5 1C6.59644 1 1 6.59643 1 13.5C1 20.4035 6.59644 26 13.5 26Z" stroke=currentColor stroke-dasharray=78 stroke-dashoffset=78></path> <path d="M13.5 26C16.1205 26 18.2449 20.4035 18.2449 13.5C18.2449 6.59643 16.1205 1 13.5 1C10.8795 1 8.75513 6.59643 8.75513 13.5C8.75513 20.4035 10.8795 26 13.5 26Z" stroke=currentColor stroke-dasharray=57 stroke-dashoffset=57></path> <path d="M1 13.5H26" stroke=currentColor stroke-dasharray=25 stroke-dashoffset=25></path> <path d="M2.57263 7.60107H24.4274" stroke=currentColor stroke-dasharray=22 stroke-dashoffset=22></path> <path d="M2.57263 19.3989H24.4274" stroke=currentColor stroke-dasharray=22 stroke-dashoffset=22></path> </svg> </span> <span class=main-menu__link-text>карта фестиваля</span> </a> </li> <li class=main-menu__item> <a href=#tickets data-href=tickets class="main-menu__link js-menu-link" data-scrollspy=#tickets> <span class=main-menu__link-icon> <svg width=26 height=26 viewbox="0 0 30 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M17.3945 5.71436H1V29.9999H17.3945V5.71436Z" stroke=currentColor stroke-dasharray=82 stroke-dashoffset=82></path> <path d="M12.8724 16.4755C15.6236 19.2391 11.9228 23.0778 9.17669 20.3142C6.5897 22.9992 2.83241 19.2234 5.4194 16.5384L9.11509 12.6997L12.8724 16.4755Z" stroke=currentColor stroke-dasharray=29 stroke-dashoffset=29 stroke-linejoin=round></path> <path d="M9.17676 20.314V23.0199" stroke=currentColor stroke-dasharray=3 stroke-dashoffset=3 stroke-linejoin=round></path> <path d="M7.60083 23.02H10.7524" stroke=currentColor stroke-dasharray=4 stroke-dashoffset=4 stroke-linejoin=round></path> <path d="M11.9075 5.74068L13.3036 1L29.0001 5.82458L22.1528 29.0823L17.7282 27.7241" stroke=currentColor stroke-dasharray=51 stroke-dashoffset=51></path> </svg> </span> <span class=main-menu__link-text>билеты</span> </a> </li> </ul> <ul class=main-menu__social> <li> <a href=# class=social-btn aria-label="Мы в Facebook"> <span>fb</span> </a> </li> <li> <a href=# class=social-btn aria-label="Мы ВКонтакте"> <span>vk</span> </a> </li> </ul> </div> <main class=page-content> <div class=animation-screen></div> <section class="screen screen--hidden screen--intro js-scrollspy" id=top> <div class=screen__wrapper> <div class=intro> <h1 class=intro__title> <span class=intro__text> Фестиваль магического искусства иллюзион </span> <span class=intro__title-line> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> </span> </h1> <a href=#about class=intro__scroll-link aria-label="Перейти к следующему экрану"> <svg width=17 height=28 fill=none> <use xlink:href=img/sprite_auto.svg#arr-down></use> </svg> </a> </div> </div> </section> <section class="screen screen--hidden screen--slogan js-scrollspy" id=about> <div class=screen__wrapper> <h2 class=slogan><span class="slogan__col slogan__col--1">Самое масштабное<br>&#x20;яркое</span> <br><span class="slogan__col slogan__col--2">Поражающее воображение</span> <span class="slogan__col slogan__col--3">событие года</span></h2> </div> </section> <section class="screen screen--hidden screen--features" id=numbers> <div class=screen__wrapper> <ul class=features-list id=js-features-list> <li class=features-list__item> <span class=features-list__item-icon> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> </span> <span class="features-list__item-value features-list__item-value_4" data-animate-count=50>50</span> <span class=features-list__item-feature>иллюзионистов</span> </li> <li class=features-list__item> <span class=features-list__item-icon> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> </span> <span class="features-list__item-value features-list__item-value_2" data-animate-count=20>20</span> <span class=features-list__item-feature>стран</span> </li> <li class=features-list__item> <span class=features-list__item-icon> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> </span> <span class="features-list__item-value features-list__item-value_4" data-animate-count=1100 data-animate-fps=60>1100</span> <span class=features-list__item-feature>м <sup>2</sup></span> </li> <li class=features-list__item> <span class=features-list__item-icon> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> </span> <span class="features-list__item-value features-list__item-value_2" data-animate-count=7>7</span> <span class=features-list__item-feature>дней</span> </li> <li class=features-list__item> <span class=features-list__item-icon> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> </span> <span class="features-list__item-value features-list__item-value_4" data-animate-count=103>103</span> <span class=features-list__item-feature>незабываемых&nbsp;шоу</span> </li> </ul> </div> </section> <section class="screen screen--hidden screen--show js-scrollspy" id=show> <div class=screen__image> <canvas class=canvas-fw-fh id=poster-bg-canvas></canvas> <canvas class=canvas-fw-fh id=poster-canvas></canvas> <canvas class=canvas-fw-fh id=whale-canvas></canvas> </div> <div class=screen__wrapper> <div class=show> <h2 class=show__title>шоу-программа:</h2> <div class=show__info> <div class=show__col> <a href=# class=show__link> <span>Amato Jakomo</span> </a> <p class=show__text>Амато&nbsp;<br>Джакомо</p> </div> <div class=show__col> <p class=show__date>15.04.2020</p> <p class="show__text show__text-2">Вызов&nbsp;<br>силам природы</p> </div> </div> </div> </div> </section> <section class="screen screen--hidden screen--mc js-scrollspy" id=mc> <div class=screen__wrapper> <div class=slider> <h2 class=slider__title>мастер-классы</h2> <div class="slider__el swiper-container js-slider"> <div class=swiper-wrapper> <div class="slider__item swiper-slide"> <div class=slider__content> <h3 class=slider__subtitle>Для новичков</h3> <ul class=slider__list> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>фокусы с&nbsp;картами и&nbsp;мелкими предметами</span> </li> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>актерское мастерство для&nbsp;фокусника</span> </li> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>секреты фокусов</span> </li> </ul> </div> </div> <div class="slider__item swiper-slide"> <div class=slider__content> <h3 class=slider__subtitle>Для детей</h3> <ul class=slider__list> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>фокусы с&nbsp;монетой</span> </li> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>фокусы с&nbsp;перестановкой цифр</span> </li> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>фокусы с&nbsp;перестановкой цифр</span> </li> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>актерское мастерство для самых маленьких</span> </li> </ul> </div> </div> <div class="slider__item swiper-slide"> <div class=slider__content> <h3 class=slider__subtitle>Для опытных</h3> <ul class=slider__list> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>сложные фокусы с&nbsp;картами</span> </li> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>как создать шоу-иллюзию</span> </li> <li> <svg width=31 height=31 class=whiff viewbox="0 0 31 31" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M15.4966 0V9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M15.4966 31V21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M31 15.4966H21.29" stroke=currentColor stroke-miterlimit=10></path> <path d="M0 15.4966H9.70317" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 4.53992L19.5962 11.404" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 26.4601L11.4041 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M26.4602 26.4601L19.5962 19.5961" stroke=currentColor stroke-miterlimit=10></path> <path d="M4.54004 4.53992L11.4041 11.404" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>микромагия</span> </li> </ul> </div> </div> </div> <div class=slider__controls> <button class="slider__control slider__control--prev swiper-button-prev" type=button aria-label="Перейти к предыдущему слайду"> <svg width=42 height=25 fill=none> <use xlink:href=img/sprite_auto.svg#arr-prev></use> </svg> </button> <button class="slider__control slider__control--next swiper-button-next" type=button aria-label="Перейти к следующему слайду"> <svg width=42 height=25 fill=none> <use xlink:href=img/sprite_auto.svg#arr-next></use> </svg> </button> <div class="slider__pagination swiper-pagination"></div> </div> </div> </div> </div> </section> <section class="screen screen--hidden screen--map js-scrollspy" id=map> <div class=map> <h2 class=map__title>Карта мероприятия</h2> <div class=map__content> <div class=map__decor> <img class="trees trees-focus" src=img/map-tree-two.svg alt=""> <img class="trees trees-focus2" src=img/map-tree-two.svg alt=""> <img class="trees trees-toilet" src=img/map-tree-two.svg alt=""> <img class="trees trees-toilet2" src=img/map-tree-two.svg alt=""> <img class="trees trees-food" src=img/map-tree-two.svg alt=""> <img class="trees trees-center" src=img/map-tree-one.svg alt=""> <img class="cloud cloud-left" src=img/map-cloud-one.svg alt=""> <img class="cloud cloud-right" src=img/map-cloud-two.svg alt=""> <img class=fish src=img/map-fish.svg alt=""> <span class="bird bird-1-left"> <span class=bird-wrap><img class=bird-img src=img/bird.svg alt=""></span> </span> <span class="bird bird-1-right"> <span class=bird-wrap><img class=bird-img src=img/bird-2.svg alt=""></span> </span> <span class="bird bird-2"> <span class=bird-wrap><img class=bird-img src=img/bird-2.svg alt=""></span> </span> <span class="bird bird-3"> <span class=bird-wrap><img class=bird-img src=img/bird.svg alt=""></span> </span> <span class="bird bird-4-left"> <span class=bird-wrap><img class=bird-img src=img/bird-2.svg alt=""></span> </span> <span class="bird bird-4-right"> <span class=bird-wrap><img class=bird-img src=img/bird.svg alt=""></span> </span> </div> <div class=map__controls> <button class="map__entrance map__entrance--first" type=button> <span>вход 1</span> </button> <button class="map__entrance map__entrance--second" type=button> <span>вход 2</span> </button> <button class="map__place map__place--food" type=button> <svg width=25 height=22 viewbox="0 0 25 22" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M23.8127 8.39418H1.18042C1.18042 4.21733 4.56421 0.834473 8.74218 0.834473H16.251C20.429 0.834473 23.8127 4.22215 23.8127 8.39418Z" fill=currentColor></path> <path d="M18.34 21.2994H6.6532C3.63042 21.2994 1.18042 18.8501 1.18042 15.8281H23.8127C23.8127 18.8501 21.3628 21.2994 18.34 21.2994Z" fill=currentColor></path> <path d="M1.18042 10.5547H23.8127" stroke=currentColor stroke-miterlimit=10></path> <path d="M0.218262 12.0654C3.28917 12.0654 3.28918 14.3175 6.36009 14.3175C9.431 14.3175 9.431 12.0654 12.5019 12.0654C15.5728 12.0654 15.5728 14.3175 18.6437 14.3175C21.7146 14.3175 21.7146 12.0654 24.7856 12.0654" stroke=currentColor stroke-miterlimit=10></path> </svg> <span>фудкорт</span> </button> <button class="map__place map__place--wc map__place--wc1" type=button> <svg width=20 height=20 viewbox="0 0 20 20" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M4.42333 8.24874L0.846191 19.9138H9.43455L5.85741 8.24874C5.67141 7.63584 4.61202 7.63584 4.42333 8.24874Z" fill=currentColor></path> <path d="M15.9614 19.4544L19.5386 7.78932L10.9502 7.78932L14.5274 19.4544C14.7134 20.0673 15.7727 20.0673 15.9614 19.4544Z" fill=currentColor></path> <circle cx=5.14065 cy=2.99001 r=2.77859 fill=currentColor></circle> <circle cx=15.2446 cy=2.99001 r=2.77859 fill=currentColor></circle> </svg> <span>туалет</span> </button> <button class="map__place map__place--wc map__place--wc2" type=button> <svg width=20 height=20 viewbox="0 0 20 20" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M4.42333 8.24874L0.846191 19.9138H9.43455L5.85741 8.24874C5.67141 7.63584 4.61202 7.63584 4.42333 8.24874Z" fill=currentColor></path> <path d="M15.9614 19.4544L19.5386 7.78932L10.9502 7.78932L14.5274 19.4544C14.7134 20.0673 15.7727 20.0673 15.9614 19.4544Z" fill=currentColor></path> <circle cx=5.14065 cy=2.99001 r=2.77859 fill=currentColor></circle> <circle cx=15.2446 cy=2.99001 r=2.77859 fill=currentColor></circle> </svg> <span>туалет</span> </button> <button class="map__info map__info--1" type=button> <svg width=45 height=45 viewbox="0 0 45 45" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M45 22.5016L35.3607 25.5156L42.7748 32.5175L32.8159 30.9325L36.5307 40.5411L28.2228 34.6945L27.5028 45L22.5 36.028L17.4972 45L16.7772 34.6945L8.46931 40.5411L12.1841 30.9325L2.22517 32.5175L9.63931 25.5156L0 22.5016L9.63931 19.4844L2.22517 12.4857L12.1841 14.0707L8.46931 4.46213L16.7772 10.3087L17.4972 0L22.5 8.97518L27.5028 0L28.2228 10.3087L36.5307 4.46213L32.8159 14.0707L42.7748 12.4857L35.3607 19.4844L45 22.5016Z" fill=#C78FFF></path> </svg> <b>i</b> <span>стойка <br>информации</span> </button> <button class="map__info map__info--2" type=button> <svg width=45 height=45 viewbox="0 0 45 45" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M45 22.5016L35.3607 25.5156L42.7748 32.5175L32.8159 30.9325L36.5307 40.5411L28.2228 34.6945L27.5028 45L22.5 36.028L17.4972 45L16.7772 34.6945L8.46931 40.5411L12.1841 30.9325L2.22517 32.5175L9.63931 25.5156L0 22.5016L9.63931 19.4844L2.22517 12.4857L12.1841 14.0707L8.46931 4.46213L16.7772 10.3087L17.4972 0L22.5 8.97518L27.5028 0L28.2228 10.3087L36.5307 4.46213L32.8159 14.0707L42.7748 12.4857L35.3607 19.4844L45 22.5016Z" fill=#C78FFF></path> </svg> <b>i</b> <span>стойка <br>информации</span> </button> <button class="map__info map__info--3" type=button> <svg width=45 height=45 viewbox="0 0 45 45" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M45 22.5016L35.3607 25.5156L42.7748 32.5175L32.8159 30.9325L36.5307 40.5411L28.2228 34.6945L27.5028 45L22.5 36.028L17.4972 45L16.7772 34.6945L8.46931 40.5411L12.1841 30.9325L2.22517 32.5175L9.63931 25.5156L0 22.5016L9.63931 19.4844L2.22517 12.4857L12.1841 14.0707L8.46931 4.46213L16.7772 10.3087L17.4972 0L22.5 8.97518L27.5028 0L28.2228 10.3087L36.5307 4.46213L32.8159 14.0707L42.7748 12.4857L35.3607 19.4844L45 22.5016Z" fill=#C78FFF></path> </svg> <b>i</b> <span>стойка <br>информации</span> </button> <button class="map__event map__event--main js-modal-trigger" data-target=main-scene type=button> <svg width=37 height=23 viewbox="0 0 37 23" fill=none xmlns=http://www.w3.org/2000/svg> <mask id=path-1-inside-1 fill=white> <path fill-rule=evenodd clip-rule=evenodd d="M0.5 11.5773C3.99984 5.24046 10.7487 0.94873 18.4999 0.94873C26.2512 0.94873 33 5.24046 36.4999 11.5773C33 17.9141 26.2512 22.2059 18.4999 22.2059C10.7487 22.2059 3.99984 17.9141 0.5 11.5773Z"></path> </mask> <path d="M0.5 11.5773L-0.375364 11.0938L-0.642382 11.5773L-0.375364 12.0608L0.5 11.5773ZM36.4999 11.5773L37.3752 12.0608L37.6423 11.5773L37.3752 11.0938L36.4999 11.5773ZM1.37536 12.0608C4.70631 6.02973 11.1272 1.94873 18.4999 1.94873V-0.0512695C10.3702 -0.0512695 3.29337 4.4512 -0.375364 11.0938L1.37536 12.0608ZM18.4999 1.94873C25.8726 1.94873 32.2936 6.02972 35.6245 12.0608L37.3752 11.0938C33.7065 4.4512 26.6297 -0.0512695 18.4999 -0.0512695V1.94873ZM35.6245 11.0938C32.2936 17.1249 25.8726 21.2059 18.4999 21.2059V23.2059C26.6297 23.2059 33.7065 18.7034 37.3752 12.0608L35.6245 11.0938ZM18.4999 21.2059C11.1272 21.2059 4.70631 17.1249 1.37536 11.0938L-0.375364 12.0608C3.29337 18.7034 10.3702 23.2059 18.4999 23.2059V21.2059Z" fill=currentColor mask=url(#path-1-inside-1)></path> <circle cx=18.4998 cy=11.4482 r=7 stroke=currentColor></circle> </svg> <span>главная сцена</span> </button> <button class="map__event map__event--1 js-modal-trigger" data-target=tent1 type=button> <svg width=22 height=27 viewbox="0 0 22 27" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M21.4288 15.647H0.773682V25.7042H21.4288V15.647Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M12.3121 6.66064H9.89034L0.773682 15.6476H21.4288L12.3121 6.66064Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.1011 6.66021V1.39258" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M13.1631 2.58119L11.1011 1.39258V3.76981L13.1631 2.58119Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> </svg> <span>карточные <br>фокусы</span> </button> <button class="map__event map__event--2 js-modal-trigger" data-target=tent2 type=button> <svg width=22 height=27 viewbox="0 0 22 27" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M21.4288 15.647H0.773682V25.7042H21.4288V15.647Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M12.3121 6.66064H9.89034L0.773682 15.6476H21.4288L12.3121 6.66064Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.1011 6.66021V1.39258" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M13.1631 2.58119L11.1011 1.39258V3.76981L13.1631 2.58119Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> </svg> <span>карточные <br>фокусы</span> </button> <button class="map__event map__event--3 js-modal-trigger" data-target=tent3 type=button> <svg width=22 height=27 viewbox="0 0 22 27" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M21.4288 15.647H0.773682V25.7042H21.4288V15.647Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M12.3121 6.66064H9.89034L0.773682 15.6476H21.4288L12.3121 6.66064Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.1011 6.66021V1.39258" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M13.1631 2.58119L11.1011 1.39258V3.76981L13.1631 2.58119Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> </svg> <span>карточные <br>фокусы</span> </button> <button class="map__event map__event--4 js-modal-trigger" data-target=tent4 type=button> <svg width=22 height=27 viewbox="0 0 22 27" fill=none xmlns=http://www.w3.org/2000/svg> <path d="M21.4288 15.647H0.773682V25.7042H21.4288V15.647Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M12.3121 6.66064H9.89034L0.773682 15.6476H21.4288L12.3121 6.66064Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.1011 6.66021V1.39258" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M13.1631 2.58119L11.1011 1.39258V3.76981L13.1631 2.58119Z" stroke=currentColor stroke-miterlimit=10 stroke-linejoin=round></path> </svg> <span>карточные <br>фокусы</span> </button> </div> </div> <div class=map__plane> <svg version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px viewbox="200 0 1280 300" preserveaspectratio="xMinYMin meet"> <defs> <path id=trajectory fill=none stroke=#FFFFFF d=M-50,59.9c130.8-42,462.6,96.8,683.8,96.8c367.2,0,701.4-78.2,992.3-78.2></path> <g id=star1> <path fill=none stroke=#FFFFFF stroke-miterlimit=10 d=M-3.5,-3.5l-7,7></path> <path fill=none stroke=#FFFFFF stroke-miterlimit=10 d=M-3.5,3.5l-7-7></path> </g> <g id=star2> <path fill=none stroke=#FFFFFF stroke-miterlimit=10 d=M-2,-2l-4,4></path> <path fill=none stroke=#FFFFFF stroke-miterlimit=10 d=M-2,2l-4-4></path> </g> </defs> <g id=stars> <g id=starsTailLeading> <g id=s1Jumping> <animateTransform attributename=transform type=translate repeatcount=indefinite dur=20s additive=sum calcmode=discrete values="0 0;\n          250 70; 350 76; 460 107; 550 116; 620 139; 715 148; 795 153;\n          868 127; 930 122; 1034 134; 1092 132; 1155 121; 1255 102;\n          0 0;\n          0 0" keytimes="0;\n          0.15; 0.2; 0.25; 0.3; 0.35; 0.4; 0.45;\n          0.5; 0.55; 0.6; 0.65; 0.7; 0.75;\n          0.8;\n        1"></animateTransform> <g id=s1Blinking> <animate attributetype=CSS attributename=opacity calcmode=discrete values="0; 1; 0; 0" keytimes="0; 0.01; 0.5; 1" dur=1s repeatcount=indefinite></animate> <use xlink:href=#star1></use> </g> <g id=s1add1Blinking> <animateTransform attributename=transform type=translate repeatcount=indefinite dur=20s additive=sum calcmode=discrete values="0 0;\n            25 -7; 28 12; 25 -7; 28 12; 25 -27; 28 12; 25 -7;\n            28 12; 25 -7; 28 12; 25 -7; 28 12; 25 17;\n            0 0;\n            0 0" keytimes="0;\n            0.15; 0.2; 0.25; 0.3; 0.35; 0.4; 0.45;\n            0.5; 0.55; 0.6; 0.65; 0.7; 0.75;\n            0.8;\n          1"></animateTransform> <animate attributetype=CSS attributename=opacity calcmode=discrete values="0; 1; 0; 0" keytimes="0; 0.4; 0.8; 1" dur=0.65s repeatcount=indefinite></animate> <use xlink:href=#star2></use> </g> </g> <g id=s2Jumping transform="translate(0, 0)"> <animateTransform attributename=transform type=translate repeatcount=indefinite dur=20s additive=sum calcmode=discrete values="0 0;\n          278 97; 390 114; 490 124; 592 122; 655 131; 755 142;\n          855 120; 900 154; 970 164; 1050 106; 1120 89; 1195 78; 1295 73;\n          0 0;\n          0 0" keytimes="0;\n          0.165; 0.215; 0.265; 0.315; 0.365; 0.415;\n          0.465; 0.515; 0.565; 0.615; 0.665; 0.715; 0.765;\n          0.815;\n        1"></animateTransform> <g id=s2Blinking> <animate attributetype=CSS attributename=opacity calcmode=discrete values="0; 1; 0; 0" keytimes="0; 0.01; 0.5; 1" dur=1s begin=3.35s repeatcount=indefinite></animate> <use xlink:href=#star1></use> <g class=smallLine> <line x1=-10 y1=-2 x2=-20 y2=-2 stroke-dasharray="3 12" fill=none stroke=#FFFFFF stroke-miterlimit=10></line> <animate dur=1s repeatcount=indefinite calcmode=linear attributename=stroke-dashoffset values="3.5; -15" keytimes="0; 1"></animate> </g> </g> </g> </g> <g id=starsPart1> <g id=s1p1Jumping transform="translate(120, 10)"> <animateTransform attributename=transform type=translate repeatcount=indefinite dur=20s additive=sum calcmode=discrete values="0 0;\n          250 70; 320 76; 460 102; 580 113; 600 112; 715 104; 775 103;\n          868 77; 930 82; 1034 74; 1092 72; 1155 68; 1255 53;\n          1312 93; 0 0;\n          0 0" keytimes="0;\n          0.15; 0.2; 0.25; 0.3; 0.35; 0.4; 0.45;\n          0.5; 0.55; 0.6; 0.65; 0.7; 0.75;\n          0.8; 0.85;\n        1"></animateTransform> <g id=s1p1Blinking> <animate attributetype=CSS attributename=opacity calcmode=discrete values="0; 1; 0; 0" keytimes="0; 0.01; 0.5; 1" dur=1s begin=0.25s repeatcount=indefinite></animate> <use xlink:href=#star1></use> <g class=smallLine> <line x1=-15 y1=2 x2=-25 y2=2 stroke-dasharray="3 12" fill=none stroke=#FFFFFF stroke-miterlimit=10></line> <animate dur=1s begin=0.25s repeatcount=indefinite calcmode=linear attributename=stroke-dashoffset values="3.5; -15" keytimes="0; 1"></animate> </g> </g> <g id=s1p1add1Blinking> <animateTransform attributename=transform type=translate repeatcount=indefinite dur=20s additive=sum calcmode=discrete values="0 0;\n            25 7; 28 -12; 25 7; 25 27; 28 -12; 20 -17; 25 7;\n            28 -12; 25 7; 28 -12; 15 -7; 20 7; 28 -4;\n            28 12; 0 0;\n            0 0" keytimes="0;\n            0.15; 0.2; 0.25; 0.3; 0.35; 0.4; 0.45;\n            0.5; 0.55; 0.6; 0.65; 0.7; 0.75;\n            0.8; 0.85;\n        1"></animateTransform> <animate attributetype=CSS attributename=opacity calcmode=discrete values="0; 1; 0; 0" keytimes="0; 0.25; 0.65; 1" dur=1s begin=0.25s repeatcount=indefinite></animate> <use xlink:href=#star2></use> </g> </g> <g id=s2p1Jumping transform="translate(90, 50)"> <animateTransform attributename=transform type=translate repeatcount=indefinite dur=20s additive=sum calcmode=discrete values="0 0;\n          278 97; 390 114; 490 124; 592 122; 655 131; 755 122;\n          855 110; 900 114; 970 104; 1050 96; 1120 99; 1195 101; 1295 72;\n          1304 36; 0 0;\n          0 0" keytimes="0;\n          0.165; 0.215; 0.265; 0.315; 0.365; 0.415;\n          0.465; 0.515; 0.565; 0.615; 0.665; 0.715; 0.765;\n          0.815; 0.865;\n      1"></animateTransform> <g id=s2p1Blinking> <animate attributetype=CSS attributename=opacity calcmode=discrete values="0; 1; 0; 0" keytimes="0; 0.01; 0.5; 1" dur=1s begin=3.75s repeatcount=indefinite></animate> <use xlink:href=#star1></use> <g class=smallLine> <line x1=10 y1=0 x2=0 y2=0 stroke-dasharray="3 12" fill=none stroke=#FFFFFF stroke-miterlimit=10></line> <animate dur=1s begin=3.75s repeatcount=indefinite calcmode=linear attributename=stroke-dashoffset values="3.5; -15" keytimes="0; 1"></animate> <animateTransform attributename=transform type=translate repeatcount=indefinite dur=4s begin=3.75s additive=sum calcmode=discrete values="0 2; 0 -20; -30 1.2; 1 22; 0 2" keytimes="0; 0.25; 0.5; 0.75; 1"></animateTransform> </g> </g> </g> </g> </g> <g id=plane> <animateMotion dur=20s repeatcount=indefinite calcmode=spline keypoints="0; 0.36; 1" keytimes="0; 0.35; 1" keysplines="0.33 0.16 0.65 0.7; 0.33 0.36 0.69 0.57"> <mpath href=#trajectory></mpath> </animateMotion> <animateTransform dur=20s repeatcount=indefinite calcmode=spline attributename=transform type=rotate values="-2; 0; 10; 11; 0; -10; -2" keytimes="0; 0.012; 0.12; 0.17; 0.35; 0.7; 1" keysplines="0.32 0.63 0.7 1; 0.31 0.01 0.72 0.94; 0 0 1 1; 0.3 0.09 0.7 1; 0.31 0.01 0.72 0.94; 0.3 0.09 0.7 1" additive=sum></animateTransform> <g id=nozzleTop> <animateTransform dur=20s repeatcount=indefinite calcmode=spline attributename=transform type=translate values="0, 6; 0, 0; 0, 8" keytimes="0; 0.3; 1" keysplines="0.63 0 0.4 1; 0.2 0 0.51 1" additive=sum></animateTransform> <g id=nozzleTopTrack transform=translate(192.4,-13.8)> <path fill=none stroke=#FFFFFF stroke-dasharray=18,10,10,8,6,6,2,30 d="M0 0c-5.6,0-13,0-28,0"></path> <animate dur=0.38s repeatcount=indefinite calcmode=linear attributename=stroke-dashoffset values="30; 0; 30" keytimes="0; 0.9; 1"></animate> </g> <path id=nozzleTopInner fill=#353535 stroke=#FFFFFF stroke-linejoin=round stroke-miterlimit=10 d="M201.3-16h-6.8v3.6\n      h6.8L201.3-16z"></path> </g> <g id=nozzleBottom> <animateTransform dur=20s repeatcount=indefinite calcmode=spline attributename=transform type=translate values="0, -6.5; 0, 0; 0, -8.5" keytimes="0; 0.3; 1" keysplines="0.63 0 0.4 1; 0.2 0 0.51 1" additive=sum></animateTransform> <g id=nozzleBottomTrack transform=translate(192.4,16.2)> <path fill=none stroke=#FFFFFF stroke-dasharray=20,14,14,10,8,8,2,34 d=M0,0c-3.7,0-45.1,0-49,0></path> <animate dur=0.34s repeatcount=indefinite calcmode=linear attributename=stroke-dashoffset values="34; 0; 34" keytimes="0; 0.9; 1"></animate> </g> <path id=nozzleBottomInner fill=#353535 stroke=#FFFFFF stroke-linejoin=round stroke-miterlimit=10 d="M200.4,18.4H194\n      v-3.6h6.5L200.4,18.4z"></path> </g> <g id=wingTop transform="translate(9.4, 0)"> <g> <animateTransform dur=20s repeatcount=indefinite calcmode=spline attributename=transform type=scale values="1, 0.65; 1, 1; 1, 0.55" keytimes="0; 0.3; 1" keysplines="0.63 0 0.4 1; 0.2 0 0.51 1" additive=sum></animateTransform> <g transform="translate(-9.4, 0)"> <path fill=#353535 d=M213.1-4l-10.2-12.7c-1-1.2-2.4-1.9-3.9-1.9h-3.2L202.9-4></path> <path fill=none stroke=#FFFFFF stroke-linejoin=round stroke-miterlimit=10 d="M213.1-4l-10.2-12.7\n          c-1-1.2-2.4-1.9-3.9-1.9h-3.2L202.9-4"></path> </g> </g> </g> <g id=banner> <path id=bannerShape fill=#353535 stroke=#FFFFFF stroke-linejoin=round stroke-miterlimit=10 d="M167.9,5.1\n      c-25.8-16.6-51.6,17.2-77.4,0.6c0-5.7,0-11.5,0-17.2c25.8,16.6,51.6-17.2,77.4-0.6C167.9-6.4,167.9-0.7,167.9,5.1z"> <animate attributename=d attributetype=XML values="M167.9,5.1c-25.8-16.6-51.6,17.2-77.4,0.6c0-5.7,0-11.5,0-17.2c25.8,16.6,51.6-17.2,77.4-0.6C167.9-6.4,167.9-0.7,167.9,5.1z;\n          M167.9,5.1c-25.8-16.6-68.5,10-78.4,2.6c0-5.7,0-11.5,0-17.2c8.8,7.2,52.6-19.2,78.4-2.6C167.9-6.4,167.9-0.7,167.9,5.1z;\n          M167.9,5.1C128.4-11.2,100,0.5,91.4,5.7c0-5.7,0-11.5,0-17.2c4.4-5,38.9-16.5,76.4-0.6C167.9-6.4,167.9-0.7,167.9,5.1z;\n          M167.9,5.1C142,10.3,105-4.9,89.2-0.6c0-5.7,0-11.5,0-17.2c13.7-5.5,46.3,7.2,78.7,5.7C167.9-6.4,167.9-0.7,167.9,5.1z;\n          M167.9,5.1c-40.3,7.7-71.4-4-77.7-9.7c0-5.7,0-11.5,0-17.2c8.3,6.6,43.1,18,77.7,9.7C167.9-6.4,167.9-0.7,167.9,5.1z;\n          M167.9,5.1c-16.1-5.7-49.6,13.1-77.7-2.7c0-5.7,0-11.5,0-17.2c31.7,17.3,60.8-1.2,77.7,2.7C167.9-6.4,167.9-0.7,167.9,5.1z;\n          M167.9,5.1c-25.8-16.6-51.6,17.2-77.4,0.6c0-5.7,0-11.5,0-17.2c25.8,16.6,51.6-17.2,77.4-0.6C167.9-6.4,167.9-0.7,167.9,5.1z;" dur=8s repeatcount=indefinite></animate> </path> <g id=word> <g transform="translate(106, 1.9)"> <g> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=translate values="0, 0; 0, -11; 0, 0" keytimes="0; 0.42; 1" keysplines="0.31 0 0.64 1; 0.31 0 0.84 1" additive=sum></animateTransform> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=skewY values="0; -6; 0; 6; 0" keytimes="0; 0.2; 0.43; 0.6; 1" keysplines="0.31 0 0.64 1; 0.31 0 0.64 1; 0.31 0 0.64 1; 0.31 0 0.84 1" additive=sum></animateTransform> <path id=w transform="translate(-106, -1.9)" fill=#FFFFFF d="M101.6-2.7c0.4,0.1,0.8,0.1,1.1,0.2c0.1,0.4,0.3,1.3,0.6,2.6c0.2,0.9,0.4,1.8,0.7,2.7\n            c0.2,0.9,0.4,1.6,0.5,2.1c0,0,0.1,0,0.1,0c0.6-2.4,1.1-4.8,1.7-7.2c0.3,0,0.6,0,0.9,0c0.6,2.4,1.1,4.8,1.7,7.2c0,0,0.1,0,0.1,0\n            c0.1-0.4,0.2-1,0.4-1.9c0.2-0.8,0.4-1.7,0.6-2.5c0.4-1.7,0.7-2.7,0.7-3.1c0.4,0,0.8-0.1,1.1-0.1c-0.2,0.8-0.6,2.5-1.2,5\n            c-0.3,1.3-0.5,2.3-0.7,3.1c-0.6,0.1-1.1,0.1-1.7,0.1c-0.6-2.2-1-4.1-1.2-5.4c0-0.2-0.1-0.4-0.1-0.5c0,0-0.1,0-0.1,0\n            c0,0.2-0.1,0.4-0.1,0.6c-0.2,0.7-0.3,1.5-0.5,2.2c-0.2,0.7-0.4,1.8-0.8,3.2c-0.6,0-1.1-0.1-1.7-0.1\n            C103.1,3.3,102.4,0.6,101.6-2.7z"></path> </g> </g> <g transform="translate(112, 1)"> <g> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=translate values="0, 0; 0, -11; 0, 0.1; 0, 0" keytimes="0; 0.32; 0.98; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.64 1; 0.31 0 0.84 1" additive=sum></animateTransform> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=skewY values="0; 6; 15; 0" keytimes="0; 0.33; 0.75; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.64 1; 0.31 0 0.84 1" additive=sum></animateTransform> <path id=e1 transform="translate(-112, -1)" fill=#FFFFFF d="M112.8,1.1c0-1.6,0-2.9-0.1-3.9c1.8-0.3,3.7-0.7,5.6-1.2c0,0.3,0,0.6,0,0.8c-1.5,0.4-3,0.7-4.5,1\n            c0,0.9,0,1.8,0,2.7c1.4-0.3,2.8-0.6,4.2-0.9c0,0.3,0,0.6,0,0.8c-1.4,0.3-2.8,0.6-4.2,0.9c0,0.9,0,1.8,0,2.7c1.5-0.3,3-0.6,4.5-1\n            c0,0.3,0,0.6,0,0.8c-1.9,0.5-3.7,0.9-5.6,1.2C112.7,4,112.8,2.7,112.8,1.1z"></path> </g> </g> <g transform="translate(122, 0)"> <g> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=translate values="0, 0; 0, -9; 0, 1.3; 0, 0" keytimes="0; 0.28; 0.88; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.64 1; 0.31 0 0.84 1" additive=sum></animateTransform> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=skewY values="0; 12; 10; 0" keytimes="0; 0.29; 0.89; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.64 1; 0.31 0 0.84 1" additive=sum></animateTransform> <path id=l transform="translate(-122, 0)" fill=#FFFFFF d="M119.8,2.2c0-1.2,0-2,0-2.6c0-0.6,0-1.4,0-2.6c0-0.4,0-0.9,0-1.3c0.4-0.1,0.7-0.2,1.1-0.3\n            c0,1.3,0,2.6,0,3.8c0,1.1,0,2.2,0,3.2c0.5-0.1,1.3-0.4,2.3-0.7c0.7-0.2,1.1-0.4,1.4-0.5c0,0.3,0,0.6-0.1,0.9\n            c-1.6,0.5-3.2,1-4.8,1.4C119.8,3,119.8,2.6,119.8,2.2z"></path> </g> </g> <g transform="translate(128, -3)"> <g> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=translate values="0, 0; 0, -7.5; 0, 3; 0, 0" keytimes="0; 0.25; 0.78; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.84 1; 0.31 0 0.84 1" additive=sum></animateTransform> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=skewY values="0; 24; 10; 0" keytimes="0; 0.27; 0.81; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.84 1; 0.31 0 0.84 1" additive=sum></animateTransform> <path id=c transform="translate(-128, 3)" fill=#FFFFFF d="M125.5,0.8c-0.6-0.5-0.9-1.4-0.9-2.7c0-1.3,0.3-2.4,0.9-3.3c0.6-0.9,1.5-1.5,2.6-1.9\n            c1-0.3,1.7-0.3,2.3,0c0.5,0.3,0.9,0.9,1,1.8c-0.4,0.2-0.7,0.3-1.1,0.5c-0.1-0.7-0.4-1.2-0.8-1.4c-0.4-0.2-0.9-0.2-1.6,0\n            c-0.6,0.2-1.1,0.5-1.5,0.9c-0.6,0.9-0.8,1.9-0.8,3.1c0,1,0.2,1.7,0.7,2.1c0.4,0.4,1.1,0.5,1.9,0.2c0.6-0.2,1-0.4,1.4-0.8\n            c0.3-0.4,0.6-1,0.7-1.7c0.4-0.1,0.7-0.2,1.1-0.4c-0.2,0.9-0.5,1.7-1.1,2.8s-1.3,1.1-2.2,1.4C127,1.4,126.1,1.3,125.5,0.8z"></path> </g> </g> <g transform="translate(136, -5.5)"> <g> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=translate values="0, 0; 0, -5.5; 0, 4.5; 0, 0" keytimes="0; 0.23; 0.7; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.84 1; 0.31 0 0.84 1" additive=sum></animateTransform> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=skewY values="0; 14; 5; 0" keytimes="0; 0.24; 0.71; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.84 1; 0.31 0 0.84 1" additive=sum></animateTransform> <path id=o transform="translate(-136, 5.5)" fill=#FFFFFF d="M133.3-1.7c-0.6-0.5-0.9-1.4-0.9-2.7c0-1.3,0.3-2.4,0.9-3.3c0.6-0.9,1.5-1.5,2.6-1.9\n            c1.1-0.3,2-0.2,2.6,0.3c0.6,0.5,0.9,1.5,0.9,2.8c0,1.3-0.3,2.4-0.9,3.3c-0.6,0.9-1.5,1.5-2.6,1.8C134.8-1.2,134-1.2,133.3-1.7z\n            M137.5-3.1c0.6-0.8,1-1.9,1-3.1c0-1-0.2-1.7-0.7-2.2s-1-0.6-1.8-0.3c-0.6,0.2-1.2,0.5-1.6,0.9c-0.6,0.8-0.9,1.8-0.9,3\n            c0,0.7,0.1,1.2,0.3,1.7c0.2,0.4,0.5,0.7,0.9,0.9c0.4,0.1,0.8,0.1,1.3,0C136.6-2.5,137.1-2.8,137.5-3.1z"></path> </g> </g> <g transform="translate(149, -9)"> <g> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=translate values="0, 0; 0, -1.8; 0, 6; 0, 0" keytimes="0; 0.2; 0.66; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.84 1; 0.31 0 0.84 1" additive=sum></animateTransform> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=skewY values="0; 14; 5; 0" keytimes="0; 0.22; 0.68; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.84 1; 0.31 0 0.84 1" additive=sum></animateTransform> <path id=m transform="translate(-149, 9)" fill=#FFFFFF d="M141-7.6c0-0.6,0-1.4,0-2.4c0-0.3,0-0.6,0-0.9c0.6-0.1,1.1-0.3,1.7-0.4c0.8,2.1,1.6,4.1,2.4,6.2\n            c0,0,0.1,0,0.1,0c0.8-2.4,1.6-4.7,2.4-7c0.6-0.1,1.1-0.1,1.7-0.2c0,1.5,0,2.6,0,3.3c0,1.6,0,3.1,0.1,4.6c-0.3,0-0.7,0.1-1,0.1\n            c0-0.8,0-2,0-3.7c0-0.7,0-1.8,0-3.1c0,0-0.1,0-0.1,0c-0.8,2.4-1.7,4.7-2.5,7.2c-0.3,0.1-0.7,0.1-1,0.2c-0.8-2.1-1.7-4.2-2.5-6.3\n            c0,0-0.1,0-0.1,0c0,0.3,0,0.6,0,1c0,1,0,1.7,0,2.2c0,0.8,0,1.7,0,2.5c0,0.4,0,0.8,0,1.2c-0.3,0.1-0.7,0.2-1,0.2\n            C141-5,141-6.6,141-7.6z"></path> </g> </g> <g transform="translate(156, -7.5)"> <g> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=translate values="0, 0; 0, -1; 0, 6; 0, 0" keytimes="0; 0.2; 0.65; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.84 1; 0.31 0 0.84 1" additive=sum></animateTransform> <animateTransform dur=8s repeatcount=indefinite calcmode=spline attributename=transform type=skewY values="0; 2; -10; 0" keytimes="0; 0.2; 0.65; 1" keysplines="0.63 0 0.84 1; 0.31 0 0.84 1; 0.31 0 0.84 1" additive=sum></animateTransform> <path transform="translate(-156, 7.5)" id=e2 fill=#FFFFFF d="M151.2-8.4c0-1.6,0-2.9-0.1-4c1.8,0,3.7,0.1,5.6,0.4c0,0.3,0,0.6,0,0.8c-1.5-0.2-3-0.4-4.5-0.4\n            c0,0.9,0,1.8,0,2.7c1.4,0,2.8,0.1,4.2,0.3c0,0.3,0,0.6,0,0.8c-1.4-0.2-2.8-0.3-4.2-0.4c0,0.9,0,1.8,0,2.7c1.5,0,3,0.1,4.5,0.4\n            c0,0.3,0,0.6,0,0.8c-1.9-0.3-3.7-0.4-5.6-0.4C151.1-5.5,151.2-6.8,151.2-8.4z"></path> </g> </g> </g> </g> <path id=rope fill=none stroke=#FFFFFF stroke-linejoin=round stroke-miterlimit=10 d=M167.9-3.2h13></path> <path id=body fill=#353535 stroke=#FFFFFF stroke-linejoin=round stroke-miterlimit=10 d="M202.8,5.6l24.5,0\n    c1.7,0,3.1-1.4,3.1-3.1c0-2.3-9.2-6.4-11.6-6.5L216.4-4h-28.7l-2.3-6.1h-4.5V-4v1.9c0,1.6,1,3,2.5,3.4c4.3,1.5,10.4,4.3,15.1,4.3\n    H202.8"></path> <g id=wingBottom transform="translate(9.4, 0)"> <g> <animateTransform dur=20s repeatcount=indefinite calcmode=spline attributename=transform type=scale values="1, 0.65; 1, 1; 1, 0.55" keytimes="0; 0.3; 1" keysplines="0.63 0 0.4 1; 0.2 0 0.51 1" additive=sum></animateTransform> <g transform="translate(-9.4, 0)"> <path fill=#353535 stroke=#FFFFFF stroke-linejoin=round stroke-miterlimit=10 d="M199,20h-3.2l9-18.3\n          h11.1l-12.9,16.4C202,19.3,200.5,20,199,20z"></path> </g> </g> </g> </g> </svg> </div> </div> <div class=screen__scrollers> <button class="screen__scroller screen__scroller--prev js-map-scroller" data-direction=left type=button aria-label="Скроллить влево"> <svg width=25 height=15 fill=none> <use xlink:href=img/sprite_auto.svg#arr-prev></use> </svg> </button> <button class="screen__scroller screen__scroller--next js-map-scroller" data-direction=right type=button aria-label="Скроллить вправо"> <svg width=25 height=15 fill=none> <use xlink:href=img/sprite_auto.svg#arr-next></use> </svg> </button> <button class="screen__scroller screen__scroller--up screen__scroller--hidden js-map-scroller" data-direction=up type=button aria-label="Скроллить вверх"> <svg width=25 height=15 fill=none> <use xlink:href=img/sprite_auto.svg#arr-prev></use> </svg> </button> <button class="screen__scroller screen__scroller--down screen__scroller--hidden js-map-scroller" data-direction=down type=button aria-label="Скроллить вниз"> <svg width=25 height=15 fill=none> <use xlink:href=img/sprite_auto.svg#arr-next></use> </svg> </button> </div> </section> <section class="screen screen--hidden screen--tickets js-scrollspy" id=tickets> <div class=screen__wrapper> <div class="tickets-block js-tickets-block"> <h2 class=tickets-block__title><span>купить билет</span></h2> <form class=tickets-block__list method=post> <ul> <li> <label class="tickets-block__button btn btn--primary btn--medium js-date-picker" data-number=0> <input type=radio class=visually-hidden id=1304 name=datepicker> 13.04 пн </label> </li> <li> <label class="tickets-block__button btn btn--primary btn--medium js-date-picker" data-number=1> <input type=radio class=visually-hidden id=1404 name=datepicker> 14.04 вт </label> </li> <li> <label class="tickets-block__button btn btn--primary btn--medium js-date-picker" data-number=2> <input type=radio class=visually-hidden id=1504 name=datepicker> 15.04 ср </label> </li> <li> <label class="tickets-block__button btn btn--primary btn--medium js-date-picker" data-number=3> <input type=radio class=visually-hidden id=1604 name=datepicker> 16.04 чт </label> </li> <li> <label class="tickets-block__button btn btn--primary btn--medium js-date-picker" data-number=4> <input type=radio class=visually-hidden id=1704 name=datepicker> 17.04 пт </label> </li> <li> <label class="tickets-block__button btn btn--primary btn--medium js-date-picker" data-number=5> <input type=radio class=visually-hidden id=1804 name=datepicker> 18.04 сб </label> </li> <li> <label class="tickets-block__button btn btn--primary btn--medium js-date-picker" data-number=6> <input type=radio class=visually-hidden id=1904 name=datepicker> 19.04 вс </label> </li> <li> <button class="tickets-block__button tickets-block__button--next btn btn--primary btn--medium js-pick js-show-form" disabled="" type=button> <svg width=42 height=25 fill=none> <use xlink:href=img/sprite_auto.svg#arr-next></use> </svg> </button> </li> </ul> </form> <form method=post class=tickets-block__form> <div class="tickets-block__slider swiper-container js-tickets-slider"> <div class=swiper-wrapper> <div class="swiper-slide tickets-block__slide"> <div class=tickets-form> <div class=tickets-form__row> <label for=adult-1304 class=tickets-form__label> <span>взрослый билет</span> <span>1400 р</span> </label> <div class="tickets-form__field js-field"> <input type=number value=0 data-sum=1400 min=0 id=adult-1304 name=adult-1304> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=child-1304 class=tickets-form__label> <span>детский билет</span> <span>1000 р</span> <em>до 12 лет</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 data-sum=1000 min=0 id=child-1304 name=child-1304> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=group-1304 class=tickets-form__label> <span>групповой билет</span> <span>4800 р</span> <em>на группу из 4 человек</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 data-sum=4800 min=0 id=group-1304 name=group-1304> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class="tickets-form__row tickets-form__row--disabled js-total-row"> <p class=tickets-form__label> <span>итого</span> <span><span class=js-total>0</span> р</span> </p> <div class=tickets-form__button> <button class="tickets-form__submit btn btn--primary"> <span>купить</span> </button> <div class=tickets-form__ticket> <div class=tickets-form__ticket_x> <div class=tickets-form__ticket_y> <svg width=30 height=31 viewbox="0 0 30 31" fill=none xmlns=http://www.w3.org/2000/svg> <g stroke=black> <path d="M17.3945 5.71436H1V29.9999H17.3945V5.71436Z" stroke-miterlimit=10></path> <path d="M12.8724 16.4755C15.6236 19.2391 11.9228 23.0778 9.17669 20.3142C6.5897 22.9992 2.83241 19.2234 5.4194 16.5384L9.11509 12.6997L12.8724 16.4755Z" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M9.17676 20.314V23.0199" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M7.60083 23.02H10.7524" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.9075 5.74068L13.3036 1L29.0001 5.82458L22.1528 29.0823L17.7282 27.7241" stroke-miterlimit=10></path> </g> </svg> </div> </div> </div> </div> </div> </div> <div class=tickets-block__date>13.04 пн</div> </div> <div class="swiper-slide tickets-block__slide"> <div class=tickets-form> <div class=tickets-form__row> <label for=adult-1404 class=tickets-form__label> <span>взрослый билет</span> <span>1400 р</span> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1400 id=adult-1404 name=adult-1404> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=child-1404 class=tickets-form__label> <span>детский билет</span> <span>1000 р</span> <em>до 12 лет</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1000 id=child-1404 name=child-1404> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=group-1404 class=tickets-form__label> <span>групповой билет</span> <span>4800 р</span> <em>на группу из 4 человек</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=4800 id=group-1404 name=group-1404> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class="tickets-form__row tickets-form__row--disabled js-total-row"> <p class=tickets-form__label> <span>итого</span> <span><span class=js-total>0</span> р</span> </p> <div class=tickets-form__button> <button class="tickets-form__submit btn btn--primary"> <span>купить</span> </button> <div class=tickets-form__ticket> <div class=tickets-form__ticket_x> <div class=tickets-form__ticket_y> <svg width=30 height=31 viewbox="0 0 30 31" fill=none xmlns=http://www.w3.org/2000/svg> <g stroke=black> <path d="M17.3945 5.71436H1V29.9999H17.3945V5.71436Z" stroke-miterlimit=10></path> <path d="M12.8724 16.4755C15.6236 19.2391 11.9228 23.0778 9.17669 20.3142C6.5897 22.9992 2.83241 19.2234 5.4194 16.5384L9.11509 12.6997L12.8724 16.4755Z" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M9.17676 20.314V23.0199" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M7.60083 23.02H10.7524" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.9075 5.74068L13.3036 1L29.0001 5.82458L22.1528 29.0823L17.7282 27.7241" stroke-miterlimit=10></path> </g> </svg> </div> </div> </div> </div> </div> </div> <div class=tickets-block__date>14.04 пн</div> </div> <div class="swiper-slide tickets-block__slide"> <div class=tickets-form> <div class=tickets-form__row> <label for=adult-1504 class=tickets-form__label> <span>взрослый билет</span> <span>1400 р</span> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1400 id=adult-1504 name=adult-1504> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=child-1504 class=tickets-form__label> <span>детский билет</span> <span>1000 р</span> <em>до 12 лет</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1000 id=child-1504 name=child-1504> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=group-1504 class=tickets-form__label> <span>групповой билет</span> <span>4800 р</span> <em>на группу из 4 человек</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=4800 id=group-1504 name=group-1504> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class="tickets-form__row tickets-form__row--disabled js-total-row"> <p class=tickets-form__label> <span>итого</span> <span><span class=js-total>0</span> р</span> </p> <div class=tickets-form__button> <button class="tickets-form__submit btn btn--primary"> <span>купить</span> </button> <div class=tickets-form__ticket> <div class=tickets-form__ticket_x> <div class=tickets-form__ticket_y> <svg width=30 height=31 viewbox="0 0 30 31" fill=none xmlns=http://www.w3.org/2000/svg> <g stroke=black> <path d="M17.3945 5.71436H1V29.9999H17.3945V5.71436Z" stroke-miterlimit=10></path> <path d="M12.8724 16.4755C15.6236 19.2391 11.9228 23.0778 9.17669 20.3142C6.5897 22.9992 2.83241 19.2234 5.4194 16.5384L9.11509 12.6997L12.8724 16.4755Z" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M9.17676 20.314V23.0199" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M7.60083 23.02H10.7524" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.9075 5.74068L13.3036 1L29.0001 5.82458L22.1528 29.0823L17.7282 27.7241" stroke-miterlimit=10></path> </g> </svg> </div> </div> </div> </div> </div> </div> <div class=tickets-block__date>15.04 пн</div> </div> <div class="swiper-slide tickets-block__slide"> <div class=tickets-form> <div class=tickets-form__row> <label for=adult-1604 class=tickets-form__label> <span>взрослый билет</span> <span>1400 р</span> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1400 id=adult-1604 name=adult-1604> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=child-1604 class=tickets-form__label> <span>детский билет</span> <span>1000 р</span> <em>до 12 лет</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1000 id=child-1604 name=child-1604> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=group-1604 class=tickets-form__label> <span>групповой билет</span> <span>4800 р</span> <em>на группу из 4 человек</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=4800 id=group-1604 name=group-1604> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class="tickets-form__row tickets-form__row--disabled js-total-row"> <p class=tickets-form__label> <span>итого</span> <span><span class=js-total>0</span> р</span> </p> <div class=tickets-form__button> <button class="tickets-form__submit btn btn--primary"> <span>купить</span> </button> <div class=tickets-form__ticket> <div class=tickets-form__ticket_x> <div class=tickets-form__ticket_y> <svg width=30 height=31 viewbox="0 0 30 31" fill=none xmlns=http://www.w3.org/2000/svg> <g stroke=black> <path d="M17.3945 5.71436H1V29.9999H17.3945V5.71436Z" stroke-miterlimit=10></path> <path d="M12.8724 16.4755C15.6236 19.2391 11.9228 23.0778 9.17669 20.3142C6.5897 22.9992 2.83241 19.2234 5.4194 16.5384L9.11509 12.6997L12.8724 16.4755Z" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M9.17676 20.314V23.0199" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M7.60083 23.02H10.7524" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.9075 5.74068L13.3036 1L29.0001 5.82458L22.1528 29.0823L17.7282 27.7241" stroke-miterlimit=10></path> </g> </svg> </div> </div> </div> </div> </div> </div> <div class=tickets-block__date>16.04 пн</div> </div> <div class="swiper-slide tickets-block__slide"> <div class=tickets-form> <div class=tickets-form__row> <label for=adult-1704 class=tickets-form__label> <span>взрослый билет</span> <span>1400 р</span> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1400 id=adult-1704 name=adult-1704> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=child-1704 class=tickets-form__label> <span>детский билет</span> <span>1000 р</span> <em>до 12 лет</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1000 id=child-1704 name=child-1704> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=group-1704 class=tickets-form__label> <span>групповой билет</span> <span>4800 р</span> <em>на группу из 4 человек</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=4800 id=group-1704 name=group-1704> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class="tickets-form__row tickets-form__row--disabled js-total-row"> <p class=tickets-form__label> <span>итого</span> <span><span class=js-total>0</span> р</span> </p> <div class=tickets-form__button> <button class="tickets-form__submit btn btn--primary"> <span>купить</span> </button> <div class=tickets-form__ticket> <div class=tickets-form__ticket_x> <div class=tickets-form__ticket_y> <svg width=30 height=31 viewbox="0 0 30 31" fill=none xmlns=http://www.w3.org/2000/svg> <g stroke=black> <path d="M17.3945 5.71436H1V29.9999H17.3945V5.71436Z" stroke-miterlimit=10></path> <path d="M12.8724 16.4755C15.6236 19.2391 11.9228 23.0778 9.17669 20.3142C6.5897 22.9992 2.83241 19.2234 5.4194 16.5384L9.11509 12.6997L12.8724 16.4755Z" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M9.17676 20.314V23.0199" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M7.60083 23.02H10.7524" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.9075 5.74068L13.3036 1L29.0001 5.82458L22.1528 29.0823L17.7282 27.7241" stroke-miterlimit=10></path> </g> </svg> </div> </div> </div> </div> </div> </div> <div class=tickets-block__date>17.04 пн</div> </div> <div class="swiper-slide tickets-block__slide"> <div class=tickets-form> <div class=tickets-form__row> <label for=adult-1804 class=tickets-form__label> <span>взрослый билет</span> <span>1400 р</span> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1400 id=adult-1804 name=adult-1804> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=child-1804 class=tickets-form__label> <span>детский билет</span> <span>1000 р</span> <em>до 12 лет</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1000 id=child-1804 name=child-1804> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=group-1804 class=tickets-form__label> <span>групповой билет</span> <span>4800 р</span> <em>на группу из 4 человек</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=4800 id=group-1804 name=group-1804> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class="tickets-form__row tickets-form__row--disabled js-total-row"> <p class=tickets-form__label> <span>итого</span> <span><span class=js-total>0</span> р</span> </p> <div class=tickets-form__button> <button class="tickets-form__submit btn btn--primary"> <span>купить</span> </button> <div class=tickets-form__ticket> <div class=tickets-form__ticket_x> <div class=tickets-form__ticket_y> <svg width=30 height=31 viewbox="0 0 30 31" fill=none xmlns=http://www.w3.org/2000/svg> <g stroke=black> <path d="M17.3945 5.71436H1V29.9999H17.3945V5.71436Z" stroke-miterlimit=10></path> <path d="M12.8724 16.4755C15.6236 19.2391 11.9228 23.0778 9.17669 20.3142C6.5897 22.9992 2.83241 19.2234 5.4194 16.5384L9.11509 12.6997L12.8724 16.4755Z" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M9.17676 20.314V23.0199" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M7.60083 23.02H10.7524" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.9075 5.74068L13.3036 1L29.0001 5.82458L22.1528 29.0823L17.7282 27.7241" stroke-miterlimit=10></path> </g> </svg> </div> </div> </div> </div> </div> </div> <div class=tickets-block__date>18.04 пн</div> </div> <div class="swiper-slide tickets-block__slide"> <div class=tickets-form> <div class=tickets-form__row> <label for=adult-1904 class=tickets-form__label> <span>взрослый билет</span> <span>1400 р</span> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1400 id=adult-1904 name=adult-1904> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=child-1904 class=tickets-form__label> <span>детский билет</span> <span>1000 р</span> <em>до 12 лет</em> </label> <div class="tickets-form__field js-field"> <input type=number value=0 min=0 data-sum=1000 id=child-1904 name=child-1904> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class=tickets-form__row> <label for=group-1904 class=tickets-form__label> <span>групповой билет</span> <span>4800 р</span> <em>на группу из 4 человек</em> </label> <div class="tickets-form__field js-field"> <input type=number min=0 value=0 data-sum=4800 id=group-1904 name=group-1904> <button class="tickets-form__counter tickets-form__counter--decrease js-decrease js-counter" disabled="" type=button aria-label="Уменьшить количество"><span>-</span></button> <button class="tickets-form__counter tickets-form__counter--increase js-increase js-counter" type=button aria-label="Увеличить количество"><span>+</span></button> </div> </div> <div class="tickets-form__row tickets-form__row--disabled js-total-row"> <p class=tickets-form__label> <span>итого</span> <span><span class=js-total>0</span> р</span> </p> <div class=tickets-form__button> <button class="tickets-form__submit btn btn--primary"> <span>купить</span> </button> <div class=tickets-form__ticket> <div class=tickets-form__ticket_x> <div class=tickets-form__ticket_y> <svg width=30 height=31 viewbox="0 0 30 31" fill=none xmlns=http://www.w3.org/2000/svg> <g stroke=black> <path d="M17.3945 5.71436H1V29.9999H17.3945V5.71436Z" stroke-miterlimit=10></path> <path d="M12.8724 16.4755C15.6236 19.2391 11.9228 23.0778 9.17669 20.3142C6.5897 22.9992 2.83241 19.2234 5.4194 16.5384L9.11509 12.6997L12.8724 16.4755Z" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M9.17676 20.314V23.0199" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M7.60083 23.02H10.7524" stroke-miterlimit=10 stroke-linejoin=round></path> <path d="M11.9075 5.74068L13.3036 1L29.0001 5.82458L22.1528 29.0823L17.7282 27.7241" stroke-miterlimit=10></path> </g> </svg> </div> </div> </div> </div> </div> </div> <div class=tickets-block__date>19.04 пн</div> </div> </div> <div class=tickets-block__controls> <button class="tickets-block__control tickets-block__control--prev swiper-button-prev" type=button aria-label="Перейти к предыдущему слайду"> <svg width=42 height=25 fill=none> <use xlink:href=img/sprite_auto.svg#arr-prev></use> </svg> </button> <button class="tickets-block__control tickets-block__control--next swiper-button-next" type=button aria-label="Перейти к следующему слайду"> <svg width=42 height=25 fill=none> <use xlink:href=img/sprite_auto.svg#arr-next></use> </svg> </button> </div> </div> </form> </div> </div> </section> </main> <section> <h2 class=visually-hidden>Модальные окна</h2> <div class="modal js-modal" id=main-scene> <div class=modal__overlay></div> <div class=modal__window> <button class="modal__close js-modal-close" data-target=main-scene type=button aria-label="Закрыть окно"> <svg width=14 height=14> <use xlink:href=img/sprite_auto.svg#cross></use> </svg> </button> <div class=modal__content> <div class=modal__block> <div class=modal__block-header> <span>13.04</span> <span>пн</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> <div class=modal__block-event> <p><b>мастер-класс</b>актерское мастерство для&nbsp;фокусника</p> </div> </div> <div class=modal__block> <div class=modal__block-header> <span>18.04</span> <span>сб</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> </div> </div> <div class=modal__button> <a href=#tickets class="btn btn--primary btn--medium js-modal-close" data-target=main-scene><span>купить билет</span></a> </div> </div> </div> <div class="modal js-modal" id=tent1> <div class=modal__overlay></div> <div class=modal__window> <button class="modal__close js-modal-close" data-target=tent1 type=button aria-label="Закрыть окно"> <svg width=14 height=14> <use xlink:href=img/sprite_auto.svg#cross></use> </svg> </button> <div class=modal__content> <div class=modal__block> <div class=modal__block-header> <span>13.04</span> <span>пн</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> <div class=modal__block-event> <p><b>мастер-класс</b>актерское мастерство для&nbsp;фокусника</p> </div> </div> <div class=modal__block> <div class=modal__block-header> <span>18.04</span> <span>сб</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> </div> </div> <div class=modal__button> <a href=#tickets class="btn btn--primary btn--medium js-modal-close" data-target=tent1><span>купить билет</span></a> </div> </div> </div> <div class="modal js-modal" id=tent2> <div class=modal__overlay></div> <div class=modal__window> <button class="modal__close js-modal-close" data-target=tent2 type=button aria-label="Закрыть окно"> <svg width=14 height=14> <use xlink:href=img/sprite_auto.svg#cross></use> </svg> </button> <div class=modal__content> <div class=modal__block> <div class=modal__block-header> <span>13.04</span> <span>пн</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> <div class=modal__block-event> <p><b>мастер-класс</b>актерское мастерство для&nbsp;фокусника</p> </div> </div> <div class=modal__block> <div class=modal__block-header> <span>18.04</span> <span>сб</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> </div> </div> <div class=modal__button> <a href=#tickets class="btn btn--primary btn--medium js-modal-close" data-target=tent2><span>купить билет</span></a> </div> </div> </div> <div class="modal js-modal" id=tent3> <div class=modal__overlay></div> <div class=modal__window> <button class="modal__close js-modal-close" data-target=tent3 type=button aria-label="Закрыть окно"> <svg width=14 height=14> <use xlink:href=img/sprite_auto.svg#cross></use> </svg> </button> <div class=modal__content> <div class=modal__block> <div class=modal__block-header> <span>13.04</span> <span>пн</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> <div class=modal__block-event> <p><b>мастер-класс</b>актерское мастерство для&nbsp;фокусника</p> </div> </div> <div class=modal__block> <div class=modal__block-header> <span>18.04</span> <span>сб</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> </div> </div> <div class=modal__button> <a href=#tickets class="btn btn--primary btn--medium js-modal-close" data-target=tent3><span>купить билет</span></a> </div> </div> </div> <div class="modal js-modal" id=tent4> <div class=modal__overlay></div> <div class=modal__window> <button class="modal__close js-modal-close" data-target=tent4 type=button aria-label="Закрыть окно"> <svg width=14 height=14> <use xlink:href=img/sprite_auto.svg#cross></use> </svg> </button> <div class=modal__content> <div class=modal__block> <div class=modal__block-header> <span>13.04</span> <span>пн</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> <div class=modal__block-event> <p><b>мастер-класс</b>актерское мастерство для&nbsp;фокусника</p> </div> </div> <div class=modal__block> <div class=modal__block-header> <span>18.04</span> <span>сб</span> </div> <div class=modal__block-event> <p><b>мастер-класс</b>фокусы с&nbsp;картами и&nbsp;мелкими предметами</p> </div> </div> </div> <div class=modal__button> <a href=#tickets class="btn btn--primary btn--medium js-modal-close" data-target=tent4><span>купить билет</span></a> </div> </div> </div> </section> </div> </body> </html> '},function(e,t,i){"use strict";i.r(t);i(3);var n=i(1);class r{constructor(e,t,i,n,r=0,a=20){this.TIME_SPACE=100,this.elementSelector=e,this.timer=t,this.classForActivate=i,this.property=n,"string"==typeof this.elementSelector?this.element=document.querySelector(this.elementSelector):this.element=this.elementSelector,this.timeOffset=0,this.timeOffsetDelta=a,this.delay=r,this.prepareText(a)}createElement(e,t){const i=document.createElement("span");return i.textContent=e,i.style.transition=this.getTransition(),this.timeOffset+=t,i}getTransition(){return`${this.property} ${this.timer}ms ease ${this.delay+this.timeOffset}ms`}prepareText(e){if(!this.element)return;const t=this.element.textContent.trim().split(/[\s]+/),{length:i}=t,n=t.reduce((t,n,r)=>{const a=Array.from(n).reduce((t,i)=>(t.appendChild(this.createElement(i,e)),t),document.createDocumentFragment()),s=document.createElement("span");return s.classList.add("slogan__word"),s.appendChild(a),t.appendChild(s),r<i-1&&t.appendChild(document.createTextNode(" ")),t},document.createDocumentFragment());this.element.innerHTML="",this.element.appendChild(n)}clearStyle(){[...this.element.querySelectorAll(".slogan__word span")].forEach(e=>{e.removeAttribute("style")})}addStyle(e){this.timeOffset=0,e="number"!=typeof e?this.timeOffsetDelta:e;[...this.element.querySelectorAll(".slogan__word")].forEach(t=>{[...t.querySelectorAll("span")].forEach(t=>{t.style.transition=this.getTransition(),this.timeOffset+=e})})}runAnimation(){this.element&&this.element.classList.add(this.classForActivate)}destroyAnimation(){this.element.classList.remove(this.classForActivate)}}function a(e){return null!==e&&"object"==typeof e&&"constructor"in e&&e.constructor===Object}function s(e,t){void 0===e&&(e={}),void 0===t&&(t={}),Object.keys(t).forEach((function(i){void 0===e[i]?e[i]=t[i]:a(t[i])&&a(e[i])&&Object.keys(t[i]).length>0&&s(e[i],t[i])}))}var o="undefined"!=typeof document?document:{},l={body:{},addEventListener:function(){},removeEventListener:function(){},activeElement:{blur:function(){},nodeName:""},querySelector:function(){return null},querySelectorAll:function(){return[]},getElementById:function(){return null},createEvent:function(){return{initEvent:function(){}}},createElement:function(){return{children:[],childNodes:[],style:{},setAttribute:function(){},getElementsByTagName:function(){return[]}}},createElementNS:function(){return{}},importNode:function(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};s(o,l);var c="undefined"!=typeof window?window:{};s(c,{document:l,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState:function(){},pushState:function(){},go:function(){},back:function(){}},CustomEvent:function(){return this},addEventListener:function(){},removeEventListener:function(){},getComputedStyle:function(){return{getPropertyValue:function(){return""}}},Image:function(){},Date:function(){},screen:{},setTimeout:function(){},clearTimeout:function(){},matchMedia:function(){return{}}});class h{constructor(e){const t=this;for(let i=0;i<e.length;i+=1)t[i]=e[i];return t.length=e.length,this}}function u(e,t){const i=[];let n=0;if(e&&!t&&e instanceof h)return e;if(e)if("string"==typeof e){let r,a;const s=e.trim();if(s.indexOf("<")>=0&&s.indexOf(">")>=0){let e="div";for(0===s.indexOf("<li")&&(e="ul"),0===s.indexOf("<tr")&&(e="tbody"),0!==s.indexOf("<td")&&0!==s.indexOf("<th")||(e="tr"),0===s.indexOf("<tbody")&&(e="table"),0===s.indexOf("<option")&&(e="select"),a=o.createElement(e),a.innerHTML=s,n=0;n<a.childNodes.length;n+=1)i.push(a.childNodes[n])}else for(r=t||"#"!==e[0]||e.match(/[ .<>:~]/)?(t||o).querySelectorAll(e.trim()):[o.getElementById(e.trim().split("#")[1])],n=0;n<r.length;n+=1)r[n]&&i.push(r[n])}else if(e.nodeType||e===c||e===o)i.push(e);else if(e.length>0&&e[0].nodeType)for(n=0;n<e.length;n+=1)i.push(e[n]);return new h(i)}function d(e){const t=[];for(let i=0;i<e.length;i+=1)-1===t.indexOf(e[i])&&t.push(e[i]);return t}u.fn=h.prototype,u.Class=h,u.Dom7=h;"resize scroll".split(" ");const p={addClass:function(e){if(void 0===e)return this;const t=e.split(" ");for(let e=0;e<t.length;e+=1)for(let i=0;i<this.length;i+=1)void 0!==this[i]&&void 0!==this[i].classList&&this[i].classList.add(t[e]);return this},removeClass:function(e){const t=e.split(" ");for(let e=0;e<t.length;e+=1)for(let i=0;i<this.length;i+=1)void 0!==this[i]&&void 0!==this[i].classList&&this[i].classList.remove(t[e]);return this},hasClass:function(e){return!!this[0]&&this[0].classList.contains(e)},toggleClass:function(e){const t=e.split(" ");for(let e=0;e<t.length;e+=1)for(let i=0;i<this.length;i+=1)void 0!==this[i]&&void 0!==this[i].classList&&this[i].classList.toggle(t[e]);return this},attr:function(e,t){if(1===arguments.length&&"string"==typeof e)return this[0]?this[0].getAttribute(e):void 0;for(let i=0;i<this.length;i+=1)if(2===arguments.length)this[i].setAttribute(e,t);else for(const t in e)this[i][t]=e[t],this[i].setAttribute(t,e[t]);return this},removeAttr:function(e){for(let t=0;t<this.length;t+=1)this[t].removeAttribute(e);return this},data:function(e,t){let i;if(void 0!==t){for(let n=0;n<this.length;n+=1)i=this[n],i.dom7ElementDataStorage||(i.dom7ElementDataStorage={}),i.dom7ElementDataStorage[e]=t;return this}if(i=this[0],i){if(i.dom7ElementDataStorage&&e in i.dom7ElementDataStorage)return i.dom7ElementDataStorage[e];const t=i.getAttribute("data-"+e);return t||void 0}},transform:function(e){for(let t=0;t<this.length;t+=1){const i=this[t].style;i.webkitTransform=e,i.transform=e}return this},transition:function(e){"string"!=typeof e&&(e+="ms");for(let t=0;t<this.length;t+=1){const i=this[t].style;i.webkitTransitionDuration=e,i.transitionDuration=e}return this},on:function(...e){let[t,i,n,r]=e;function a(e){const t=e.target;if(!t)return;const r=e.target.dom7EventData||[];if(r.indexOf(e)<0&&r.unshift(e),u(t).is(i))n.apply(t,r);else{const e=u(t).parents();for(let t=0;t<e.length;t+=1)u(e[t]).is(i)&&n.apply(e[t],r)}}function s(e){const t=e&&e.target&&e.target.dom7EventData||[];t.indexOf(e)<0&&t.unshift(e),n.apply(this,t)}"function"==typeof e[1]&&([t,n,r]=e,i=void 0),r||(r=!1);const o=t.split(" ");let l;for(let e=0;e<this.length;e+=1){const t=this[e];if(i)for(l=0;l<o.length;l+=1){const e=o[l];t.dom7LiveListeners||(t.dom7LiveListeners={}),t.dom7LiveListeners[e]||(t.dom7LiveListeners[e]=[]),t.dom7LiveListeners[e].push({listener:n,proxyListener:a}),t.addEventListener(e,a,r)}else for(l=0;l<o.length;l+=1){const e=o[l];t.dom7Listeners||(t.dom7Listeners={}),t.dom7Listeners[e]||(t.dom7Listeners[e]=[]),t.dom7Listeners[e].push({listener:n,proxyListener:s}),t.addEventListener(e,s,r)}}return this},off:function(...e){let[t,i,n,r]=e;"function"==typeof e[1]&&([t,n,r]=e,i=void 0),r||(r=!1);const a=t.split(" ");for(let e=0;e<a.length;e+=1){const t=a[e];for(let e=0;e<this.length;e+=1){const a=this[e];let s;if(!i&&a.dom7Listeners?s=a.dom7Listeners[t]:i&&a.dom7LiveListeners&&(s=a.dom7LiveListeners[t]),s&&s.length)for(let e=s.length-1;e>=0;e-=1){const i=s[e];n&&i.listener===n||n&&i.listener&&i.listener.dom7proxy&&i.listener.dom7proxy===n?(a.removeEventListener(t,i.proxyListener,r),s.splice(e,1)):n||(a.removeEventListener(t,i.proxyListener,r),s.splice(e,1))}}}return this},trigger:function(...e){const t=e[0].split(" "),i=e[1];for(let n=0;n<t.length;n+=1){const r=t[n];for(let t=0;t<this.length;t+=1){const n=this[t];let a;try{a=new c.CustomEvent(r,{detail:i,bubbles:!0,cancelable:!0})}catch(e){a=o.createEvent("Event"),a.initEvent(r,!0,!0),a.detail=i}n.dom7EventData=e.filter((e,t)=>t>0),n.dispatchEvent(a),n.dom7EventData=[],delete n.dom7EventData}}return this},transitionEnd:function(e){const t=["webkitTransitionEnd","transitionend"],i=this;let n;function r(a){if(a.target===this)for(e.call(this,a),n=0;n<t.length;n+=1)i.off(t[n],r)}if(e)for(n=0;n<t.length;n+=1)i.on(t[n],r);return this},outerWidth:function(e){if(this.length>0){if(e){const e=this.styles();return this[0].offsetWidth+parseFloat(e.getPropertyValue("margin-right"))+parseFloat(e.getPropertyValue("margin-left"))}return this[0].offsetWidth}return null},outerHeight:function(e){if(this.length>0){if(e){const e=this.styles();return this[0].offsetHeight+parseFloat(e.getPropertyValue("margin-top"))+parseFloat(e.getPropertyValue("margin-bottom"))}return this[0].offsetHeight}return null},offset:function(){if(this.length>0){const e=this[0],t=e.getBoundingClientRect(),i=o.body,n=e.clientTop||i.clientTop||0,r=e.clientLeft||i.clientLeft||0,a=e===c?c.scrollY:e.scrollTop,s=e===c?c.scrollX:e.scrollLeft;return{top:t.top+a-n,left:t.left+s-r}}return null},css:function(e,t){let i;if(1===arguments.length){if("string"!=typeof e){for(i=0;i<this.length;i+=1)for(let t in e)this[i].style[t]=e[t];return this}if(this[0])return c.getComputedStyle(this[0],null).getPropertyValue(e)}if(2===arguments.length&&"string"==typeof e){for(i=0;i<this.length;i+=1)this[i].style[e]=t;return this}return this},each:function(e){if(!e)return this;for(let t=0;t<this.length;t+=1)if(!1===e.call(this[t],t,this[t]))return this;return this},html:function(e){if(void 0===e)return this[0]?this[0].innerHTML:void 0;for(let t=0;t<this.length;t+=1)this[t].innerHTML=e;return this},text:function(e){if(void 0===e)return this[0]?this[0].textContent.trim():null;for(let t=0;t<this.length;t+=1)this[t].textContent=e;return this},is:function(e){const t=this[0];let i,n;if(!t||void 0===e)return!1;if("string"==typeof e){if(t.matches)return t.matches(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);for(i=u(e),n=0;n<i.length;n+=1)if(i[n]===t)return!0;return!1}if(e===o)return t===o;if(e===c)return t===c;if(e.nodeType||e instanceof h){for(i=e.nodeType?[e]:e,n=0;n<i.length;n+=1)if(i[n]===t)return!0;return!1}return!1},index:function(){let e,t=this[0];if(t){for(e=0;null!==(t=t.previousSibling);)1===t.nodeType&&(e+=1);return e}},eq:function(e){if(void 0===e)return this;const t=this.length;let i;return e>t-1?new h([]):e<0?(i=t+e,new h(i<0?[]:[this[i]])):new h([this[e]])},append:function(...e){let t;for(let i=0;i<e.length;i+=1){t=e[i];for(let e=0;e<this.length;e+=1)if("string"==typeof t){const i=o.createElement("div");for(i.innerHTML=t;i.firstChild;)this[e].appendChild(i.firstChild)}else if(t instanceof h)for(let i=0;i<t.length;i+=1)this[e].appendChild(t[i]);else this[e].appendChild(t)}return this},prepend:function(e){let t,i;for(t=0;t<this.length;t+=1)if("string"==typeof e){const n=o.createElement("div");for(n.innerHTML=e,i=n.childNodes.length-1;i>=0;i-=1)this[t].insertBefore(n.childNodes[i],this[t].childNodes[0])}else if(e instanceof h)for(i=0;i<e.length;i+=1)this[t].insertBefore(e[i],this[t].childNodes[0]);else this[t].insertBefore(e,this[t].childNodes[0]);return this},next:function(e){return this.length>0?e?this[0].nextElementSibling&&u(this[0].nextElementSibling).is(e)?new h([this[0].nextElementSibling]):new h([]):this[0].nextElementSibling?new h([this[0].nextElementSibling]):new h([]):new h([])},nextAll:function(e){const t=[];let i=this[0];if(!i)return new h([]);for(;i.nextElementSibling;){const n=i.nextElementSibling;e?u(n).is(e)&&t.push(n):t.push(n),i=n}return new h(t)},prev:function(e){if(this.length>0){const t=this[0];return e?t.previousElementSibling&&u(t.previousElementSibling).is(e)?new h([t.previousElementSibling]):new h([]):t.previousElementSibling?new h([t.previousElementSibling]):new h([])}return new h([])},prevAll:function(e){const t=[];let i=this[0];if(!i)return new h([]);for(;i.previousElementSibling;){const n=i.previousElementSibling;e?u(n).is(e)&&t.push(n):t.push(n),i=n}return new h(t)},parent:function(e){const t=[];for(let i=0;i<this.length;i+=1)null!==this[i].parentNode&&(e?u(this[i].parentNode).is(e)&&t.push(this[i].parentNode):t.push(this[i].parentNode));return u(d(t))},parents:function(e){const t=[];for(let i=0;i<this.length;i+=1){let n=this[i].parentNode;for(;n;)e?u(n).is(e)&&t.push(n):t.push(n),n=n.parentNode}return u(d(t))},closest:function(e){let t=this;return void 0===e?new h([]):(t.is(e)||(t=t.parents(e).eq(0)),t)},find:function(e){const t=[];for(let i=0;i<this.length;i+=1){const n=this[i].querySelectorAll(e);for(let e=0;e<n.length;e+=1)t.push(n[e])}return new h(t)},children:function(e){const t=[];for(let i=0;i<this.length;i+=1){const n=this[i].childNodes;for(let i=0;i<n.length;i+=1)e?1===n[i].nodeType&&u(n[i]).is(e)&&t.push(n[i]):1===n[i].nodeType&&t.push(n[i])}return new h(d(t))},filter:function(e){const t=[],i=this;for(let n=0;n<i.length;n+=1)e.call(i[n],n,i[n])&&t.push(i[n]);return new h(t)},remove:function(){for(let e=0;e<this.length;e+=1)this[e].parentNode&&this[e].parentNode.removeChild(this[e]);return this},add:function(...e){const t=this;let i,n;for(i=0;i<e.length;i+=1){const r=u(e[i]);for(n=0;n<r.length;n+=1)t[t.length]=r[n],t.length+=1}return t},styles:function(){return this[0]?c.getComputedStyle(this[0],null):{}}};Object.keys(p).forEach(e=>{u.fn[e]=u.fn[e]||p[e]});const m={deleteProps(e){const t=e;Object.keys(t).forEach(e=>{try{t[e]=null}catch(e){}try{delete t[e]}catch(e){}})},nextTick:(e,t=0)=>setTimeout(e,t),now:()=>Date.now(),getTranslate(e,t="x"){let i,n,r;const a=c.getComputedStyle(e,null);return c.WebKitCSSMatrix?(n=a.transform||a.webkitTransform,n.split(",").length>6&&(n=n.split(", ").map(e=>e.replace(",",".")).join(", ")),r=new c.WebKitCSSMatrix("none"===n?"":n)):(r=a.MozTransform||a.OTransform||a.MsTransform||a.msTransform||a.transform||a.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),i=r.toString().split(",")),"x"===t&&(n=c.WebKitCSSMatrix?r.m41:16===i.length?parseFloat(i[12]):parseFloat(i[4])),"y"===t&&(n=c.WebKitCSSMatrix?r.m42:16===i.length?parseFloat(i[13]):parseFloat(i[5])),n||0},parseUrlQuery(e){const t={};let i,n,r,a,s=e||c.location.href;if("string"==typeof s&&s.length)for(s=s.indexOf("?")>-1?s.replace(/\S*\?/,""):"",n=s.split("&").filter(e=>""!==e),a=n.length,i=0;i<a;i+=1)r=n[i].replace(/#\S+/g,"").split("="),t[decodeURIComponent(r[0])]=void 0===r[1]?void 0:decodeURIComponent(r[1])||"";return t},isObject:e=>"object"==typeof e&&null!==e&&e.constructor&&e.constructor===Object,extend(...e){const t=Object(e[0]);for(let i=1;i<e.length;i+=1){const n=e[i];if(null!=n){const e=Object.keys(Object(n));for(let i=0,r=e.length;i<r;i+=1){const r=e[i],a=Object.getOwnPropertyDescriptor(n,r);void 0!==a&&a.enumerable&&(m.isObject(t[r])&&m.isObject(n[r])?m.extend(t[r],n[r]):!m.isObject(t[r])&&m.isObject(n[r])?(t[r]={},m.extend(t[r],n[r])):t[r]=n[r])}}}return t}},f={touch:!!("ontouchstart"in c||c.DocumentTouch&&o instanceof c.DocumentTouch),pointerEvents:!!c.PointerEvent&&"maxTouchPoints"in c.navigator&&c.navigator.maxTouchPoints>=0,observer:"MutationObserver"in c||"WebkitMutationObserver"in c,passiveListener:function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get(){e=!0}});c.addEventListener("testPassiveListener",null,t)}catch(e){}return e}(),gestures:"ongesturestart"in c};class g{constructor(e={}){const t=this;t.params=e,t.eventsListeners={},t.params&&t.params.on&&Object.keys(t.params.on).forEach(e=>{t.on(e,t.params.on[e])})}on(e,t,i){const n=this;if("function"!=typeof t)return n;const r=i?"unshift":"push";return e.split(" ").forEach(e=>{n.eventsListeners[e]||(n.eventsListeners[e]=[]),n.eventsListeners[e][r](t)}),n}once(e,t,i){const n=this;if("function"!=typeof t)return n;function r(...i){n.off(e,r),r.f7proxy&&delete r.f7proxy,t.apply(n,i)}return r.f7proxy=t,n.on(e,r,i)}off(e,t){const i=this;return i.eventsListeners?(e.split(" ").forEach(e=>{void 0===t?i.eventsListeners[e]=[]:i.eventsListeners[e]&&i.eventsListeners[e].length&&i.eventsListeners[e].forEach((n,r)=>{(n===t||n.f7proxy&&n.f7proxy===t)&&i.eventsListeners[e].splice(r,1)})}),i):i}emit(...e){const t=this;if(!t.eventsListeners)return t;let i,n,r;"string"==typeof e[0]||Array.isArray(e[0])?(i=e[0],n=e.slice(1,e.length),r=t):(i=e[0].events,n=e[0].data,r=e[0].context||t);return(Array.isArray(i)?i:i.split(" ")).forEach(e=>{if(t.eventsListeners&&t.eventsListeners[e]){const i=[];t.eventsListeners[e].forEach(e=>{i.push(e)}),i.forEach(e=>{e.apply(r,n)})}}),t}useModulesParams(e){const t=this;t.modules&&Object.keys(t.modules).forEach(i=>{const n=t.modules[i];n.params&&m.extend(e,n.params)})}useModules(e={}){const t=this;t.modules&&Object.keys(t.modules).forEach(i=>{const n=t.modules[i],r=e[i]||{};n.instance&&Object.keys(n.instance).forEach(e=>{const i=n.instance[e];t[e]="function"==typeof i?i.bind(t):i}),n.on&&t.on&&Object.keys(n.on).forEach(e=>{t.on(e,n.on[e])}),n.create&&n.create.bind(t)(r)})}static set components(e){this.use&&this.use(e)}static installModule(e,...t){const i=this;i.prototype.modules||(i.prototype.modules={});const n=e.name||`${Object.keys(i.prototype.modules).length}_${m.now()}`;return i.prototype.modules[n]=e,e.proto&&Object.keys(e.proto).forEach(t=>{i.prototype[t]=e.proto[t]}),e.static&&Object.keys(e.static).forEach(t=>{i[t]=e.static[t]}),e.install&&e.install.apply(i,t),i}static use(e,...t){const i=this;return Array.isArray(e)?(e.forEach(e=>i.installModule(e)),i):i.installModule(e,...t)}}var v={updateSize:function(){const e=this;let t,i;const n=e.$el;t=void 0!==e.params.width?e.params.width:n[0].clientWidth,i=void 0!==e.params.height?e.params.height:n[0].clientHeight,0===t&&e.isHorizontal()||0===i&&e.isVertical()||(t=t-parseInt(n.css("padding-left"),10)-parseInt(n.css("padding-right"),10),i=i-parseInt(n.css("padding-top"),10)-parseInt(n.css("padding-bottom"),10),m.extend(e,{width:t,height:i,size:e.isHorizontal()?t:i}))},updateSlides:function(){const e=this,t=e.params,{$wrapperEl:i,size:n,rtlTranslate:r,wrongRTL:a}=e,s=e.virtual&&t.virtual.enabled,o=s?e.virtual.slides.length:e.slides.length,l=i.children("."+e.params.slideClass),h=s?e.virtual.slides.length:l.length;let u=[];const d=[],p=[];function f(e){return!t.cssMode||e!==l.length-1}let g=t.slidesOffsetBefore;"function"==typeof g&&(g=t.slidesOffsetBefore.call(e));let v=t.slidesOffsetAfter;"function"==typeof v&&(v=t.slidesOffsetAfter.call(e));const y=e.snapGrid.length,b=e.snapGrid.length;let x,w,_=t.spaceBetween,M=-g,S=0,T=0;if(void 0===n)return;"string"==typeof _&&_.indexOf("%")>=0&&(_=parseFloat(_.replace("%",""))/100*n),e.virtualSize=-_,r?l.css({marginLeft:"",marginTop:""}):l.css({marginRight:"",marginBottom:""}),t.slidesPerColumn>1&&(x=Math.floor(h/t.slidesPerColumn)===h/e.params.slidesPerColumn?h:Math.ceil(h/t.slidesPerColumn)*t.slidesPerColumn,"auto"!==t.slidesPerView&&"row"===t.slidesPerColumnFill&&(x=Math.max(x,t.slidesPerView*t.slidesPerColumn)));const E=t.slidesPerColumn,C=x/E,L=Math.floor(h/t.slidesPerColumn);for(let i=0;i<h;i+=1){w=0;const r=l.eq(i);if(t.slidesPerColumn>1){let n,a,s;if("row"===t.slidesPerColumnFill&&t.slidesPerGroup>1){const e=Math.floor(i/(t.slidesPerGroup*t.slidesPerColumn)),o=i-t.slidesPerColumn*t.slidesPerGroup*e,l=0===e?t.slidesPerGroup:Math.min(Math.ceil((h-e*E*t.slidesPerGroup)/E),t.slidesPerGroup);s=Math.floor(o/l),a=o-s*l+e*t.slidesPerGroup,n=a+s*x/E,r.css({"-webkit-box-ordinal-group":n,"-moz-box-ordinal-group":n,"-ms-flex-order":n,"-webkit-order":n,order:n})}else"column"===t.slidesPerColumnFill?(a=Math.floor(i/E),s=i-a*E,(a>L||a===L&&s===E-1)&&(s+=1,s>=E&&(s=0,a+=1))):(s=Math.floor(i/C),a=i-s*C);r.css("margin-"+(e.isHorizontal()?"top":"left"),0!==s&&t.spaceBetween&&t.spaceBetween+"px")}if("none"!==r.css("display")){if("auto"===t.slidesPerView){const i=c.getComputedStyle(r[0],null),n=r[0].style.transform,a=r[0].style.webkitTransform;if(n&&(r[0].style.transform="none"),a&&(r[0].style.webkitTransform="none"),t.roundLengths)w=e.isHorizontal()?r.outerWidth(!0):r.outerHeight(!0);else if(e.isHorizontal()){const e=parseFloat(i.getPropertyValue("width")),t=parseFloat(i.getPropertyValue("padding-left")),n=parseFloat(i.getPropertyValue("padding-right")),r=parseFloat(i.getPropertyValue("margin-left")),a=parseFloat(i.getPropertyValue("margin-right")),s=i.getPropertyValue("box-sizing");w=s&&"border-box"===s?e+r+a:e+t+n+r+a}else{const e=parseFloat(i.getPropertyValue("height")),t=parseFloat(i.getPropertyValue("padding-top")),n=parseFloat(i.getPropertyValue("padding-bottom")),r=parseFloat(i.getPropertyValue("margin-top")),a=parseFloat(i.getPropertyValue("margin-bottom")),s=i.getPropertyValue("box-sizing");w=s&&"border-box"===s?e+r+a:e+t+n+r+a}n&&(r[0].style.transform=n),a&&(r[0].style.webkitTransform=a),t.roundLengths&&(w=Math.floor(w))}else w=(n-(t.slidesPerView-1)*_)/t.slidesPerView,t.roundLengths&&(w=Math.floor(w)),l[i]&&(e.isHorizontal()?l[i].style.width=w+"px":l[i].style.height=w+"px");l[i]&&(l[i].swiperSlideSize=w),p.push(w),t.centeredSlides?(M=M+w/2+S/2+_,0===S&&0!==i&&(M=M-n/2-_),0===i&&(M=M-n/2-_),Math.abs(M)<.001&&(M=0),t.roundLengths&&(M=Math.floor(M)),T%t.slidesPerGroup==0&&u.push(M),d.push(M)):(t.roundLengths&&(M=Math.floor(M)),(T-Math.min(e.params.slidesPerGroupSkip,T))%e.params.slidesPerGroup==0&&u.push(M),d.push(M),M=M+w+_),e.virtualSize+=w+_,S=w,T+=1}}let A;if(e.virtualSize=Math.max(e.virtualSize,n)+v,r&&a&&("slide"===t.effect||"coverflow"===t.effect)&&i.css({width:e.virtualSize+t.spaceBetween+"px"}),t.setWrapperSize&&(e.isHorizontal()?i.css({width:e.virtualSize+t.spaceBetween+"px"}):i.css({height:e.virtualSize+t.spaceBetween+"px"})),t.slidesPerColumn>1&&(e.virtualSize=(w+t.spaceBetween)*x,e.virtualSize=Math.ceil(e.virtualSize/t.slidesPerColumn)-t.spaceBetween,e.isHorizontal()?i.css({width:e.virtualSize+t.spaceBetween+"px"}):i.css({height:e.virtualSize+t.spaceBetween+"px"}),t.centeredSlides)){A=[];for(let i=0;i<u.length;i+=1){let n=u[i];t.roundLengths&&(n=Math.floor(n)),u[i]<e.virtualSize+u[0]&&A.push(n)}u=A}if(!t.centeredSlides){A=[];for(let i=0;i<u.length;i+=1){let r=u[i];t.roundLengths&&(r=Math.floor(r)),u[i]<=e.virtualSize-n&&A.push(r)}u=A,Math.floor(e.virtualSize-n)-Math.floor(u[u.length-1])>1&&u.push(e.virtualSize-n)}if(0===u.length&&(u=[0]),0!==t.spaceBetween&&(e.isHorizontal()?r?l.filter(f).css({marginLeft:_+"px"}):l.filter(f).css({marginRight:_+"px"}):l.filter(f).css({marginBottom:_+"px"})),t.centeredSlides&&t.centeredSlidesBounds){let e=0;p.forEach(i=>{e+=i+(t.spaceBetween?t.spaceBetween:0)}),e-=t.spaceBetween;const i=e-n;u=u.map(e=>e<0?-g:e>i?i+v:e)}if(t.centerInsufficientSlides){let e=0;if(p.forEach(i=>{e+=i+(t.spaceBetween?t.spaceBetween:0)}),e-=t.spaceBetween,e<n){const t=(n-e)/2;u.forEach((e,i)=>{u[i]=e-t}),d.forEach((e,i)=>{d[i]=e+t})}}m.extend(e,{slides:l,snapGrid:u,slidesGrid:d,slidesSizesGrid:p}),h!==o&&e.emit("slidesLengthChange"),u.length!==y&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),d.length!==b&&e.emit("slidesGridLengthChange"),(t.watchSlidesProgress||t.watchSlidesVisibility)&&e.updateSlidesOffset()},updateAutoHeight:function(e){const t=this,i=[];let n,r=0;if("number"==typeof e?t.setTransition(e):!0===e&&t.setTransition(t.params.speed),"auto"!==t.params.slidesPerView&&t.params.slidesPerView>1)if(t.params.centeredSlides)t.visibleSlides.each((e,t)=>{i.push(t)});else for(n=0;n<Math.ceil(t.params.slidesPerView);n+=1){const e=t.activeIndex+n;if(e>t.slides.length)break;i.push(t.slides.eq(e)[0])}else i.push(t.slides.eq(t.activeIndex)[0]);for(n=0;n<i.length;n+=1)if(void 0!==i[n]){const e=i[n].offsetHeight;r=e>r?e:r}r&&t.$wrapperEl.css("height",r+"px")},updateSlidesOffset:function(){const e=this,t=e.slides;for(let i=0;i<t.length;i+=1)t[i].swiperSlideOffset=e.isHorizontal()?t[i].offsetLeft:t[i].offsetTop},updateSlidesProgress:function(e=this&&this.translate||0){const t=this,i=t.params,{slides:n,rtlTranslate:r}=t;if(0===n.length)return;void 0===n[0].swiperSlideOffset&&t.updateSlidesOffset();let a=-e;r&&(a=e),n.removeClass(i.slideVisibleClass),t.visibleSlidesIndexes=[],t.visibleSlides=[];for(let e=0;e<n.length;e+=1){const s=n[e],o=(a+(i.centeredSlides?t.minTranslate():0)-s.swiperSlideOffset)/(s.swiperSlideSize+i.spaceBetween);if(i.watchSlidesVisibility||i.centeredSlides&&i.autoHeight){const r=-(a-s.swiperSlideOffset),o=r+t.slidesSizesGrid[e];(r>=0&&r<t.size-1||o>1&&o<=t.size||r<=0&&o>=t.size)&&(t.visibleSlides.push(s),t.visibleSlidesIndexes.push(e),n.eq(e).addClass(i.slideVisibleClass))}s.progress=r?-o:o}t.visibleSlides=u(t.visibleSlides)},updateProgress:function(e){const t=this;if(void 0===e){const i=t.rtlTranslate?-1:1;e=t&&t.translate&&t.translate*i||0}const i=t.params,n=t.maxTranslate()-t.minTranslate();let{progress:r,isBeginning:a,isEnd:s}=t;const o=a,l=s;0===n?(r=0,a=!0,s=!0):(r=(e-t.minTranslate())/n,a=r<=0,s=r>=1),m.extend(t,{progress:r,isBeginning:a,isEnd:s}),(i.watchSlidesProgress||i.watchSlidesVisibility||i.centeredSlides&&i.autoHeight)&&t.updateSlidesProgress(e),a&&!o&&t.emit("reachBeginning toEdge"),s&&!l&&t.emit("reachEnd toEdge"),(o&&!a||l&&!s)&&t.emit("fromEdge"),t.emit("progress",r)},updateSlidesClasses:function(){const e=this,{slides:t,params:i,$wrapperEl:n,activeIndex:r,realIndex:a}=e,s=e.virtual&&i.virtual.enabled;let o;t.removeClass(`${i.slideActiveClass} ${i.slideNextClass} ${i.slidePrevClass} ${i.slideDuplicateActiveClass} ${i.slideDuplicateNextClass} ${i.slideDuplicatePrevClass}`),o=s?e.$wrapperEl.find(`.${i.slideClass}[data-swiper-slide-index="${r}"]`):t.eq(r),o.addClass(i.slideActiveClass),i.loop&&(o.hasClass(i.slideDuplicateClass)?n.children(`.${i.slideClass}:not(.${i.slideDuplicateClass})[data-swiper-slide-index="${a}"]`).addClass(i.slideDuplicateActiveClass):n.children(`.${i.slideClass}.${i.slideDuplicateClass}[data-swiper-slide-index="${a}"]`).addClass(i.slideDuplicateActiveClass));let l=o.nextAll("."+i.slideClass).eq(0).addClass(i.slideNextClass);i.loop&&0===l.length&&(l=t.eq(0),l.addClass(i.slideNextClass));let c=o.prevAll("."+i.slideClass).eq(0).addClass(i.slidePrevClass);i.loop&&0===c.length&&(c=t.eq(-1),c.addClass(i.slidePrevClass)),i.loop&&(l.hasClass(i.slideDuplicateClass)?n.children(`.${i.slideClass}:not(.${i.slideDuplicateClass})[data-swiper-slide-index="${l.attr("data-swiper-slide-index")}"]`).addClass(i.slideDuplicateNextClass):n.children(`.${i.slideClass}.${i.slideDuplicateClass}[data-swiper-slide-index="${l.attr("data-swiper-slide-index")}"]`).addClass(i.slideDuplicateNextClass),c.hasClass(i.slideDuplicateClass)?n.children(`.${i.slideClass}:not(.${i.slideDuplicateClass})[data-swiper-slide-index="${c.attr("data-swiper-slide-index")}"]`).addClass(i.slideDuplicatePrevClass):n.children(`.${i.slideClass}.${i.slideDuplicateClass}[data-swiper-slide-index="${c.attr("data-swiper-slide-index")}"]`).addClass(i.slideDuplicatePrevClass))},updateActiveIndex:function(e){const t=this,i=t.rtlTranslate?t.translate:-t.translate,{slidesGrid:n,snapGrid:r,params:a,activeIndex:s,realIndex:o,snapIndex:l}=t;let c,h=e;if(void 0===h){for(let e=0;e<n.length;e+=1)void 0!==n[e+1]?i>=n[e]&&i<n[e+1]-(n[e+1]-n[e])/2?h=e:i>=n[e]&&i<n[e+1]&&(h=e+1):i>=n[e]&&(h=e);a.normalizeSlideIndex&&(h<0||void 0===h)&&(h=0)}if(r.indexOf(i)>=0)c=r.indexOf(i);else{const e=Math.min(a.slidesPerGroupSkip,h);c=e+Math.floor((h-e)/a.slidesPerGroup)}if(c>=r.length&&(c=r.length-1),h===s)return void(c!==l&&(t.snapIndex=c,t.emit("snapIndexChange")));const u=parseInt(t.slides.eq(h).attr("data-swiper-slide-index")||h,10);m.extend(t,{snapIndex:c,realIndex:u,previousIndex:s,activeIndex:h}),t.emit("activeIndexChange"),t.emit("snapIndexChange"),o!==u&&t.emit("realIndexChange"),(t.initialized||t.params.runCallbacksOnInit)&&t.emit("slideChange")},updateClickedSlide:function(e){const t=this,i=t.params,n=u(e.target).closest("."+i.slideClass)[0];let r=!1;if(n)for(let e=0;e<t.slides.length;e+=1)t.slides[e]===n&&(r=!0);if(!n||!r)return t.clickedSlide=void 0,void(t.clickedIndex=void 0);t.clickedSlide=n,t.virtual&&t.params.virtual.enabled?t.clickedIndex=parseInt(u(n).attr("data-swiper-slide-index"),10):t.clickedIndex=u(n).index(),i.slideToClickedSlide&&void 0!==t.clickedIndex&&t.clickedIndex!==t.activeIndex&&t.slideToClickedSlide()}};var y={getTranslate:function(e=(this.isHorizontal()?"x":"y")){const{params:t,rtlTranslate:i,translate:n,$wrapperEl:r}=this;if(t.virtualTranslate)return i?-n:n;if(t.cssMode)return n;let a=m.getTranslate(r[0],e);return i&&(a=-a),a||0},setTranslate:function(e,t){const i=this,{rtlTranslate:n,params:r,$wrapperEl:a,wrapperEl:s,progress:o}=i;let l,c=0,h=0;i.isHorizontal()?c=n?-e:e:h=e,r.roundLengths&&(c=Math.floor(c),h=Math.floor(h)),r.cssMode?s[i.isHorizontal()?"scrollLeft":"scrollTop"]=i.isHorizontal()?-c:-h:r.virtualTranslate||a.transform(`translate3d(${c}px, ${h}px, 0px)`),i.previousTranslate=i.translate,i.translate=i.isHorizontal()?c:h;const u=i.maxTranslate()-i.minTranslate();l=0===u?0:(e-i.minTranslate())/u,l!==o&&i.updateProgress(e),i.emit("setTranslate",i.translate,t)},minTranslate:function(){return-this.snapGrid[0]},maxTranslate:function(){return-this.snapGrid[this.snapGrid.length-1]},translateTo:function(e=0,t=this.params.speed,i=!0,n=!0,r){const a=this,{params:s,wrapperEl:o}=a;if(a.animating&&s.preventInteractionOnTransition)return!1;const l=a.minTranslate(),c=a.maxTranslate();let h;if(h=n&&e>l?l:n&&e<c?c:e,a.updateProgress(h),s.cssMode){const e=a.isHorizontal();return 0===t?o[e?"scrollLeft":"scrollTop"]=-h:o.scrollTo?o.scrollTo({[e?"left":"top"]:-h,behavior:"smooth"}):o[e?"scrollLeft":"scrollTop"]=-h,!0}return 0===t?(a.setTransition(0),a.setTranslate(h),i&&(a.emit("beforeTransitionStart",t,r),a.emit("transitionEnd"))):(a.setTransition(t),a.setTranslate(h),i&&(a.emit("beforeTransitionStart",t,r),a.emit("transitionStart")),a.animating||(a.animating=!0,a.onTranslateToWrapperTransitionEnd||(a.onTranslateToWrapperTransitionEnd=function(e){a&&!a.destroyed&&e.target===this&&(a.$wrapperEl[0].removeEventListener("transitionend",a.onTranslateToWrapperTransitionEnd),a.$wrapperEl[0].removeEventListener("webkitTransitionEnd",a.onTranslateToWrapperTransitionEnd),a.onTranslateToWrapperTransitionEnd=null,delete a.onTranslateToWrapperTransitionEnd,i&&a.emit("transitionEnd"))}),a.$wrapperEl[0].addEventListener("transitionend",a.onTranslateToWrapperTransitionEnd),a.$wrapperEl[0].addEventListener("webkitTransitionEnd",a.onTranslateToWrapperTransitionEnd))),!0}};var b={setTransition:function(e,t){const i=this;i.params.cssMode||i.$wrapperEl.transition(e),i.emit("setTransition",e,t)},transitionStart:function(e=!0,t){const i=this,{activeIndex:n,params:r,previousIndex:a}=i;if(r.cssMode)return;r.autoHeight&&i.updateAutoHeight();let s=t;if(s||(s=n>a?"next":n<a?"prev":"reset"),i.emit("transitionStart"),e&&n!==a){if("reset"===s)return void i.emit("slideResetTransitionStart");i.emit("slideChangeTransitionStart"),"next"===s?i.emit("slideNextTransitionStart"):i.emit("slidePrevTransitionStart")}},transitionEnd:function(e=!0,t){const i=this,{activeIndex:n,previousIndex:r,params:a}=i;if(i.animating=!1,a.cssMode)return;i.setTransition(0);let s=t;if(s||(s=n>r?"next":n<r?"prev":"reset"),i.emit("transitionEnd"),e&&n!==r){if("reset"===s)return void i.emit("slideResetTransitionEnd");i.emit("slideChangeTransitionEnd"),"next"===s?i.emit("slideNextTransitionEnd"):i.emit("slidePrevTransitionEnd")}}};var x={slideTo:function(e=0,t=this.params.speed,i=!0,n){const r=this;let a=e;a<0&&(a=0);const{params:s,snapGrid:o,slidesGrid:l,previousIndex:c,activeIndex:h,rtlTranslate:u,wrapperEl:d}=r;if(r.animating&&s.preventInteractionOnTransition)return!1;const p=Math.min(r.params.slidesPerGroupSkip,a);let m=p+Math.floor((a-p)/r.params.slidesPerGroup);m>=o.length&&(m=o.length-1),(h||s.initialSlide||0)===(c||0)&&i&&r.emit("beforeSlideChangeStart");const f=-o[m];if(r.updateProgress(f),s.normalizeSlideIndex)for(let e=0;e<l.length;e+=1)-Math.floor(100*f)>=Math.floor(100*l[e])&&(a=e);if(r.initialized&&a!==h){if(!r.allowSlideNext&&f<r.translate&&f<r.minTranslate())return!1;if(!r.allowSlidePrev&&f>r.translate&&f>r.maxTranslate()&&(h||0)!==a)return!1}let g;if(g=a>h?"next":a<h?"prev":"reset",u&&-f===r.translate||!u&&f===r.translate)return r.updateActiveIndex(a),s.autoHeight&&r.updateAutoHeight(),r.updateSlidesClasses(),"slide"!==s.effect&&r.setTranslate(f),"reset"!==g&&(r.transitionStart(i,g),r.transitionEnd(i,g)),!1;if(s.cssMode){const e=r.isHorizontal();let i=-f;return u&&(i=d.scrollWidth-d.offsetWidth-i),0===t?d[e?"scrollLeft":"scrollTop"]=i:d.scrollTo?d.scrollTo({[e?"left":"top"]:i,behavior:"smooth"}):d[e?"scrollLeft":"scrollTop"]=i,!0}return 0===t?(r.setTransition(0),r.setTranslate(f),r.updateActiveIndex(a),r.updateSlidesClasses(),r.emit("beforeTransitionStart",t,n),r.transitionStart(i,g),r.transitionEnd(i,g)):(r.setTransition(t),r.setTranslate(f),r.updateActiveIndex(a),r.updateSlidesClasses(),r.emit("beforeTransitionStart",t,n),r.transitionStart(i,g),r.animating||(r.animating=!0,r.onSlideToWrapperTransitionEnd||(r.onSlideToWrapperTransitionEnd=function(e){r&&!r.destroyed&&e.target===this&&(r.$wrapperEl[0].removeEventListener("transitionend",r.onSlideToWrapperTransitionEnd),r.$wrapperEl[0].removeEventListener("webkitTransitionEnd",r.onSlideToWrapperTransitionEnd),r.onSlideToWrapperTransitionEnd=null,delete r.onSlideToWrapperTransitionEnd,r.transitionEnd(i,g))}),r.$wrapperEl[0].addEventListener("transitionend",r.onSlideToWrapperTransitionEnd),r.$wrapperEl[0].addEventListener("webkitTransitionEnd",r.onSlideToWrapperTransitionEnd))),!0},slideToLoop:function(e=0,t=this.params.speed,i=!0,n){const r=this;let a=e;return r.params.loop&&(a+=r.loopedSlides),r.slideTo(a,t,i,n)},slideNext:function(e=this.params.speed,t=!0,i){const n=this,{params:r,animating:a}=n,s=n.activeIndex<r.slidesPerGroupSkip?1:r.slidesPerGroup;if(r.loop){if(a)return!1;n.loopFix(),n._clientLeft=n.$wrapperEl[0].clientLeft}return n.slideTo(n.activeIndex+s,e,t,i)},slidePrev:function(e=this.params.speed,t=!0,i){const n=this,{params:r,animating:a,snapGrid:s,slidesGrid:o,rtlTranslate:l}=n;if(r.loop){if(a)return!1;n.loopFix(),n._clientLeft=n.$wrapperEl[0].clientLeft}function c(e){return e<0?-Math.floor(Math.abs(e)):Math.floor(e)}const h=c(l?n.translate:-n.translate),u=s.map(e=>c(e));o.map(e=>c(e)),s[u.indexOf(h)];let d,p=s[u.indexOf(h)-1];return void 0===p&&r.cssMode&&s.forEach(e=>{!p&&h>=e&&(p=e)}),void 0!==p&&(d=o.indexOf(p),d<0&&(d=n.activeIndex-1)),n.slideTo(d,e,t,i)},slideReset:function(e=this.params.speed,t=!0,i){return this.slideTo(this.activeIndex,e,t,i)},slideToClosest:function(e=this.params.speed,t=!0,i,n=.5){const r=this;let a=r.activeIndex;const s=Math.min(r.params.slidesPerGroupSkip,a),o=s+Math.floor((a-s)/r.params.slidesPerGroup),l=r.rtlTranslate?r.translate:-r.translate;if(l>=r.snapGrid[o]){const e=r.snapGrid[o];l-e>(r.snapGrid[o+1]-e)*n&&(a+=r.params.slidesPerGroup)}else{const e=r.snapGrid[o-1];l-e<=(r.snapGrid[o]-e)*n&&(a-=r.params.slidesPerGroup)}return a=Math.max(a,0),a=Math.min(a,r.slidesGrid.length-1),r.slideTo(a,e,t,i)},slideToClickedSlide:function(){const e=this,{params:t,$wrapperEl:i}=e,n="auto"===t.slidesPerView?e.slidesPerViewDynamic():t.slidesPerView;let r,a=e.clickedIndex;if(t.loop){if(e.animating)return;r=parseInt(u(e.clickedSlide).attr("data-swiper-slide-index"),10),t.centeredSlides?a<e.loopedSlides-n/2||a>e.slides.length-e.loopedSlides+n/2?(e.loopFix(),a=i.children(`.${t.slideClass}[data-swiper-slide-index="${r}"]:not(.${t.slideDuplicateClass})`).eq(0).index(),m.nextTick(()=>{e.slideTo(a)})):e.slideTo(a):a>e.slides.length-n?(e.loopFix(),a=i.children(`.${t.slideClass}[data-swiper-slide-index="${r}"]:not(.${t.slideDuplicateClass})`).eq(0).index(),m.nextTick(()=>{e.slideTo(a)})):e.slideTo(a)}else e.slideTo(a)}};var w={loopCreate:function(){const e=this,{params:t,$wrapperEl:i}=e;i.children(`.${t.slideClass}.${t.slideDuplicateClass}`).remove();let n=i.children("."+t.slideClass);if(t.loopFillGroupWithBlank){const e=t.slidesPerGroup-n.length%t.slidesPerGroup;if(e!==t.slidesPerGroup){for(let n=0;n<e;n+=1){const e=u(o.createElement("div")).addClass(`${t.slideClass} ${t.slideBlankClass}`);i.append(e)}n=i.children("."+t.slideClass)}}"auto"!==t.slidesPerView||t.loopedSlides||(t.loopedSlides=n.length),e.loopedSlides=Math.ceil(parseFloat(t.loopedSlides||t.slidesPerView,10)),e.loopedSlides+=t.loopAdditionalSlides,e.loopedSlides>n.length&&(e.loopedSlides=n.length);const r=[],a=[];n.each((t,i)=>{const s=u(i);t<e.loopedSlides&&a.push(i),t<n.length&&t>=n.length-e.loopedSlides&&r.push(i),s.attr("data-swiper-slide-index",t)});for(let e=0;e<a.length;e+=1)i.append(u(a[e].cloneNode(!0)).addClass(t.slideDuplicateClass));for(let e=r.length-1;e>=0;e-=1)i.prepend(u(r[e].cloneNode(!0)).addClass(t.slideDuplicateClass))},loopFix:function(){const e=this;e.emit("beforeLoopFix");const{activeIndex:t,slides:i,loopedSlides:n,allowSlidePrev:r,allowSlideNext:a,snapGrid:s,rtlTranslate:o}=e;let l;e.allowSlidePrev=!0,e.allowSlideNext=!0;const c=-s[t]-e.getTranslate();if(t<n){l=i.length-3*n+t,l+=n;e.slideTo(l,0,!1,!0)&&0!==c&&e.setTranslate((o?-e.translate:e.translate)-c)}else if(t>=i.length-n){l=-i.length+t+n,l+=n;e.slideTo(l,0,!1,!0)&&0!==c&&e.setTranslate((o?-e.translate:e.translate)-c)}e.allowSlidePrev=r,e.allowSlideNext=a,e.emit("loopFix")},loopDestroy:function(){const{$wrapperEl:e,params:t,slides:i}=this;e.children(`.${t.slideClass}.${t.slideDuplicateClass},.${t.slideClass}.${t.slideBlankClass}`).remove(),i.removeAttr("data-swiper-slide-index")}};var _={setGrabCursor:function(e){if(f.touch||!this.params.simulateTouch||this.params.watchOverflow&&this.isLocked||this.params.cssMode)return;const t=this.el;t.style.cursor="move",t.style.cursor=e?"-webkit-grabbing":"-webkit-grab",t.style.cursor=e?"-moz-grabbin":"-moz-grab",t.style.cursor=e?"grabbing":"grab"},unsetGrabCursor:function(){f.touch||this.params.watchOverflow&&this.isLocked||this.params.cssMode||(this.el.style.cursor="")}};var M={appendSlide:function(e){const t=this,{$wrapperEl:i,params:n}=t;if(n.loop&&t.loopDestroy(),"object"==typeof e&&"length"in e)for(let t=0;t<e.length;t+=1)e[t]&&i.append(e[t]);else i.append(e);n.loop&&t.loopCreate(),n.observer&&f.observer||t.update()},prependSlide:function(e){const t=this,{params:i,$wrapperEl:n,activeIndex:r}=t;i.loop&&t.loopDestroy();let a=r+1;if("object"==typeof e&&"length"in e){for(let t=0;t<e.length;t+=1)e[t]&&n.prepend(e[t]);a=r+e.length}else n.prepend(e);i.loop&&t.loopCreate(),i.observer&&f.observer||t.update(),t.slideTo(a,0,!1)},addSlide:function(e,t){const i=this,{$wrapperEl:n,params:r,activeIndex:a}=i;let s=a;r.loop&&(s-=i.loopedSlides,i.loopDestroy(),i.slides=n.children("."+r.slideClass));const o=i.slides.length;if(e<=0)return void i.prependSlide(t);if(e>=o)return void i.appendSlide(t);let l=s>e?s+1:s;const c=[];for(let t=o-1;t>=e;t-=1){const e=i.slides.eq(t);e.remove(),c.unshift(e)}if("object"==typeof t&&"length"in t){for(let e=0;e<t.length;e+=1)t[e]&&n.append(t[e]);l=s>e?s+t.length:s}else n.append(t);for(let e=0;e<c.length;e+=1)n.append(c[e]);r.loop&&i.loopCreate(),r.observer&&f.observer||i.update(),r.loop?i.slideTo(l+i.loopedSlides,0,!1):i.slideTo(l,0,!1)},removeSlide:function(e){const t=this,{params:i,$wrapperEl:n,activeIndex:r}=t;let a=r;i.loop&&(a-=t.loopedSlides,t.loopDestroy(),t.slides=n.children("."+i.slideClass));let s,o=a;if("object"==typeof e&&"length"in e){for(let i=0;i<e.length;i+=1)s=e[i],t.slides[s]&&t.slides.eq(s).remove(),s<o&&(o-=1);o=Math.max(o,0)}else s=e,t.slides[s]&&t.slides.eq(s).remove(),s<o&&(o-=1),o=Math.max(o,0);i.loop&&t.loopCreate(),i.observer&&f.observer||t.update(),i.loop?t.slideTo(o+t.loopedSlides,0,!1):t.slideTo(o,0,!1)},removeAllSlides:function(){const e=this,t=[];for(let i=0;i<e.slides.length;i+=1)t.push(i);e.removeSlide(t)}};const S=function(){const e=c.navigator.platform,t=c.navigator.userAgent,i={ios:!1,android:!1,androidChrome:!1,desktop:!1,iphone:!1,ipod:!1,ipad:!1,edge:!1,ie:!1,firefox:!1,macos:!1,windows:!1,cordova:!(!c.cordova&&!c.phonegap),phonegap:!(!c.cordova&&!c.phonegap),electron:!1},n=c.screen.width,r=c.screen.height,a=t.match(/(Android);?[\s\/]+([\d.]+)?/);let s=t.match(/(iPad).*OS\s([\d_]+)/);const o=t.match(/(iPod)(.*OS\s([\d_]+))?/),l=!s&&t.match(/(iPhone\sOS|iOS)\s([\d_]+)/),h=t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0,u=t.indexOf("Edge/")>=0,d=t.indexOf("Gecko/")>=0&&t.indexOf("Firefox/")>=0,p="Win32"===e,m=t.toLowerCase().indexOf("electron")>=0;let g="MacIntel"===e;return!s&&g&&f.touch&&(1024===n&&1366===r||834===n&&1194===r||834===n&&1112===r||768===n&&1024===r)&&(s=t.match(/(Version)\/([\d.]+)/),g=!1),i.ie=h,i.edge=u,i.firefox=d,a&&!p&&(i.os="android",i.osVersion=a[2],i.android=!0,i.androidChrome=t.toLowerCase().indexOf("chrome")>=0),(s||l||o)&&(i.os="ios",i.ios=!0),l&&!o&&(i.osVersion=l[2].replace(/_/g,"."),i.iphone=!0),s&&(i.osVersion=s[2].replace(/_/g,"."),i.ipad=!0),o&&(i.osVersion=o[3]?o[3].replace(/_/g,"."):null,i.ipod=!0),i.ios&&i.osVersion&&t.indexOf("Version/")>=0&&"10"===i.osVersion.split(".")[0]&&(i.osVersion=t.toLowerCase().split("version/")[1].split(" ")[0]),i.webView=!(!(l||s||o)||!t.match(/.*AppleWebKit(?!.*Safari)/i)&&!c.navigator.standalone)||c.matchMedia&&c.matchMedia("(display-mode: standalone)").matches,i.webview=i.webView,i.standalone=i.webView,i.desktop=!(i.ios||i.android)||m,i.desktop&&(i.electron=m,i.macos=g,i.windows=p,i.macos&&(i.os="macos"),i.windows&&(i.os="windows")),i.pixelRatio=c.devicePixelRatio||1,i}();function T(e){const t=this,i=t.touchEventsData,{params:n,touches:r}=t;if(t.animating&&n.preventInteractionOnTransition)return;let a=e;a.originalEvent&&(a=a.originalEvent);const s=u(a.target);if("wrapper"===n.touchEventsTarget&&!s.closest(t.wrapperEl).length)return;if(i.isTouchEvent="touchstart"===a.type,!i.isTouchEvent&&"which"in a&&3===a.which)return;if(!i.isTouchEvent&&"button"in a&&a.button>0)return;if(i.isTouched&&i.isMoved)return;if(n.noSwiping&&s.closest(n.noSwipingSelector?n.noSwipingSelector:"."+n.noSwipingClass)[0])return void(t.allowClick=!0);if(n.swipeHandler&&!s.closest(n.swipeHandler)[0])return;r.currentX="touchstart"===a.type?a.targetTouches[0].pageX:a.pageX,r.currentY="touchstart"===a.type?a.targetTouches[0].pageY:a.pageY;const l=r.currentX,h=r.currentY,d=n.edgeSwipeDetection||n.iOSEdgeSwipeDetection,p=n.edgeSwipeThreshold||n.iOSEdgeSwipeThreshold;if(!d||!(l<=p||l>=c.screen.width-p)){if(m.extend(i,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),r.startX=l,r.startY=h,i.touchStartTime=m.now(),t.allowClick=!0,t.updateSize(),t.swipeDirection=void 0,n.threshold>0&&(i.allowThresholdMove=!1),"touchstart"!==a.type){let e=!0;s.is(i.formElements)&&(e=!1),o.activeElement&&u(o.activeElement).is(i.formElements)&&o.activeElement!==s[0]&&o.activeElement.blur();const r=e&&t.allowTouchMove&&n.touchStartPreventDefault;(n.touchStartForcePreventDefault||r)&&a.preventDefault()}t.emit("touchStart",a)}}function E(e){const t=this,i=t.touchEventsData,{params:n,touches:r,rtlTranslate:a}=t;let s=e;if(s.originalEvent&&(s=s.originalEvent),!i.isTouched)return void(i.startMoving&&i.isScrolling&&t.emit("touchMoveOpposite",s));if(i.isTouchEvent&&"touchmove"!==s.type)return;const l="touchmove"===s.type&&s.targetTouches&&(s.targetTouches[0]||s.changedTouches[0]),c="touchmove"===s.type?l.pageX:s.pageX,h="touchmove"===s.type?l.pageY:s.pageY;if(s.preventedByNestedSwiper)return r.startX=c,void(r.startY=h);if(!t.allowTouchMove)return t.allowClick=!1,void(i.isTouched&&(m.extend(r,{startX:c,startY:h,currentX:c,currentY:h}),i.touchStartTime=m.now()));if(i.isTouchEvent&&n.touchReleaseOnEdges&&!n.loop)if(t.isVertical()){if(h<r.startY&&t.translate<=t.maxTranslate()||h>r.startY&&t.translate>=t.minTranslate())return i.isTouched=!1,void(i.isMoved=!1)}else if(c<r.startX&&t.translate<=t.maxTranslate()||c>r.startX&&t.translate>=t.minTranslate())return;if(i.isTouchEvent&&o.activeElement&&s.target===o.activeElement&&u(s.target).is(i.formElements))return i.isMoved=!0,void(t.allowClick=!1);if(i.allowTouchCallbacks&&t.emit("touchMove",s),s.targetTouches&&s.targetTouches.length>1)return;r.currentX=c,r.currentY=h;const d=r.currentX-r.startX,p=r.currentY-r.startY;if(t.params.threshold&&Math.sqrt(d**2+p**2)<t.params.threshold)return;if(void 0===i.isScrolling){let e;t.isHorizontal()&&r.currentY===r.startY||t.isVertical()&&r.currentX===r.startX?i.isScrolling=!1:d*d+p*p>=25&&(e=180*Math.atan2(Math.abs(p),Math.abs(d))/Math.PI,i.isScrolling=t.isHorizontal()?e>n.touchAngle:90-e>n.touchAngle)}if(i.isScrolling&&t.emit("touchMoveOpposite",s),void 0===i.startMoving&&(r.currentX===r.startX&&r.currentY===r.startY||(i.startMoving=!0)),i.isScrolling)return void(i.isTouched=!1);if(!i.startMoving)return;t.allowClick=!1,!n.cssMode&&s.cancelable&&s.preventDefault(),n.touchMoveStopPropagation&&!n.nested&&s.stopPropagation(),i.isMoved||(n.loop&&t.loopFix(),i.startTranslate=t.getTranslate(),t.setTransition(0),t.animating&&t.$wrapperEl.trigger("webkitTransitionEnd transitionend"),i.allowMomentumBounce=!1,!n.grabCursor||!0!==t.allowSlideNext&&!0!==t.allowSlidePrev||t.setGrabCursor(!0),t.emit("sliderFirstMove",s)),t.emit("sliderMove",s),i.isMoved=!0;let f=t.isHorizontal()?d:p;r.diff=f,f*=n.touchRatio,a&&(f=-f),t.swipeDirection=f>0?"prev":"next",i.currentTranslate=f+i.startTranslate;let g=!0,v=n.resistanceRatio;if(n.touchReleaseOnEdges&&(v=0),f>0&&i.currentTranslate>t.minTranslate()?(g=!1,n.resistance&&(i.currentTranslate=t.minTranslate()-1+(-t.minTranslate()+i.startTranslate+f)**v)):f<0&&i.currentTranslate<t.maxTranslate()&&(g=!1,n.resistance&&(i.currentTranslate=t.maxTranslate()+1-(t.maxTranslate()-i.startTranslate-f)**v)),g&&(s.preventedByNestedSwiper=!0),!t.allowSlideNext&&"next"===t.swipeDirection&&i.currentTranslate<i.startTranslate&&(i.currentTranslate=i.startTranslate),!t.allowSlidePrev&&"prev"===t.swipeDirection&&i.currentTranslate>i.startTranslate&&(i.currentTranslate=i.startTranslate),n.threshold>0){if(!(Math.abs(f)>n.threshold||i.allowThresholdMove))return void(i.currentTranslate=i.startTranslate);if(!i.allowThresholdMove)return i.allowThresholdMove=!0,r.startX=r.currentX,r.startY=r.currentY,i.currentTranslate=i.startTranslate,void(r.diff=t.isHorizontal()?r.currentX-r.startX:r.currentY-r.startY)}n.followFinger&&!n.cssMode&&((n.freeMode||n.watchSlidesProgress||n.watchSlidesVisibility)&&(t.updateActiveIndex(),t.updateSlidesClasses()),n.freeMode&&(0===i.velocities.length&&i.velocities.push({position:r[t.isHorizontal()?"startX":"startY"],time:i.touchStartTime}),i.velocities.push({position:r[t.isHorizontal()?"currentX":"currentY"],time:m.now()})),t.updateProgress(i.currentTranslate),t.setTranslate(i.currentTranslate))}function C(e){const t=this,i=t.touchEventsData,{params:n,touches:r,rtlTranslate:a,$wrapperEl:s,slidesGrid:o,snapGrid:l}=t;let c=e;if(c.originalEvent&&(c=c.originalEvent),i.allowTouchCallbacks&&t.emit("touchEnd",c),i.allowTouchCallbacks=!1,!i.isTouched)return i.isMoved&&n.grabCursor&&t.setGrabCursor(!1),i.isMoved=!1,void(i.startMoving=!1);n.grabCursor&&i.isMoved&&i.isTouched&&(!0===t.allowSlideNext||!0===t.allowSlidePrev)&&t.setGrabCursor(!1);const h=m.now(),u=h-i.touchStartTime;if(t.allowClick&&(t.updateClickedSlide(c),t.emit("tap click",c),u<300&&h-i.lastClickTime<300&&t.emit("doubleTap doubleClick",c)),i.lastClickTime=m.now(),m.nextTick(()=>{t.destroyed||(t.allowClick=!0)}),!i.isTouched||!i.isMoved||!t.swipeDirection||0===r.diff||i.currentTranslate===i.startTranslate)return i.isTouched=!1,i.isMoved=!1,void(i.startMoving=!1);let d;if(i.isTouched=!1,i.isMoved=!1,i.startMoving=!1,d=n.followFinger?a?t.translate:-t.translate:-i.currentTranslate,n.cssMode)return;if(n.freeMode){if(d<-t.minTranslate())return void t.slideTo(t.activeIndex);if(d>-t.maxTranslate())return void(t.slides.length<l.length?t.slideTo(l.length-1):t.slideTo(t.slides.length-1));if(n.freeModeMomentum){if(i.velocities.length>1){const e=i.velocities.pop(),r=i.velocities.pop(),a=e.position-r.position,s=e.time-r.time;t.velocity=a/s,t.velocity/=2,Math.abs(t.velocity)<n.freeModeMinimumVelocity&&(t.velocity=0),(s>150||m.now()-e.time>300)&&(t.velocity=0)}else t.velocity=0;t.velocity*=n.freeModeMomentumVelocityRatio,i.velocities.length=0;let e=1e3*n.freeModeMomentumRatio;const r=t.velocity*e;let o=t.translate+r;a&&(o=-o);let c,h=!1;const u=20*Math.abs(t.velocity)*n.freeModeMomentumBounceRatio;let d;if(o<t.maxTranslate())n.freeModeMomentumBounce?(o+t.maxTranslate()<-u&&(o=t.maxTranslate()-u),c=t.maxTranslate(),h=!0,i.allowMomentumBounce=!0):o=t.maxTranslate(),n.loop&&n.centeredSlides&&(d=!0);else if(o>t.minTranslate())n.freeModeMomentumBounce?(o-t.minTranslate()>u&&(o=t.minTranslate()+u),c=t.minTranslate(),h=!0,i.allowMomentumBounce=!0):o=t.minTranslate(),n.loop&&n.centeredSlides&&(d=!0);else if(n.freeModeSticky){let e;for(let t=0;t<l.length;t+=1)if(l[t]>-o){e=t;break}o=Math.abs(l[e]-o)<Math.abs(l[e-1]-o)||"next"===t.swipeDirection?l[e]:l[e-1],o=-o}if(d&&t.once("transitionEnd",()=>{t.loopFix()}),0!==t.velocity){if(e=a?Math.abs((-o-t.translate)/t.velocity):Math.abs((o-t.translate)/t.velocity),n.freeModeSticky){const i=Math.abs((a?-o:o)-t.translate),r=t.slidesSizesGrid[t.activeIndex];e=i<r?n.speed:i<2*r?1.5*n.speed:2.5*n.speed}}else if(n.freeModeSticky)return void t.slideToClosest();n.freeModeMomentumBounce&&h?(t.updateProgress(c),t.setTransition(e),t.setTranslate(o),t.transitionStart(!0,t.swipeDirection),t.animating=!0,s.transitionEnd(()=>{t&&!t.destroyed&&i.allowMomentumBounce&&(t.emit("momentumBounce"),t.setTransition(n.speed),setTimeout(()=>{t.setTranslate(c),s.transitionEnd(()=>{t&&!t.destroyed&&t.transitionEnd()})},0))})):t.velocity?(t.updateProgress(o),t.setTransition(e),t.setTranslate(o),t.transitionStart(!0,t.swipeDirection),t.animating||(t.animating=!0,s.transitionEnd(()=>{t&&!t.destroyed&&t.transitionEnd()}))):t.updateProgress(o),t.updateActiveIndex(),t.updateSlidesClasses()}else if(n.freeModeSticky)return void t.slideToClosest();return void((!n.freeModeMomentum||u>=n.longSwipesMs)&&(t.updateProgress(),t.updateActiveIndex(),t.updateSlidesClasses()))}let p=0,f=t.slidesSizesGrid[0];for(let e=0;e<o.length;e+=e<n.slidesPerGroupSkip?1:n.slidesPerGroup){const t=e<n.slidesPerGroupSkip-1?1:n.slidesPerGroup;void 0!==o[e+t]?d>=o[e]&&d<o[e+t]&&(p=e,f=o[e+t]-o[e]):d>=o[e]&&(p=e,f=o[o.length-1]-o[o.length-2])}const g=(d-o[p])/f,v=p<n.slidesPerGroupSkip-1?1:n.slidesPerGroup;if(u>n.longSwipesMs){if(!n.longSwipes)return void t.slideTo(t.activeIndex);"next"===t.swipeDirection&&(g>=n.longSwipesRatio?t.slideTo(p+v):t.slideTo(p)),"prev"===t.swipeDirection&&(g>1-n.longSwipesRatio?t.slideTo(p+v):t.slideTo(p))}else{if(!n.shortSwipes)return void t.slideTo(t.activeIndex);t.navigation&&(c.target===t.navigation.nextEl||c.target===t.navigation.prevEl)?c.target===t.navigation.nextEl?t.slideTo(p+v):t.slideTo(p):("next"===t.swipeDirection&&t.slideTo(p+v),"prev"===t.swipeDirection&&t.slideTo(p))}}function L(){const e=this,{params:t,el:i}=e;if(i&&0===i.offsetWidth)return;t.breakpoints&&e.setBreakpoint();const{allowSlideNext:n,allowSlidePrev:r,snapGrid:a}=e;e.allowSlideNext=!0,e.allowSlidePrev=!0,e.updateSize(),e.updateSlides(),e.updateSlidesClasses(),("auto"===t.slidesPerView||t.slidesPerView>1)&&e.isEnd&&!e.params.centeredSlides?e.slideTo(e.slides.length-1,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0),e.autoplay&&e.autoplay.running&&e.autoplay.paused&&e.autoplay.run(),e.allowSlidePrev=r,e.allowSlideNext=n,e.params.watchOverflow&&a!==e.snapGrid&&e.checkOverflow()}function A(e){const t=this;t.allowClick||(t.params.preventClicks&&e.preventDefault(),t.params.preventClicksPropagation&&t.animating&&(e.stopPropagation(),e.stopImmediatePropagation()))}function k(){const e=this,{wrapperEl:t,rtlTranslate:i}=e;let n;e.previousTranslate=e.translate,e.isHorizontal()?e.translate=i?t.scrollWidth-t.offsetWidth-t.scrollLeft:-t.scrollLeft:e.translate=-t.scrollTop,-0===e.translate&&(e.translate=0),e.updateActiveIndex(),e.updateSlidesClasses();const r=e.maxTranslate()-e.minTranslate();n=0===r?0:(e.translate-e.minTranslate())/r,n!==e.progress&&e.updateProgress(i?-e.translate:e.translate),e.emit("setTranslate",e.translate,!1)}let P=!1;function R(){}var O={init:!0,direction:"horizontal",touchEventsTarget:"container",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,preventInteractionOnTransition:!1,edgeSwipeDetection:!1,edgeSwipeThreshold:20,freeMode:!1,freeModeMomentum:!0,freeModeMomentumRatio:1,freeModeMomentumBounce:!0,freeModeMomentumBounceRatio:1,freeModeMomentumVelocityRatio:1,freeModeSticky:!1,freeModeMinimumVelocity:.02,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,spaceBetween:0,slidesPerView:1,slidesPerColumn:1,slidesPerColumnFill:"column",slidesPerGroup:1,slidesPerGroupSkip:0,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!1,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:0,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,watchSlidesVisibility:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,loopFillGroupWithBlank:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,containerModifierClass:"swiper-container-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-invisible-blank",slideActiveClass:"swiper-slide-active",slideDuplicateActiveClass:"swiper-slide-duplicate-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slideDuplicateNextClass:"swiper-slide-duplicate-next",slidePrevClass:"swiper-slide-prev",slideDuplicatePrevClass:"swiper-slide-duplicate-prev",wrapperClass:"swiper-wrapper",runCallbacksOnInit:!0};const I={update:v,translate:y,transition:b,slide:x,loop:w,grabCursor:_,manipulation:M,events:{attachEvents:function(){const e=this,{params:t,touchEvents:i,el:n,wrapperEl:r}=e;e.onTouchStart=T.bind(e),e.onTouchMove=E.bind(e),e.onTouchEnd=C.bind(e),t.cssMode&&(e.onScroll=k.bind(e)),e.onClick=A.bind(e);const a=!!t.nested;if(!f.touch&&f.pointerEvents)n.addEventListener(i.start,e.onTouchStart,!1),o.addEventListener(i.move,e.onTouchMove,a),o.addEventListener(i.end,e.onTouchEnd,!1);else{if(f.touch){const r=!("touchstart"!==i.start||!f.passiveListener||!t.passiveListeners)&&{passive:!0,capture:!1};n.addEventListener(i.start,e.onTouchStart,r),n.addEventListener(i.move,e.onTouchMove,f.passiveListener?{passive:!1,capture:a}:a),n.addEventListener(i.end,e.onTouchEnd,r),i.cancel&&n.addEventListener(i.cancel,e.onTouchEnd,r),P||(o.addEventListener("touchstart",R),P=!0)}(t.simulateTouch&&!S.ios&&!S.android||t.simulateTouch&&!f.touch&&S.ios)&&(n.addEventListener("mousedown",e.onTouchStart,!1),o.addEventListener("mousemove",e.onTouchMove,a),o.addEventListener("mouseup",e.onTouchEnd,!1))}(t.preventClicks||t.preventClicksPropagation)&&n.addEventListener("click",e.onClick,!0),t.cssMode&&r.addEventListener("scroll",e.onScroll),t.updateOnWindowResize?e.on(S.ios||S.android?"resize orientationchange observerUpdate":"resize observerUpdate",L,!0):e.on("observerUpdate",L,!0)},detachEvents:function(){const e=this,{params:t,touchEvents:i,el:n,wrapperEl:r}=e,a=!!t.nested;if(!f.touch&&f.pointerEvents)n.removeEventListener(i.start,e.onTouchStart,!1),o.removeEventListener(i.move,e.onTouchMove,a),o.removeEventListener(i.end,e.onTouchEnd,!1);else{if(f.touch){const r=!("onTouchStart"!==i.start||!f.passiveListener||!t.passiveListeners)&&{passive:!0,capture:!1};n.removeEventListener(i.start,e.onTouchStart,r),n.removeEventListener(i.move,e.onTouchMove,a),n.removeEventListener(i.end,e.onTouchEnd,r),i.cancel&&n.removeEventListener(i.cancel,e.onTouchEnd,r)}(t.simulateTouch&&!S.ios&&!S.android||t.simulateTouch&&!f.touch&&S.ios)&&(n.removeEventListener("mousedown",e.onTouchStart,!1),o.removeEventListener("mousemove",e.onTouchMove,a),o.removeEventListener("mouseup",e.onTouchEnd,!1))}(t.preventClicks||t.preventClicksPropagation)&&n.removeEventListener("click",e.onClick,!0),t.cssMode&&r.removeEventListener("scroll",e.onScroll),e.off(S.ios||S.android?"resize orientationchange observerUpdate":"resize observerUpdate",L)}},breakpoints:{setBreakpoint:function(){const e=this,{activeIndex:t,initialized:i,loopedSlides:n=0,params:r,$el:a}=e,s=r.breakpoints;if(!s||s&&0===Object.keys(s).length)return;const o=e.getBreakpoint(s);if(o&&e.currentBreakpoint!==o){const l=o in s?s[o]:void 0;l&&["slidesPerView","spaceBetween","slidesPerGroup","slidesPerGroupSkip","slidesPerColumn"].forEach(e=>{const t=l[e];void 0!==t&&(l[e]="slidesPerView"!==e||"AUTO"!==t&&"auto"!==t?"slidesPerView"===e?parseFloat(t):parseInt(t,10):"auto")});const c=l||e.originalParams,h=r.slidesPerColumn>1,u=c.slidesPerColumn>1;h&&!u?a.removeClass(`${r.containerModifierClass}multirow ${r.containerModifierClass}multirow-column`):!h&&u&&(a.addClass(r.containerModifierClass+"multirow"),"column"===c.slidesPerColumnFill&&a.addClass(r.containerModifierClass+"multirow-column"));const d=c.direction&&c.direction!==r.direction,p=r.loop&&(c.slidesPerView!==r.slidesPerView||d);d&&i&&e.changeDirection(),m.extend(e.params,c),m.extend(e,{allowTouchMove:e.params.allowTouchMove,allowSlideNext:e.params.allowSlideNext,allowSlidePrev:e.params.allowSlidePrev}),e.currentBreakpoint=o,p&&i&&(e.loopDestroy(),e.loopCreate(),e.updateSlides(),e.slideTo(t-n+e.loopedSlides,0,!1)),e.emit("breakpoint",c)}},getBreakpoint:function(e){if(!e)return;let t=!1;const i=Object.keys(e).map(e=>{if("string"==typeof e&&0===e.indexOf("@")){const t=parseFloat(e.substr(1));return{value:c.innerHeight*t,point:e}}return{value:e,point:e}});i.sort((e,t)=>parseInt(e.value,10)-parseInt(t.value,10));for(let e=0;e<i.length;e+=1){const{point:n,value:r}=i[e];r<=c.innerWidth&&(t=n)}return t||"max"}},checkOverflow:{checkOverflow:function(){const e=this,t=e.params,i=e.isLocked,n=e.slides.length>0&&t.slidesOffsetBefore+t.spaceBetween*(e.slides.length-1)+e.slides[0].offsetWidth*e.slides.length;t.slidesOffsetBefore&&t.slidesOffsetAfter&&n?e.isLocked=n<=e.size:e.isLocked=1===e.snapGrid.length,e.allowSlideNext=!e.isLocked,e.allowSlidePrev=!e.isLocked,i!==e.isLocked&&e.emit(e.isLocked?"lock":"unlock"),i&&i!==e.isLocked&&(e.isEnd=!1,e.navigation.update())}},classes:{addClasses:function(){const{classNames:e,params:t,rtl:i,$el:n}=this,r=[];r.push("initialized"),r.push(t.direction),t.freeMode&&r.push("free-mode"),t.autoHeight&&r.push("autoheight"),i&&r.push("rtl"),t.slidesPerColumn>1&&(r.push("multirow"),"column"===t.slidesPerColumnFill&&r.push("multirow-column")),S.android&&r.push("android"),S.ios&&r.push("ios"),t.cssMode&&r.push("css-mode"),r.forEach(i=>{e.push(t.containerModifierClass+i)}),n.addClass(e.join(" "))},removeClasses:function(){const{$el:e,classNames:t}=this;e.removeClass(t.join(" "))}},images:{loadImage:function(e,t,i,n,r,a){let s;function o(){a&&a()}u(e).parent("picture")[0]||e.complete&&r?o():t?(s=new c.Image,s.onload=o,s.onerror=o,n&&(s.sizes=n),i&&(s.srcset=i),t&&(s.src=t)):o()},preloadImages:function(){const e=this;function t(){null!=e&&e&&!e.destroyed&&(void 0!==e.imagesLoaded&&(e.imagesLoaded+=1),e.imagesLoaded===e.imagesToLoad.length&&(e.params.updateOnImagesReady&&e.update(),e.emit("imagesReady")))}e.imagesToLoad=e.$el.find("img");for(let i=0;i<e.imagesToLoad.length;i+=1){const n=e.imagesToLoad[i];e.loadImage(n,n.currentSrc||n.getAttribute("src"),n.srcset||n.getAttribute("srcset"),n.sizes||n.getAttribute("sizes"),!0,t)}}}},D={};class N extends g{constructor(...e){let t,i;1===e.length&&e[0].constructor&&e[0].constructor===Object?i=e[0]:[t,i]=e,i||(i={}),i=m.extend({},i),t&&!i.el&&(i.el=t),super(i),Object.keys(I).forEach(e=>{Object.keys(I[e]).forEach(t=>{N.prototype[t]||(N.prototype[t]=I[e][t])})});const n=this;void 0===n.modules&&(n.modules={}),Object.keys(n.modules).forEach(e=>{const t=n.modules[e];if(t.params){const e=Object.keys(t.params)[0],n=t.params[e];if("object"!=typeof n||null===n)return;if(!(e in i)||!("enabled"in n))return;!0===i[e]&&(i[e]={enabled:!0}),"object"!=typeof i[e]||"enabled"in i[e]||(i[e].enabled=!0),i[e]||(i[e]={enabled:!1})}});const r=m.extend({},O);n.useModulesParams(r),n.params=m.extend({},r,D,i),n.originalParams=m.extend({},n.params),n.passedParams=m.extend({},i),n.$=u;const a=u(n.params.el);if(t=a[0],!t)return;if(a.length>1){const e=[];return a.each((t,n)=>{const r=m.extend({},i,{el:n});e.push(new N(r))}),e}let s;return t.swiper=n,a.data("swiper",n),t&&t.shadowRoot&&t.shadowRoot.querySelector?(s=u(t.shadowRoot.querySelector("."+n.params.wrapperClass)),s.children=e=>a.children(e)):s=a.children("."+n.params.wrapperClass),m.extend(n,{$el:a,el:t,$wrapperEl:s,wrapperEl:s[0],classNames:[],slides:u(),slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal:()=>"horizontal"===n.params.direction,isVertical:()=>"vertical"===n.params.direction,rtl:"rtl"===t.dir.toLowerCase()||"rtl"===a.css("direction"),rtlTranslate:"horizontal"===n.params.direction&&("rtl"===t.dir.toLowerCase()||"rtl"===a.css("direction")),wrongRTL:"-webkit-box"===s.css("display"),activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,allowSlideNext:n.params.allowSlideNext,allowSlidePrev:n.params.allowSlidePrev,touchEvents:function(){const e=["touchstart","touchmove","touchend","touchcancel"];let t=["mousedown","mousemove","mouseup"];return f.pointerEvents&&(t=["pointerdown","pointermove","pointerup"]),n.touchEventsTouch={start:e[0],move:e[1],end:e[2],cancel:e[3]},n.touchEventsDesktop={start:t[0],move:t[1],end:t[2]},f.touch||!n.params.simulateTouch?n.touchEventsTouch:n.touchEventsDesktop}(),touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,formElements:"input, select, option, textarea, button, video, label",lastClickTime:m.now(),clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,isTouchEvent:void 0,startMoving:void 0},allowClick:!0,allowTouchMove:n.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),n.useModules(),n.params.init&&n.init(),n}slidesPerViewDynamic(){const{params:e,slides:t,slidesGrid:i,size:n,activeIndex:r}=this;let a=1;if(e.centeredSlides){let e,i=t[r].swiperSlideSize;for(let s=r+1;s<t.length;s+=1)t[s]&&!e&&(i+=t[s].swiperSlideSize,a+=1,i>n&&(e=!0));for(let s=r-1;s>=0;s-=1)t[s]&&!e&&(i+=t[s].swiperSlideSize,a+=1,i>n&&(e=!0))}else for(let e=r+1;e<t.length;e+=1)i[e]-i[r]<n&&(a+=1);return a}update(){const e=this;if(!e||e.destroyed)return;const{snapGrid:t,params:i}=e;function n(){const t=e.rtlTranslate?-1*e.translate:e.translate,i=Math.min(Math.max(t,e.maxTranslate()),e.minTranslate());e.setTranslate(i),e.updateActiveIndex(),e.updateSlidesClasses()}let r;i.breakpoints&&e.setBreakpoint(),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),e.params.freeMode?(n(),e.params.autoHeight&&e.updateAutoHeight()):(r=("auto"===e.params.slidesPerView||e.params.slidesPerView>1)&&e.isEnd&&!e.params.centeredSlides?e.slideTo(e.slides.length-1,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0),r||n()),i.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t=!0){const i=this,n=i.params.direction;return e||(e="horizontal"===n?"vertical":"horizontal"),e===n||"horizontal"!==e&&"vertical"!==e||(i.$el.removeClass(`${i.params.containerModifierClass}${n}`).addClass(`${i.params.containerModifierClass}${e}`),i.params.direction=e,i.slides.each((t,i)=>{"vertical"===e?i.style.width="":i.style.height=""}),i.emit("changeDirection"),t&&i.update()),i}init(){const e=this;e.initialized||(e.emit("beforeInit"),e.params.breakpoints&&e.setBreakpoint(),e.addClasses(),e.params.loop&&e.loopCreate(),e.updateSize(),e.updateSlides(),e.params.watchOverflow&&e.checkOverflow(),e.params.grabCursor&&e.setGrabCursor(),e.params.preloadImages&&e.preloadImages(),e.params.loop?e.slideTo(e.params.initialSlide+e.loopedSlides,0,e.params.runCallbacksOnInit):e.slideTo(e.params.initialSlide,0,e.params.runCallbacksOnInit),e.attachEvents(),e.initialized=!0,e.emit("init"))}destroy(e=!0,t=!0){const i=this,{params:n,$el:r,$wrapperEl:a,slides:s}=i;return void 0===i.params||i.destroyed||(i.emit("beforeDestroy"),i.initialized=!1,i.detachEvents(),n.loop&&i.loopDestroy(),t&&(i.removeClasses(),r.removeAttr("style"),a.removeAttr("style"),s&&s.length&&s.removeClass([n.slideVisibleClass,n.slideActiveClass,n.slideNextClass,n.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-slide-index")),i.emit("destroy"),Object.keys(i.eventsListeners).forEach(e=>{i.off(e)}),!1!==e&&(i.$el[0].swiper=null,i.$el.data("swiper",null),m.deleteProps(i)),i.destroyed=!0),null}static extendDefaults(e){m.extend(D,e)}static get extendedDefaults(){return D}static get defaults(){return O}static get Class(){return g}static get $(){return u}}var z={name:"device",proto:{device:S},static:{device:S}},F={name:"support",proto:{support:f},static:{support:f}};const B={isEdge:!!c.navigator.userAgent.match(/Edge/g),isSafari:function(){const e=c.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("android")<0}(),isUiWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(c.navigator.userAgent)};var H={name:"browser",proto:{browser:B},static:{browser:B}},G={name:"resize",create(){const e=this;m.extend(e,{resize:{resizeHandler(){e&&!e.destroyed&&e.initialized&&(e.emit("beforeResize"),e.emit("resize"))},orientationChangeHandler(){e&&!e.destroyed&&e.initialized&&e.emit("orientationchange")}}})},on:{init(){c.addEventListener("resize",this.resize.resizeHandler),c.addEventListener("orientationchange",this.resize.orientationChangeHandler)},destroy(){c.removeEventListener("resize",this.resize.resizeHandler),c.removeEventListener("orientationchange",this.resize.orientationChangeHandler)}}};const U={func:c.MutationObserver||c.WebkitMutationObserver,attach(e,t={}){const i=this,n=new(0,U.func)(e=>{if(1===e.length)return void i.emit("observerUpdate",e[0]);const t=function(){i.emit("observerUpdate",e[0])};c.requestAnimationFrame?c.requestAnimationFrame(t):c.setTimeout(t,0)});n.observe(e,{attributes:void 0===t.attributes||t.attributes,childList:void 0===t.childList||t.childList,characterData:void 0===t.characterData||t.characterData}),i.observer.observers.push(n)},init(){const e=this;if(f.observer&&e.params.observer){if(e.params.observeParents){const t=e.$el.parents();for(let i=0;i<t.length;i+=1)e.observer.attach(t[i])}e.observer.attach(e.$el[0],{childList:e.params.observeSlideChildren}),e.observer.attach(e.$wrapperEl[0],{attributes:!1})}},destroy(){this.observer.observers.forEach(e=>{e.disconnect()}),this.observer.observers=[]}};var j={name:"observer",params:{observer:!1,observeParents:!1,observeSlideChildren:!1},create(){m.extend(this,{observer:{init:U.init.bind(this),attach:U.attach.bind(this),destroy:U.destroy.bind(this),observers:[]}})},on:{init(){this.observer.init()},destroy(){this.observer.destroy()}}};const V={update(e){const t=this,{slidesPerView:i,slidesPerGroup:n,centeredSlides:r}=t.params,{addSlidesBefore:a,addSlidesAfter:s}=t.params.virtual,{from:o,to:l,slides:c,slidesGrid:h,renderSlide:u,offset:d}=t.virtual;t.updateActiveIndex();const p=t.activeIndex||0;let f,g,v;f=t.rtlTranslate?"right":t.isHorizontal()?"left":"top",r?(g=Math.floor(i/2)+n+a,v=Math.floor(i/2)+n+s):(g=i+(n-1)+a,v=n+s);const y=Math.max((p||0)-v,0),b=Math.min((p||0)+g,c.length-1),x=(t.slidesGrid[y]||0)-(t.slidesGrid[0]||0);function w(){t.updateSlides(),t.updateProgress(),t.updateSlidesClasses(),t.lazy&&t.params.lazy.enabled&&t.lazy.load()}if(m.extend(t.virtual,{from:y,to:b,offset:x,slidesGrid:t.slidesGrid}),o===y&&l===b&&!e)return t.slidesGrid!==h&&x!==d&&t.slides.css(f,x+"px"),void t.updateProgress();if(t.params.virtual.renderExternal)return t.params.virtual.renderExternal.call(t,{offset:x,from:y,to:b,slides:function(){const e=[];for(let t=y;t<=b;t+=1)e.push(c[t]);return e}()}),void w();const _=[],M=[];if(e)t.$wrapperEl.find("."+t.params.slideClass).remove();else for(let e=o;e<=l;e+=1)(e<y||e>b)&&t.$wrapperEl.find(`.${t.params.slideClass}[data-swiper-slide-index="${e}"]`).remove();for(let t=0;t<c.length;t+=1)t>=y&&t<=b&&(void 0===l||e?M.push(t):(t>l&&M.push(t),t<o&&_.push(t)));M.forEach(e=>{t.$wrapperEl.append(u(c[e],e))}),_.sort((e,t)=>t-e).forEach(e=>{t.$wrapperEl.prepend(u(c[e],e))}),t.$wrapperEl.children(".swiper-slide").css(f,x+"px"),w()},renderSlide(e,t){const i=this,n=i.params.virtual;if(n.cache&&i.virtual.cache[t])return i.virtual.cache[t];const r=n.renderSlide?u(n.renderSlide.call(i,e,t)):u(`<div class="${i.params.slideClass}" data-swiper-slide-index="${t}">${e}</div>`);return r.attr("data-swiper-slide-index")||r.attr("data-swiper-slide-index",t),n.cache&&(i.virtual.cache[t]=r),r},appendSlide(e){const t=this;if("object"==typeof e&&"length"in e)for(let i=0;i<e.length;i+=1)e[i]&&t.virtual.slides.push(e[i]);else t.virtual.slides.push(e);t.virtual.update(!0)},prependSlide(e){const t=this,i=t.activeIndex;let n=i+1,r=1;if(Array.isArray(e)){for(let i=0;i<e.length;i+=1)e[i]&&t.virtual.slides.unshift(e[i]);n=i+e.length,r=e.length}else t.virtual.slides.unshift(e);if(t.params.virtual.cache){const e=t.virtual.cache,i={};Object.keys(e).forEach(t=>{const n=e[t],a=n.attr("data-swiper-slide-index");a&&n.attr("data-swiper-slide-index",parseInt(a,10)+1),i[parseInt(t,10)+r]=n}),t.virtual.cache=i}t.virtual.update(!0),t.slideTo(n,0)},removeSlide(e){const t=this;if(null==e)return;let i=t.activeIndex;if(Array.isArray(e))for(let n=e.length-1;n>=0;n-=1)t.virtual.slides.splice(e[n],1),t.params.virtual.cache&&delete t.virtual.cache[e[n]],e[n]<i&&(i-=1),i=Math.max(i,0);else t.virtual.slides.splice(e,1),t.params.virtual.cache&&delete t.virtual.cache[e],e<i&&(i-=1),i=Math.max(i,0);t.virtual.update(!0),t.slideTo(i,0)},removeAllSlides(){const e=this;e.virtual.slides=[],e.params.virtual.cache&&(e.virtual.cache={}),e.virtual.update(!0),e.slideTo(0,0)}};var W={name:"virtual",params:{virtual:{enabled:!1,slides:[],cache:!0,renderSlide:null,renderExternal:null,addSlidesBefore:0,addSlidesAfter:0}},create(){m.extend(this,{virtual:{update:V.update.bind(this),appendSlide:V.appendSlide.bind(this),prependSlide:V.prependSlide.bind(this),removeSlide:V.removeSlide.bind(this),removeAllSlides:V.removeAllSlides.bind(this),renderSlide:V.renderSlide.bind(this),slides:this.params.virtual.slides,cache:{}}})},on:{beforeInit(){const e=this;if(!e.params.virtual.enabled)return;e.classNames.push(e.params.containerModifierClass+"virtual");const t={watchSlidesProgress:!0};m.extend(e.params,t),m.extend(e.originalParams,t),e.params.initialSlide||e.virtual.update()},setTranslate(){this.params.virtual.enabled&&this.virtual.update()}}};const q={handle(e){const t=this,{rtlTranslate:i}=t;let n=e;n.originalEvent&&(n=n.originalEvent);const r=n.keyCode||n.charCode;if(!t.allowSlideNext&&(t.isHorizontal()&&39===r||t.isVertical()&&40===r||34===r))return!1;if(!t.allowSlidePrev&&(t.isHorizontal()&&37===r||t.isVertical()&&38===r||33===r))return!1;if(!(n.shiftKey||n.altKey||n.ctrlKey||n.metaKey||o.activeElement&&o.activeElement.nodeName&&("input"===o.activeElement.nodeName.toLowerCase()||"textarea"===o.activeElement.nodeName.toLowerCase()))){if(t.params.keyboard.onlyInViewport&&(33===r||34===r||37===r||39===r||38===r||40===r)){let e=!1;if(t.$el.parents("."+t.params.slideClass).length>0&&0===t.$el.parents("."+t.params.slideActiveClass).length)return;const n=c.innerWidth,r=c.innerHeight,a=t.$el.offset();i&&(a.left-=t.$el[0].scrollLeft);const s=[[a.left,a.top],[a.left+t.width,a.top],[a.left,a.top+t.height],[a.left+t.width,a.top+t.height]];for(let t=0;t<s.length;t+=1){const i=s[t];i[0]>=0&&i[0]<=n&&i[1]>=0&&i[1]<=r&&(e=!0)}if(!e)return}t.isHorizontal()?(33!==r&&34!==r&&37!==r&&39!==r||(n.preventDefault?n.preventDefault():n.returnValue=!1),(34!==r&&39!==r||i)&&(33!==r&&37!==r||!i)||t.slideNext(),(33!==r&&37!==r||i)&&(34!==r&&39!==r||!i)||t.slidePrev()):(33!==r&&34!==r&&38!==r&&40!==r||(n.preventDefault?n.preventDefault():n.returnValue=!1),34!==r&&40!==r||t.slideNext(),33!==r&&38!==r||t.slidePrev()),t.emit("keyPress",r)}},enable(){this.keyboard.enabled||(u(o).on("keydown",this.keyboard.handle),this.keyboard.enabled=!0)},disable(){this.keyboard.enabled&&(u(o).off("keydown",this.keyboard.handle),this.keyboard.enabled=!1)}};var $={name:"keyboard",params:{keyboard:{enabled:!1,onlyInViewport:!0}},create(){m.extend(this,{keyboard:{enabled:!1,enable:q.enable.bind(this),disable:q.disable.bind(this),handle:q.handle.bind(this)}})},on:{init(){const e=this;e.params.keyboard.enabled&&e.keyboard.enable()},destroy(){const e=this;e.keyboard.enabled&&e.keyboard.disable()}}};const X={lastScrollTime:m.now(),lastEventBeforeSnap:void 0,recentWheelEvents:[],event:()=>c.navigator.userAgent.indexOf("firefox")>-1?"DOMMouseScroll":function(){let e="onwheel"in o;if(!e){const t=o.createElement("div");t.setAttribute("onwheel","return;"),e="function"==typeof t.onwheel}return!e&&o.implementation&&o.implementation.hasFeature&&!0!==o.implementation.hasFeature("","")&&(e=o.implementation.hasFeature("Events.wheel","3.0")),e}()?"wheel":"mousewheel",normalize(e){let t=0,i=0,n=0,r=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),n=10*t,r=10*i,"deltaY"in e&&(r=e.deltaY),"deltaX"in e&&(n=e.deltaX),e.shiftKey&&!n&&(n=r,r=0),(n||r)&&e.deltaMode&&(1===e.deltaMode?(n*=40,r*=40):(n*=800,r*=800)),n&&!t&&(t=n<1?-1:1),r&&!i&&(i=r<1?-1:1),{spinX:t,spinY:i,pixelX:n,pixelY:r}},handleMouseEnter(){this.mouseEntered=!0},handleMouseLeave(){this.mouseEntered=!1},handle(e){let t=e;const i=this,n=i.params.mousewheel;i.params.cssMode&&t.preventDefault();let r=i.$el;if("container"!==i.params.mousewheel.eventsTarged&&(r=u(i.params.mousewheel.eventsTarged)),!i.mouseEntered&&!r[0].contains(t.target)&&!n.releaseOnEdges)return!0;t.originalEvent&&(t=t.originalEvent);let a=0;const s=i.rtlTranslate?-1:1,o=X.normalize(t);if(n.forceToAxis)if(i.isHorizontal()){if(!(Math.abs(o.pixelX)>Math.abs(o.pixelY)))return!0;a=o.pixelX*s}else{if(!(Math.abs(o.pixelY)>Math.abs(o.pixelX)))return!0;a=o.pixelY}else a=Math.abs(o.pixelX)>Math.abs(o.pixelY)?-o.pixelX*s:-o.pixelY;if(0===a)return!0;if(n.invert&&(a=-a),i.params.freeMode){const e={time:m.now(),delta:Math.abs(a),direction:Math.sign(a)},{lastEventBeforeSnap:r}=i.mousewheel,s=r&&e.time<r.time+500&&e.delta<=r.delta&&e.direction===r.direction;if(!s){i.mousewheel.lastEventBeforeSnap=void 0,i.params.loop&&i.loopFix();let r=i.getTranslate()+a*n.sensitivity;const o=i.isBeginning,l=i.isEnd;if(r>=i.minTranslate()&&(r=i.minTranslate()),r<=i.maxTranslate()&&(r=i.maxTranslate()),i.setTransition(0),i.setTranslate(r),i.updateProgress(),i.updateActiveIndex(),i.updateSlidesClasses(),(!o&&i.isBeginning||!l&&i.isEnd)&&i.updateSlidesClasses(),i.params.freeModeSticky){clearTimeout(i.mousewheel.timeout),i.mousewheel.timeout=void 0;const t=i.mousewheel.recentWheelEvents;t.length>=15&&t.shift();const n=t.length?t[t.length-1]:void 0,r=t[0];if(t.push(e),n&&(e.delta>n.delta||e.direction!==n.direction))t.splice(0);else if(t.length>=15&&e.time-r.time<500&&r.delta-e.delta>=1&&e.delta<=6){const n=a>0?.8:.2;i.mousewheel.lastEventBeforeSnap=e,t.splice(0),i.mousewheel.timeout=m.nextTick(()=>{i.slideToClosest(i.params.speed,!0,void 0,n)},0)}i.mousewheel.timeout||(i.mousewheel.timeout=m.nextTick(()=>{i.mousewheel.lastEventBeforeSnap=e,t.splice(0),i.slideToClosest(i.params.speed,!0,void 0,.5)},500))}if(s||i.emit("scroll",t),i.params.autoplay&&i.params.autoplayDisableOnInteraction&&i.autoplay.stop(),r===i.minTranslate()||r===i.maxTranslate())return!0}}else{const t={time:m.now(),delta:Math.abs(a),direction:Math.sign(a),raw:e},n=i.mousewheel.recentWheelEvents;n.length>=2&&n.shift();const r=n.length?n[n.length-1]:void 0;if(n.push(t),r?(t.direction!==r.direction||t.delta>r.delta||t.time>r.time+150)&&i.mousewheel.animateSlider(t):i.mousewheel.animateSlider(t),i.mousewheel.releaseScroll(t))return!0}return t.preventDefault?t.preventDefault():t.returnValue=!1,!1},animateSlider(e){const t=this;return e.delta>=6&&m.now()-t.mousewheel.lastScrollTime<60||(e.direction<0?t.isEnd&&!t.params.loop||t.animating||(t.slideNext(),t.emit("scroll",e.raw)):t.isBeginning&&!t.params.loop||t.animating||(t.slidePrev(),t.emit("scroll",e.raw)),t.mousewheel.lastScrollTime=(new c.Date).getTime(),!1)},releaseScroll(e){const t=this,i=t.params.mousewheel;if(e.direction<0){if(t.isEnd&&!t.params.loop&&i.releaseOnEdges)return!0}else if(t.isBeginning&&!t.params.loop&&i.releaseOnEdges)return!0;return!1},enable(){const e=this,t=X.event();if(e.params.cssMode)return e.wrapperEl.removeEventListener(t,e.mousewheel.handle),!0;if(!t)return!1;if(e.mousewheel.enabled)return!1;let i=e.$el;return"container"!==e.params.mousewheel.eventsTarged&&(i=u(e.params.mousewheel.eventsTarged)),i.on("mouseenter",e.mousewheel.handleMouseEnter),i.on("mouseleave",e.mousewheel.handleMouseLeave),i.on(t,e.mousewheel.handle),e.mousewheel.enabled=!0,!0},disable(){const e=this,t=X.event();if(e.params.cssMode)return e.wrapperEl.addEventListener(t,e.mousewheel.handle),!0;if(!t)return!1;if(!e.mousewheel.enabled)return!1;let i=e.$el;return"container"!==e.params.mousewheel.eventsTarged&&(i=u(e.params.mousewheel.eventsTarged)),i.off(t,e.mousewheel.handle),e.mousewheel.enabled=!1,!0}};const Y={update(){const e=this,t=e.params.navigation;if(e.params.loop)return;const{$nextEl:i,$prevEl:n}=e.navigation;n&&n.length>0&&(e.isBeginning?n.addClass(t.disabledClass):n.removeClass(t.disabledClass),n[e.params.watchOverflow&&e.isLocked?"addClass":"removeClass"](t.lockClass)),i&&i.length>0&&(e.isEnd?i.addClass(t.disabledClass):i.removeClass(t.disabledClass),i[e.params.watchOverflow&&e.isLocked?"addClass":"removeClass"](t.lockClass))},onPrevClick(e){e.preventDefault(),this.isBeginning&&!this.params.loop||this.slidePrev()},onNextClick(e){e.preventDefault(),this.isEnd&&!this.params.loop||this.slideNext()},init(){const e=this,t=e.params.navigation;if(!t.nextEl&&!t.prevEl)return;let i,n;t.nextEl&&(i=u(t.nextEl),e.params.uniqueNavElements&&"string"==typeof t.nextEl&&i.length>1&&1===e.$el.find(t.nextEl).length&&(i=e.$el.find(t.nextEl))),t.prevEl&&(n=u(t.prevEl),e.params.uniqueNavElements&&"string"==typeof t.prevEl&&n.length>1&&1===e.$el.find(t.prevEl).length&&(n=e.$el.find(t.prevEl))),i&&i.length>0&&i.on("click",e.navigation.onNextClick),n&&n.length>0&&n.on("click",e.navigation.onPrevClick),m.extend(e.navigation,{$nextEl:i,nextEl:i&&i[0],$prevEl:n,prevEl:n&&n[0]})},destroy(){const e=this,{$nextEl:t,$prevEl:i}=e.navigation;t&&t.length&&(t.off("click",e.navigation.onNextClick),t.removeClass(e.params.navigation.disabledClass)),i&&i.length&&(i.off("click",e.navigation.onPrevClick),i.removeClass(e.params.navigation.disabledClass))}};const Z={update(){const e=this,t=e.rtl,i=e.params.pagination;if(!i.el||!e.pagination.el||!e.pagination.$el||0===e.pagination.$el.length)return;const n=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,r=e.pagination.$el;let a;const s=e.params.loop?Math.ceil((n-2*e.loopedSlides)/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(a=Math.ceil((e.activeIndex-e.loopedSlides)/e.params.slidesPerGroup),a>n-1-2*e.loopedSlides&&(a-=n-2*e.loopedSlides),a>s-1&&(a-=s),a<0&&"bullets"!==e.params.paginationType&&(a=s+a)):a=void 0!==e.snapIndex?e.snapIndex:e.activeIndex||0,"bullets"===i.type&&e.pagination.bullets&&e.pagination.bullets.length>0){const n=e.pagination.bullets;let s,o,l;if(i.dynamicBullets&&(e.pagination.bulletSize=n.eq(0)[e.isHorizontal()?"outerWidth":"outerHeight"](!0),r.css(e.isHorizontal()?"width":"height",e.pagination.bulletSize*(i.dynamicMainBullets+4)+"px"),i.dynamicMainBullets>1&&void 0!==e.previousIndex&&(e.pagination.dynamicBulletIndex+=a-e.previousIndex,e.pagination.dynamicBulletIndex>i.dynamicMainBullets-1?e.pagination.dynamicBulletIndex=i.dynamicMainBullets-1:e.pagination.dynamicBulletIndex<0&&(e.pagination.dynamicBulletIndex=0)),s=a-e.pagination.dynamicBulletIndex,o=s+(Math.min(n.length,i.dynamicMainBullets)-1),l=(o+s)/2),n.removeClass(`${i.bulletActiveClass} ${i.bulletActiveClass}-next ${i.bulletActiveClass}-next-next ${i.bulletActiveClass}-prev ${i.bulletActiveClass}-prev-prev ${i.bulletActiveClass}-main`),r.length>1)n.each((e,t)=>{const n=u(t),r=n.index();r===a&&n.addClass(i.bulletActiveClass),i.dynamicBullets&&(r>=s&&r<=o&&n.addClass(i.bulletActiveClass+"-main"),r===s&&n.prev().addClass(i.bulletActiveClass+"-prev").prev().addClass(i.bulletActiveClass+"-prev-prev"),r===o&&n.next().addClass(i.bulletActiveClass+"-next").next().addClass(i.bulletActiveClass+"-next-next"))});else{const t=n.eq(a),r=t.index();if(t.addClass(i.bulletActiveClass),i.dynamicBullets){const t=n.eq(s),a=n.eq(o);for(let e=s;e<=o;e+=1)n.eq(e).addClass(i.bulletActiveClass+"-main");if(e.params.loop)if(r>=n.length-i.dynamicMainBullets){for(let e=i.dynamicMainBullets;e>=0;e-=1)n.eq(n.length-e).addClass(i.bulletActiveClass+"-main");n.eq(n.length-i.dynamicMainBullets-1).addClass(i.bulletActiveClass+"-prev")}else t.prev().addClass(i.bulletActiveClass+"-prev").prev().addClass(i.bulletActiveClass+"-prev-prev"),a.next().addClass(i.bulletActiveClass+"-next").next().addClass(i.bulletActiveClass+"-next-next");else t.prev().addClass(i.bulletActiveClass+"-prev").prev().addClass(i.bulletActiveClass+"-prev-prev"),a.next().addClass(i.bulletActiveClass+"-next").next().addClass(i.bulletActiveClass+"-next-next")}}if(i.dynamicBullets){const r=Math.min(n.length,i.dynamicMainBullets+4),a=(e.pagination.bulletSize*r-e.pagination.bulletSize)/2-l*e.pagination.bulletSize,s=t?"right":"left";n.css(e.isHorizontal()?s:"top",a+"px")}}if("fraction"===i.type&&(r.find("."+i.currentClass).text(i.formatFractionCurrent(a+1)),r.find("."+i.totalClass).text(i.formatFractionTotal(s))),"progressbar"===i.type){let t;t=i.progressbarOpposite?e.isHorizontal()?"vertical":"horizontal":e.isHorizontal()?"horizontal":"vertical";const n=(a+1)/s;let o=1,l=1;"horizontal"===t?o=n:l=n,r.find("."+i.progressbarFillClass).transform(`translate3d(0,0,0) scaleX(${o}) scaleY(${l})`).transition(e.params.speed)}"custom"===i.type&&i.renderCustom?(r.html(i.renderCustom(e,a+1,s)),e.emit("paginationRender",e,r[0])):e.emit("paginationUpdate",e,r[0]),r[e.params.watchOverflow&&e.isLocked?"addClass":"removeClass"](i.lockClass)},render(){const e=this,t=e.params.pagination;if(!t.el||!e.pagination.el||!e.pagination.$el||0===e.pagination.$el.length)return;const i=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,n=e.pagination.$el;let r="";if("bullets"===t.type){const a=e.params.loop?Math.ceil((i-2*e.loopedSlides)/e.params.slidesPerGroup):e.snapGrid.length;for(let i=0;i<a;i+=1)t.renderBullet?r+=t.renderBullet.call(e,i,t.bulletClass):r+=`<${t.bulletElement} class="${t.bulletClass}"></${t.bulletElement}>`;n.html(r),e.pagination.bullets=n.find("."+t.bulletClass)}"fraction"===t.type&&(r=t.renderFraction?t.renderFraction.call(e,t.currentClass,t.totalClass):`<span class="${t.currentClass}"></span> / <span class="${t.totalClass}"></span>`,n.html(r)),"progressbar"===t.type&&(r=t.renderProgressbar?t.renderProgressbar.call(e,t.progressbarFillClass):`<span class="${t.progressbarFillClass}"></span>`,n.html(r)),"custom"!==t.type&&e.emit("paginationRender",e.pagination.$el[0])},init(){const e=this,t=e.params.pagination;if(!t.el)return;let i=u(t.el);0!==i.length&&(e.params.uniqueNavElements&&"string"==typeof t.el&&i.length>1&&1===e.$el.find(t.el).length&&(i=e.$el.find(t.el)),"bullets"===t.type&&t.clickable&&i.addClass(t.clickableClass),i.addClass(t.modifierClass+t.type),"bullets"===t.type&&t.dynamicBullets&&(i.addClass(`${t.modifierClass}${t.type}-dynamic`),e.pagination.dynamicBulletIndex=0,t.dynamicMainBullets<1&&(t.dynamicMainBullets=1)),"progressbar"===t.type&&t.progressbarOpposite&&i.addClass(t.progressbarOppositeClass),t.clickable&&i.on("click","."+t.bulletClass,(function(t){t.preventDefault();let i=u(this).index()*e.params.slidesPerGroup;e.params.loop&&(i+=e.loopedSlides),e.slideTo(i)})),m.extend(e.pagination,{$el:i,el:i[0]}))},destroy(){const e=this.params.pagination;if(!e.el||!this.pagination.el||!this.pagination.$el||0===this.pagination.$el.length)return;const t=this.pagination.$el;t.removeClass(e.hiddenClass),t.removeClass(e.modifierClass+e.type),this.pagination.bullets&&this.pagination.bullets.removeClass(e.bulletActiveClass),e.clickable&&t.off("click","."+e.bulletClass)}};const J={setTranslate(){const e=this;if(!e.params.scrollbar.el||!e.scrollbar.el)return;const{scrollbar:t,rtlTranslate:i,progress:n}=e,{dragSize:r,trackSize:a,$dragEl:s,$el:o}=t,l=e.params.scrollbar;let c=r,h=(a-r)*n;i?(h=-h,h>0?(c=r-h,h=0):-h+r>a&&(c=a+h)):h<0?(c=r+h,h=0):h+r>a&&(c=a-h),e.isHorizontal()?(s.transform(`translate3d(${h}px, 0, 0)`),s[0].style.width=c+"px"):(s.transform(`translate3d(0px, ${h}px, 0)`),s[0].style.height=c+"px"),l.hide&&(clearTimeout(e.scrollbar.timeout),o[0].style.opacity=1,e.scrollbar.timeout=setTimeout(()=>{o[0].style.opacity=0,o.transition(400)},1e3))},setTransition(e){this.params.scrollbar.el&&this.scrollbar.el&&this.scrollbar.$dragEl.transition(e)},updateSize(){const e=this;if(!e.params.scrollbar.el||!e.scrollbar.el)return;const{scrollbar:t}=e,{$dragEl:i,$el:n}=t;i[0].style.width="",i[0].style.height="";const r=e.isHorizontal()?n[0].offsetWidth:n[0].offsetHeight,a=e.size/e.virtualSize,s=a*(r/e.size);let o;o="auto"===e.params.scrollbar.dragSize?r*a:parseInt(e.params.scrollbar.dragSize,10),e.isHorizontal()?i[0].style.width=o+"px":i[0].style.height=o+"px",n[0].style.display=a>=1?"none":"",e.params.scrollbar.hide&&(n[0].style.opacity=0),m.extend(t,{trackSize:r,divider:a,moveDivider:s,dragSize:o}),t.$el[e.params.watchOverflow&&e.isLocked?"addClass":"removeClass"](e.params.scrollbar.lockClass)},getPointerPosition(e){return this.isHorizontal()?"touchstart"===e.type||"touchmove"===e.type?e.targetTouches[0].clientX:e.clientX:"touchstart"===e.type||"touchmove"===e.type?e.targetTouches[0].clientY:e.clientY},setDragPosition(e){const{scrollbar:t,rtlTranslate:i}=this,{$el:n,dragSize:r,trackSize:a,dragStartPos:s}=t;let o;o=(t.getPointerPosition(e)-n.offset()[this.isHorizontal()?"left":"top"]-(null!==s?s:r/2))/(a-r),o=Math.max(Math.min(o,1),0),i&&(o=1-o);const l=this.minTranslate()+(this.maxTranslate()-this.minTranslate())*o;this.updateProgress(l),this.setTranslate(l),this.updateActiveIndex(),this.updateSlidesClasses()},onDragStart(e){const t=this,i=t.params.scrollbar,{scrollbar:n,$wrapperEl:r}=t,{$el:a,$dragEl:s}=n;t.scrollbar.isTouched=!0,t.scrollbar.dragStartPos=e.target===s[0]||e.target===s?n.getPointerPosition(e)-e.target.getBoundingClientRect()[t.isHorizontal()?"left":"top"]:null,e.preventDefault(),e.stopPropagation(),r.transition(100),s.transition(100),n.setDragPosition(e),clearTimeout(t.scrollbar.dragTimeout),a.transition(0),i.hide&&a.css("opacity",1),t.params.cssMode&&t.$wrapperEl.css("scroll-snap-type","none"),t.emit("scrollbarDragStart",e)},onDragMove(e){const{scrollbar:t,$wrapperEl:i}=this,{$el:n,$dragEl:r}=t;this.scrollbar.isTouched&&(e.preventDefault?e.preventDefault():e.returnValue=!1,t.setDragPosition(e),i.transition(0),n.transition(0),r.transition(0),this.emit("scrollbarDragMove",e))},onDragEnd(e){const t=this,i=t.params.scrollbar,{scrollbar:n,$wrapperEl:r}=t,{$el:a}=n;t.scrollbar.isTouched&&(t.scrollbar.isTouched=!1,t.params.cssMode&&(t.$wrapperEl.css("scroll-snap-type",""),r.transition("")),i.hide&&(clearTimeout(t.scrollbar.dragTimeout),t.scrollbar.dragTimeout=m.nextTick(()=>{a.css("opacity",0),a.transition(400)},1e3)),t.emit("scrollbarDragEnd",e),i.snapOnRelease&&t.slideToClosest())},enableDraggable(){const e=this;if(!e.params.scrollbar.el)return;const{scrollbar:t,touchEventsTouch:i,touchEventsDesktop:n,params:r}=e,a=t.$el[0],s=!(!f.passiveListener||!r.passiveListeners)&&{passive:!1,capture:!1},l=!(!f.passiveListener||!r.passiveListeners)&&{passive:!0,capture:!1};f.touch?(a.addEventListener(i.start,e.scrollbar.onDragStart,s),a.addEventListener(i.move,e.scrollbar.onDragMove,s),a.addEventListener(i.end,e.scrollbar.onDragEnd,l)):(a.addEventListener(n.start,e.scrollbar.onDragStart,s),o.addEventListener(n.move,e.scrollbar.onDragMove,s),o.addEventListener(n.end,e.scrollbar.onDragEnd,l))},disableDraggable(){const e=this;if(!e.params.scrollbar.el)return;const{scrollbar:t,touchEventsTouch:i,touchEventsDesktop:n,params:r}=e,a=t.$el[0],s=!(!f.passiveListener||!r.passiveListeners)&&{passive:!1,capture:!1},l=!(!f.passiveListener||!r.passiveListeners)&&{passive:!0,capture:!1};f.touch?(a.removeEventListener(i.start,e.scrollbar.onDragStart,s),a.removeEventListener(i.move,e.scrollbar.onDragMove,s),a.removeEventListener(i.end,e.scrollbar.onDragEnd,l)):(a.removeEventListener(n.start,e.scrollbar.onDragStart,s),o.removeEventListener(n.move,e.scrollbar.onDragMove,s),o.removeEventListener(n.end,e.scrollbar.onDragEnd,l))},init(){const e=this;if(!e.params.scrollbar.el)return;const{scrollbar:t,$el:i}=e,n=e.params.scrollbar;let r=u(n.el);e.params.uniqueNavElements&&"string"==typeof n.el&&r.length>1&&1===i.find(n.el).length&&(r=i.find(n.el));let a=r.find("."+e.params.scrollbar.dragClass);0===a.length&&(a=u(`<div class="${e.params.scrollbar.dragClass}"></div>`),r.append(a)),m.extend(t,{$el:r,el:r[0],$dragEl:a,dragEl:a[0]}),n.draggable&&t.enableDraggable()},destroy(){this.scrollbar.disableDraggable()}};const K={setTransform(e,t){const{rtl:i}=this,n=u(e),r=i?-1:1,a=n.attr("data-swiper-parallax")||"0";let s=n.attr("data-swiper-parallax-x"),o=n.attr("data-swiper-parallax-y");const l=n.attr("data-swiper-parallax-scale"),c=n.attr("data-swiper-parallax-opacity");if(s||o?(s=s||"0",o=o||"0"):this.isHorizontal()?(s=a,o="0"):(o=a,s="0"),s=s.indexOf("%")>=0?parseInt(s,10)*t*r+"%":s*t*r+"px",o=o.indexOf("%")>=0?parseInt(o,10)*t+"%":o*t+"px",null!=c){const e=c-(c-1)*(1-Math.abs(t));n[0].style.opacity=e}if(null==l)n.transform(`translate3d(${s}, ${o}, 0px)`);else{const e=l-(l-1)*(1-Math.abs(t));n.transform(`translate3d(${s}, ${o}, 0px) scale(${e})`)}},setTranslate(){const e=this,{$el:t,slides:i,progress:n,snapGrid:r}=e;t.children("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]").each((t,i)=>{e.parallax.setTransform(i,n)}),i.each((t,i)=>{let a=i.progress;e.params.slidesPerGroup>1&&"auto"!==e.params.slidesPerView&&(a+=Math.ceil(t/2)-n*(r.length-1)),a=Math.min(Math.max(a,-1),1),u(i).find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]").each((t,i)=>{e.parallax.setTransform(i,a)})})},setTransition(e=this.params.speed){const{$el:t}=this;t.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]").each((t,i)=>{const n=u(i);let r=parseInt(n.attr("data-swiper-parallax-duration"),10)||e;0===e&&(r=0),n.transition(r)})}};const Q={getDistanceBetweenTouches(e){if(e.targetTouches.length<2)return 1;const t=e.targetTouches[0].pageX,i=e.targetTouches[0].pageY,n=e.targetTouches[1].pageX,r=e.targetTouches[1].pageY;return Math.sqrt((n-t)**2+(r-i)**2)},onGestureStart(e){const t=this,i=t.params.zoom,n=t.zoom,{gesture:r}=n;if(n.fakeGestureTouched=!1,n.fakeGestureMoved=!1,!f.gestures){if("touchstart"!==e.type||"touchstart"===e.type&&e.targetTouches.length<2)return;n.fakeGestureTouched=!0,r.scaleStart=Q.getDistanceBetweenTouches(e)}r.$slideEl&&r.$slideEl.length||(r.$slideEl=u(e.target).closest("."+t.params.slideClass),0===r.$slideEl.length&&(r.$slideEl=t.slides.eq(t.activeIndex)),r.$imageEl=r.$slideEl.find("img, svg, canvas, picture, .swiper-zoom-target"),r.$imageWrapEl=r.$imageEl.parent("."+i.containerClass),r.maxRatio=r.$imageWrapEl.attr("data-swiper-zoom")||i.maxRatio,0!==r.$imageWrapEl.length)?(r.$imageEl&&r.$imageEl.transition(0),t.zoom.isScaling=!0):r.$imageEl=void 0},onGestureChange(e){const t=this.params.zoom,i=this.zoom,{gesture:n}=i;if(!f.gestures){if("touchmove"!==e.type||"touchmove"===e.type&&e.targetTouches.length<2)return;i.fakeGestureMoved=!0,n.scaleMove=Q.getDistanceBetweenTouches(e)}n.$imageEl&&0!==n.$imageEl.length&&(i.scale=f.gestures?e.scale*i.currentScale:n.scaleMove/n.scaleStart*i.currentScale,i.scale>n.maxRatio&&(i.scale=n.maxRatio-1+(i.scale-n.maxRatio+1)**.5),i.scale<t.minRatio&&(i.scale=t.minRatio+1-(t.minRatio-i.scale+1)**.5),n.$imageEl.transform(`translate3d(0,0,0) scale(${i.scale})`))},onGestureEnd(e){const t=this.params.zoom,i=this.zoom,{gesture:n}=i;if(!f.gestures){if(!i.fakeGestureTouched||!i.fakeGestureMoved)return;if("touchend"!==e.type||"touchend"===e.type&&e.changedTouches.length<2&&!S.android)return;i.fakeGestureTouched=!1,i.fakeGestureMoved=!1}n.$imageEl&&0!==n.$imageEl.length&&(i.scale=Math.max(Math.min(i.scale,n.maxRatio),t.minRatio),n.$imageEl.transition(this.params.speed).transform(`translate3d(0,0,0) scale(${i.scale})`),i.currentScale=i.scale,i.isScaling=!1,1===i.scale&&(n.$slideEl=void 0))},onTouchStart(e){const t=this.zoom,{gesture:i,image:n}=t;i.$imageEl&&0!==i.$imageEl.length&&(n.isTouched||(S.android&&e.cancelable&&e.preventDefault(),n.isTouched=!0,n.touchesStart.x="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,n.touchesStart.y="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY))},onTouchMove(e){const t=this,i=t.zoom,{gesture:n,image:r,velocity:a}=i;if(!n.$imageEl||0===n.$imageEl.length)return;if(t.allowClick=!1,!r.isTouched||!n.$slideEl)return;r.isMoved||(r.width=n.$imageEl[0].offsetWidth,r.height=n.$imageEl[0].offsetHeight,r.startX=m.getTranslate(n.$imageWrapEl[0],"x")||0,r.startY=m.getTranslate(n.$imageWrapEl[0],"y")||0,n.slideWidth=n.$slideEl[0].offsetWidth,n.slideHeight=n.$slideEl[0].offsetHeight,n.$imageWrapEl.transition(0),t.rtl&&(r.startX=-r.startX,r.startY=-r.startY));const s=r.width*i.scale,o=r.height*i.scale;if(!(s<n.slideWidth&&o<n.slideHeight)){if(r.minX=Math.min(n.slideWidth/2-s/2,0),r.maxX=-r.minX,r.minY=Math.min(n.slideHeight/2-o/2,0),r.maxY=-r.minY,r.touchesCurrent.x="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,r.touchesCurrent.y="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,!r.isMoved&&!i.isScaling){if(t.isHorizontal()&&(Math.floor(r.minX)===Math.floor(r.startX)&&r.touchesCurrent.x<r.touchesStart.x||Math.floor(r.maxX)===Math.floor(r.startX)&&r.touchesCurrent.x>r.touchesStart.x))return void(r.isTouched=!1);if(!t.isHorizontal()&&(Math.floor(r.minY)===Math.floor(r.startY)&&r.touchesCurrent.y<r.touchesStart.y||Math.floor(r.maxY)===Math.floor(r.startY)&&r.touchesCurrent.y>r.touchesStart.y))return void(r.isTouched=!1)}e.cancelable&&e.preventDefault(),e.stopPropagation(),r.isMoved=!0,r.currentX=r.touchesCurrent.x-r.touchesStart.x+r.startX,r.currentY=r.touchesCurrent.y-r.touchesStart.y+r.startY,r.currentX<r.minX&&(r.currentX=r.minX+1-(r.minX-r.currentX+1)**.8),r.currentX>r.maxX&&(r.currentX=r.maxX-1+(r.currentX-r.maxX+1)**.8),r.currentY<r.minY&&(r.currentY=r.minY+1-(r.minY-r.currentY+1)**.8),r.currentY>r.maxY&&(r.currentY=r.maxY-1+(r.currentY-r.maxY+1)**.8),a.prevPositionX||(a.prevPositionX=r.touchesCurrent.x),a.prevPositionY||(a.prevPositionY=r.touchesCurrent.y),a.prevTime||(a.prevTime=Date.now()),a.x=(r.touchesCurrent.x-a.prevPositionX)/(Date.now()-a.prevTime)/2,a.y=(r.touchesCurrent.y-a.prevPositionY)/(Date.now()-a.prevTime)/2,Math.abs(r.touchesCurrent.x-a.prevPositionX)<2&&(a.x=0),Math.abs(r.touchesCurrent.y-a.prevPositionY)<2&&(a.y=0),a.prevPositionX=r.touchesCurrent.x,a.prevPositionY=r.touchesCurrent.y,a.prevTime=Date.now(),n.$imageWrapEl.transform(`translate3d(${r.currentX}px, ${r.currentY}px,0)`)}},onTouchEnd(){const e=this.zoom,{gesture:t,image:i,velocity:n}=e;if(!t.$imageEl||0===t.$imageEl.length)return;if(!i.isTouched||!i.isMoved)return i.isTouched=!1,void(i.isMoved=!1);i.isTouched=!1,i.isMoved=!1;let r=300,a=300;const s=n.x*r,o=i.currentX+s,l=n.y*a,c=i.currentY+l;0!==n.x&&(r=Math.abs((o-i.currentX)/n.x)),0!==n.y&&(a=Math.abs((c-i.currentY)/n.y));const h=Math.max(r,a);i.currentX=o,i.currentY=c;const u=i.width*e.scale,d=i.height*e.scale;i.minX=Math.min(t.slideWidth/2-u/2,0),i.maxX=-i.minX,i.minY=Math.min(t.slideHeight/2-d/2,0),i.maxY=-i.minY,i.currentX=Math.max(Math.min(i.currentX,i.maxX),i.minX),i.currentY=Math.max(Math.min(i.currentY,i.maxY),i.minY),t.$imageWrapEl.transition(h).transform(`translate3d(${i.currentX}px, ${i.currentY}px,0)`)},onTransitionEnd(){const e=this.zoom,{gesture:t}=e;t.$slideEl&&this.previousIndex!==this.activeIndex&&(t.$imageEl&&t.$imageEl.transform("translate3d(0,0,0) scale(1)"),t.$imageWrapEl&&t.$imageWrapEl.transform("translate3d(0,0,0)"),e.scale=1,e.currentScale=1,t.$slideEl=void 0,t.$imageEl=void 0,t.$imageWrapEl=void 0)},toggle(e){const t=this.zoom;t.scale&&1!==t.scale?t.out():t.in(e)},in(e){const t=this,i=t.zoom,n=t.params.zoom,{gesture:r,image:a}=i;if(r.$slideEl||(t.params.virtual&&t.params.virtual.enabled&&t.virtual?r.$slideEl=t.$wrapperEl.children("."+t.params.slideActiveClass):r.$slideEl=t.slides.eq(t.activeIndex),r.$imageEl=r.$slideEl.find("img, svg, canvas, picture, .swiper-zoom-target"),r.$imageWrapEl=r.$imageEl.parent("."+n.containerClass)),!r.$imageEl||0===r.$imageEl.length)return;let s,o,l,c,h,u,d,p,m,f,g,v,y,b,x,w,_,M;r.$slideEl.addClass(""+n.zoomedSlideClass),void 0===a.touchesStart.x&&e?(s="touchend"===e.type?e.changedTouches[0].pageX:e.pageX,o="touchend"===e.type?e.changedTouches[0].pageY:e.pageY):(s=a.touchesStart.x,o=a.touchesStart.y),i.scale=r.$imageWrapEl.attr("data-swiper-zoom")||n.maxRatio,i.currentScale=r.$imageWrapEl.attr("data-swiper-zoom")||n.maxRatio,e?(_=r.$slideEl[0].offsetWidth,M=r.$slideEl[0].offsetHeight,l=r.$slideEl.offset().left,c=r.$slideEl.offset().top,h=l+_/2-s,u=c+M/2-o,m=r.$imageEl[0].offsetWidth,f=r.$imageEl[0].offsetHeight,g=m*i.scale,v=f*i.scale,y=Math.min(_/2-g/2,0),b=Math.min(M/2-v/2,0),x=-y,w=-b,d=h*i.scale,p=u*i.scale,d<y&&(d=y),d>x&&(d=x),p<b&&(p=b),p>w&&(p=w)):(d=0,p=0),r.$imageWrapEl.transition(300).transform(`translate3d(${d}px, ${p}px,0)`),r.$imageEl.transition(300).transform(`translate3d(0,0,0) scale(${i.scale})`)},out(){const e=this,t=e.zoom,i=e.params.zoom,{gesture:n}=t;n.$slideEl||(e.params.virtual&&e.params.virtual.enabled&&e.virtual?n.$slideEl=e.$wrapperEl.children("."+e.params.slideActiveClass):n.$slideEl=e.slides.eq(e.activeIndex),n.$imageEl=n.$slideEl.find("img, svg, canvas, picture, .swiper-zoom-target"),n.$imageWrapEl=n.$imageEl.parent("."+i.containerClass)),n.$imageEl&&0!==n.$imageEl.length&&(t.scale=1,t.currentScale=1,n.$imageWrapEl.transition(300).transform("translate3d(0,0,0)"),n.$imageEl.transition(300).transform("translate3d(0,0,0) scale(1)"),n.$slideEl.removeClass(""+i.zoomedSlideClass),n.$slideEl=void 0)},enable(){const e=this,t=e.zoom;if(t.enabled)return;t.enabled=!0;const i=!("touchstart"!==e.touchEvents.start||!f.passiveListener||!e.params.passiveListeners)&&{passive:!0,capture:!1},n=!f.passiveListener||{passive:!1,capture:!0},r="."+e.params.slideClass;f.gestures?(e.$wrapperEl.on("gesturestart",r,t.onGestureStart,i),e.$wrapperEl.on("gesturechange",r,t.onGestureChange,i),e.$wrapperEl.on("gestureend",r,t.onGestureEnd,i)):"touchstart"===e.touchEvents.start&&(e.$wrapperEl.on(e.touchEvents.start,r,t.onGestureStart,i),e.$wrapperEl.on(e.touchEvents.move,r,t.onGestureChange,n),e.$wrapperEl.on(e.touchEvents.end,r,t.onGestureEnd,i),e.touchEvents.cancel&&e.$wrapperEl.on(e.touchEvents.cancel,r,t.onGestureEnd,i)),e.$wrapperEl.on(e.touchEvents.move,"."+e.params.zoom.containerClass,t.onTouchMove,n)},disable(){const e=this,t=e.zoom;if(!t.enabled)return;e.zoom.enabled=!1;const i=!("touchstart"!==e.touchEvents.start||!f.passiveListener||!e.params.passiveListeners)&&{passive:!0,capture:!1},n=!f.passiveListener||{passive:!1,capture:!0},r="."+e.params.slideClass;f.gestures?(e.$wrapperEl.off("gesturestart",r,t.onGestureStart,i),e.$wrapperEl.off("gesturechange",r,t.onGestureChange,i),e.$wrapperEl.off("gestureend",r,t.onGestureEnd,i)):"touchstart"===e.touchEvents.start&&(e.$wrapperEl.off(e.touchEvents.start,r,t.onGestureStart,i),e.$wrapperEl.off(e.touchEvents.move,r,t.onGestureChange,n),e.$wrapperEl.off(e.touchEvents.end,r,t.onGestureEnd,i),e.touchEvents.cancel&&e.$wrapperEl.off(e.touchEvents.cancel,r,t.onGestureEnd,i)),e.$wrapperEl.off(e.touchEvents.move,"."+e.params.zoom.containerClass,t.onTouchMove,n)}};const ee={loadInSlide(e,t=!0){const i=this,n=i.params.lazy;if(void 0===e)return;if(0===i.slides.length)return;const r=i.virtual&&i.params.virtual.enabled?i.$wrapperEl.children(`.${i.params.slideClass}[data-swiper-slide-index="${e}"]`):i.slides.eq(e);let a=r.find(`.${n.elementClass}:not(.${n.loadedClass}):not(.${n.loadingClass})`);!r.hasClass(n.elementClass)||r.hasClass(n.loadedClass)||r.hasClass(n.loadingClass)||(a=a.add(r[0])),0!==a.length&&a.each((e,a)=>{const s=u(a);s.addClass(n.loadingClass);const o=s.attr("data-background"),l=s.attr("data-src"),c=s.attr("data-srcset"),h=s.attr("data-sizes"),d=s.parent("picture");i.loadImage(s[0],l||o,c,h,!1,()=>{if(null!=i&&i&&(!i||i.params)&&!i.destroyed){if(o?(s.css("background-image",`url("${o}")`),s.removeAttr("data-background")):(c&&(s.attr("srcset",c),s.removeAttr("data-srcset")),h&&(s.attr("sizes",h),s.removeAttr("data-sizes")),d.length&&d.children("source").each((e,t)=>{const i=u(t);i.attr("data-srcset")&&(i.attr("srcset",i.attr("data-srcset")),i.removeAttr("data-srcset"))}),l&&(s.attr("src",l),s.removeAttr("data-src"))),s.addClass(n.loadedClass).removeClass(n.loadingClass),r.find("."+n.preloaderClass).remove(),i.params.loop&&t){const e=r.attr("data-swiper-slide-index");if(r.hasClass(i.params.slideDuplicateClass)){const t=i.$wrapperEl.children(`[data-swiper-slide-index="${e}"]:not(.${i.params.slideDuplicateClass})`);i.lazy.loadInSlide(t.index(),!1)}else{const t=i.$wrapperEl.children(`.${i.params.slideDuplicateClass}[data-swiper-slide-index="${e}"]`);i.lazy.loadInSlide(t.index(),!1)}}i.emit("lazyImageReady",r[0],s[0]),i.params.autoHeight&&i.updateAutoHeight()}}),i.emit("lazyImageLoad",r[0],s[0])})},load(){const e=this,{$wrapperEl:t,params:i,slides:n,activeIndex:r}=e,a=e.virtual&&i.virtual.enabled,s=i.lazy;let o=i.slidesPerView;function l(e){if(a){if(t.children(`.${i.slideClass}[data-swiper-slide-index="${e}"]`).length)return!0}else if(n[e])return!0;return!1}function c(e){return a?u(e).attr("data-swiper-slide-index"):u(e).index()}if("auto"===o&&(o=0),e.lazy.initialImageLoaded||(e.lazy.initialImageLoaded=!0),e.params.watchSlidesVisibility)t.children("."+i.slideVisibleClass).each((t,i)=>{const n=a?u(i).attr("data-swiper-slide-index"):u(i).index();e.lazy.loadInSlide(n)});else if(o>1)for(let t=r;t<r+o;t+=1)l(t)&&e.lazy.loadInSlide(t);else e.lazy.loadInSlide(r);if(s.loadPrevNext)if(o>1||s.loadPrevNextAmount&&s.loadPrevNextAmount>1){const t=s.loadPrevNextAmount,i=o,a=Math.min(r+i+Math.max(t,i),n.length),c=Math.max(r-Math.max(i,t),0);for(let t=r+o;t<a;t+=1)l(t)&&e.lazy.loadInSlide(t);for(let t=c;t<r;t+=1)l(t)&&e.lazy.loadInSlide(t)}else{const n=t.children("."+i.slideNextClass);n.length>0&&e.lazy.loadInSlide(c(n));const r=t.children("."+i.slidePrevClass);r.length>0&&e.lazy.loadInSlide(c(r))}}};const te={LinearSpline:function(e,t){const i=function(){let e,t,i;return(n,r)=>{for(t=-1,e=n.length;e-t>1;)i=e+t>>1,n[i]<=r?t=i:e=i;return e}}();let n,r;return this.x=e,this.y=t,this.lastIndex=e.length-1,this.interpolate=function(e){return e?(r=i(this.x,e),n=r-1,(e-this.x[n])*(this.y[r]-this.y[n])/(this.x[r]-this.x[n])+this.y[n]):0},this},getInterpolateFunction(e){const t=this;t.controller.spline||(t.controller.spline=t.params.loop?new te.LinearSpline(t.slidesGrid,e.slidesGrid):new te.LinearSpline(t.snapGrid,e.snapGrid))},setTranslate(e,t){const i=this,n=i.controller.control;let r,a;function s(e){const t=i.rtlTranslate?-i.translate:i.translate;"slide"===i.params.controller.by&&(i.controller.getInterpolateFunction(e),a=-i.controller.spline.interpolate(-t)),a&&"container"!==i.params.controller.by||(r=(e.maxTranslate()-e.minTranslate())/(i.maxTranslate()-i.minTranslate()),a=(t-i.minTranslate())*r+e.minTranslate()),i.params.controller.inverse&&(a=e.maxTranslate()-a),e.updateProgress(a),e.setTranslate(a,i),e.updateActiveIndex(),e.updateSlidesClasses()}if(Array.isArray(n))for(let e=0;e<n.length;e+=1)n[e]!==t&&n[e]instanceof N&&s(n[e]);else n instanceof N&&t!==n&&s(n)},setTransition(e,t){const i=this,n=i.controller.control;let r;function a(t){t.setTransition(e,i),0!==e&&(t.transitionStart(),t.params.autoHeight&&m.nextTick(()=>{t.updateAutoHeight()}),t.$wrapperEl.transitionEnd(()=>{n&&(t.params.loop&&"slide"===i.params.controller.by&&t.loopFix(),t.transitionEnd())}))}if(Array.isArray(n))for(r=0;r<n.length;r+=1)n[r]!==t&&n[r]instanceof N&&a(n[r]);else n instanceof N&&t!==n&&a(n)}};const ie={makeElFocusable:e=>(e.attr("tabIndex","0"),e),makeElNotFocusable:e=>(e.attr("tabIndex","-1"),e),addElRole:(e,t)=>(e.attr("role",t),e),addElLabel:(e,t)=>(e.attr("aria-label",t),e),disableEl:e=>(e.attr("aria-disabled",!0),e),enableEl:e=>(e.attr("aria-disabled",!1),e),onEnterKey(e){const t=this,i=t.params.a11y;if(13!==e.keyCode)return;const n=u(e.target);t.navigation&&t.navigation.$nextEl&&n.is(t.navigation.$nextEl)&&(t.isEnd&&!t.params.loop||t.slideNext(),t.isEnd?t.a11y.notify(i.lastSlideMessage):t.a11y.notify(i.nextSlideMessage)),t.navigation&&t.navigation.$prevEl&&n.is(t.navigation.$prevEl)&&(t.isBeginning&&!t.params.loop||t.slidePrev(),t.isBeginning?t.a11y.notify(i.firstSlideMessage):t.a11y.notify(i.prevSlideMessage)),t.pagination&&n.is("."+t.params.pagination.bulletClass)&&n[0].click()},notify(e){const t=this.a11y.liveRegion;0!==t.length&&(t.html(""),t.html(e))},updateNavigation(){const e=this;if(e.params.loop||!e.navigation)return;const{$nextEl:t,$prevEl:i}=e.navigation;i&&i.length>0&&(e.isBeginning?(e.a11y.disableEl(i),e.a11y.makeElNotFocusable(i)):(e.a11y.enableEl(i),e.a11y.makeElFocusable(i))),t&&t.length>0&&(e.isEnd?(e.a11y.disableEl(t),e.a11y.makeElNotFocusable(t)):(e.a11y.enableEl(t),e.a11y.makeElFocusable(t)))},updatePagination(){const e=this,t=e.params.a11y;e.pagination&&e.params.pagination.clickable&&e.pagination.bullets&&e.pagination.bullets.length&&e.pagination.bullets.each((i,n)=>{const r=u(n);e.a11y.makeElFocusable(r),e.a11y.addElRole(r,"button"),e.a11y.addElLabel(r,t.paginationBulletMessage.replace(/\{\{index\}\}/,r.index()+1))})},init(){const e=this;e.$el.append(e.a11y.liveRegion);const t=e.params.a11y;let i,n;e.navigation&&e.navigation.$nextEl&&(i=e.navigation.$nextEl),e.navigation&&e.navigation.$prevEl&&(n=e.navigation.$prevEl),i&&(e.a11y.makeElFocusable(i),e.a11y.addElRole(i,"button"),e.a11y.addElLabel(i,t.nextSlideMessage),i.on("keydown",e.a11y.onEnterKey)),n&&(e.a11y.makeElFocusable(n),e.a11y.addElRole(n,"button"),e.a11y.addElLabel(n,t.prevSlideMessage),n.on("keydown",e.a11y.onEnterKey)),e.pagination&&e.params.pagination.clickable&&e.pagination.bullets&&e.pagination.bullets.length&&e.pagination.$el.on("keydown","."+e.params.pagination.bulletClass,e.a11y.onEnterKey)},destroy(){const e=this;let t,i;e.a11y.liveRegion&&e.a11y.liveRegion.length>0&&e.a11y.liveRegion.remove(),e.navigation&&e.navigation.$nextEl&&(t=e.navigation.$nextEl),e.navigation&&e.navigation.$prevEl&&(i=e.navigation.$prevEl),t&&t.off("keydown",e.a11y.onEnterKey),i&&i.off("keydown",e.a11y.onEnterKey),e.pagination&&e.params.pagination.clickable&&e.pagination.bullets&&e.pagination.bullets.length&&e.pagination.$el.off("keydown","."+e.params.pagination.bulletClass,e.a11y.onEnterKey)}};const ne={init(){const e=this;if(!e.params.history)return;if(!c.history||!c.history.pushState)return e.params.history.enabled=!1,void(e.params.hashNavigation.enabled=!0);const t=e.history;t.initialized=!0,t.paths=ne.getPathValues(),(t.paths.key||t.paths.value)&&(t.scrollToSlide(0,t.paths.value,e.params.runCallbacksOnInit),e.params.history.replaceState||c.addEventListener("popstate",e.history.setHistoryPopState))},destroy(){const e=this;e.params.history.replaceState||c.removeEventListener("popstate",e.history.setHistoryPopState)},setHistoryPopState(){this.history.paths=ne.getPathValues(),this.history.scrollToSlide(this.params.speed,this.history.paths.value,!1)},getPathValues(){const e=c.location.pathname.slice(1).split("/").filter(e=>""!==e),t=e.length;return{key:e[t-2],value:e[t-1]}},setHistory(e,t){if(!this.history.initialized||!this.params.history.enabled)return;const i=this.slides.eq(t);let n=ne.slugify(i.attr("data-history"));c.location.pathname.includes(e)||(n=`${e}/${n}`);const r=c.history.state;r&&r.value===n||(this.params.history.replaceState?c.history.replaceState({value:n},null,n):c.history.pushState({value:n},null,n))},slugify:e=>e.toString().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,""),scrollToSlide(e,t,i){const n=this;if(t)for(let r=0,a=n.slides.length;r<a;r+=1){const a=n.slides.eq(r);if(ne.slugify(a.attr("data-history"))===t&&!a.hasClass(n.params.slideDuplicateClass)){const t=a.index();n.slideTo(t,e,i)}}else n.slideTo(0,e,i)}};const re={onHashCange(){const e=this;e.emit("hashChange");const t=o.location.hash.replace("#","");if(t!==e.slides.eq(e.activeIndex).attr("data-hash")){const i=e.$wrapperEl.children(`.${e.params.slideClass}[data-hash="${t}"]`).index();if(void 0===i)return;e.slideTo(i)}},setHash(){const e=this;if(e.hashNavigation.initialized&&e.params.hashNavigation.enabled)if(e.params.hashNavigation.replaceState&&c.history&&c.history.replaceState)c.history.replaceState(null,null,"#"+e.slides.eq(e.activeIndex).attr("data-hash")||""),e.emit("hashSet");else{const t=e.slides.eq(e.activeIndex),i=t.attr("data-hash")||t.attr("data-history");o.location.hash=i||"",e.emit("hashSet")}},init(){const e=this;if(!e.params.hashNavigation.enabled||e.params.history&&e.params.history.enabled)return;e.hashNavigation.initialized=!0;const t=o.location.hash.replace("#","");if(t){const i=0;for(let n=0,r=e.slides.length;n<r;n+=1){const r=e.slides.eq(n);if((r.attr("data-hash")||r.attr("data-history"))===t&&!r.hasClass(e.params.slideDuplicateClass)){const t=r.index();e.slideTo(t,i,e.params.runCallbacksOnInit,!0)}}}e.params.hashNavigation.watchState&&u(c).on("hashchange",e.hashNavigation.onHashCange)},destroy(){const e=this;e.params.hashNavigation.watchState&&u(c).off("hashchange",e.hashNavigation.onHashCange)}};const ae={run(){const e=this,t=e.slides.eq(e.activeIndex);let i=e.params.autoplay.delay;t.attr("data-swiper-autoplay")&&(i=t.attr("data-swiper-autoplay")||e.params.autoplay.delay),clearTimeout(e.autoplay.timeout),e.autoplay.timeout=m.nextTick(()=>{e.params.autoplay.reverseDirection?e.params.loop?(e.loopFix(),e.slidePrev(e.params.speed,!0,!0),e.emit("autoplay")):e.isBeginning?e.params.autoplay.stopOnLastSlide?e.autoplay.stop():(e.slideTo(e.slides.length-1,e.params.speed,!0,!0),e.emit("autoplay")):(e.slidePrev(e.params.speed,!0,!0),e.emit("autoplay")):e.params.loop?(e.loopFix(),e.slideNext(e.params.speed,!0,!0),e.emit("autoplay")):e.isEnd?e.params.autoplay.stopOnLastSlide?e.autoplay.stop():(e.slideTo(0,e.params.speed,!0,!0),e.emit("autoplay")):(e.slideNext(e.params.speed,!0,!0),e.emit("autoplay")),e.params.cssMode&&e.autoplay.running&&e.autoplay.run()},i)},start(){return void 0===this.autoplay.timeout&&(!this.autoplay.running&&(this.autoplay.running=!0,this.emit("autoplayStart"),this.autoplay.run(),!0))},stop(){const e=this;return!!e.autoplay.running&&(void 0!==e.autoplay.timeout&&(e.autoplay.timeout&&(clearTimeout(e.autoplay.timeout),e.autoplay.timeout=void 0),e.autoplay.running=!1,e.emit("autoplayStop"),!0))},pause(e){const t=this;t.autoplay.running&&(t.autoplay.paused||(t.autoplay.timeout&&clearTimeout(t.autoplay.timeout),t.autoplay.paused=!0,0!==e&&t.params.autoplay.waitForTransition?(t.$wrapperEl[0].addEventListener("transitionend",t.autoplay.onTransitionEnd),t.$wrapperEl[0].addEventListener("webkitTransitionEnd",t.autoplay.onTransitionEnd)):(t.autoplay.paused=!1,t.autoplay.run())))}};const se={setTranslate(){const e=this,{slides:t}=e;for(let i=0;i<t.length;i+=1){const t=e.slides.eq(i);let n=-t[0].swiperSlideOffset;e.params.virtualTranslate||(n-=e.translate);let r=0;e.isHorizontal()||(r=n,n=0);const a=e.params.fadeEffect.crossFade?Math.max(1-Math.abs(t[0].progress),0):1+Math.min(Math.max(t[0].progress,-1),0);t.css({opacity:a}).transform(`translate3d(${n}px, ${r}px, 0px)`)}},setTransition(e){const t=this,{slides:i,$wrapperEl:n}=t;if(i.transition(e),t.params.virtualTranslate&&0!==e){let e=!1;i.transitionEnd(()=>{if(e)return;if(!t||t.destroyed)return;e=!0,t.animating=!1;const i=["webkitTransitionEnd","transitionend"];for(let e=0;e<i.length;e+=1)n.trigger(i[e])})}}};const oe={setTranslate(){const{$el:e,$wrapperEl:t,slides:i,width:n,height:r,rtlTranslate:a,size:s}=this,o=this.params.cubeEffect,l=this.isHorizontal(),c=this.virtual&&this.params.virtual.enabled;let h,d=0;o.shadow&&(l?(h=t.find(".swiper-cube-shadow"),0===h.length&&(h=u('<div class="swiper-cube-shadow"></div>'),t.append(h)),h.css({height:n+"px"})):(h=e.find(".swiper-cube-shadow"),0===h.length&&(h=u('<div class="swiper-cube-shadow"></div>'),e.append(h))));for(let e=0;e<i.length;e+=1){const t=i.eq(e);let n=e;c&&(n=parseInt(t.attr("data-swiper-slide-index"),10));let r=90*n,h=Math.floor(r/360);a&&(r=-r,h=Math.floor(-r/360));const p=Math.max(Math.min(t[0].progress,1),-1);let m=0,f=0,g=0;n%4==0?(m=4*-h*s,g=0):(n-1)%4==0?(m=0,g=4*-h*s):(n-2)%4==0?(m=s+4*h*s,g=s):(n-3)%4==0&&(m=-s,g=3*s+4*s*h),a&&(m=-m),l||(f=m,m=0);const v=`rotateX(${l?0:-r}deg) rotateY(${l?r:0}deg) translate3d(${m}px, ${f}px, ${g}px)`;if(p<=1&&p>-1&&(d=90*n+90*p,a&&(d=90*-n-90*p)),t.transform(v),o.slideShadows){let e=l?t.find(".swiper-slide-shadow-left"):t.find(".swiper-slide-shadow-top"),i=l?t.find(".swiper-slide-shadow-right"):t.find(".swiper-slide-shadow-bottom");0===e.length&&(e=u(`<div class="swiper-slide-shadow-${l?"left":"top"}"></div>`),t.append(e)),0===i.length&&(i=u(`<div class="swiper-slide-shadow-${l?"right":"bottom"}"></div>`),t.append(i)),e.length&&(e[0].style.opacity=Math.max(-p,0)),i.length&&(i[0].style.opacity=Math.max(p,0))}}if(t.css({"-webkit-transform-origin":`50% 50% -${s/2}px`,"-moz-transform-origin":`50% 50% -${s/2}px`,"-ms-transform-origin":`50% 50% -${s/2}px`,"transform-origin":`50% 50% -${s/2}px`}),o.shadow)if(l)h.transform(`translate3d(0px, ${n/2+o.shadowOffset}px, ${-n/2}px) rotateX(90deg) rotateZ(0deg) scale(${o.shadowScale})`);else{const e=Math.abs(d)-90*Math.floor(Math.abs(d)/90),t=1.5-(Math.sin(2*e*Math.PI/360)/2+Math.cos(2*e*Math.PI/360)/2),i=o.shadowScale,n=o.shadowScale/t,a=o.shadowOffset;h.transform(`scale3d(${i}, 1, ${n}) translate3d(0px, ${r/2+a}px, ${-r/2/n}px) rotateX(-90deg)`)}const p=B.isSafari||B.isUiWebView?-s/2:0;t.transform(`translate3d(0px,0,${p}px) rotateX(${this.isHorizontal()?0:d}deg) rotateY(${this.isHorizontal()?-d:0}deg)`)},setTransition(e){const{$el:t,slides:i}=this;i.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e),this.params.cubeEffect.shadow&&!this.isHorizontal()&&t.find(".swiper-cube-shadow").transition(e)}};const le={setTranslate(){const e=this,{slides:t,rtlTranslate:i}=e;for(let n=0;n<t.length;n+=1){const r=t.eq(n);let a=r[0].progress;e.params.flipEffect.limitRotation&&(a=Math.max(Math.min(r[0].progress,1),-1));let s=-180*a,o=0,l=-r[0].swiperSlideOffset,c=0;if(e.isHorizontal()?i&&(s=-s):(c=l,l=0,o=-s,s=0),r[0].style.zIndex=-Math.abs(Math.round(a))+t.length,e.params.flipEffect.slideShadows){let t=e.isHorizontal()?r.find(".swiper-slide-shadow-left"):r.find(".swiper-slide-shadow-top"),i=e.isHorizontal()?r.find(".swiper-slide-shadow-right"):r.find(".swiper-slide-shadow-bottom");0===t.length&&(t=u(`<div class="swiper-slide-shadow-${e.isHorizontal()?"left":"top"}"></div>`),r.append(t)),0===i.length&&(i=u(`<div class="swiper-slide-shadow-${e.isHorizontal()?"right":"bottom"}"></div>`),r.append(i)),t.length&&(t[0].style.opacity=Math.max(-a,0)),i.length&&(i[0].style.opacity=Math.max(a,0))}r.transform(`translate3d(${l}px, ${c}px, 0px) rotateX(${o}deg) rotateY(${s}deg)`)}},setTransition(e){const t=this,{slides:i,activeIndex:n,$wrapperEl:r}=t;if(i.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e),t.params.virtualTranslate&&0!==e){let e=!1;i.eq(n).transitionEnd((function(){if(e)return;if(!t||t.destroyed)return;e=!0,t.animating=!1;const i=["webkitTransitionEnd","transitionend"];for(let e=0;e<i.length;e+=1)r.trigger(i[e])}))}}};const ce={setTranslate(){const{width:e,height:t,slides:i,$wrapperEl:n,slidesSizesGrid:r}=this,a=this.params.coverflowEffect,s=this.isHorizontal(),o=this.translate,l=s?e/2-o:t/2-o,c=s?a.rotate:-a.rotate,h=a.depth;for(let e=0,t=i.length;e<t;e+=1){const t=i.eq(e),n=r[e],o=(l-t[0].swiperSlideOffset-n/2)/n*a.modifier;let d=s?c*o:0,p=s?0:c*o,m=-h*Math.abs(o),f=a.stretch;"string"==typeof f&&-1!==f.indexOf("%")&&(f=parseFloat(a.stretch)/100*n);let g=s?0:f*o,v=s?f*o:0;Math.abs(v)<.001&&(v=0),Math.abs(g)<.001&&(g=0),Math.abs(m)<.001&&(m=0),Math.abs(d)<.001&&(d=0),Math.abs(p)<.001&&(p=0);const y=`translate3d(${v}px,${g}px,${m}px)  rotateX(${p}deg) rotateY(${d}deg)`;if(t.transform(y),t[0].style.zIndex=1-Math.abs(Math.round(o)),a.slideShadows){let e=s?t.find(".swiper-slide-shadow-left"):t.find(".swiper-slide-shadow-top"),i=s?t.find(".swiper-slide-shadow-right"):t.find(".swiper-slide-shadow-bottom");0===e.length&&(e=u(`<div class="swiper-slide-shadow-${s?"left":"top"}"></div>`),t.append(e)),0===i.length&&(i=u(`<div class="swiper-slide-shadow-${s?"right":"bottom"}"></div>`),t.append(i)),e.length&&(e[0].style.opacity=o>0?o:0),i.length&&(i[0].style.opacity=-o>0?-o:0)}}if(f.pointerEvents||f.prefixedPointerEvents){n[0].style.perspectiveOrigin=l+"px 50%"}},setTransition(e){this.slides.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e)}};const he={init(){const e=this,{thumbs:t}=e.params,i=e.constructor;t.swiper instanceof i?(e.thumbs.swiper=t.swiper,m.extend(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),m.extend(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1})):m.isObject(t.swiper)&&(e.thumbs.swiper=new i(m.extend({},t.swiper,{watchSlidesVisibility:!0,watchSlidesProgress:!0,slideToClickedSlide:!1})),e.thumbs.swiperCreated=!0),e.thumbs.swiper.$el.addClass(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",e.thumbs.onThumbClick)},onThumbClick(){const e=this,t=e.thumbs.swiper;if(!t)return;const i=t.clickedIndex,n=t.clickedSlide;if(n&&u(n).hasClass(e.params.thumbs.slideThumbActiveClass))return;if(null==i)return;let r;if(r=t.params.loop?parseInt(u(t.clickedSlide).attr("data-swiper-slide-index"),10):i,e.params.loop){let t=e.activeIndex;e.slides.eq(t).hasClass(e.params.slideDuplicateClass)&&(e.loopFix(),e._clientLeft=e.$wrapperEl[0].clientLeft,t=e.activeIndex);const i=e.slides.eq(t).prevAll(`[data-swiper-slide-index="${r}"]`).eq(0).index(),n=e.slides.eq(t).nextAll(`[data-swiper-slide-index="${r}"]`).eq(0).index();r=void 0===i?n:void 0===n?i:n-t<t-i?n:i}e.slideTo(r)},update(e){const t=this,i=t.thumbs.swiper;if(!i)return;const n="auto"===i.params.slidesPerView?i.slidesPerViewDynamic():i.params.slidesPerView,r=t.params.thumbs.autoScrollOffset,a=r&&!i.params.loop;if(t.realIndex!==i.realIndex||a){let s,o,l=i.activeIndex;if(i.params.loop){i.slides.eq(l).hasClass(i.params.slideDuplicateClass)&&(i.loopFix(),i._clientLeft=i.$wrapperEl[0].clientLeft,l=i.activeIndex);const e=i.slides.eq(l).prevAll(`[data-swiper-slide-index="${t.realIndex}"]`).eq(0).index(),n=i.slides.eq(l).nextAll(`[data-swiper-slide-index="${t.realIndex}"]`).eq(0).index();s=void 0===e?n:void 0===n?e:n-l==l-e?l:n-l<l-e?n:e,o=t.activeIndex>t.previousIndex?"next":"prev"}else s=t.realIndex,o=s>t.previousIndex?"next":"prev";a&&(s+="next"===o?r:-1*r),i.visibleSlidesIndexes&&i.visibleSlidesIndexes.indexOf(s)<0&&(i.params.centeredSlides?s=s>l?s-Math.floor(n/2)+1:s+Math.floor(n/2)-1:s>l&&(s=s-n+1),i.slideTo(s,e?0:void 0))}let s=1;const o=t.params.thumbs.slideThumbActiveClass;if(t.params.slidesPerView>1&&!t.params.centeredSlides&&(s=t.params.slidesPerView),t.params.thumbs.multipleActiveThumbs||(s=1),s=Math.floor(s),i.slides.removeClass(o),i.params.loop||i.params.virtual&&i.params.virtual.enabled)for(let e=0;e<s;e+=1)i.$wrapperEl.children(`[data-swiper-slide-index="${t.realIndex+e}"]`).addClass(o);else for(let e=0;e<s;e+=1)i.slides.eq(t.realIndex+e).addClass(o)}};const ue=[z,F,H,G,j,W,$,{name:"mousewheel",params:{mousewheel:{enabled:!1,releaseOnEdges:!1,invert:!1,forceToAxis:!1,sensitivity:1,eventsTarged:"container"}},create(){m.extend(this,{mousewheel:{enabled:!1,enable:X.enable.bind(this),disable:X.disable.bind(this),handle:X.handle.bind(this),handleMouseEnter:X.handleMouseEnter.bind(this),handleMouseLeave:X.handleMouseLeave.bind(this),animateSlider:X.animateSlider.bind(this),releaseScroll:X.releaseScroll.bind(this),lastScrollTime:m.now(),lastEventBeforeSnap:void 0,recentWheelEvents:[]}})},on:{init(){const e=this;!e.params.mousewheel.enabled&&e.params.cssMode&&e.mousewheel.disable(),e.params.mousewheel.enabled&&e.mousewheel.enable()},destroy(){const e=this;e.params.cssMode&&e.mousewheel.enable(),e.mousewheel.enabled&&e.mousewheel.disable()}}},{name:"navigation",params:{navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock"}},create(){m.extend(this,{navigation:{init:Y.init.bind(this),update:Y.update.bind(this),destroy:Y.destroy.bind(this),onNextClick:Y.onNextClick.bind(this),onPrevClick:Y.onPrevClick.bind(this)}})},on:{init(){this.navigation.init(),this.navigation.update()},toEdge(){this.navigation.update()},fromEdge(){this.navigation.update()},destroy(){this.navigation.destroy()},click(e){const t=this,{$nextEl:i,$prevEl:n}=t.navigation;if(t.params.navigation.hideOnClick&&!u(e.target).is(n)&&!u(e.target).is(i)){let e;i?e=i.hasClass(t.params.navigation.hiddenClass):n&&(e=n.hasClass(t.params.navigation.hiddenClass)),!0===e?t.emit("navigationShow",t):t.emit("navigationHide",t),i&&i.toggleClass(t.params.navigation.hiddenClass),n&&n.toggleClass(t.params.navigation.hiddenClass)}}}},{name:"pagination",params:{pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:e=>e,formatFractionTotal:e=>e,bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active",modifierClass:"swiper-pagination-",currentClass:"swiper-pagination-current",totalClass:"swiper-pagination-total",hiddenClass:"swiper-pagination-hidden",progressbarFillClass:"swiper-pagination-progressbar-fill",progressbarOppositeClass:"swiper-pagination-progressbar-opposite",clickableClass:"swiper-pagination-clickable",lockClass:"swiper-pagination-lock"}},create(){m.extend(this,{pagination:{init:Z.init.bind(this),render:Z.render.bind(this),update:Z.update.bind(this),destroy:Z.destroy.bind(this),dynamicBulletIndex:0}})},on:{init(){this.pagination.init(),this.pagination.render(),this.pagination.update()},activeIndexChange(){const e=this;(e.params.loop||void 0===e.snapIndex)&&e.pagination.update()},snapIndexChange(){const e=this;e.params.loop||e.pagination.update()},slidesLengthChange(){const e=this;e.params.loop&&(e.pagination.render(),e.pagination.update())},snapGridLengthChange(){const e=this;e.params.loop||(e.pagination.render(),e.pagination.update())},destroy(){this.pagination.destroy()},click(e){const t=this;if(t.params.pagination.el&&t.params.pagination.hideOnClick&&t.pagination.$el.length>0&&!u(e.target).hasClass(t.params.pagination.bulletClass)){!0===t.pagination.$el.hasClass(t.params.pagination.hiddenClass)?t.emit("paginationShow",t):t.emit("paginationHide",t),t.pagination.$el.toggleClass(t.params.pagination.hiddenClass)}}}},{name:"scrollbar",params:{scrollbar:{el:null,dragSize:"auto",hide:!1,draggable:!1,snapOnRelease:!0,lockClass:"swiper-scrollbar-lock",dragClass:"swiper-scrollbar-drag"}},create(){m.extend(this,{scrollbar:{init:J.init.bind(this),destroy:J.destroy.bind(this),updateSize:J.updateSize.bind(this),setTranslate:J.setTranslate.bind(this),setTransition:J.setTransition.bind(this),enableDraggable:J.enableDraggable.bind(this),disableDraggable:J.disableDraggable.bind(this),setDragPosition:J.setDragPosition.bind(this),getPointerPosition:J.getPointerPosition.bind(this),onDragStart:J.onDragStart.bind(this),onDragMove:J.onDragMove.bind(this),onDragEnd:J.onDragEnd.bind(this),isTouched:!1,timeout:null,dragTimeout:null}})},on:{init(){this.scrollbar.init(),this.scrollbar.updateSize(),this.scrollbar.setTranslate()},update(){this.scrollbar.updateSize()},resize(){this.scrollbar.updateSize()},observerUpdate(){this.scrollbar.updateSize()},setTranslate(){this.scrollbar.setTranslate()},setTransition(e){this.scrollbar.setTransition(e)},destroy(){this.scrollbar.destroy()}}},{name:"parallax",params:{parallax:{enabled:!1}},create(){m.extend(this,{parallax:{setTransform:K.setTransform.bind(this),setTranslate:K.setTranslate.bind(this),setTransition:K.setTransition.bind(this)}})},on:{beforeInit(){this.params.parallax.enabled&&(this.params.watchSlidesProgress=!0,this.originalParams.watchSlidesProgress=!0)},init(){this.params.parallax.enabled&&this.parallax.setTranslate()},setTranslate(){this.params.parallax.enabled&&this.parallax.setTranslate()},setTransition(e){this.params.parallax.enabled&&this.parallax.setTransition(e)}}},{name:"zoom",params:{zoom:{enabled:!1,maxRatio:3,minRatio:1,toggle:!0,containerClass:"swiper-zoom-container",zoomedSlideClass:"swiper-slide-zoomed"}},create(){const e=this,t={enabled:!1,scale:1,currentScale:1,isScaling:!1,gesture:{$slideEl:void 0,slideWidth:void 0,slideHeight:void 0,$imageEl:void 0,$imageWrapEl:void 0,maxRatio:3},image:{isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},velocity:{x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0}};"onGestureStart onGestureChange onGestureEnd onTouchStart onTouchMove onTouchEnd onTransitionEnd toggle enable disable in out".split(" ").forEach(i=>{t[i]=Q[i].bind(e)}),m.extend(e,{zoom:t});let i=1;Object.defineProperty(e.zoom,"scale",{get:()=>i,set(t){if(i!==t){const i=e.zoom.gesture.$imageEl?e.zoom.gesture.$imageEl[0]:void 0,n=e.zoom.gesture.$slideEl?e.zoom.gesture.$slideEl[0]:void 0;e.emit("zoomChange",t,i,n)}i=t}})},on:{init(){const e=this;e.params.zoom.enabled&&e.zoom.enable()},destroy(){this.zoom.disable()},touchStart(e){this.zoom.enabled&&this.zoom.onTouchStart(e)},touchEnd(e){this.zoom.enabled&&this.zoom.onTouchEnd(e)},doubleTap(e){const t=this;t.params.zoom.enabled&&t.zoom.enabled&&t.params.zoom.toggle&&t.zoom.toggle(e)},transitionEnd(){const e=this;e.zoom.enabled&&e.params.zoom.enabled&&e.zoom.onTransitionEnd()},slideChange(){const e=this;e.zoom.enabled&&e.params.zoom.enabled&&e.params.cssMode&&e.zoom.onTransitionEnd()}}},{name:"lazy",params:{lazy:{enabled:!1,loadPrevNext:!1,loadPrevNextAmount:1,loadOnTransitionStart:!1,elementClass:"swiper-lazy",loadingClass:"swiper-lazy-loading",loadedClass:"swiper-lazy-loaded",preloaderClass:"swiper-lazy-preloader"}},create(){m.extend(this,{lazy:{initialImageLoaded:!1,load:ee.load.bind(this),loadInSlide:ee.loadInSlide.bind(this)}})},on:{beforeInit(){const e=this;e.params.lazy.enabled&&e.params.preloadImages&&(e.params.preloadImages=!1)},init(){const e=this;e.params.lazy.enabled&&!e.params.loop&&0===e.params.initialSlide&&e.lazy.load()},scroll(){const e=this;e.params.freeMode&&!e.params.freeModeSticky&&e.lazy.load()},resize(){const e=this;e.params.lazy.enabled&&e.lazy.load()},scrollbarDragMove(){const e=this;e.params.lazy.enabled&&e.lazy.load()},transitionStart(){const e=this;e.params.lazy.enabled&&(e.params.lazy.loadOnTransitionStart||!e.params.lazy.loadOnTransitionStart&&!e.lazy.initialImageLoaded)&&e.lazy.load()},transitionEnd(){const e=this;e.params.lazy.enabled&&!e.params.lazy.loadOnTransitionStart&&e.lazy.load()},slideChange(){const e=this;e.params.lazy.enabled&&e.params.cssMode&&e.lazy.load()}}},{name:"controller",params:{controller:{control:void 0,inverse:!1,by:"slide"}},create(){m.extend(this,{controller:{control:this.params.controller.control,getInterpolateFunction:te.getInterpolateFunction.bind(this),setTranslate:te.setTranslate.bind(this),setTransition:te.setTransition.bind(this)}})},on:{update(){const e=this;e.controller.control&&e.controller.spline&&(e.controller.spline=void 0,delete e.controller.spline)},resize(){const e=this;e.controller.control&&e.controller.spline&&(e.controller.spline=void 0,delete e.controller.spline)},observerUpdate(){const e=this;e.controller.control&&e.controller.spline&&(e.controller.spline=void 0,delete e.controller.spline)},setTranslate(e,t){this.controller.control&&this.controller.setTranslate(e,t)},setTransition(e,t){this.controller.control&&this.controller.setTransition(e,t)}}},{name:"a11y",params:{a11y:{enabled:!0,notificationClass:"swiper-notification",prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}"}},create(){const e=this;m.extend(e,{a11y:{liveRegion:u(`<span class="${e.params.a11y.notificationClass}" aria-live="assertive" aria-atomic="true"></span>`)}}),Object.keys(ie).forEach(t=>{e.a11y[t]=ie[t].bind(e)})},on:{init(){this.params.a11y.enabled&&(this.a11y.init(),this.a11y.updateNavigation())},toEdge(){this.params.a11y.enabled&&this.a11y.updateNavigation()},fromEdge(){this.params.a11y.enabled&&this.a11y.updateNavigation()},paginationUpdate(){this.params.a11y.enabled&&this.a11y.updatePagination()},destroy(){this.params.a11y.enabled&&this.a11y.destroy()}}},{name:"history",params:{history:{enabled:!1,replaceState:!1,key:"slides"}},create(){m.extend(this,{history:{init:ne.init.bind(this),setHistory:ne.setHistory.bind(this),setHistoryPopState:ne.setHistoryPopState.bind(this),scrollToSlide:ne.scrollToSlide.bind(this),destroy:ne.destroy.bind(this)}})},on:{init(){const e=this;e.params.history.enabled&&e.history.init()},destroy(){const e=this;e.params.history.enabled&&e.history.destroy()},transitionEnd(){const e=this;e.history.initialized&&e.history.setHistory(e.params.history.key,e.activeIndex)},slideChange(){const e=this;e.history.initialized&&e.params.cssMode&&e.history.setHistory(e.params.history.key,e.activeIndex)}}},{name:"hash-navigation",params:{hashNavigation:{enabled:!1,replaceState:!1,watchState:!1}},create(){m.extend(this,{hashNavigation:{initialized:!1,init:re.init.bind(this),destroy:re.destroy.bind(this),setHash:re.setHash.bind(this),onHashCange:re.onHashCange.bind(this)}})},on:{init(){const e=this;e.params.hashNavigation.enabled&&e.hashNavigation.init()},destroy(){const e=this;e.params.hashNavigation.enabled&&e.hashNavigation.destroy()},transitionEnd(){const e=this;e.hashNavigation.initialized&&e.hashNavigation.setHash()},slideChange(){const e=this;e.hashNavigation.initialized&&e.params.cssMode&&e.hashNavigation.setHash()}}},{name:"autoplay",params:{autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!0,stopOnLastSlide:!1,reverseDirection:!1}},create(){const e=this;m.extend(e,{autoplay:{running:!1,paused:!1,run:ae.run.bind(e),start:ae.start.bind(e),stop:ae.stop.bind(e),pause:ae.pause.bind(e),onVisibilityChange(){"hidden"===document.visibilityState&&e.autoplay.running&&e.autoplay.pause(),"visible"===document.visibilityState&&e.autoplay.paused&&(e.autoplay.run(),e.autoplay.paused=!1)},onTransitionEnd(t){e&&!e.destroyed&&e.$wrapperEl&&t.target===this&&(e.$wrapperEl[0].removeEventListener("transitionend",e.autoplay.onTransitionEnd),e.$wrapperEl[0].removeEventListener("webkitTransitionEnd",e.autoplay.onTransitionEnd),e.autoplay.paused=!1,e.autoplay.running?e.autoplay.run():e.autoplay.stop())}}})},on:{init(){const e=this;e.params.autoplay.enabled&&(e.autoplay.start(),document.addEventListener("visibilitychange",e.autoplay.onVisibilityChange))},beforeTransitionStart(e,t){const i=this;i.autoplay.running&&(t||!i.params.autoplay.disableOnInteraction?i.autoplay.pause(e):i.autoplay.stop())},sliderFirstMove(){const e=this;e.autoplay.running&&(e.params.autoplay.disableOnInteraction?e.autoplay.stop():e.autoplay.pause())},touchEnd(){const e=this;e.params.cssMode&&e.autoplay.paused&&!e.params.autoplay.disableOnInteraction&&e.autoplay.run()},destroy(){const e=this;e.autoplay.running&&e.autoplay.stop(),document.removeEventListener("visibilitychange",e.autoplay.onVisibilityChange)}}},{name:"effect-fade",params:{fadeEffect:{crossFade:!1}},create(){m.extend(this,{fadeEffect:{setTranslate:se.setTranslate.bind(this),setTransition:se.setTransition.bind(this)}})},on:{beforeInit(){if("fade"!==this.params.effect)return;this.classNames.push(this.params.containerModifierClass+"fade");const e={slidesPerView:1,slidesPerColumn:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!0};m.extend(this.params,e),m.extend(this.originalParams,e)},setTranslate(){"fade"===this.params.effect&&this.fadeEffect.setTranslate()},setTransition(e){"fade"===this.params.effect&&this.fadeEffect.setTransition(e)}}},{name:"effect-cube",params:{cubeEffect:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94}},create(){m.extend(this,{cubeEffect:{setTranslate:oe.setTranslate.bind(this),setTransition:oe.setTransition.bind(this)}})},on:{beforeInit(){if("cube"!==this.params.effect)return;this.classNames.push(this.params.containerModifierClass+"cube"),this.classNames.push(this.params.containerModifierClass+"3d");const e={slidesPerView:1,slidesPerColumn:1,slidesPerGroup:1,watchSlidesProgress:!0,resistanceRatio:0,spaceBetween:0,centeredSlides:!1,virtualTranslate:!0};m.extend(this.params,e),m.extend(this.originalParams,e)},setTranslate(){"cube"===this.params.effect&&this.cubeEffect.setTranslate()},setTransition(e){"cube"===this.params.effect&&this.cubeEffect.setTransition(e)}}},{name:"effect-flip",params:{flipEffect:{slideShadows:!0,limitRotation:!0}},create(){m.extend(this,{flipEffect:{setTranslate:le.setTranslate.bind(this),setTransition:le.setTransition.bind(this)}})},on:{beforeInit(){if("flip"!==this.params.effect)return;this.classNames.push(this.params.containerModifierClass+"flip"),this.classNames.push(this.params.containerModifierClass+"3d");const e={slidesPerView:1,slidesPerColumn:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!0};m.extend(this.params,e),m.extend(this.originalParams,e)},setTranslate(){"flip"===this.params.effect&&this.flipEffect.setTranslate()},setTransition(e){"flip"===this.params.effect&&this.flipEffect.setTransition(e)}}},{name:"effect-coverflow",params:{coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0}},create(){m.extend(this,{coverflowEffect:{setTranslate:ce.setTranslate.bind(this),setTransition:ce.setTransition.bind(this)}})},on:{beforeInit(){"coverflow"===this.params.effect&&(this.classNames.push(this.params.containerModifierClass+"coverflow"),this.classNames.push(this.params.containerModifierClass+"3d"),this.params.watchSlidesProgress=!0,this.originalParams.watchSlidesProgress=!0)},setTranslate(){"coverflow"===this.params.effect&&this.coverflowEffect.setTranslate()},setTransition(e){"coverflow"===this.params.effect&&this.coverflowEffect.setTransition(e)}}},{name:"thumbs",params:{thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-container-thumbs"}},create(){m.extend(this,{thumbs:{swiper:null,init:he.init.bind(this),update:he.update.bind(this),onThumbClick:he.onThumbClick.bind(this)}})},on:{beforeInit(){const{thumbs:e}=this.params;e&&e.swiper&&(this.thumbs.init(),this.thumbs.update(!0))},slideChange(){this.thumbs.swiper&&this.thumbs.update()},update(){this.thumbs.swiper&&this.thumbs.update()},resize(){this.thumbs.swiper&&this.thumbs.update()},observerUpdate(){this.thumbs.swiper&&this.thumbs.update()},setTransition(e){const t=this.thumbs.swiper;t&&t.setTransition(e)},beforeDestroy(){const e=this.thumbs.swiper;e&&this.thumbs.swiperCreated&&e&&e.destroy()}}}];void 0===N.use&&(N.use=N.Class.use,N.installModule=N.Class.installModule),N.use(ue);var de=N;class pe{constructor(){this.header=document.querySelector(".js-header"),this.menu=document.querySelector(".js-menu"),this.menuToggler=document.querySelector(".js-menu-toggler"),this.menuOverlay=document.querySelector(".js-overlay"),this.menuLinks=[...document.querySelectorAll(".js-menu-link")],this.vh=.01*window.innerHeight,document.documentElement.style.setProperty("--vh",this.vh+"px"),n("#menu",{sectionClass:".js-scrollspy",menuActiveTarget:".js-menu-link",offset:100});var e,t;this.accentLinkTextObjects=(e=this.menu,t=".main-menu__link-text",[...e.querySelectorAll(t)].map(e=>{const t=new r(e,300,null,"transform");return t.clearStyle(),t})),this.initEventListeners()}initEventListeners(){window.addEventListener("resize",()=>{this.vh=.01*window.innerHeight,document.documentElement.style.setProperty("--vh",this.vh+"px")}),this.menuToggler&&(this.menuToggler.addEventListener("click",()=>{this.menu.classList.contains("main-menu--opened")?(this.header.classList.remove("page-header--menu-opened"),this.menu.classList.remove("main-menu--active"),this.menu.classList.remove("main-menu--opened-in"),this.menu.classList.add("main-menu--opened-out"),this.accentLinkTextObjects.forEach(e=>{e.clearStyle()}),setTimeout(()=>{this.menu.classList.remove("main-menu--opened"),this.menu.classList.remove("main-menu--opened-out")},350)):(this.menu.classList.add("main-menu--opened"),this.menu.classList.add("main-menu--opened-in"),this.menu.classList.remove("main-menu--opened-out"),this.header.classList.add("page-header--menu-opened"),setTimeout(()=>{this.accentLinkTextObjects.forEach(e=>{e.addStyle()}),this.menu.classList.add("main-menu--active")},100))}),document.addEventListener("keyup",e=>{"Escape"===e.key&&(this.menu.classList.remove("main-menu--opened"),this.header.classList.remove("page-header--menu-opened"))}),this.menuOverlay.addEventListener("click",()=>{this.menu.classList.remove("main-menu--opened"),this.header.classList.remove("page-header--menu-opened")}));for(let e=0;e<this.menuLinks.length;e++)this.menuLinks[e].addEventListener("click",()=>{this.menu.classList.contains("main-menu--opened")&&(this.menu.classList.remove("main-menu--opened"),this.header.classList.remove("page-header--menu-opened"))})}}class me{constructor(){new de(".js-slider",{loop:!0,navigation:{nextEl:".slider__control--next",prevEl:".slider__control--prev"},pagination:{el:".swiper-pagination",type:"fraction"},observer:!0,observeParents:!0,on:{slideChange(){const e=new CustomEvent("slideChanged",{detail:{slideId:(this.activeIndex+2)%3}});document.body.dispatchEvent(e)}}})}}class fe{constructor(){this.modalTriggers=document.querySelectorAll(".js-modal-trigger"),this.initEventListeners()}initEventListeners(){if(this.modalTriggers.length){const e=document.querySelectorAll(".js-modal");for(let t=0;t<this.modalTriggers.length;t++)this.modalTriggers[t].addEventListener("click",t=>{t.preventDefault(),Array.from(this.modalTriggers).forEach(e=>{e.classList.remove("map__event--active")}),t.currentTarget.classList.contains("map__event")&&t.currentTarget.classList.add("map__event--active");const i=t.currentTarget.getAttribute("data-target");e.length&&Array.from(e).forEach(e=>{const t=e.getAttribute("id");t!==i&&e.classList.contains("modal--show")?(e.classList.remove("modal--show"),document.querySelector("body").classList.remove("modal-opened")):t===i&&(e.classList.add("modal--show"),document.querySelector("body").classList.add("modal-opened"))})});const t=document.querySelectorAll(".modal__overlay");Array.from(t).forEach(e=>{e.addEventListener("click",()=>{e.parentNode.classList.remove("modal--show"),document.querySelector("body").classList.remove("modal-opened"),Array.from(this.modalTriggers).forEach(e=>{e.classList.remove("map__event--active")})})});const i=document.querySelectorAll(".js-modal-close");Array.from(i).forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-target");document.getElementById(t).classList.remove("modal--show"),document.querySelector("body").classList.remove("modal-opened"),Array.from(this.modalTriggers).forEach(e=>{e.classList.remove("map__event--active")})})})}}}class ge{constructor(){this.ticketsSlider=new de(".js-tickets-slider",{speed:500,navigation:{nextEl:".tickets-block__control--next",prevEl:".tickets-block__control--prev"}}),this.datePickers=document.querySelectorAll(".js-date-picker"),this.pickerBtn=document.querySelector(".js-pick"),this.counters=document.querySelectorAll(".js-counter"),this.numberFields=document.querySelectorAll('input[type="number"]'),this.initEventListeners()}initEventListeners(){for(let e=0;e<this.datePickers.length;e++)this.datePickers[e].addEventListener("click",e=>{Array.from(this.datePickers).forEach(e=>{e.classList.remove("tickets-block__button--chosen")}),e.currentTarget.classList.add("tickets-block__button--chosen"),this.pickerBtn.removeAttribute("disabled");const t=parseInt(e.currentTarget.getAttribute("data-number"),10);this.ticketsSlider.update(),this.ticketsSlider.slideTo(t)});this.pickerBtn.addEventListener("click",()=>{document.querySelector(".js-tickets-block").classList.add("tickets-block--form-opened")});for(let e=0;e<this.counters.length;e++)this.counters[e].addEventListener("click",e=>{const t=e.currentTarget.parentNode.querySelector("input");e.currentTarget.classList.contains("js-increase")?(t.value=parseInt(t.value,10)+1,e.currentTarget.parentNode.querySelector(".js-decrease").removeAttribute("disabled")):e.currentTarget.classList.contains("js-decrease")&&1===t.value?(t.value=Math.max(parseInt(t.value,10)-1,0),e.currentTarget.setAttribute("disabled",!0)):t.value=Math.max(parseInt(t.value,10)-1,0);const i=e.currentTarget.closest(".tickets-form").querySelectorAll("input"),n=Array.from(i).reduce((e,t)=>e+(t=parseInt(t.value,10)*parseInt(t.getAttribute("data-sum"),10)),0);e.currentTarget.closest(".tickets-form").querySelector(".js-total").innerText=n,n>0?e.currentTarget.closest(".tickets-form").querySelector(".js-total-row").classList.remove("tickets-form__row--disabled"):e.currentTarget.closest(".tickets-form").querySelector(".js-total-row").classList.add("tickets-form__row--disabled")});for(let e=0;e<this.numberFields.length;e++)this.numberFields[e].addEventListener("keydown",e=>{e.key>="0"&&event.key<="9"||"Backspace"===e.key||event.preventDefault(),"Backspace"===event.key&&e.currentTarget.value.length<2&&(event.preventDefault(),e.currentTarget.value=0)}),this.numberFields[e].addEventListener("input",e=>{0===e.currentTarget.value.indexOf("0")&&e.currentTarget.value.length>1&&(e.currentTarget.value=e.currentTarget.value.slice(1))})}}class ve{constructor(){this.map=document.getElementById("map"),this.scrollers=document.querySelectorAll(".js-map-scroller"),this.reverseNames={touchstart:"touchend",mousedown:"mouseup"};const e=this.map.scrollWidth-this.map.clientWidth;this.map.scrollLeft=e/10;const t=this.map.scrollHeight-this.map.clientHeight;t>0&&(document.querySelector(".screen__scroller--up").classList.remove("screen__scroller--hidden"),document.querySelector(".screen__scroller--down").classList.remove("screen__scroller--hidden"),this.map.scrollTop=t/10),this.initEventListeners()}initEventListeners(){for(let e=0;e<this.scrollers.length;e++)"touchstart,mousedown".split(",").forEach(t=>{this.scrollers[e].addEventListener(t,e=>{let i,n=+new Date,r=!0;window.addEventListener(this.reverseNames[t],i=()=>{window.removeEventListener(this.reverseNames[t],i),r=!1});const a=e.currentTarget.getAttribute("data-direction"),s=()=>{const e=+new Date;let t=(e-n)/1e3;switch(n=e,t>.5&&(t=.5),a){case"up":this.map.scrollTop-=300*t;break;case"down":this.map.scrollTop+=300*t;break;case"left":this.map.scrollLeft-=300*t;break;case"right":this.map.scrollLeft+=300*t}r&&requestAnimationFrame(s)};s()})})}}const ye=(e,t,i)=>new Promise(n=>{const r=Date.now();!function a(){const s=(Date.now()-r)/t;s>1?(e(1),n()):(requestAnimationFrame(a),e(i(s)))}()}),be=(e,t)=>new Promise(i=>{const n=Date.now();!function r(){const a=Date.now()-n;a>t?(e(t),i()):(requestAnimationFrame(r),e(a))}()});class xe{constructor(e){this.animations=[],this.elements=document.querySelectorAll(e.elements),this.delay=e.delay||0,this.duration=e.duration||1e3,this.durationAttenuation=e.durationAttenuation||0}animate(){this.clear(),this.stopAllAnimations(),this.timeout=setTimeout(()=>{this.startAllAnimtions()},this.delay)}clear(){this.elements.forEach(e=>{e.innerHTML="0"})}startAllAnimtions(){this.stopAllAnimations(),this.elements.forEach((e,t)=>{const i=parseInt(e.dataset.animateCount,10)||0;this.startAnimationForNumber(e,i,this.duration+t*this.durationAttenuation,parseInt(e.dataset.animateFps,10)||12)})}startAnimationForNumber(e,t,i,n){const r=1e3/n;let a,s,o=0,l=Date.now();((e,t)=>new Promise(i=>{const n=Date.now();!function r(){const a=(Date.now()-n)/t;a>1?(e(1),i()):(requestAnimationFrame(r),e(a))}()}))(i=>{a=Date.now(),s=a-l,s>r&&(l=a-s%r,e.innerHTML=o.toString(),o=Math.ceil(i*t))},i).then(()=>{e.innerHTML=t})}stopAllAnimations(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.animations.length&&this.animations.forEach(e=>cancelAnimationFrame(e)),this.animations=[]}}class we{constructor(e){const t=new r(".intro__text",500,"accent-typography--active","transform"),i=new r(".slogan__col--1",500,"accent-typography--active","transform"),n=new r(".slogan__col--2",500,"accent-typography--active","transform"),a=new r(".slogan__col--3",500,"accent-typography--active","transform"),s=new r(".show__title",500,"accent-typography--active","transform"),o=new r(".show__text",500,"accent-typography--active","transform"),l=new r(".show__text-2",500,"accent-typography--active","transform"),c=new r(".slider__title",500,"accent-typography--active","transform"),h=new r(".map__title",500,"accent-typography--active","transform"),u=new r(".tickets-block__title",500,"accent-typography--active","transform"),d=new xe({elements:"#js-features-list .features-list__item-value",duration:800,durationAttenuation:150,delay:200});this.colorScheme={tickets:{body:"last-section"},top:{".intro__title-line":"active",body:"logo-hidden"},about:{".slogan__col--2":"active"},numbers:{".features-list":"active"},mc:{".swiper-wrapper":"active"}},this.scriptRunSchema={top:[t.runAnimation.bind(t)],about:[i.runAnimation.bind(i),n.runAnimation.bind(n),a.runAnimation.bind(a)],numbers:[d.animate.bind(d)],show:[e.poster.startAnimation.bind(e.poster,e),s.runAnimation.bind(s),()=>{setTimeout(o.runAnimation.bind(o),200),setTimeout(o.runAnimation.bind(l),200)}],mc:[c.runAnimation.bind(c)],map:[h.runAnimation.bind(h)],tickets:[u.runAnimation.bind(u)]},this.scriptDestroySchema={top:[t.destroyAnimation.bind(t)],about:[i.destroyAnimation.bind(i),n.destroyAnimation.bind(n),a.destroyAnimation.bind(a)],show:[s.destroyAnimation.bind(s),o.destroyAnimation.bind(o),o.destroyAnimation.bind(l)],mc:[c.destroyAnimation.bind(c)],map:[h.destroyAnimation.bind(h)],tickets:[u.destroyAnimation.bind(u)]},this.setMasterClassAccentTypography(),this.setTicketAccentTypography()}setColorScheme(e){if(this.resetScheme(),this.colorScheme[e])for(const t in this.colorScheme[e])if(this.colorScheme[e].hasOwnProperty(t)){const i=document.querySelector(t);i&&setTimeout(()=>{i.classList.add(this.colorScheme[e][t])},100)}this.scriptRunSchema[e]&&[...this.scriptRunSchema[e]].forEach(e=>setTimeout(()=>e(),100))}resetScheme(){for(const e in this.colorScheme)if(this.colorScheme.hasOwnProperty(e))for(const t in this.colorScheme[e])if(this.colorScheme[e].hasOwnProperty(t)){const i=document.querySelector(t);i&&i.classList.remove(this.colorScheme[e][t])}for(const e in this.scriptDestroySchema)this.scriptDestroySchema.hasOwnProperty(e)&&this.scriptDestroySchema[e].forEach(e=>e())}setMasterClassAccentTypography(){document.querySelectorAll(".slider__subtitle").forEach(e=>{const t=new r(e,500,"accent-typography--active","transform");document.body.addEventListener("screenChanged",()=>{t.destroyAnimation(),setTimeout(()=>{t.runAnimation()},500)})})}setTicketAccentTypography(){document.querySelectorAll(".tickets-form__row .tickets-form__label span:not(.js-total):nth-child(1)").forEach(e=>{const t=new r(e,500,"accent-typography--active","transform",100);document.body.addEventListener("screenChanged",()=>{t.destroyAnimation(),setTimeout(()=>{t.runAnimation()},500)})})}}class _e{constructor(e){this.THROTTLE_TIMEOUT=1500,this.scrollFlag=!0,this.timeout=null,this.swipeStartY=0,this.screenElements=document.querySelectorAll(".screen"),this.menuElements=document.querySelectorAll(".main-menu__list .main-menu__link"),this.activeScreen=0,this.onScrollHandler=this.onScroll.bind(this),this.onUrlHashChangedHandler=this.onUrlHashChanged.bind(this),this.wheelEvents=[],this.headerColorSwitcher=new we(e),document.addEventListener("wheel",this.onScrollHandler,{passive:!1,useCapture:!0}),window.addEventListener("popstate",this.onUrlHashChangedHandler),document.body.addEventListener("slideChanged",e=>{this.emitChangeDisplayEvent(e.detail.slideId)});const t=document.querySelector(".page-content");t.addEventListener("touchstart",this.onSwipeStart.bind(this)),t.addEventListener("touchend",this.onSwipeEnd.bind(this)),this.menuElements.forEach((e,t)=>{e.addEventListener("click",e=>{e.preventDefault();const i=this.activeScreen;this.activeScreen=t<2?t:t+1,this.transitionToActiveScreen(i)})}),this.emitChangeDisplayEvent(0),this.init()}init(){this.onUrlHashChanged(),this.changePageDisplay()}transitionToActiveScreen(e){e!==this.activeScreen&&(this.clearDeactivatedClass(),this.screenElements[e].classList.add("screen--hidden"),this.screenElements[e].classList.add("screen--deactivated"),this.headerColorSwitcher.resetScheme(),this.emitChangeDisplayEvent(),setTimeout(this.clearDeactivatedClass.bind(this),this.THROTTLE_TIMEOUT),setTimeout(this.changePageDisplay.bind(this),this.THROTTLE_TIMEOUT/2),this.updateBodyClass(this.activeScreen))}updateBodyClass(e){e>0?document.querySelector("body").classList.add("second-section"):document.querySelector("body").classList.remove("second-section")}onScroll(e){e.preventDefault();const t={timestamp:Date.now(),direction:Math.sign(e.deltaY),value:Math.abs(e.deltaY)};let i=null;if(this.wheelEvents.length>0&&(i=this.wheelEvents[this.wheelEvents.length-1]),this.wheelEvents.push(t),this.wheelEvents.length>2&&this.wheelEvents.shift(),i&&i.direction===t.direction&&i.value>=t.value&&t.timestamp<i.timestamp+150)return;if(!this.scrollFlag)return;this.scrollFlag=!1;const n=this.activeScreen;this.reCalculateActiveScreenPosition(e.deltaY),this.transitionToActiveScreen(n),null!==this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.timeout=null,this.scrollFlag=!0},this.THROTTLE_TIMEOUT)}onUrlHashChanged(){const e=this.activeScreen,t=Array.from(this.screenElements).findIndex(e=>location.hash.slice(1)===e.id);this.activeScreen=t<0?0:t,this.transitionToActiveScreen(e)}changePageDisplay(){this.changeVisibilityDisplay(),this.changeActiveMenuItem(),this.headerColorSwitcher.setColorScheme(this.screenElements[this.activeScreen].id),this.emitChangeDisplayEvent(),this.clearDeactivatedClass(),location.hash=this.screenElements[this.activeScreen].id}clearDeactivatedClass(){this.screenElements.forEach(e=>{e.classList.contains("screen--deactivated")&&e.classList.remove("screen--deactivated")})}changeVisibilityDisplay(){this.screenElements.forEach(e=>{e.classList.add("screen--hidden"),e.classList.remove("active")}),this.screenElements[this.activeScreen].classList.remove("screen--hidden"),setTimeout(()=>{this.screenElements[this.activeScreen].classList.add("active")},100)}changeActiveMenuItem(){const e=Array.from(this.menuElements).find(e=>e.dataset.href===this.screenElements[this.activeScreen].id);e&&(this.menuElements.forEach(e=>e.classList.remove("active")),e.classList.add("active"))}emitChangeDisplayEvent(e=-1){const t=new CustomEvent("screenChanged",{detail:{screenId:this.activeScreen,slideId:e,screenName:this.screenElements[this.activeScreen].id,screenElement:this.screenElements[this.activeScreen]}});document.body.dispatchEvent(t)}reCalculateActiveScreenPosition(e){e>0?this.activeScreen!==this.screenElements.length-1&&this.activeScreen++:this.activeScreen>0&&this.activeScreen--}onSwipeStart(e){e.changedTouches&&(e=e.changedTouches[0]),this.swipeStartY=e.clientY}onSwipeEnd(e){e.changedTouches&&(e=e.changedTouches[0]);const t=e.clientY-this.swipeStartY;if(Math.abs(t)>300){const e=this.activeScreen;this.reCalculateActiveScreenPosition(-t),this.transitionToActiveScreen(e)}}}class Me{constructor(e){this.options=e,this.cart=document.querySelector(e.cart),this.ticket=document.querySelector(e.ticket),this.form=document.querySelector(e.form),this.ticketsBlock=document.querySelector(e.ticketsBlock),this.inputs=this.form.querySelectorAll("input"),this.number=this.cart.querySelector(e.number),this.currentContainer=this.ticketsBlock.querySelector(e.currentContainer),this.initEventListeners()}initEventListeners(){this.form.addEventListener("submit",e=>{e.preventDefault(),this.animate()})}animate(){const e=Array.from(this.inputs).reduce((e,t)=>e+parseInt(t.value,10),0);this.calculateDeltas(),this.ticket.classList.remove("animate"),this.ticket.offsetWidth,this.ticket.classList.add("animate"),setTimeout(()=>{this.cart.classList.contains("updated")?(this.cart.classList.remove("updated"),setTimeout(()=>{this.number.innerHTML=e,this.cart.classList.add("updated")},300)):(this.number.innerHTML=e,this.cart.classList.add("updated"))},800)}calculateDeltas(){this.currentContainer=this.ticketsBlock.querySelector(this.options.currentContainer),this.ticket=this.currentContainer.querySelector(this.options.ticket);const e=this.ticket.getBoundingClientRect(),{width:t,height:i,left:n,top:r}=e,a=this.cart.getBoundingClientRect(),{width:s,height:o,left:l,top:c}=a,h=l-n+s/2-t/2,u=c-r+o/2-i/2;console.log(h),console.log(u),document.documentElement.style.setProperty("--cartDeltaX",h+"px"),document.documentElement.style.setProperty("--cartDeltaY",u+"px")}}const Se="Float32Array"in window;function Te(e,t){return 1-3*t+3*e}function Ee(e,t){return 3*t-6*e}function Ce(e){return 3*e}function Le(e,t,i){return((Te(t,i)*e+Ee(t,i))*e+Ce(t))*e}function Ae(e,t,i){return 3*Te(t,i)*e*e+2*Ee(t,i)*e+Ce(t)}const ke=(e,t,i,n)=>{if(e<0||e>1||i<0||i>1)throw new Error("BezierEasing x values must be in [0, 1] range.");const r=Se?new Float32Array(11):new Array(11);function a(t){let n=0,a=1;for(;10!==a&&r[a]<=t;++a)n+=.1;--a;const s=n+.1*((t-r[a])/(r[a+1]-r[a])),o=Ae(s,e,i);return o>=.001?function(t,n){for(let r=0;r<4;++r){const r=Ae(n,e,i);if(0===r)return n;n-=(Le(n,e,i)-t)/r}return n}(t,s):0===o?s:function(e,t,i,n,r){let a,s,o=0;do{s=t+(i-t)/2,a=Le(s,n,r)-e,a>0?i=s:t=s}while(Math.abs(a)>1e-7&&++o<10);return s}(t,n,n+.1)}let s=!1;function o(){s=!0,e===t&&i===n||function(){for(let t=0;t<11;++t)r[t]=Le(.1*t,e,i)}()}const l=function(r){return s||o(),e===t&&i===n?r:0===r?0:1===r?1:Le(a(r),t,n)};l.getControlPoints=function(){return[{x:e,y:t},{x:i,y:n}]};const c=[e,t,i,n],h="BezierEasing("+c+")";l.toString=function(){return h};const u="cubic-bezier("+c+")";return l.toCSS=function(){return u},l},Pe=e=>{let t=Promise.resolve();return e.forEach(e=>{t=t.then(e)}),t},Re=(e,t)=>new Promise(i=>{Pe(e).then(()=>{"function"!=typeof t||t()?Re(e,t):i()})});let Oe,Ie,De,Ne,ze=window.innerWidth,Fe=window.innerHeight,Be=window.innerWidth/1440;class He{constructor(e){this.canvas=document.querySelector(e.canvas),this.ctx=this.canvas.getContext("2d"),this.bgCanvas=document.querySelector(e.bgCanvas),this.bgCtx=this.bgCanvas.getContext("2d"),this.width=0,this.height=0,this.L=0,this.T=0,this.R=0,this.B=0,this.cornerAlpha=0,this.cornerWidth=150,this.scaleY=1,this.skewX=0,this.translateX=0,this.rotateAngle=0,this.startAnimations=[],this.isAnimated=!1,this.updateSize(),this.img=new Image,this.img.onload=()=>{this.draw()},this.img.src="/illusion/img/pic1.jpg"}updateWindowSize(){ze=window.innerWidth,Fe=window.innerHeight,Be=window.innerWidth/1440}updateSize(){this.updateWindowSize();if(window.innerWidth<=600){1.45<ze/Fe?(this.width=ze,this.height=Math.round(1.45*this.width)+2):(this.height=Fe,this.width=Math.round(this.height/1.45)+2),this.L=Math.round((ze-this.width)/2),this.T=Math.round((Fe-this.height)/2),this.R=this.L+this.width,this.B=this.T+this.height}else this.width=Math.round(340*Be),this.height=Math.round(1.45*this.width),this.L=Math.round((ze-this.width)/2),this.T=Math.round((Fe-this.height)/2+17*Be),this.R=this.L+this.width,this.B=this.T+this.height}draw(){this.canvas.width=ze,this.canvas.height=Fe,this.ctx.clearRect(0,0,ze,Fe),this.ctx.transform(1,this.skewX,0,this.scaleY,this.translateX,0),this.rotate(this.rotateAngle,ze/2,0),this.ctx.drawImage(this.img,this.L,this.T,this.width,this.height),this.drawCorner(this.cornerAlpha,this.cornerWidth)}drawBg(){this.bgCanvas.width=ze,this.bgCanvas.height=Fe,this.bgCtx.clearRect(0,0,ze,Fe),this.bgCtx.fillStyle="#c78fff",this.bgCtx.fillRect(this.L+1,this.T+1,this.width-2,this.height-2)}drawCorner(e,t){const i=e*Math.PI/180,n=t*Math.tan(i);if(this.ctx.beginPath(),t<=this.width)this.ctx.moveTo(this.R-t,this.B),this.ctx.lineTo(this.R,this.B-n),this.ctx.lineTo(this.R-n*Math.sin(2*i),this.B-n*(Math.cos(2*i)+1));else{const e=(t-this.width)*Math.tan(i);this.ctx.moveTo(this.L,this.B-e),this.ctx.lineTo(this.R,this.B-n),this.ctx.lineTo(this.R-n*Math.sin(2*i),this.B-n*(1+Math.cos(2*i))),this.ctx.lineTo(this.L-e*Math.sin(2*i),this.B-e*(1+Math.cos(2*i)))}this.ctx.closePath(),this.ctx.fillStyle="#ccc",this.ctx.fill(),this.ctx.save(),this.rotate(-e,this.R-t,this.B),this.ctx.clearRect(this.L-this.width/4,this.B,this.width+this.width/2,n),this.ctx.restore()}rotate(e,t,i){this.ctx.translate(t,i),this.ctx.rotate(e*Math.PI/180),this.ctx.translate(-t,-i)}getCornerAnimationTick(e,t,i,n){return r=>{this.cornerAlpha=e+r*(t-e),i&&n&&(this.cornerWidth=i+r*(n-i))}}getScaleYAnimationTick(e,t){return i=>{this.scaleY=e+i*(t-e)}}getSkewXAnimationTick(e,t){return i=>{this.skewX=e+i*(t-e)}}getTranslateXAnimationTick(e,t){return i=>{this.translateX=e+i*(t-e)}}getRotateAnimationTick(e,t){return i=>{this.rotateAngle=e+i*(t-e)}}animateCornerFluid(){const e=ke(.33,0,.67,1),t=this.cornerWidth-10,i=this.cornerWidth;Pe([()=>ye(this.getCornerAnimationTick(0,7),500,e),()=>ye(this.getCornerAnimationTick(7,0),500,e),()=>ye(this.getCornerAnimationTick(0,6),667,e),()=>ye(this.getCornerAnimationTick(6,2),367,e),()=>ye(this.getCornerAnimationTick(2,17,i,t),617,e),()=>ye(this.getCornerAnimationTick(17,0,t,i),417,e)])}animatePosterTearOff(){const e=ke(.41,0,.05,1),t=this.cornerWidth+250;ye(this.getCornerAnimationTick(0,15,this.cornerWidth,t),500,e);const i=ke(.33,0,0,1);ye(this.getSkewXAnimationTick(0,15/Fe),633,i);const n=ke(.33,0,0,1);ye(this.getScaleYAnimationTick(1,.9),633,n);const r=ke(.2,0,0,1);ye(this.getRotateAnimationTick(0,35),1200,r);const a=ke(.2,0,0,1);ye(this.getTranslateXAnimationTick(0,-976),1800,a)}startAnimation(e){if(!this.isAnimated){this.isAnimated=!0;const t=e=>{e>=0&&-1===this.startAnimations.indexOf("fluid")&&(this.startAnimations.push("fluid"),this.animateCornerFluid()),this.draw()},i=t=>{t>=0&&-1===this.startAnimations.indexOf("tear-off")&&(this.startAnimations.push("tear-off"),this.animatePosterTearOff(),e.whaleScene.startAnimation({posterT:this.T,posterL:this.L,posterHeight:this.height,posterWidth:this.width})),this.draw()};Pe([()=>be(t,3068),()=>be(i,1800)])}}}const Ge=[{t:"b",x:1150,y:273,s:4.15,h:4.15+.4},{t:"b",x:1090,y:525,s:5.17,h:5.57},{t:"b",x:324,y:329,s:4.52,h:4.92},{t:"b",x:962,y:543,s:3.39,h:3.79},{t:"b",x:466,y:253,s:3.28,h:3.28+.4},{t:"s",x:1079,y:240,s:5.41,h:6.23},{t:"s",x:1203,y:275,s:5.08,h:5.54},{t:"s",x:350,y:368,s:3.27,h:4.07},{t:"s",x:350,y:368,s:6.02,h:6.23},{t:"s",x:496,y:344,s:5.23,h:6.21},{t:"s",x:1043,y:170,s:4.56,h:5.57},{t:"s",x:1071,y:495,s:4.28,h:5.02},{t:"s",x:382,y:272,s:4.4,h:5.41},{t:"s",x:462,y:372,s:4.22,h:5.16},{t:"s",x:925,y:526,s:3.49,h:4.31},{t:"s",x:1123,y:249,s:3.27,h:4.21},{t:"s",x:494,y:284,s:3.4,h:4.19},{t:"s",x:426,y:232,s:3.33,h:4.14}];class Ue{constructor(e){this.canvas=document.querySelector(e.canvas),this.ctx=this.canvas.getContext("2d"),this.bodyImg=new Image,this.finImg=new Image,this.tailImg=new Image,this.cloudLeftImg=new Image,this.cloudRightImg=new Image,this.balloonLeftImg=new Image,this.balloonRightImg=new Image,this.loadingCounter=0,this.isMobile=!1,this.isAnimated=!1,this.startAnimations=[],this.posterT=0,this.posterL=0,this.posterHeight=0,this.posterWidth=0,this.bodyWidth=void 0,this.bodyHeight=void 0,this.bodyL=void 0,this.bodyT=void 0,this.finWidth=void 0,this.finHeight=void 0,this.finL=void 0,this.finT=void 0,this.finAngle=0,this.tailWidth=void 0,this.tailHeight=void 0,this.tailL=void 0,this.tailT=void 0,this.tailAngle=0,this.cloudLeftWidth=void 0,this.cloudLeftHeight=void 0,this.cloudLeftL=void 0,this.cloudLeftT=void 0,this.cloudRightWidth=void 0,this.cloudRightHeight=void 0,this.cloudRightL=void 0,this.cloudRightT=void 0,this.balloonLeftWidth=void 0,this.balloonLeftHeight=void 0,this.balloonLeftL=void 0,this.balloonLeftT=void 0,this.balloonRightWidth=void 0,this.balloonRightHeight=void 0,this.balloonRightL=void 0,this.balloonRightT=void 0,this.cloudsOpacity=0,this.sceneX=0,this.sceneY=0,this.sceneAngle=0,this.moonRadius=0,this.moonDx=0,this.moonEndX=0,this.moonY=0,this.moonRotateAngle=0,this.starsOptions=Ge,this.initEventListeners(),this.updateSceneSizing(),this.loadImages()}increaseLoadingCounter(){this.loadingCounter++,7===this.loadingCounter&&this.drawScene()}initEventListeners(){this.bodyImg.onload=()=>{this.increaseLoadingCounter()},this.finImg.onload=()=>{this.increaseLoadingCounter()},this.tailImg.onload=()=>{this.increaseLoadingCounter()},this.cloudLeftImg.onload=()=>{this.increaseLoadingCounter()},this.cloudRightImg.onload=()=>{this.increaseLoadingCounter()},this.balloonLeftImg.onload=()=>{this.increaseLoadingCounter()},this.balloonRightImg.onload=()=>{this.increaseLoadingCounter()}}loadImages(){this.bodyImg.src="/illusion/img/whaleBody.png",this.finImg.src="/illusion/img/whaleFin.png",this.tailImg.src="/illusion/img/whaleTail.png",this.cloudLeftImg.src="/illusion/img/cloudLeft.png",this.cloudRightImg.src="/illusion/img/cloudRight.png",this.balloonLeftImg.src="/illusion/img/balloonLeft.png",this.balloonRightImg.src="/illusion/img/balloonRight.png"}updateSceneSizing(){Oe=window.innerWidth,Ie=window.innerHeight,De=window.innerWidth/1440,Ne=window.innerHeight/760,this.isMobile=Oe<=600,this.updateWhaleSizing(),this.updateCloudsSizing(),this.updateBalloonsSizing()}updateWhaleSizing(){let e=De;this.isMobile&&(e*=1.5),this.bodyWidth=Math.round(880*e),this.bodyHeight=Math.round(295*this.bodyWidth/783),this.bodyL=Math.round((Oe-this.bodyWidth)/2),this.isMobile?this.bodyT=Math.round((Ie-this.bodyHeight)/2-120*e):this.bodyT=Math.round((Ie-this.bodyHeight)/2+17*e),this.finWidth=Math.round(200*e),this.finHeight=Math.round(133*this.finWidth/216),this.finL=Math.round(this.bodyL+310*e),this.finT=Math.round(this.bodyT+200*e),this.tailWidth=Math.round(119*e),this.tailHeight=Math.round(79*this.tailWidth/119),this.tailL=Math.round(this.bodyL+this.bodyWidth-145*e),this.tailT=Math.round(this.bodyT+35*e)}updateCloudsSizing(){this.isMobile?(this.cloudLeftWidth=Math.round(612*De*3),this.cloudLeftHeight=Math.round(344*this.cloudLeftWidth/612),this.cloudLeftL=Math.round(this.bodyL+180*De),this.cloudLeftT=Math.round(this.bodyT+100*De),this.cloudRightWidth=Math.round(644*De*3.5),this.cloudRightHeight=Math.round(270*this.cloudRightWidth/644),this.cloudRightL=Math.round(this.bodyL-this.bodyWidth-540*De),this.cloudRightT=Math.round(this.bodyT-10*De*55)):(this.cloudLeftWidth=Math.round(612*De),this.cloudLeftHeight=Math.round(344*this.cloudLeftWidth/612),this.cloudLeftL=Math.round(this.bodyL-180*De),this.cloudLeftT=Math.round(this.bodyT+100*De),this.cloudRightWidth=Math.round(644*De),this.cloudRightHeight=Math.round(270*this.cloudRightWidth/644),this.cloudRightL=Math.round(this.bodyL+this.bodyWidth-540*De),this.cloudRightT=Math.round(this.bodyT+10*De))}updateBalloonsSizing(){let e=De;this.isMobile&&(e*=1.5),this.balloonLeftWidth=Math.round(149*e),this.balloonLeftHeight=Math.round(162*this.balloonLeftWidth/149),this.balloonLeftL=Math.round(this.bodyL+140*e),this.balloonLeftT=Math.round(this.bodyT-145*e),this.balloonRightWidth=Math.round(152*e),this.balloonRightHeight=Math.round(182*this.balloonRightWidth/152),this.balloonRightL=Math.round(this.bodyL+208*e),this.balloonRightT=Math.round(this.bodyT-185*e)}drawStar(e,t,i,n){switch(t*=De,i*=Ne,this.ctx.beginPath(),e){case"s":{const e=7*n;this.ctx.moveTo(t,i),this.ctx.lineTo(t+e,i+e),this.ctx.moveTo(t+e,i),this.ctx.lineTo(t,i+e);break}case"b":{const e=20*n,r=28*n,a=t-e/2,s=i,o=a+e/2,l=s-r/2,c=a+e,h=s,u=a+e/2,d=s+r/2,p=a+e/2,m=s;this.ctx.moveTo(a,s),this.ctx.bezierCurveTo(a,s,p-.06*e,m-.15*r,o,l),this.ctx.bezierCurveTo(o,l,p+.06*e,m-.15*r,c,h),this.ctx.bezierCurveTo(c,h,p+.06*e,m+.15*r,u,d),this.ctx.bezierCurveTo(u,d,p-.06*e,m+.15*r,a,s);break}}this.ctx.lineJoin="round",this.ctx.strokeStyle="#fff",this.ctx.stroke()}rotateCtx(e,t,i){this.ctx.translate(t,i),this.ctx.rotate(e*Math.PI/180),this.ctx.translate(-t,-i)}drawMoon(e,t,i,n,r){e*=De,t*=Ne,this.ctx.save(),this.rotateCtx(r,e,t),this.ctx.beginPath();let a=Math.PI/8;this.ctx.arc(e,t,i,a,2*Math.PI-a),this.ctx.strokeStyle="#fff",this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),a+=Math.PI/24,this.ctx.arc(e+n+1,t,i-n,a,2*Math.PI-a),this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore()}drawClouds(){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.posterL+this.posterWidth,0),this.ctx.lineTo(this.posterL+this.posterWidth,Ie),this.ctx.lineTo(0,Ie),this.ctx.closePath(),this.ctx.clip(),this.ctx.drawImage(this.cloudLeftImg,this.cloudLeftL,this.cloudLeftT,this.cloudLeftWidth,this.cloudLeftHeight),this.ctx.restore(),this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.posterL,0),this.ctx.lineTo(Oe,0),this.ctx.lineTo(Oe,Ie),this.ctx.lineTo(this.posterL,Ie),this.ctx.closePath(),this.ctx.clip(),this.ctx.drawImage(this.cloudRightImg,this.cloudRightL,this.cloudRightT,this.cloudRightWidth,this.cloudRightHeight),this.ctx.restore()}drawWhale(){this.ctx.globalAlpha=1,this.ctx.translate(this.sceneX*De,this.sceneY*De),this.rotateCtx(this.sceneAngle,Oe/2,Ie/2),this.ctx.drawImage(this.bodyImg,this.bodyL,this.bodyT,this.bodyWidth,this.bodyHeight),this.ctx.save(),this.rotateCtx(this.finAngle,this.finL+21*De,this.finT+31*De),this.ctx.drawImage(this.finImg,this.finL,this.finT,this.finWidth,this.finHeight),this.ctx.restore(),this.ctx.save(),this.rotateCtx(this.tailAngle,this.tailL+10*De,this.tailT+12*De),this.ctx.drawImage(this.tailImg,this.tailL,this.tailT,this.tailWidth,this.tailHeight),this.ctx.restore()}drawThreads(){let e=De;this.isMobile&&(e*=1.5),this.ctx.strokeStyle="#fff",this.ctx.beginPath();const t=this.bodyL+370*e,i=this.bodyT+222*e,n=t-84*e,r=i-98*e,a=n+43*e,s=r+35*e,o=n+84*e,l=r+92*e,c=n-68*e,h=r-110*e,u=h+75*e,d=c+25*e;this.ctx.moveTo(c,h),this.ctx.bezierCurveTo(c,h,d,u,n,r),this.ctx.bezierCurveTo(a,s,o,l,t,i),this.ctx.stroke(),this.ctx.closePath();const p=this.bodyL+312*e,m=this.bodyT+234*e,f=p-30*e,g=m-262*e,v=f+16*e,y=g+39*e,b=f+11*e,x=g+117*e,w=f+6*e,_=g+190*e,M=f+25*e,S=g+256*e;this.ctx.beginPath(),this.ctx.moveTo(f,g),this.ctx.bezierCurveTo(f,g,v,y,b,x),this.ctx.bezierCurveTo(w,_,M,S,p,m),this.ctx.stroke(),this.ctx.closePath()}drawBaloons(){this.ctx.drawImage(this.balloonLeftImg,this.balloonLeftL,this.balloonLeftT,this.balloonLeftWidth,this.balloonLeftHeight),this.ctx.drawImage(this.balloonRightImg,this.balloonRightL,this.balloonRightT,this.balloonRightWidth,this.balloonRightHeight)}drawScene(){if(this.canvas.width=Oe,this.canvas.height=Ie,this.ctx.clearRect(0,0,Oe,Ie),this.isAnimated){const e=De<1?De:1,t=this.moonEndX-this.moonRadius*((-this.moonRotateAngle-32)*Math.PI/180)/e;this.drawMoon(t,this.moonY,this.moonRadius,this.moonDx,this.moonRotateAngle),this.ctx.clearRect(0,0,this.posterL,Ie),this.starsOptions.forEach(e=>{this.drawStar(e.t,e.x,e.y,e.sc||0)}),this.ctx.globalAlpha=this.cloudsOpacity,this.drawClouds(),this.drawWhale(),this.drawThreads(),this.drawBaloons()}}getStarsAnimationTick(){return e=>{this.starsOptions=this.starsOptions.map(t=>{const i=1e3*(t.s-3.27)||0,n=1e3*(t.h-3.27)||0;switch(t.t){case"b":{const r=ke(.33,0,.06,1),a=ke(.33,0,.18,1),s=200,o=650;if(e<n&&e>=i){const n=e-i>=s?1:(e-i)/s;t.sc=r(n)}else if(e>n&&e-n<o){const i=e-n>=o?0:(e-n)/o;t.sc=1-a(i)}else t.sc=0;break}case"s":t.sc=e<n&&e>=i?1:0;break;default:t.sc=0}return t})}}animateStarsInfinite(){Pe([()=>be(this.getStarsAnimationTick(),2960),()=>be(this.getStarsAnimationTick(),2960),()=>be(this.getStarsAnimationTick(),2960)])}startStarsAnimationInfinite(){const e=e=>{0===e&&this.animateStarsInfinite()};Pe([()=>be(e,6e3)]).then(this.startStarsAnimationInfinite.bind(this))}animateClouds(){const e=(e,t)=>i=>{this.cloudLeftL=e+i*(t-e)},t=(e,t)=>i=>{this.cloudRightL=e+i*(t-e)};let i=807*De;this.isMobile&&(i=1419*De);const n=i-660*De,r=[()=>ye(e(i,n),2467,ke(.11,0,0,1))];let a=141*De;this.isMobile&&(a=-2113*De);const s=a+660*De,o=[()=>ye(t(a,s),2467,ke(.11,0,0,1))];Pe(r),Pe(o);ye(e=>{this.cloudsOpacity=e},850,ke(0,0,1,1))}animateCloudsInfinite(){const e=(e,t)=>i=>{this.cloudLeftT=e+i*(t-e)},t=(e,t)=>i=>{this.cloudRightT=e+i*(t-e)},i=ke(.33,0,.67,1),n=this.cloudLeftT,r=n-20*De,a=[()=>ye(e(n,r),4883,i),()=>ye(e(r,n),4317,i)],s=this.cloudRightT,o=s+20*De,l=[()=>ye(t(s,o),4883,i),()=>ye(t(o,s),4317,i)];Pe(a),Pe(l)}startAnimateClouds(){const e=e=>{0===e&&this.animateClouds()};Pe([()=>be(e,2467)]).then(this.startAnimateCloudsInfinite.bind(this))}startAnimateCloudsInfinite(){const e=e=>{0===e&&this.animateCloudsInfinite()};Pe([()=>be(e,9200)]).then(this.startAnimateCloudsInfinite.bind(this))}animateMoon(){const e=(e,t)=>i=>{this.moonRotateAngle=e+i*(t-e)};Pe([()=>ye(e(-550/De,-20),2033,ke(.55,0,.12,1)),()=>ye(e(-20,-37),683,ke(.31,0,.69,1)),()=>ye(e(-37,-32),717,ke(.17,0,.69,1))])}resetWhale(){this.sceneX=1180}animateWhaleShow(){ye(e=>{this.sceneX=1180+-1130*e},3900,ke(.11,.26,0,1))}animateWhaleInfinite(){const e=(e,t)=>i=>{this.sceneY=e+i*(t-e)},t=ke(.33,0,.67,1);Re([()=>ye(e(80,0),3120,t),()=>ye(e(0,80),2880,t)]);const i=(e,t)=>i=>{this.sceneAngle=e+i*(t-e)},n=[()=>ye(i(5,-3),3e3,t),()=>ye(i(-3,5),3e3,t)];ye(i(0,5),1500,t).then(()=>{Re(n)});const r=(e,t)=>i=>{this.finAngle=e+i*(t-e)};Re([()=>ye(r(26,3),2340,ke(.33,0,.33,1)),()=>ye(r(3,26),3660,ke(.46,0,.67,1))]);const a=(e,t)=>i=>{this.tailAngle=e+i*(t-e)},s=[()=>ye(a(-20,7),3240,t),()=>ye(a(7,-20),2760,t)];ye(a(-19,-20),360,t).then(()=>{Re(s)});const o=(e,t)=>i=>{this.balloonLeftT=e+i*(t-e)},l=this.balloonLeftT,c=l+20*De,h=[()=>ye(o(l,c),3240,t),()=>ye(o(c,l),2760,t)];ye(o(l+2*De,l),360,t).then(()=>{Re(h)});const u=(e,t)=>i=>{this.balloonLeftL=e+i*(t-e)},d=this.balloonLeftL,p=d+8*De,m=[()=>ye(u(d,p),3240,t),()=>ye(u(p,d),2760,t)];ye(u(d+1*De,d),360,t).then(()=>{Re(m)});const f=(e,t)=>i=>{this.balloonRightT=e+i*(t-e)},g=this.balloonRightT,v=g+20*De,y=[()=>ye(f(g,v),2520,t),()=>ye(f(v,g),6e3*.58,t)];ye(f(g+2*De,g),360,t).then(()=>{Re(y)});const b=(e,t)=>i=>{this.balloonRightL=e+i*(t-e)},x=this.balloonRightL,w=x+5*De,_=[()=>ye(b(x,w),2520,t),()=>ye(b(w,x),6e3*.58,t)];ye(b(x+.5*De,x),360,t).then(()=>{Re(_)})}startAnimationInfinite(){const e=()=>{this.drawScene()};Pe([()=>be(e,6e3)]).then(this.startAnimationInfinite.bind(this))}reset(){this.resetWhale()}startAnimation(e){if(this.posterT=e.posterT,this.posterL=e.posterL,this.posterHeight=e.posterHeight,this.posterWidth=e.posterWidth,this.moonRadius=this.posterHeight/8.7,this.moonDx=this.posterWidth/20,this.moonEndX=(this.posterL+this.posterWidth+1.2*this.moonRadius)/De,this.moonY=(this.posterT+this.posterHeight/6)/Ne,this.moonRotateAngle=-550/De,this.reset(),!this.isAnimated){this.isAnimated=!0;be(e=>{e>=0&&this.startAnimations.indexOf(0)<0&&(this.startAnimations.push(0),this.animateWhaleShow(),this.animateWhaleInfinite(),this.startAnimationInfinite()),e>=350&&this.startAnimations.indexOf(350)<0&&(this.startAnimations.push(350),this.isMobile||(this.startStarsAnimationInfinite(),this.animateMoon())),e>=233&&this.startAnimations.indexOf(233)<0&&(this.startAnimations.push(233),this.startAnimateClouds())},3900)}}}var je,Ve,We,qe=function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},$e=i(0),Xe={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")};function Ye(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(Ye.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Ye.FullScreenQuad=(je=new $e.OrthographicCamera(-1,1,1,-1,0,1),Ve=new $e.PlaneBufferGeometry(2,2),We=function(e){this._mesh=new $e.Mesh(Ve,e)},Object.defineProperty(We.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(We.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(e){e.render(this._mesh,je)}}),We);var Ze=function(e,t){Ye.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof $e.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=$e.UniformsUtils.clone(e.uniforms),this.material=new $e.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Ye.FullScreenQuad(this.material)};Ze.prototype=Object.assign(Object.create(Ye.prototype),{constructor:Ze,render:function(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}});var Je=function(e,t){Ye.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};Je.prototype=Object.assign(Object.create(Ye.prototype),{constructor:Je,render:function(e,t,i){var n,r,a=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(n=0,r=1):(n=1,r=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),s.buffers.stencil.setFunc(a.ALWAYS,n,4294967295),s.buffers.stencil.setClear(r),s.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(a.EQUAL,1,4294967295),s.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),s.buffers.stencil.setLocked(!0)}});var Ke=function(){Ye.call(this),this.needsSwap=!1};Ke.prototype=Object.create(Ye.prototype),Object.assign(Ke.prototype,{render:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}});var Qe=function(e,t){if(this.renderer=e,void 0===t){var i={minFilter:$e.LinearFilter,magFilter:$e.LinearFilter,format:$e.RGBAFormat,stencilBuffer:!1},n=e.getSize(new $e.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new $e.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===Xe&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===Ze&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new Ze(Xe),this.clock=new $e.Clock};Object.assign(Qe.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var t,i,n=this.renderer.getRenderTarget(),r=!1,a=this.passes.length;for(i=0;i<a;i++)if(!1!==(t=this.passes[i]).enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),t.needsSwap){if(r){var s=this.renderer.getContext(),o=this.renderer.state.buffers.stencil;o.setFunc(s.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),o.setFunc(s.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==Je&&(t instanceof Je?r=!0:t instanceof Ke&&(r=!1))}this.renderer.setRenderTarget(n)},reset:function(e){if(void 0===e){var t=this.renderer.getSize(new $e.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var i=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(i,n),this.renderTarget2.setSize(i,n);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(i,n)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}});var et=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(et.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),et.FullScreenQuad=function(){var e=new $e.OrthographicCamera(-1,1,1,-1,0,1),t=new $e.PlaneBufferGeometry(2,2),i=function(e){this._mesh=new $e.Mesh(t,e)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(i.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,e)}}),i}();var tt=function(e,t,i,n,r){Ye.call(this),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=n,this.clearAlpha=void 0!==r?r:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};tt.prototype=Object.assign(Object.create(Ye.prototype),{constructor:tt,render:function(e,t,i){var n,r,a,s=e.autoClear;e.autoClear=!1,void 0!==this.overrideMaterial&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(n=e.getClearColor().getHex(),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(n,r),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=a),e.autoClear=s}});var it="\nuniform mat4 projectionMatrix;\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( position, 1.0 );\n}\n";const nt=i(0);class rt extends nt.RawShaderMaterial{constructor(e=0,t=16777215){super({uniforms:{tDiffuse:{value:null},outerColor:{value:new nt.Color(e)},centerColor:{value:new nt.Color(t)}},vertexShader:it,fragmentShader:"\n        precision mediump float;\n\n        uniform sampler2D tDiffuse;\n        uniform vec3 outerColor;\n        uniform vec3 centerColor;\n        varying vec2 vUv;\n\n        highp vec3 smoothstepvec3(vec3 color0, vec3 color1, float edge0, float edge1, float x) {\n          highp float ratio = smoothstep(edge0, edge1, x);\n          return mix(color0, color1, ratio);\n        }\n\n        void main() {\n          vec4 texel = texture2D( tDiffuse, vUv );\n          float scale = 1.3;\n          vec2 centeredUv = 2.0 * (vUv - vec2(0.5));\n          centeredUv /= scale;\n          float ratio = sqrt(centeredUv.x * centeredUv.x + centeredUv.y * centeredUv.y);\n          vec4 gradientColor = vec4(smoothstepvec3(centerColor, outerColor, 0.0, 1.0, ratio), 1.0);\n          gl_FragColor = gradientColor;\n        }"})}}var at=rt;const st=i(0);class ot extends st.RawShaderMaterial{constructor(e,t=2){super({uniforms:{tDiffuse:{value:null},noiseAmplitude:{value:e},prevNoiseAmplitude:{value:e},noiseSize:{value:t},time:{value:0},transitionProgress:{value:0}},vertexShader:it,fragmentShader:"\n        precision mediump float;\n\n        uniform sampler2D tDiffuse;\n        uniform float time;\n        uniform float transitionProgress;\n        uniform float noiseAmplitude;\n        uniform float prevNoiseAmplitude;\n        uniform float noiseSize;\n\n        varying vec2 vUv;\n\n        #define PI 3.14159265359\n        #define PI_HALF 1.5707963267949\n\n        highp float rand(const in vec2 uv) {\n          return fract(sin(dot(uv.xy, vec2(12.9898,78.233))) * 43758.5453123);\n        }\n\n        void main() {\n          vec4 texel = texture2D( tDiffuse, vUv );\n\n          float xNormalized = floor(gl_FragCoord.x / noiseSize);\n          float yNormalized = floor(gl_FragCoord.y / noiseSize);\n\n          float amp = prevNoiseAmplitude + (noiseAmplitude - prevNoiseAmplitude) * sin(transitionProgress * PI_HALF);\n\n          float seedPeriod = 100.0;\n          float seedFrequency = 1.0 / 12.0;\n          float seed = floor(mod(time, seedPeriod) / seedFrequency);\n          float mixFrequency = 0.002;\n\n          vec4 noiseColor = 0.08 * amp * vec4(rand(vec2(xNormalized * mixFrequency * seed, yNormalized * mixFrequency * seed)));\n\n          gl_FragColor = texel + noiseColor;\n        }"})}}var lt=ot;var ct=class{constructor(e,t,i){this.setupParameters(),this.construct(e,t,i)}setupParameters(){this.maxNoiseAmplitude=.6,this.transitionDuration=1,this.states=["default","off"],this.stateName=null,this.timeStart=-1,this.transitionStart=-1}construct(e,t,i){const n=new at(394502,3354928),r=new lt(this.maxNoiseAmplitude);this.composer=((e,t,i,n,r)=>{const a=new Qe(e),s=new tt(t,i);return a.setPixelRatio(window.devicePixelRatio),e.autoClearColor=!1,a.addPass(new Ze(n,"tDiffuse")),a.addPass(s),a.addPass(new Ze(r,"tDiffuse")),a})(e,t,i,n,r),this.effectMaterial=r}render(){const e=Date.now(),t=this.effectMaterial;if(this.timeStart<0?this.timeStart=e:t.uniforms.time.value=.001*(e-this.timeStart),this.transitionStart>0){const i=.001*(e-this.transitionStart);i>this.transitionDuration&&(this.transitionStart=-1),t.uniforms.transitionProgress.value=i/this.transitionDuration}this.composer.render()}isStateValid(e){return this.states.includes(e)}setState(e){if(!this.isStateValid(e)||this.stateName===e)return;const t=this.effectMaterial;this.stateName=e,t.uniforms.prevNoiseAmplitude.value=t.uniforms.noiseAmplitude.value,t.uniforms.noiseAmplitude.value="off"===e?0:this.maxNoiseAmplitude,this.transitionStart=Date.now()}};var ht=class{constructor(e,t,i,n){this.targetObject=e,this.duration=i;const r=Object.keys(t).filter(i=>e[i]!==t[i]);this.params=r.map(i=>({paramName:i,from:e[i],to:t[i]})),this.startTime=-1,this.progress=0,this.isComplete=!1,this.hasOnComplete="function"==typeof n,this.onComplete=this.hasOnComplete?n:null}invalidate(e,t){if(Number.isNaN(t)||void 0===t)return;if(this.isComplete)return;if(this.params.length<1)return void(this.progress=1);if(this.progress>=1)return void(this.isComplete||this.stop());if(this.startTime<0)return void(t&&(this.startTime=t));let i=.001*(t-this.startTime)/this.duration,n=i;i>1&&(i=1),this.progress=i;n=n<.2?.2*(1-Math.cos(i*Math.PI/.4)):.2+.8*Math.sin((i-.2)*Math.PI/1.6),this.params.forEach(({paramName:e,from:t,to:i})=>{this.targetObject[e]=t+(i-t)*n})}stop(){this.hasOnComplete&&this.onComplete.call(null),this.isComplete=!0}kill(){this.isComplete=!0}};var ut=class{constructor(e=null){this.setupParameters(e),this.construct(),this.setDefaultRender()}setupParameters(){this.started=!1,this.playing=!1,this.resizeInProgress=!1,this.width=window.innerWidth,this.height=window.innerHeight,this.renderFunc=null}construct(){console.warn("Класс AbstractView требует расширения.\n          Метод construct необходимо переопределить в дочернем классе.")}setDefaultRender(){this.renderFunc=()=>{this.renderer.render(this.scene,this.camera)}}setRenderFunction(e){"function"==typeof e&&(this.renderFunc=e)}render(){null!==this.renderFunc&&this.renderFunc.call(this)}start(){return this.started||(this.started=!0,this.startResize(),this.play()),this}stop(){return this.started?(this.pause(),this.stopResize(),this.started=!1,this):this}startResize(){this.onResize=()=>{this.resizeInProgress||(this.resizeInProgress=!0)},this.resize(),window.addEventListener("resize",this.onResize)}stopResize(){this.onResize&&(window.removeEventListener("resize",this.onResize),this.onResize=null,this.resizeInProgress=!1)}play(){if(this.playing)return this;const e=t=>{t.resizeInProgress&&t.resize(),t.render(),t.resizeInProgress=!1,t.started&&t.playing&&requestAnimationFrame(()=>{e(t)})};return this.playing=!0,this.render(),requestAnimationFrame(()=>{e(this)}),this}pause(){return this.playing?(this.playing=!1,this):this}resize(){console.warn("Класс AbstractView требует расширения.\n          Метод resize необходимо переопределить в дочернем классе.")}};var dt={DEFAULT:"Dark",VERSICOLOR:"Versicolor",PARSE:"ParseObjectPartsMaterialNames"};const pt=i(0);var mt=e=>new Promise(t=>{const i=new pt.TextureLoader,n={};Promise.all(e.map(e=>new Promise(t=>{i.load(e,i=>{n[e]=i,t(i)})}))).then(()=>{t(n)})});const ft=i(0),gt=(e=100,t=100,i=100)=>{const n=new ft.WebGLRenderer({alpha:!1,antialias:!1,logarithmicDepthBuffer:!0,powerPreference:"high-performance"});n.setPixelRatio(window.devicePixelRatio),n.setSize(e,t),n.setClearColor(0);return{renderer:n,scene:new ft.Scene,camera:new ft.PerspectiveCamera(35,e/t,1,i)}},vt=i(0),yt=(e,t)=>{const i={};let n=e["/darkMatcap.png"];return i[dt.DEFAULT]=t&&n?new vt.MeshMatcapMaterial({transparent:!1,opacity:1,matcap:e["/illusion/img/darkMatcap.png"],side:vt.FrontSide,color:16777215}):new vt.MeshPhongMaterial({color:526344,specular:new vt.Color(`rgb(\n      ${Math.round(242*.1)},\n      ${Math.round(244*.1)},\n      ${Math.round(25)})`),emissive:0,shininess:39.65,reflectivity:.78,combine:vt.MixOperation,flatShading:!1,depthWrite:!0}),n=e["/illusion/img/versicolorMatcap.png"],i[dt.VERSICOLOR]=n?new vt.MeshMatcapMaterial({transparent:!1,opacity:1,matcap:n,side:vt.FrontSide,color:16777215}):i[dt.DEFAULT],i},bt=i(0);class xt extends bt.Group{constructor(){super(),this.setupParams(),this.construct()}setupParams(){this.fluctuationConfigs=[],this.hasLoad=!1,this.hasUpdateSizeMode=!1,this.rotationY=0,this.substages=[],this.hasSubstages=!1,this.currentSubstage=-1,this.invisibleOnPortrait=[]}construct(){const e=new bt.Group;this.add(e),this.stagePoleG=e}addFluctuationConfig(e,t=0,i=5){this.fluctuationConfigs.push({target:e,amplitudeX:t,amplitudeY:i,periodX:2+5*Math.random(),shiftX:7*Math.random(),periodY:5+2*Math.random(),shiftY:7*Math.random()})}constructParametric(){}loadWithMaterials(){return null}updateSizeMode(e){this.invisibleOnPortrait&&this.invisibleOnPortrait.forEach(t=>{t.visible=e})}invalidate(e,t){this.fluctuationConfigs&&this.fluctuationConfigs.forEach(e=>(({target:e,amplitudeX:t,amplitudeY:i,periodX:n,periodY:r,shiftX:a,shiftY:s},o)=>{const l=.001*o;t>0&&(e.position.x=t*Math.sin((l-a)*Math.PI*2/n)),i>0&&(e.position.y=i*Math.sin((l-s)*Math.PI*2/r))})(e,t)),this.visible&&(this.stagePoleG.rotation.y=-this.rotationY)}}var wt=xt;const _t=function(){this.logging={enabled:!1,debug:!1};let e=this;this.callbacks={onProgress:function(t){e._onProgress(t)},onAssetAvailable:function(t){e._onAssetAvailable(t)},onError:function(t){e._onError(t)},onLoad:function(t,i){e._onLoad(t,i)}},this.contentRef=null,this.legacyMode=!1,this.materials={},this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.useIndices=!1,this.disregardNormals=!1,this.vertices=[],this.colors=[],this.normals=[],this.uvs=[],this.rawMesh={objectName:"",groupName:"",activeMtlName:"",mtllibName:"",faceType:-1,subGroups:[],subGroupInUse:null,smoothingGroup:{splitMaterials:!1,normalized:-1,real:-1},counts:{doubleIndicesCount:0,faceCount:0,mtlCount:0,smoothingGroupCount:0}},this.inputObjectCount=1,this.outputObjectCount=1,this.globalCounts={vertices:0,faces:0,doubleIndicesCount:0,lineByte:0,currentByte:0,totalBytes:0}};_t.prototype={constructor:_t,_resetRawMesh:function(){this.rawMesh.subGroups=[],this.rawMesh.subGroupInUse=null,this.rawMesh.smoothingGroup.normalized=-1,this.rawMesh.smoothingGroup.real=-1,this._pushSmoothingGroup(1),this.rawMesh.counts.doubleIndicesCount=0,this.rawMesh.counts.faceCount=0,this.rawMesh.counts.mtlCount=0,this.rawMesh.counts.smoothingGroupCount=0},setMaterialPerSmoothingGroup:function(e){return this.materialPerSmoothingGroup=!0===e,this},setUseOAsMesh:function(e){return this.useOAsMesh=!0===e,this},setUseIndices:function(e){return this.useIndices=!0===e,this},setDisregardNormals:function(e){return this.disregardNormals=!0===e,this},setMaterials:function(e){this.materials=Object.assign({},e)},setCallbackOnAssetAvailable:function(e){return null!=e&&e instanceof Function&&(this.callbacks.onAssetAvailable=e),this},setCallbackOnProgress:function(e){return null!=e&&e instanceof Function&&(this.callbacks.onProgress=e),this},setCallbackOnError:function(e){return null!=e&&e instanceof Function&&(this.callbacks.onError=e),this},setCallbackOnLoad:function(e){return null!=e&&e instanceof Function&&(this.callbacks.onLoad=e),this},_onProgress:function(e){let t=e||"";this.logging.enabled&&this.logging.debug&&console.log(t)},_onError:function(e){this.logging.enabled&&this.logging.debug&&console.error(e)},_onAssetAvailable:function(e){let t="OBJLoader2Parser does not provide implementation for onAssetAvailable. Aborting...";throw this.callbacks.onError(t),t},_onLoad:function(e,t){console.log("You reached parser default onLoad callback: "+t)},setLogging:function(e,t){return this.logging.enabled=!0===e,this.logging.debug=!0===t,this},_configure:function(){if(this._pushSmoothingGroup(1),this.logging.enabled){let e=Object.keys(this.materials),t="OBJLoader.Parser configuration:"+(e.length>0?"\n\tmaterialNames:\n\t\t- "+e.join("\n\t\t- "):"\n\tmaterialNames: None")+"\n\tmaterialPerSmoothingGroup: "+this.materialPerSmoothingGroup+"\n\tuseOAsMesh: "+this.useOAsMesh+"\n\tuseIndices: "+this.useIndices+"\n\tdisregardNormals: "+this.disregardNormals;t+="\n\tcallbacks.onProgress: "+this.callbacks.onProgress.name,t+="\n\tcallbacks.onAssetAvailable: "+this.callbacks.onAssetAvailable.name,t+="\n\tcallbacks.onError: "+this.callbacks.onError.name,console.info(t)}},execute:function(e){this.logging.enabled&&console.time("OBJLoader2Parser.execute"),this._configure();let t=new Uint8Array(e);this.contentRef=t;let i=t.byteLength;this.globalCounts.totalBytes=i;let n=new Array(128);for(let e,r="",a=0,s=0,o=0;o<i;o++)switch(e=t[o],e){case 32:r.length>0&&(n[a++]=r),r="";break;case 47:r.length>0&&(n[a++]=r),s++,r="";break;case 10:r.length>0&&(n[a++]=r),r="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=o,this._processLine(n,a,s),a=0,s=0;break;case 13:break;default:r+=String.fromCharCode(e)}this._finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2Parser.execute")},executeLegacy:function(e){this.logging.enabled&&console.time("OBJLoader2Parser.executeLegacy"),this._configure(),this.legacyMode=!0,this.contentRef=e;let t=e.length;this.globalCounts.totalBytes=t;let i=new Array(128);for(let n,r="",a=0,s=0,o=0;o<t;o++)switch(n=e[o],n){case" ":r.length>0&&(i[a++]=r),r="";break;case"/":r.length>0&&(i[a++]=r),s++,r="";break;case"\n":r.length>0&&(i[a++]=r),r="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=o,this._processLine(i,a,s),a=0,s=0;break;case"\r":break;default:r+=n}this._finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2Parser.executeLegacy")},_processLine:function(e,t,i){if(t<1)return;let n,r,a,s,o=function(e,t,i,n){let r="";if(n>i){let a;if(t)for(a=i;a<n;a++)r+=e[a];else for(a=i;a<n;a++)r+=String.fromCharCode(e[a]);r=r.trim()}return r};switch(s=e[0],s){case"v":this.vertices.push(parseFloat(e[1])),this.vertices.push(parseFloat(e[2])),this.vertices.push(parseFloat(e[3])),t>4&&(this.colors.push(parseFloat(e[4])),this.colors.push(parseFloat(e[5])),this.colors.push(parseFloat(e[6])));break;case"vt":this.uvs.push(parseFloat(e[1])),this.uvs.push(parseFloat(e[2]));break;case"vn":this.normals.push(parseFloat(e[1])),this.normals.push(parseFloat(e[2])),this.normals.push(parseFloat(e[3]));break;case"f":if(n=t-1,0===i)for(this._checkFaceType(0),a=2,r=n;a<r;a++)this._buildFace(e[1]),this._buildFace(e[a]),this._buildFace(e[a+1]);else if(n===2*i)for(this._checkFaceType(1),a=3,r=n-2;a<r;a+=2)this._buildFace(e[1],e[2]),this._buildFace(e[a],e[a+1]),this._buildFace(e[a+2],e[a+3]);else if(2*n==3*i)for(this._checkFaceType(2),a=4,r=n-3;a<r;a+=3)this._buildFace(e[1],e[2],e[3]),this._buildFace(e[a],e[a+1],e[a+2]),this._buildFace(e[a+3],e[a+4],e[a+5]);else for(this._checkFaceType(3),a=3,r=n-2;a<r;a+=2)this._buildFace(e[1],void 0,e[2]),this._buildFace(e[a],void 0,e[a+1]),this._buildFace(e[a+2],void 0,e[a+3]);break;case"l":case"p":if(n=t-1,n===2*i)for(this._checkFaceType(4),a=1,r=n+1;a<r;a+=2)this._buildFace(e[a],e[a+1]);else for(this._checkFaceType("l"===s?5:6),a=1,r=n+1;a<r;a++)this._buildFace(e[a]);break;case"s":this._pushSmoothingGroup(e[1]);break;case"g":this._processCompletedMesh(),this.rawMesh.groupName=o(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"o":this.useOAsMesh&&this._processCompletedMesh(),this.rawMesh.objectName=o(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"mtllib":this.rawMesh.mtllibName=o(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);break;case"usemtl":let l=o(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);""!==l&&this.rawMesh.activeMtlName!==l&&(this.rawMesh.activeMtlName=l,this.rawMesh.counts.mtlCount++,this._checkSubGroup())}},_pushSmoothingGroup:function(e){let t=parseInt(e);isNaN(t)&&(t="off"===e?0:1);let i=this.rawMesh.smoothingGroup.normalized;this.rawMesh.smoothingGroup.normalized=this.rawMesh.smoothingGroup.splitMaterials?t:0===t?0:1,this.rawMesh.smoothingGroup.real=t,i!==t&&(this.rawMesh.counts.smoothingGroupCount++,this._checkSubGroup())},_checkFaceType:function(e){this.rawMesh.faceType!==e&&(this._processCompletedMesh(),this.rawMesh.faceType=e,this._checkSubGroup())},_checkSubGroup:function(){let e=this.rawMesh.activeMtlName+"|"+this.rawMesh.smoothingGroup.normalized;this.rawMesh.subGroupInUse=this.rawMesh.subGroups[e],void 0!==this.rawMesh.subGroupInUse&&null!==this.rawMesh.subGroupInUse||(this.rawMesh.subGroupInUse={index:e,objectName:this.rawMesh.objectName,groupName:this.rawMesh.groupName,materialName:this.rawMesh.activeMtlName,smoothingGroup:this.rawMesh.smoothingGroup.normalized,vertices:[],indexMappingsCount:0,indexMappings:[],indices:[],colors:[],uvs:[],normals:[]},this.rawMesh.subGroups[e]=this.rawMesh.subGroupInUse)},_buildFace:function(e,t,i){let n=this.rawMesh.subGroupInUse,r=this,a=function(){let a=parseInt(e),s=3*(a>0?a-1:a+r.vertices.length/3),o=r.colors.length>0?s:null,l=n.vertices;if(l.push(r.vertices[s++]),l.push(r.vertices[s++]),l.push(r.vertices[s]),null!==o){let e=n.colors;e.push(r.colors[o++]),e.push(r.colors[o++]),e.push(r.colors[o])}if(t){let e=parseInt(t),i=2*(e>0?e-1:e+r.uvs.length/2),a=n.uvs;a.push(r.uvs[i++]),a.push(r.uvs[i])}if(i&&!r.disregardNormals){let e=parseInt(i),t=3*(e>0?e-1:e+r.normals.length/3),a=n.normals;a.push(r.normals[t++]),a.push(r.normals[t++]),a.push(r.normals[t])}};if(this.useIndices){this.disregardNormals&&(i=void 0);let r=e+(t?"_"+t:"_n")+(i?"_"+i:"_n"),s=n.indexMappings[r];null==s?(s=this.rawMesh.subGroupInUse.vertices.length/3,a(),n.indexMappings[r]=s,n.indexMappingsCount++):this.rawMesh.counts.doubleIndicesCount++,n.indices.push(s)}else a();this.rawMesh.counts.faceCount++},_createRawMeshReport:function(e){return"Input Object number: "+e+"\n\tObject name: "+this.rawMesh.objectName+"\n\tGroup name: "+this.rawMesh.groupName+"\n\tMtllib name: "+this.rawMesh.mtllibName+"\n\tVertex count: "+this.vertices.length/3+"\n\tNormal count: "+this.normals.length/3+"\n\tUV count: "+this.uvs.length/2+"\n\tSmoothingGroup count: "+this.rawMesh.counts.smoothingGroupCount+"\n\tMaterial count: "+this.rawMesh.counts.mtlCount+"\n\tReal MeshOutputGroup count: "+this.rawMesh.subGroups.length},_finalizeRawMesh:function(){let e,t,i=[],n=0,r=0,a=0,s=0,o=0,l=0;for(let c in this.rawMesh.subGroups)if(e=this.rawMesh.subGroups[c],e.vertices.length>0){if(t=e.indices,t.length>0&&r>0)for(let e=0;e<t.length;e++)t[e]=t[e]+r;i.push(e),n+=e.vertices.length,r+=e.indexMappingsCount,a+=e.indices.length,s+=e.colors.length,l+=e.uvs.length,o+=e.normals.length}let c=null;return i.length>0&&(c={name:""!==this.rawMesh.groupName?this.rawMesh.groupName:this.rawMesh.objectName,subGroups:i,absoluteVertexCount:n,absoluteIndexCount:a,absoluteColorCount:s,absoluteNormalCount:o,absoluteUvCount:l,faceCount:this.rawMesh.counts.faceCount,doubleIndicesCount:this.rawMesh.counts.doubleIndicesCount}),c},_processCompletedMesh:function(){let e=this._finalizeRawMesh(),t=null!==e;if(t){this.colors.length>0&&this.colors.length!==this.vertices.length&&this.callbacks.onError("Vertex Colors were detected, but vertex count and color count do not match!"),this.logging.enabled&&this.logging.debug&&console.debug(this._createRawMeshReport(this.inputObjectCount)),this.inputObjectCount++,this._buildMesh(e);let t=this.globalCounts.currentByte/this.globalCounts.totalBytes;this._onProgress("Completed [o: "+this.rawMesh.objectName+" g:"+this.rawMesh.groupName+"] Total progress: "+(100*t).toFixed(2)+"%"),this._resetRawMesh()}return t},_buildMesh:function(e){let t=e.subGroups,i=new Float32Array(e.absoluteVertexCount);this.globalCounts.vertices+=e.absoluteVertexCount/3,this.globalCounts.faces+=e.faceCount,this.globalCounts.doubleIndicesCount+=e.doubleIndicesCount;let n,r,a,s,o,l,c,h=e.absoluteIndexCount>0?new Uint32Array(e.absoluteIndexCount):null,u=e.absoluteColorCount>0?new Float32Array(e.absoluteColorCount):null,d=e.absoluteNormalCount>0?new Float32Array(e.absoluteNormalCount):null,p=e.absoluteUvCount>0?new Float32Array(e.absoluteUvCount):null,m=null!==u,f=[],g=t.length>1,v=0,y=[],b=[],x=0,w=0,_=0,M=0,S=0,T=0,E=0;for(let e in t)if(t.hasOwnProperty(e)){if(n=t[e],c=n.materialName,l=this.rawMesh.faceType<4?c+(m?"_vertexColor":"")+(0===n.smoothingGroup?"_flat":""):6===this.rawMesh.faceType?"defaultPointMaterial":"defaultLineMaterial",s=this.materials[c],o=this.materials[l],null==s&&null==o&&(l=m?"defaultVertexColorMaterial":"defaultMaterial",o=this.materials[l],this.logging.enabled&&console.info('object_group "'+n.objectName+"_"+n.groupName+'" was defined with unresolvable material "'+c+'"! Assigning "'+l+'".')),null==o){let e={materialNameOrg:c,materialName:l,materialProperties:{vertexColors:m?2:0,flatShading:0===n.smoothingGroup}},t={cmd:"assetAvailable",type:"material",materials:{materialCloneInstructions:e}};this.callbacks.onAssetAvailable(t);let i=this.materials[l];null==i&&(this.materials[l]=e)}if(g?(r=y[l],r||(r=v,y[l]=v,f.push(l),v++),E=this.useIndices?n.indices.length:n.vertices.length/3,a={start:T,count:E,index:r},b.push(a),T+=E):f.push(l),i.set(n.vertices,x),x+=n.vertices.length,h&&(h.set(n.indices,w),w+=n.indices.length),u&&(u.set(n.colors,_),_+=n.colors.length),d&&(d.set(n.normals,M),M+=n.normals.length),p&&(p.set(n.uvs,S),S+=n.uvs.length),this.logging.enabled&&this.logging.debug){let e=null==r?"":"\n\t\tmaterialIndex: "+r,t="\tOutput Object no.: "+this.outputObjectCount+"\n\t\tgroupName: "+n.groupName+"\n\t\tIndex: "+n.index+"\n\t\tfaceType: "+this.rawMesh.faceType+"\n\t\tmaterialName: "+n.materialName+"\n\t\tsmoothingGroup: "+n.smoothingGroup+e+"\n\t\tobjectName: "+n.objectName+"\n\t\t#vertices: "+n.vertices.length/3+"\n\t\t#indices: "+n.indices.length+"\n\t\t#colors: "+n.colors.length/3+"\n\t\t#uvs: "+n.uvs.length/2+"\n\t\t#normals: "+n.normals.length/3;console.debug(t)}}this.outputObjectCount++,this.callbacks.onAssetAvailable({cmd:"assetAvailable",type:"mesh",progress:{numericalValue:this.globalCounts.currentByte/this.globalCounts.totalBytes},params:{meshName:e.name},materials:{multiMaterial:g,materialNames:f,materialGroups:b},buffers:{vertices:i,indices:h,colors:u,normals:d,uvs:p},geometryType:this.rawMesh.faceType<4?0:6===this.rawMesh.faceType?2:1},[i.buffer],null!==h?[h.buffer]:null,null!==u?[u.buffer]:null,null!==d?[d.buffer]:null,null!==p?[p.buffer]:null)},_finalizeParsing:function(){if(this.logging.enabled&&console.info("Global output object count: "+this.outputObjectCount),this._processCompletedMesh()&&this.logging.enabled){let e="Overall counts: \n\tVertices: "+this.globalCounts.vertices+"\n\tFaces: "+this.globalCounts.faces+"\n\tMultiple definitions: "+this.globalCounts.doubleIndicesCount;console.info(e)}}};const Mt=function(e){this.logging={enabled:!1,debug:!1},this.callbacks={onProgress:null,onMeshAlter:null},this.materialHandler=e};Mt.prototype={constructor:Mt,setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},_setCallbacks:function(e,t){null!=e&&e instanceof Function&&(this.callbacks.onProgress=e),null!=t&&t instanceof Function&&(this.callbacks.onMeshAlter=t)},buildMeshes:function(e){let t,i,n,r=e.params.meshName,a=e.buffers,s=new $e.BufferGeometry;void 0!==a.vertices&&null!==a.vertices&&s.setAttribute("position",new $e.BufferAttribute(new Float32Array(a.vertices),3)),void 0!==a.indices&&null!==a.indices&&s.setIndex(new $e.BufferAttribute(new Uint32Array(a.indices),1)),void 0!==a.colors&&null!==a.colors&&s.setAttribute("color",new $e.BufferAttribute(new Float32Array(a.colors),3)),void 0!==a.normals&&null!==a.normals?s.setAttribute("normal",new $e.BufferAttribute(new Float32Array(a.normals),3)):s.computeVertexNormals(),void 0!==a.uvs&&null!==a.uvs&&s.setAttribute("uv",new $e.BufferAttribute(new Float32Array(a.uvs),2)),void 0!==a.skinIndex&&null!==a.skinIndex&&s.setAttribute("skinIndex",new $e.BufferAttribute(new Uint16Array(a.skinIndex),4)),void 0!==a.skinWeight&&null!==a.skinWeight&&s.setAttribute("skinWeight",new $e.BufferAttribute(new Float32Array(a.skinWeight),4));let o=e.materials.materialNames,l=e.materials.multiMaterial,c=[];for(n in o)i=o[n],t=this.materialHandler.getMaterial(i),l&&c.push(t);if(l){t=c;let i,r=e.materials.materialGroups;for(n in r)i=r[n],s.addGroup(i.start,i.count,i.index)}let h,u,d=[],p=!0,m=null===e.geometryType?0:e.geometryType;if(this.callbacks.onMeshAlter&&(u=this.callbacks.onMeshAlter({detail:{meshName:r,bufferGeometry:s,material:t,geometryType:m}})),u)if(u.isDisregardMesh())p=!1;else if(u.providesAlteredMeshes()){for(let e in u.meshes)d.push(u.meshes[e]);p=!1}p&&(e.computeBoundingSphere&&s.computeBoundingSphere(),h=0===m?new $e.Mesh(s,t):1===m?new $e.LineSegments(s,t):new $e.Points(s,t),h.name=r,d.push(h));let f=e.params.meshName;if(d.length>0){let t=[];for(let e in d)h=d[e],t[e]=h.name;f+=": Adding mesh(es) ("+t.length+": "+t+") from input mesh: "+r,f+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)"}else f+=": Not adding mesh: "+r,f+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)";return this.callbacks.onProgress&&this.callbacks.onProgress("progress",f,e.progress.numericalValue),d}};const St=function(e,t){this.disregardMesh=!0===e,this.alteredMesh=!0===t,this.meshes=[]};St.prototype={constructor:St,addMesh:function(e){this.meshes.push(e),this.alteredMesh=!0},isDisregardMesh:function(){return this.disregardMesh},providesAlteredMeshes:function(){return this.alteredMesh}};const Tt=function(){this.logging={enabled:!1,debug:!1},this.callbacks={onLoadMaterials:null},this.materials={}};Tt.prototype={constructor:Tt,setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},_setCallbacks:function(e){null!=e&&e instanceof Function&&(this.callbacks.onLoadMaterials=e)},createDefaultMaterials:function(e){let t=new $e.MeshStandardMaterial({color:14479871});t.name="defaultMaterial";let i=new $e.MeshStandardMaterial({color:14479871});i.name="defaultVertexColorMaterial",i.vertexColors=$e.VertexColors;let n=new $e.LineBasicMaterial;n.name="defaultLineMaterial";let r=new $e.PointsMaterial({size:.1});r.name="defaultPointMaterial";let a={};a[t.name]=t,a[i.name]=i,a[n.name]=n,a[r.name]=r,this.addMaterials(a,e)},addPayloadMaterials:function(e){let t,i,n=e.materials.materialCloneInstructions,r={};if(null!=n){let e=n.materialNameOrg;e=null!=e?e:"";let a=this.materials[e];a?(t=a.clone(),i=n.materialName,t.name=i,Object.assign(t,n.materialProperties),this.materials[i]=t,r[i]=t):this.logging.enabled&&console.info('Requested material "'+e+'" is not available!')}let a=e.materials.serializedMaterials;if(null!=a&&Object.keys(a).length>0){let e,n=new $e.MaterialLoader;for(i in a)e=a[i],null!=e&&(t=n.parse(e),this.logging.enabled&&console.info('De-serialized material with name "'+i+'" will be added.'),this.materials[i]=t,r[i]=t)}return a=e.materials.runtimeMaterials,r=this.addMaterials(a,!0,r),r},addMaterials:function(e,t,i){if(null==i&&(i={}),null!=e&&Object.keys(e).length>0){let n,r,a;for(let s in e)n=e[s],a=!0===t,a||(r=this.materials[s],a=null==r),a&&(this.materials[s]=n,i[s]=n),this.logging.enabled&&this.logging.debug&&console.info('Material with name "'+s+'" was added.')}return this.callbacks.onLoadMaterials&&this.callbacks.onLoadMaterials(i),i},getMaterials:function(){return this.materials},getMaterial:function(e){return this.materials[e]},getMaterialsJSON:function(){let e,t={};for(let i in this.materials)e=this.materials[i],t[i]=e.toJSON();return t},clearMaterials:function(){this.materials={}}};const Et=function(e){$e.Loader.call(this,e),this.parser=new _t,this.modelName="",this.instanceNo=0,this.baseObject3d=new $e.Object3D,this.materialHandler=new Tt,this.meshReceiver=new Mt(this.materialHandler);let t=this;this.parser.setCallbackOnAssetAvailable((function(e){t._onAssetAvailable(e)}))};Et.OBJLOADER2_VERSION="3.2.0",console.info("Using OBJLoader2 version: "+Et.OBJLOADER2_VERSION),Et.prototype=Object.assign(Object.create($e.Loader.prototype),{constructor:Et,setLogging:function(e,t){return this.parser.setLogging(e,t),this},setMaterialPerSmoothingGroup:function(e){return this.parser.setMaterialPerSmoothingGroup(e),this},setUseOAsMesh:function(e){return this.parser.setUseOAsMesh(e),this},setUseIndices:function(e){return this.parser.setUseIndices(e),this},setDisregardNormals:function(e){return this.parser.setDisregardNormals(e),this},setModelName:function(e){return this.modelName=e||this.modelName,this},setBaseObject3d:function(e){return this.baseObject3d=null==e?this.baseObject3d:e,this},addMaterials:function(e,t){return this.materialHandler.addMaterials(e,t),this},setCallbackOnAssetAvailable:function(e){return this.parser.setCallbackOnAssetAvailable(e),this},setCallbackOnProgress:function(e){return this.parser.setCallbackOnProgress(e),this},setCallbackOnError:function(e){return this.parser.setCallbackOnError(e),this},setCallbackOnLoad:function(e){return this.parser.setCallbackOnLoad(e),this},setCallbackOnMeshAlter:function(e){return this.meshReceiver._setCallbacks(this.parser.callbacks.onProgress,e),this},setCallbackOnLoadMaterials:function(e){return this.materialHandler._setCallbacks(e),this},load:function(e,t,i,n,r){let a=this;if(!(null!=t&&t instanceof Function)){let e="onLoad is not a function! Aborting...";throw a.parser.callbacks.onError(e),e}this.parser.setCallbackOnLoad(t),null!=n&&n instanceof Function||(n=function(e){let t=e;e.currentTarget&&null!==e.currentTarget.statusText&&(t="Error occurred while downloading!\nurl: "+e.currentTarget.responseURL+"\nstatus: "+e.currentTarget.statusText),a.parser.callbacks.onError(t)}),e||n("An invalid url was provided. Unable to continue!");let s=new URL(e,window.location.href).href,o=s,l=s.split("/");if(l.length>2&&(o=l[l.length-1],this.path=l.slice(0,l.length-1).join("/")+"/"),null==i||!(i instanceof Function)){let t=0,n=0;i=function(i){if(i.lengthComputable&&(n=i.loaded/i.total,n>t)){t=n;let i='Download of "'+e+'": '+(100*n).toFixed(2)+"%";a.parser.callbacks.onProgress("progressLoad",i,n)}}}this.setCallbackOnMeshAlter(r);let c=new $e.FileLoader(this.manager);c.setPath(this.path||this.resourcePath),c.setResponseType("arraybuffer"),c.load(o,(function(e){a.parser.callbacks.onLoad(a.parse(e),"OBJLoader2#load: Parsing completed")}),i,n)},parse:function(e){if(null==e)throw"Provided content is not a valid ArrayBuffer or String. Unable to continue parsing";return this.parser.logging.enabled&&console.time("OBJLoader parse: "+this.modelName),this.materialHandler.createDefaultMaterials(!1),this.parser.setMaterials(this.materialHandler.getMaterials()),e instanceof ArrayBuffer||e instanceof Uint8Array?(this.parser.logging.enabled&&console.info("Parsing arrayBuffer..."),this.parser.execute(e)):"string"==typeof e||e instanceof String?(this.parser.logging.enabled&&console.info("Parsing text..."),this.parser.executeLegacy(e)):this.parser.callbacks.onError("Provided content was neither of type String nor Uint8Array! Aborting..."),this.parser.logging.enabled&&console.timeEnd("OBJLoader parse: "+this.modelName),this.baseObject3d},_onAssetAvailable:function(e){if("assetAvailable"===e.cmd)if("mesh"===e.type){let t=this.meshReceiver.buildMeshes(e);for(let e of t)this.baseObject3d.add(e)}else"material"===e.type&&this.materialHandler.addPayloadMaterials(e)}});var Ct=function(){function e(e){$e.Loader.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,i){e[t]=i},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create($e.Loader.prototype),{constructor:e,load:function(e,t,i,n){var r,a=this;r=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:$e.LoaderUtils.extractUrlBase(e),a.manager.itemStart(e);var s=function(t){n?n(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},o=new $e.FileLoader(a.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),"use-credentials"===a.crossOrigin&&o.setWithCredentials(!0),o.load(e,(function(i){try{a.parse(i,r,(function(i){t(i),a.manager.itemEnd(e)}),s)}catch(e){s(e)}}),i,s)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,l,c){var p,g={};if("string"==typeof e)p=e;else if($e.LoaderUtils.decodeText(new Uint8Array(e,0,4))===o){try{g[i.KHR_BINARY_GLTF]=new h(e)}catch(e){return void(c&&c(e))}p=g[i.KHR_BINARY_GLTF].content}else p=$e.LoaderUtils.decodeText(new Uint8Array(e));var v=JSON.parse(p);if(void 0===v.asset||v.asset.version[0]<2)c&&c(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(v.extensionsUsed)for(var y=0;y<v.extensionsUsed.length;++y){var b=v.extensionsUsed[y],x=v.extensionsRequired||[];switch(b){case i.KHR_LIGHTS_PUNCTUAL:g[b]=new r(v);break;case i.KHR_MATERIALS_CLEARCOAT:g[b]=new s;break;case i.KHR_MATERIALS_UNLIT:g[b]=new a;break;case i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:g[b]=new m;break;case i.KHR_DRACO_MESH_COMPRESSION:g[b]=new u(v,this.dracoLoader);break;case i.MSFT_TEXTURE_DDS:g[b]=new n(this.ddsLoader);break;case i.KHR_TEXTURE_TRANSFORM:g[b]=new d;break;case i.KHR_MESH_QUANTIZATION:g[b]=new f;break;default:x.indexOf(b)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+b+'".')}}new H(v,g,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(l,c)}}});var i={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function n(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=i.MSFT_TEXTURE_DDS,this.ddsLoader=e}function r(e){this.name=i.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[i.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function a(){this.name=i.KHR_MATERIALS_UNLIT}function s(){this.name=i.KHR_MATERIALS_CLEARCOAT}r.prototype.loadLight=function(e){var t,i=this.lightDefs[e],n=new $e.Color(16777215);void 0!==i.color&&n.fromArray(i.color);var r=void 0!==i.range?i.range:0;switch(i.type){case"directional":(t=new $e.DirectionalLight(n)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new $e.PointLight(n)).distance=r;break;case"spot":(t=new $e.SpotLight(n)).distance=r,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,t.angle=i.spot.outerConeAngle,t.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+i.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==i.intensity&&(t.intensity=i.intensity),t.name=i.name||"light_"+e,Promise.resolve(t)},a.prototype.getMaterialType=function(){return $e.MeshBasicMaterial},a.prototype.extendParams=function(e,t,i){var n=[];e.color=new $e.Color(1,1,1),e.opacity=1;var r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){var a=r.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==r.baseColorTexture&&n.push(i.assignTexture(e,"map",r.baseColorTexture))}return Promise.all(n)},s.prototype.getMaterialType=function(){return $e.MeshPhysicalMaterial},s.prototype.extendParams=function(e,t,i){var n=[],r=t.extensions[this.name];if(void 0!==r.clearcoatFactor&&(e.clearcoat=r.clearcoatFactor),void 0!==r.clearcoatTexture&&n.push(i.assignTexture(e,"clearcoatMap",r.clearcoatTexture)),void 0!==r.clearcoatRoughnessFactor&&(e.clearcoatRoughness=r.clearcoatRoughnessFactor),void 0!==r.clearcoatRoughnessTexture&&n.push(i.assignTexture(e,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),void 0!==r.clearcoatNormalTexture&&(n.push(i.assignTexture(e,"clearcoatNormalMap",r.clearcoatNormalTexture)),void 0!==r.clearcoatNormalTexture.scale)){var a=r.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new $e.Vector2(a,a)}return Promise.all(n)};var o="glTF",l=1313821514,c=5130562;function h(e){this.name=i.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:$e.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==o)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=new DataView(e,12),r=0;r<n.byteLength;){var a=n.getUint32(r,!0);r+=4;var s=n.getUint32(r,!0);if(r+=4,s===l){var h=new Uint8Array(e,12+r,a);this.content=$e.LoaderUtils.decodeText(h)}else if(s===c){var u=12+r;this.body=e.slice(u,u+a)}r+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function u(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=i.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function d(){this.name=i.KHR_TEXTURE_TRANSFORM}function p(e){$e.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),i=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),r=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),a=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),s={specular:{value:(new $e.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(e){for(var o in s)e.uniforms[o]=s[o];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),e.fragmentShader=e.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_pars_fragment>",t),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_pars_fragment>",i),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>",n),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_fragment>",r),e.fragmentShader=e.fragmentShader.replace("#include <lights_physical_fragment>",a)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(e){s.specular.value=e}},specularMap:{get:function(){return s.specularMap.value},set:function(e){s.specularMap.value=e}},glossiness:{get:function(){return s.glossiness.value},set:function(e){s.glossiness.value=e}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(e){s.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function m(){return{name:i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return p},extendParams:function(e,t,i){var n=t.extensions[this.name];e.color=new $e.Color(1,1,1),e.opacity=1;var r=[];if(Array.isArray(n.diffuseFactor)){var a=n.diffuseFactor;e.color.fromArray(a),e.opacity=a[3]}if(void 0!==n.diffuseTexture&&r.push(i.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new $e.Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new $e.Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var s=n.specularGlossinessTexture;r.push(i.assignTexture(e,"glossinessMap",s)),r.push(i.assignTexture(e,"specularMap",s))}return Promise.all(r)},createMaterial:function(e){var t=new p(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=$e.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function f(){this.name=i.KHR_MESH_QUANTIZATION}function g(e,t,i,n){$e.Interpolant.call(this,e,t,i,n)}u.prototype.decodePrimitive=function(e,t){var i=this.json,n=this.dracoLoader,r=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,s={},o={},l={};for(var c in a){var h=L[c]||c.toLowerCase();s[h]=a[c]}for(c in e.attributes){h=L[c]||c.toLowerCase();if(void 0!==a[c]){var u=i.accessors[e.attributes[c]],d=S[u.componentType];l[h]=d,o[h]=!0===u.normalized}}return t.getDependency("bufferView",r).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var i in e.attributes){var n=e.attributes[i],r=o[i];void 0!==r&&(n.normalized=r)}t(e)}),s,l)}))}))},d.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},p.prototype=Object.create($e.MeshStandardMaterial.prototype),p.prototype.constructor=p,p.prototype.copy=function(e){return $e.MeshStandardMaterial.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},g.prototype=Object.create($e.Interpolant.prototype),g.prototype.constructor=g,g.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n*3+n,a=0;a!==n;a++)t[a]=i[r+a];return t},g.prototype.beforeStart_=g.prototype.copySampleValue_,g.prototype.afterEnd_=g.prototype.copySampleValue_,g.prototype.interpolate_=function(e,t,i,n){for(var r=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=2*s,l=3*s,c=n-t,h=(i-t)/c,u=h*h,d=u*h,p=e*l,m=p-l,f=-2*d+3*u,g=d-u,v=1-f,y=g-u+h,b=0;b!==s;b++){var x=a[m+b+s],w=a[m+b+o]*c,_=a[p+b+s],M=a[p+b]*c;r[b]=v*x+y*w+f*_+g*M}return r};var v=0,y=1,b=2,x=3,w=4,_=5,M=6,S={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},T={9728:$e.NearestFilter,9729:$e.LinearFilter,9984:$e.NearestMipmapNearestFilter,9985:$e.LinearMipmapNearestFilter,9986:$e.NearestMipmapLinearFilter,9987:$e.LinearMipmapLinearFilter},E={33071:$e.ClampToEdgeWrapping,33648:$e.MirroredRepeatWrapping,10497:$e.RepeatWrapping},C={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},L={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},A={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},k={CUBICSPLINE:void 0,LINEAR:$e.InterpolateLinear,STEP:$e.InterpolateDiscrete},P="OPAQUE",R="MASK",O="BLEND",I={"image/png":$e.RGBAFormat,"image/jpeg":$e.RGBFormat};function D(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function N(e,t,i){for(var n in i.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=i.extensions[n])}function z(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function F(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var i=0,n=t.weights.length;i<n;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){var r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(i=0,n=r.length;i<n;i++)e.morphTargetDictionary[r[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function B(e){for(var t="",i=Object.keys(e).sort(),n=0,r=i.length;n<r;n++)t+=i[n]+":"+e[i[n]]+";";return t}function H(e,i,n){this.json=e||{},this.extensions=i||{},this.options=n||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new $e.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new $e.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function G(e,t,i){var n=t.attributes,r=[];function a(t,n){return i.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(var s in n){var o=L[s]||s.toLowerCase();o in e.attributes||r.push(a(n[s],o))}if(void 0!==t.indices&&!e.index){var l=i.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));r.push(l)}return z(e,t),function(e,t,i){var n=t.attributes,r=new $e.Box3;if(void 0!==n.POSITION){var a=(p=i.json.accessors[n.POSITION]).min,s=p.max;if(void 0!==a&&void 0!==s){r.set(new $e.Vector3(a[0],a[1],a[2]),new $e.Vector3(s[0],s[1],s[2]));var o=t.targets;if(void 0!==o){for(var l=new $e.Vector3,c=new $e.Vector3,h=0,u=o.length;h<u;h++){var d=o[h];if(void 0!==d.POSITION){var p;a=(p=i.json.accessors[d.POSITION]).min,s=p.max;void 0!==a&&void 0!==s?(c.setX(Math.max(Math.abs(a[0]),Math.abs(s[0]))),c.setY(Math.max(Math.abs(a[1]),Math.abs(s[1]))),c.setZ(Math.max(Math.abs(a[2]),Math.abs(s[2]))),l.max(c)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(l)}e.boundingBox=r;var m=new $e.Sphere;r.getCenter(m.center),m.radius=r.min.distanceTo(r.max)/2,e.boundingSphere=m}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,i),Promise.all(r).then((function(){return void 0!==t.targets?function(e,t,i){for(var n=!1,r=!1,a=0,s=t.length;a<s;a++){if(void 0!==(c=t[a]).POSITION&&(n=!0),void 0!==c.NORMAL&&(r=!0),n&&r)break}if(!n&&!r)return Promise.resolve(e);var o=[],l=[];for(a=0,s=t.length;a<s;a++){var c=t[a];if(n){var h=void 0!==c.POSITION?i.getDependency("accessor",c.POSITION):e.attributes.position;o.push(h)}if(r){h=void 0!==c.NORMAL?i.getDependency("accessor",c.NORMAL):e.attributes.normal;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(l)]).then((function(t){var i=t[0],a=t[1];return n&&(e.morphAttributes.position=i),r&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,i):e}))}function U(e,t){var i=e.getIndex();if(null===i){var n=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<r.count;a++)n.push(a);e.setIndex(n),i=e.getIndex()}var s=i.count-2,o=[];if(t===$e.TriangleFanDrawMode)for(a=1;a<=s;a++)o.push(i.getX(0)),o.push(i.getX(a)),o.push(i.getX(a+1));else for(a=0;a<s;a++)a%2==0?(o.push(i.getX(a)),o.push(i.getX(a+1)),o.push(i.getX(a+2))):(o.push(i.getX(a+2)),o.push(i.getX(a+1)),o.push(i.getX(a)));o.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=e.clone();return l.setIndex(o),l}return H.prototype.parse=function(e,t){var i=this,n=this.json,r=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var a={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:i,userData:{}};N(r,a,n),z(a,n),e(a)})).catch(t)},H.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[],n={},r={},a=0,s=t.length;a<s;a++)for(var o=t[a].joints,l=0,c=o.length;l<c;l++)e[o[l]].isBone=!0;for(var h=0,u=e.length;h<u;h++){var d=e[h];void 0!==d.mesh&&(void 0===n[d.mesh]&&(n[d.mesh]=r[d.mesh]=0),n[d.mesh]++,void 0!==d.skin&&(i[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=r},H.prototype.getDependency=function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this.loadMesh(t);break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this.loadBufferView(t);break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this.loadMaterial(t);break;case"texture":r=this.loadTexture(t);break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;case"light":r=this.extensions[i.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r},H.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var i=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return i.getDependency(e,n)}))),this.cache.add(e,t)}return t},H.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[i.KHR_BINARY_GLTF].body);var r=this.options;return new Promise((function(e,i){n.load(D(t.uri,r.path),e,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},H.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var i=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+i)}))},H.prototype.loadAccessor=function(e){var t=this,i=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var r=[];return void 0!==n.bufferView?r.push(this.getDependency("bufferView",n.bufferView)):r.push(null),void 0!==n.sparse&&(r.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(r).then((function(e){var r,a,s=e[0],o=C[n.type],l=S[n.componentType],c=l.BYTES_PER_ELEMENT,h=c*o,u=n.byteOffset||0,d=void 0!==n.bufferView?i.bufferViews[n.bufferView].byteStride:void 0,p=!0===n.normalized;if(d&&d!==h){var m=Math.floor(u/d),f="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+m+":"+n.count,g=t.cache.get(f);g||(r=new l(s,m*d,n.count*d/c),g=new $e.InterleavedBuffer(r,d/c),t.cache.add(f,g)),a=new $e.InterleavedBufferAttribute(g,o,u%d/c,p)}else r=null===s?new l(n.count*o):new l(s,u,n.count*o),a=new $e.BufferAttribute(r,o,p);if(void 0!==n.sparse){var v=C.SCALAR,y=S[n.sparse.indices.componentType],b=n.sparse.indices.byteOffset||0,x=n.sparse.values.byteOffset||0,w=new y(e[1],b,n.sparse.count*v),_=new l(e[2],x,n.sparse.count*o);null!==s&&(a=new $e.BufferAttribute(a.array.slice(),a.itemSize,a.normalized));for(var M=0,T=w.length;M<T;M++){var E=w[M];if(a.setX(E,_[M*o]),o>=2&&a.setY(E,_[M*o+1]),o>=3&&a.setZ(E,_[M*o+2]),o>=4&&a.setW(E,_[M*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a}))},H.prototype.loadTexture=function(e){var t,n=this,r=this.json,a=this.options,s=this.textureLoader,o=self.URL||self.webkitURL,l=r.textures[e],c=l.extensions||{},h=(t=c[i.MSFT_TEXTURE_DDS]?r.images[c[i.MSFT_TEXTURE_DDS].source]:r.images[l.source]).uri,u=!1;return void 0!==t.bufferView&&(h=n.getDependency("bufferView",t.bufferView).then((function(e){u=!0;var i=new Blob([e],{type:t.mimeType});return h=o.createObjectURL(i)}))),Promise.resolve(h).then((function(e){var t=a.manager.getHandler(e);return t||(t=c[i.MSFT_TEXTURE_DDS]?n.extensions[i.MSFT_TEXTURE_DDS].ddsLoader:s),new Promise((function(i,n){t.load(D(e,a.path),i,void 0,n)}))})).then((function(e){!0===u&&o.revokeObjectURL(h),e.flipY=!1,l.name&&(e.name=l.name),t.mimeType in I&&(e.format=I[t.mimeType]);var i=(r.samplers||{})[l.sampler]||{};return e.magFilter=T[i.magFilter]||$e.LinearFilter,e.minFilter=T[i.minFilter]||$e.LinearMipmapLinearFilter,e.wrapS=E[i.wrapS]||$e.RepeatWrapping,e.wrapT=E[i.wrapT]||$e.RepeatWrapping,e}))},H.prototype.assignTexture=function(e,t,n){var r=this;return this.getDependency("texture",n.index).then((function(a){if(!a.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":a.format=$e.RGBFormat}if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),r.extensions[i.KHR_TEXTURE_TRANSFORM]){var s=void 0!==n.extensions?n.extensions[i.KHR_TEXTURE_TRANSFORM]:void 0;s&&(a=r.extensions[i.KHR_TEXTURE_TRANSFORM].extendTexture(a,s))}e[t]=a}))},H.prototype.assignFinalMaterial=function(e){var t=e.geometry,i=e.material,n=void 0!==t.attributes.tangent,r=void 0!==t.attributes.color,a=void 0===t.attributes.normal,s=!0===e.isSkinnedMesh,o=Object.keys(t.morphAttributes).length>0,l=o&&void 0!==t.morphAttributes.normal;if(e.isPoints){var c="PointsMaterial:"+i.uuid,h=this.cache.get(c);h||(h=new $e.PointsMaterial,$e.Material.prototype.copy.call(h,i),h.color.copy(i.color),h.map=i.map,h.sizeAttenuation=!1,this.cache.add(c,h)),i=h}else if(e.isLine){c="LineBasicMaterial:"+i.uuid;var u=this.cache.get(c);u||(u=new $e.LineBasicMaterial,$e.Material.prototype.copy.call(u,i),u.color.copy(i.color),this.cache.add(c,u)),i=u}if(n||r||a||s||o){c="ClonedMaterial:"+i.uuid+":";i.isGLTFSpecularGlossinessMaterial&&(c+="specular-glossiness:"),s&&(c+="skinning:"),n&&(c+="vertex-tangents:"),r&&(c+="vertex-colors:"),a&&(c+="flat-shading:"),o&&(c+="morph-targets:"),l&&(c+="morph-normals:");var d=this.cache.get(c);d||(d=i.clone(),s&&(d.skinning=!0),n&&(d.vertexTangents=!0),r&&(d.vertexColors=!0),a&&(d.flatShading=!0),o&&(d.morphTargets=!0),l&&(d.morphNormals=!0),this.cache.add(c,d)),i=d}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",new $e.BufferAttribute(t.attributes.uv.array,2)),i.normalScale&&!n&&(i.normalScale.y=-i.normalScale.y),i.clearcoatNormalScale&&!n&&(i.clearcoatNormalScale.y=-i.clearcoatNormalScale.y),e.material=i},H.prototype.loadMaterial=function(e){var t,n=this.json,r=this.extensions,a=n.materials[e],s={},o=a.extensions||{},l=[];if(o[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=r[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=c.getMaterialType(),l.push(c.extendParams(s,a,this))}else if(o[i.KHR_MATERIALS_UNLIT]){var h=r[i.KHR_MATERIALS_UNLIT];t=h.getMaterialType(),l.push(h.extendParams(s,a,this))}else{t=$e.MeshStandardMaterial;var u=a.pbrMetallicRoughness||{};if(s.color=new $e.Color(1,1,1),s.opacity=1,Array.isArray(u.baseColorFactor)){var d=u.baseColorFactor;s.color.fromArray(d),s.opacity=d[3]}void 0!==u.baseColorTexture&&l.push(this.assignTexture(s,"map",u.baseColorTexture)),s.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,s.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture&&(l.push(this.assignTexture(s,"metalnessMap",u.metallicRoughnessTexture)),l.push(this.assignTexture(s,"roughnessMap",u.metallicRoughnessTexture)))}!0===a.doubleSided&&(s.side=$e.DoubleSide);var m=a.alphaMode||P;if(m===O?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,m===R&&(s.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==$e.MeshBasicMaterial&&(l.push(this.assignTexture(s,"normalMap",a.normalTexture)),s.normalScale=new $e.Vector2(1,1),void 0!==a.normalTexture.scale&&s.normalScale.set(a.normalTexture.scale,a.normalTexture.scale)),void 0!==a.occlusionTexture&&t!==$e.MeshBasicMaterial&&(l.push(this.assignTexture(s,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(s.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==$e.MeshBasicMaterial&&(s.emissive=(new $e.Color).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&t!==$e.MeshBasicMaterial&&l.push(this.assignTexture(s,"emissiveMap",a.emissiveTexture)),o[i.KHR_MATERIALS_CLEARCOAT]){var f=r[i.KHR_MATERIALS_CLEARCOAT];t=f.getMaterialType(),l.push(f.extendParams(s,{extensions:o},this))}return Promise.all(l).then((function(){var e;return e=t===p?r[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),a.name&&(e.name=a.name),e.map&&(e.map.encoding=$e.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=$e.sRGBEncoding),z(e,a),a.extensions&&N(r,e,a),e}))},H.prototype.loadGeometries=function(e){var t=this,n=this.extensions,r=this.primitiveCache;function a(e){return n[i.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(i){return G(i,e,t)}))}for(var s,o,l=[],c=0,h=e.length;c<h;c++){var u,d=e[c],p=(o=void 0,(o=(s=d).extensions&&s.extensions[i.KHR_DRACO_MESH_COMPRESSION])?"draco:"+o.bufferView+":"+o.indices+":"+B(o.attributes):s.indices+":"+B(s.attributes)+":"+s.mode),m=r[p];if(m)l.push(m.promise);else u=d.extensions&&d.extensions[i.KHR_DRACO_MESH_COMPRESSION]?a(d):G(new $e.BufferGeometry,d,t),r[p]={primitive:d,promise:u},l.push(u)}return Promise.all(l)},H.prototype.loadMesh=function(e){for(var t,i=this,n=this.json.meshes[e],r=n.primitives,a=[],s=0,o=r.length;s<o;s++){var l=void 0===r[s].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new $e.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:$e.FrontSide})),t.DefaultMaterial):this.getDependency("material",r[s].material);a.push(l)}return a.push(i.loadGeometries(r)),Promise.all(a).then((function(t){for(var a=t.slice(0,t.length-1),s=t[t.length-1],o=[],l=0,c=s.length;l<c;l++){var h,u=s[l],d=r[l],p=a[l];if(d.mode===w||d.mode===_||d.mode===M||void 0===d.mode)!0!==(h=!0===n.isSkinnedMesh?new $e.SkinnedMesh(u,p):new $e.Mesh(u,p)).isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),d.mode===_?h.geometry=U(h.geometry,$e.TriangleStripDrawMode):d.mode===M&&(h.geometry=U(h.geometry,$e.TriangleFanDrawMode));else if(d.mode===y)h=new $e.LineSegments(u,p);else if(d.mode===x)h=new $e.Line(u,p);else if(d.mode===b)h=new $e.LineLoop(u,p);else{if(d.mode!==v)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);h=new $e.Points(u,p)}Object.keys(h.geometry.morphAttributes).length>0&&F(h,n),h.name=n.name||"mesh_"+e,s.length>1&&(h.name+="_"+l),z(h,n),i.assignFinalMaterial(h),o.push(h)}if(1===o.length)return o[0];var m=new $e.Group;for(l=0,c=o.length;l<c;l++)m.add(o[l]);return m}))},H.prototype.loadCamera=function(e){var t,i=this.json.cameras[e],n=i[i.type];if(n)return"perspective"===i.type?t=new $e.PerspectiveCamera($e.MathUtils.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===i.type&&(t=new $e.OrthographicCamera(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),i.name&&(t.name=i.name),z(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},H.prototype.loadSkin=function(e){var t=this.json.skins[e],i={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return i.inverseBindMatrices=e,i}))},H.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],i=[],n=[],r=[],a=[],s=[],o=0,l=t.channels.length;o<l;o++){var c=t.channels[o],h=t.samplers[c.sampler],u=c.target,d=void 0!==u.node?u.node:u.id,p=void 0!==t.parameters?t.parameters[h.input]:h.input,m=void 0!==t.parameters?t.parameters[h.output]:h.output;i.push(this.getDependency("node",d)),n.push(this.getDependency("accessor",p)),r.push(this.getDependency("accessor",m)),a.push(h),s.push(u)}return Promise.all([Promise.all(i),Promise.all(n),Promise.all(r),Promise.all(a),Promise.all(s)]).then((function(i){for(var n=i[0],r=i[1],a=i[2],s=i[3],o=i[4],l=[],c=0,h=n.length;c<h;c++){var u=n[c],d=r[c],p=a[c],m=s[c],f=o[c];if(void 0!==u){var v;switch(u.updateMatrix(),u.matrixAutoUpdate=!0,A[f.path]){case A.weights:v=$e.NumberKeyframeTrack;break;case A.rotation:v=$e.QuaternionKeyframeTrack;break;case A.position:case A.scale:default:v=$e.VectorKeyframeTrack}var y=u.name?u.name:u.uuid,b=void 0!==m.interpolation?k[m.interpolation]:$e.InterpolateLinear,x=[];A[f.path]===A.weights?u.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&x.push(e.name?e.name:e.uuid)})):x.push(y);var w=p.array;if(p.normalized){var _;if(w.constructor===Int8Array)_=1/127;else if(w.constructor===Uint8Array)_=1/255;else if(w.constructor==Int16Array)_=1/32767;else{if(w.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");_=1/65535}for(var M=new Float32Array(w.length),S=0,T=w.length;S<T;S++)M[S]=w[S]*_;w=M}for(S=0,T=x.length;S<T;S++){var E=new v(x[S]+"."+A[f.path],d.array,w,b);"CUBICSPLINE"===m.interpolation&&(E.createInterpolant=function(e){return new g(this.times,this.values,this.getValueSize()/3,e)},E.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(E)}}}var C=t.name?t.name:"animation_"+e;return new $e.AnimationClip(C,void 0,l)}))},H.prototype.loadNode=function(e){var t,n=this.json,r=this.extensions,a=this,s=n.meshReferences,o=n.meshUses,l=n.nodes[e];return(t=[],void 0!==l.mesh&&t.push(a.getDependency("mesh",l.mesh).then((function(e){var t;if(s[l.mesh]>1){var i=o[l.mesh]++;(t=e.clone()).name+="_instance_"+i}else t=e;return void 0!==l.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,i=l.weights.length;t<i;t++)e.morphTargetInfluences[t]=l.weights[t]})),t}))),void 0!==l.camera&&t.push(a.getDependency("camera",l.camera)),l.extensions&&l.extensions[i.KHR_LIGHTS_PUNCTUAL]&&void 0!==l.extensions[i.KHR_LIGHTS_PUNCTUAL].light&&t.push(a.getDependency("light",l.extensions[i.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then((function(e){var t;if((t=!0===l.isBone?new $e.Bone:e.length>1?new $e.Group:1===e.length?e[0]:new $e.Object3D)!==e[0])for(var i=0,n=e.length;i<n;i++)t.add(e[i]);if(l.name&&(t.userData.name=l.name,t.name=$e.PropertyBinding.sanitizeNodeName(l.name)),z(t,l),l.extensions&&N(r,t,l),void 0!==l.matrix){var a=new $e.Matrix4;a.fromArray(l.matrix),t.applyMatrix4(a)}else void 0!==l.translation&&t.position.fromArray(l.translation),void 0!==l.rotation&&t.quaternion.fromArray(l.rotation),void 0!==l.scale&&t.scale.fromArray(l.scale);return t}))},H.prototype.loadScene=function(){function e(t,i,n,r){var a=n.nodes[t];return r.getDependency("node",t).then((function(e){return void 0===a.skin?e:r.getDependency("skin",a.skin).then((function(e){for(var i=[],n=0,a=(t=e).joints.length;n<a;n++)i.push(r.getDependency("node",t.joints[n]));return Promise.all(i)})).then((function(i){return e.traverse((function(e){if(e.isMesh){for(var n=[],r=[],a=0,s=i.length;a<s;a++){var o=i[a];if(o){n.push(o);var l=new $e.Matrix4;void 0!==t.inverseBindMatrices&&l.fromArray(t.inverseBindMatrices.array,16*a),r.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}e.bind(new $e.Skeleton(n,r),e.matrixWorld)}})),e}));var t})).then((function(t){i.add(t);var s=[];if(a.children)for(var o=a.children,l=0,c=o.length;l<c;l++){var h=o[l];s.push(e(h,t,n,r))}return Promise.all(s)}))}return function(t){var i=this.json,n=this.extensions,r=this.json.scenes[t],a=new $e.Group;r.name&&(a.name=r.name),z(a,r),r.extensions&&N(n,a,r);for(var s=r.nodes||[],o=[],l=0,c=s.length;l<c;l++)o.push(e(s[l],a,i,this));return Promise.all(o).then((function(){return a}))}}(),e}();const Lt={hat:{type:"gltf",path:"3d/gltf/hat.gltf"},rabbit:{type:"gltf",path:"3d/gltf/rabbit.gltf",material:dt.PARSE},key:{type:"gltf",material:dt.VERSICOLOR,path:"3d/gltf/key.gltf"},unicornsUnit:{type:"gltf",material:dt.VERSICOLOR,path:"3d/gltf/unicorns_unit.gltf"},peaks:{type:"obj",path:"3d/obj/peaks.obj"},clubs:{type:"obj",path:"3d/obj/clubs.obj"},star:{type:"obj",path:"3d/obj/star.obj"}},At=new Ct;var kt=(e,t)=>{const{defaultMaterial:i,materialsMap:n}=t;return new Promise(t=>{const r=Lt[e];if(!r)return void t(null);const a=e=>{if(!e)return void t(null);const a=r.material===dt.PARSE?null:n[r.material||dt.DEFAULT]||i;e.traverse(e=>{if(e.isMesh){const t=a||n[e.material.name||dt.DEFAULT]||i;t&&(e.material=t)}}),t(e)},s=e=>{a(e&&e.scene||null)};switch(r.type){case"gltf":((e,t)=>{At.load(e.path,t)})(r,s);break;default:((e,t)=>{(new Et).load(e.path,t)})(r,a)}})};const Pt=i(0),Rt=(e,t,i)=>{const n=new Pt.SphereBufferGeometry(i,32,32);return Array.from({length:t},()=>new Pt.Mesh(n,e))},Ot=e=>new Pt.Mesh(new Pt.CylinderBufferGeometry(6,6,415,10),e),It=i(0),Dt=(e,t)=>{const i=new It.Group;return i.add(e),t.add(i),i},Nt=e=>e*Math.PI/180,zt=i(0);var Ft=class extends wt{setupParams(){super.setupParams(),this.hasLoad=!0}constructParametric(e){const{stagePoleG:t}=this,{defaultMaterial:i,materialsMap:n}=e,r=n[dt.VERSICOLOR];let a=Rt(i,3,65),s=0,o=a[s],l=Dt(o,t);this.addFluctuationConfig(l,5,8),o.position.set(-210,-30,415),this.invisibleOnPortrait.push(l),s+=1,o=a[s],l=Dt(o,t),this.addFluctuationConfig(l,5,8),o.scale.set(.7,.7,.7),o.position.set(155,-145,270),s+=1,o=a[s],l=Dt(o,t),this.addFluctuationConfig(l,5,8),o.scale.set(.54,.54,.54),o.position.set(395,190,-90),this.invisibleOnPortrait.push(l),a=((e,t)=>{const i=new Pt.ConeBufferGeometry(42,140,40);return Array.from({length:t},()=>new Pt.Mesh(i,e))})(r,2),s=0,o=a[s],l=Dt(o,t),this.addFluctuationConfig(l),o.position.set(290,-117,345),o.rotation.copy(new zt.Euler(Nt(-20),0,Nt(-30),"XZY")),this.invisibleOnPortrait.push(l),s+=1,o=a[s],l=Dt(o,t),this.addFluctuationConfig(l),o.scale.set(1,1.26,1),o.position.set(-260,165,-70),o.rotation.copy(new zt.Euler(Nt(-150),0,Nt(45),"XZY")),a=((e,t)=>{const i=new Pt.TorusBufferGeometry(150,8,10,60);return Array.from({length:t},()=>new Pt.Mesh(i,e))})(r,2),s=0,o=a[s],l=Dt(o,t),this.addFluctuationConfig(l),o.position.set(235,-175,-10),o.rotation.copy(new zt.Euler(Nt(-40),Nt(-55),0,"YXZ")),this.invisibleOnPortrait.push(l),s+=1,o=a[s],l=Dt(o,t),this.addFluctuationConfig(l),o.position.set(-320,120,-215),o.rotation.copy(new zt.Euler(Nt(-20),Nt(55),0,"YXZ")),this.invisibleOnPortrait.push(l),o=Ot(r),l=Dt(o,t),this.addFluctuationConfig(l),o.position.set(130,-55,520),o.rotation.copy(new zt.Euler(Nt(25),0,Nt(75),"ZXY"))}async loadWithMaterials(e){const{stagePoleG:t}=this,i=new zt.Group;t.add(i),this.invisibleOnPortrait.push(i);let n=await kt("peaks",e),r=Dt(n,i);r.name="peaks",this.addFluctuationConfig(r),n.scale.set(.58,.58,.58),n.position.set(315,375,-221),n.rotation.copy(new zt.Euler(Nt(25),Nt(26),Nt(40),"XZY")),n=await kt("hat",e),r=Dt(n,t),n.position.copy(new zt.Vector3(-13,-17,-55)),n.rotation.copy(new zt.Euler(Nt(20),Nt(-20),Nt(4.5),"YXZ")),this.mainObject=r,n=await kt("clubs",e),r=Dt(n,t),this.addFluctuationConfig(r),n.position.set(164,95,294),n.rotation.copy(new zt.Euler(Nt(-15),Nt(6),Nt(20),"XYZ")),n=await kt("star",e),r=Dt(n,t),this.addFluctuationConfig(r),n.scale.set(.83,.83,.83),n.position.set(-102,-200,255),n.rotation.copy(new zt.Euler(Nt(-30),Nt(36),Nt(35),"YXZ"))}};var Bt=class extends wt{setupParams(){super.setupParams(),this.sphereXPositions=[155,-370,495,770,-1495]}constructParametric(e){const{stagePoleG:t,sphereXPositions:i}=this,{defaultMaterial:n}=e,r=Rt(n,5,65);let a=0,s=r[a],o=Dt(s,t);this.addFluctuationConfig(o,5,8),s.position.set(i[a],-145,370),a+=1,s=r[a],o=Dt(s,t),this.addFluctuationConfig(o,5,8),s.scale.set(.9,.9,.9),s.position.set(i[a],30,115),a+=1,s=r[a],o=Dt(s,t),this.addFluctuationConfig(o,5,8),s.scale.set(.9,.9,.9),s.position.set(i[a],190,-690),a+=1,s=r[a],s.scale.set(.55,.55,.55),s.position.set(i[a],30,1015),t.add(s),a+=1,s=r[a],s.scale.set(.7,.7,.7),s.position.set(i[a],-690,-1090),t.add(s),this.spheres=r}updateSizeMode(e){if(super.updateSizeMode(e),!this.sphere)return;const t=this.sphereXPositions;this.spheres.forEach((i,n)=>{i.position.x=t[n]*(e?1:.6)})}};const Ht=i(0);var Gt=class extends wt{setupParams(){super.setupParams(),this.hasLoad=!0}constructParametric(e){const{stagePoleG:t}=this,{defaultMaterial:i,materialsMap:n}=e,r=n[dt.VERSICOLOR],a=Rt(i,4,65);let s=0,o=a[s],l=Dt(o,t);this.addFluctuationConfig(l,5,8),o.position.set(-210,-60,415),s+=1,o=a[s],l=Dt(o,t),this.addFluctuationConfig(l,5,8),o.scale.set(.6,.6,.6),o.position.set(255,-145,600),s+=1,o=a[s],l=Dt(o,t),this.addFluctuationConfig(l,5,8),o.scale.set(.8,.8,.8),o.position.set(495,190,-800),s+=1,o=a[s],o.scale.set(.6,.6,.6),o.position.set(870,-130,1015),t.add(o),o=Ot(r),o.position.set(-180,-15,520),o.rotation.copy(new Ht.Euler(Nt(60),0,Nt(120),"ZXY")),t.add(o),this.magicWand=o}async loadWithMaterials(e){const{stagePoleG:t}=this,i=await kt("star",e),n=Dt(i,t);this.star=i,this.addFluctuationConfig(n),i.position.set(-402,100,255),i.rotation.copy(new Ht.Euler(Nt(-20),Nt(36),Nt(25),"YXZ"))}};const Ut=i(0);var jt=class extends wt{setupParams(){super.setupParams(),this.hasLoad=!0}construct(){super.construct();const e=new Ut.Group;e.position.y=-50,this.mainObject=e,this.stagePoleG.add(e)}async loadWithMaterials(e){const t=await kt("key",e);t.rotation.copy(new Ut.Euler(Nt(-10),Nt(-25),Nt(-18),"XZY")),this.mainObject.add(t)}invalidate(e,t){super.invalidate(e,t),this.mainObject.rotation.y+=Nt(17*e*.001)}};const Vt=i(0);var Wt=class extends wt{setupParams(){super.setupParams(),this.hasLoad=!0}async loadWithMaterials(e){const t=await kt("rabbit",e);this.mainObject=t,t.position.copy(new Vt.Vector3(0,-275,-55)),t.rotation.copy(new Vt.Euler(0,Nt(145),0,"YXZ")),this.stagePoleG.add(t)}};const qt=i(0);var $t=class extends wt{setupParams(){super.setupParams(),this.hasLoad=!0}async loadWithMaterials(e){const t=new qt.Group;this.mainObject=t;const i=await kt("unicornsUnit",e),n=i.clone();n.position.x=1,n.rotation.y=Math.PI,t.add(n),t.add(i),t.position.copy(new qt.Vector3(-80,-300,0)),t.rotation.copy(new qt.Euler(0,Nt(-40),0,"YXZ")),this.stagePoleG.add(t)}};const Xt=i(0);var Yt=class extends ut{setupParameters(e){super.setupParameters(e),this.isLightMode=e.isLightMode,this.statesMap={stage1:!0,stage2:!0,stage3:!0,stage4:!1,stage5:!0,stage6:!1},this.statesForceRenderMap={stage4:!0},this.stateName=null,this.prevStateName=null,this.forceInvalidate=!1,this.initiationTime=Date.now(),this.startTime=0,this.time=0,this.zDepth=1500,this.addOn=null}construct(){const{renderer:e,scene:t,camera:i}=gt(this.width,this.height,5500);if(i.position.z=this.zDepth,t.add(i),!this.isLightMode){const{lightRoot:e}=(()=>{const e=new Xt.Group,t=[],i=new Xt.SphereBufferGeometry(5,16,8);let n=new Xt.PointLight(16774632,.98),r=new Xt.Mesh(i,new Xt.MeshBasicMaterial({color:16711680}));return n.add(r),n.position.set(-1225,20,-820),t.push(n),e.add(n),n=new Xt.PointLight(16182271,.95),r=new Xt.Mesh(i,new Xt.MeshBasicMaterial({color:255})),n.add(r),n.position.set(940,960,-628),t.push(n),e.add(n),n=new Xt.PointLight(15917311,.7),r=new Xt.Mesh(i,new Xt.MeshBasicMaterial({color:65280})),n.add(r),n.position.set(1400,-962,-1610),t.push(n),e.add(n),{lights:t,lightRoot:e}})();i.add(e)}this.renderer=e,this.scene=t,this.camera=i,this.add3dStages(),this.resize()}installAddOn(e){this.addOn=e,e.rig&&((e,t)=>{const{camera:i,scene:n}=e;i.position.set(0,0,0),n.add(t.root),t.cameraNull.add(i),e.cameraRig=t})(this,e.rig)}async load(){const e=await this.loadMaterials();this.stages.forEach(t=>{t&&t.constructParametric(e)}),await Promise.all(this.stagesToLoad.map(t=>t.loadWithMaterials(e)))}add3dStages(){const e=[],t=[],i=(i,n,r,a,s)=>{(s=s||this.scene).add(n),(a=a||e).push(n),n.hasLoad&&t.push(n),r&&(r[i]=n)};i("stage1",new Ft,this),i("stage2",new Bt,this),i("stage3",new Gt,this),e.push(null),this.stage4=null;const n=new wt;i("stage5",n,this),i("sub5-1",new jt,null,n.substages,n.stagePoleG),i("sub5-2",new Wt,null,n.substages,n.stagePoleG),i("sub5-3",new $t,null,n.substages,n.stagePoleG);const r=2*Math.PI/n.substages.length;n.substages.forEach((e,t)=>{const{stagePoleG:i}=e;i.position.z=-1500,e.rotation.y=2*Math.PI-t*r}),n.hasSubstages=!0,e.push(null),this.stage6=null,this.stages=e,this.stagesToLoad=t}async loadMaterials(){const e=await mt((e=>{const t=["/illusion/img/versicolorMatcap.png"];return e&&t.push("/illusion/img/darkMatcap.png"),t})()),t={materialsMap:yt(e,this.isLightMode)};return t.defaultMaterial=t.materialsMap[dt.DEFAULT],t}resize(){const e=window.innerWidth,t=window.innerHeight;if(this.width=e,this.height=t,t<1||e<1)return this;this.updateCamera(e,t);const i=e/t>1.3&&e>768;return this.forceInvalidate?this.updateSizeMode(i):(this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{this.updateSizeMode(i)},1e3)),this.renderer.setSize(e,t),this}updateCamera(e,t){const{camera:i}=this;i.fov=e>t?35:32*t/Math.min(1.3*e,t),i.aspect=e/t,i.updateProjectionMatrix()}updateSizeMode(e){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.stages.forEach(t=>{t&&t.updateSizeMode(e)})}render(){const e=Date.now();this.invalidate(e-this.time,e-this.startTime),this.time=e,super.render()}play(){this.stateName&&(this.hasStateObjects(this.stateName)||this.hasForceRender(this.stateName))&&(this.startTime=Date.now(),this.forceInvalidate=!0,this.invalidate(0),super.play())}invalidate(e,t){if(!this.started&&!this.forceInvalidate)return this;this.stages.forEach(i=>{i&&i.visible&&(i.invalidate(e,t),i.hasSubstages&&i.substages.forEach(i=>{i.invalidate(e,t)}))});const{tweens:i}=this;if(i&&i.length>0){let n=i.length-1;for(;i.length>0&&n>-1;){const r=i[n];r.invalidate(e,t),r.isComplete&&i.splice(n,1),n-=1}i.length<1&&(this.tweens=null)}return this.addOn&&"function"==typeof this.addOn.invalidate&&this.addOn.invalidate(e,t),this.forceInvalidate=!1,this}isStateValid(e){return Object.keys(this.statesMap).includes(e)}hasStateObjects(e){return this.isStateValid(e)&&this.statesMap[e]}hasForceRender(e){return this.isStateValid(e)&&this.statesForceRenderMap[e]}setState(e,t){let i,n=null;if(!this.isStateValid(e))return;if(this.stateName===e){if(i=this[e],i&&(!i.hasSubstages||i.currentSubstage===t))return}else this.prevStateName=this.stateName,n=this.stateName;this.stateName=e,this.killTweens();let r=!0;e&&this.hasStateObjects(e)&&(i=this[e],i.visible=!0,i.hasSubstages&&t>-1&&t<i.substages.length?(i.currentSubstage>-1&&i.currentSubstage!==t&&(i.prevSubstage=i.currentSubstage),i.substages[t].visible=!0,i.currentSubstage=t):i.currentSubstage=-1,r=!1),this.hasForceRender(e)&&(r=!1),!r&&this.started&&this.play(),this.changeStateTo(e,i?i.currentSubstage:-1,()=>{if(n&&this.hasStateObjects(n)){this[n];this.prevStateName=null}i&&i.hasSubstages&&i.prevSubstage&&(i.prevSubstage=null),r&&this.pause(),this.mainTween=null},.001*(Date.now()-this.initiationTime)<1.5)}changeStateTo(e,t,i,n=!1){this.killTweens();let r=parseInt(e.substring(5),10)-1;Number.isNaN(r)&&(r=0);const{stage5:a}=this;let s=a.rotationY,o=!1,l=[];if(a.substages.length>0){s=2*Math.PI*(1-(t<0?0:t)/a.substages.length),a.rotationY<0&&(a.rotationY+=2*Math.PI),a.rotationY>2*Math.PI&&(a.rotationY-=2*Math.PI);const e=s>a.rotationY?1:-1;Math.abs(s-a.rotationY)>Math.abs(s-e*Math.PI*2-a.rotationY)&&(s-=e*Math.PI*2),s!==a.rotationY&&(l.push(new ht(a,{rotationY:s},n?0:1,this.addOn?null:i)),o=!0)}this.addOn&&"function"==typeof this.addOn.changeState&&(this.mainTween=this.addOn.changeState(e,t,i,n),l=l.concat(this.stages.map((e,t)=>e?new ht(e.stagePoleG.position,{x:3e3*-Math.max(0,t-r)},n?0:1.5):null).filter(e=>e&&e.params.length>0)),o=!0),this.tweens=l,o||"function"==typeof i&&i.call(null)}killTweens(){this.mainTween&&(this.mainTween.stop(),this.mainTween=null),this.tweens&&(this.tweens.forEach(e=>e.stop()),this.tweens.splice(0,this.tweens.length))}};const Zt=i(0);var Jt=class extends ut{setupParameters(){super.setupParameters(),this.zDepth=150}construct(){const{renderer:e,scene:t,camera:i}=gt(100,100,1.1*this.zDepth);i.position.z=this.zDepth,t.add(i),this.renderer=e,this.scene=t,this.camera=i,this.addMesh()}addMesh(){const e=new Zt.Mesh(new Zt.PlaneBufferGeometry(100,100),new at(394502,3354928));this.bgMesh=e,this.scene.add(e)}};const Kt=i(0),Qt=1750,ei=1500,ti=1800,ii=550,ni=1050,ri=Nt(120),ai=Nt(6),si=Nt(2);var oi=class{constructor(){this.setupInternalParameters(),this.construct(),this.invalidate()}setupInternalParameters(){this._depth=0,this._dollyLength=ti,this._polePosition=ii,this._horizonAngle=0,this._aroundAngle=0,this._pitchAngle=0,this._targetAroundAngle=0,this._targetPitchAngle=0,this._depthChanged=!0,this._dollyLengthChanged=!0,this._polePositionChanged=!0,this._horizonAngleChanged=!0,this._aroundAngleChanged=!0,this._pitchAngleChanged=!0}construct(){const e=new Kt.Group,t=new Kt.Group,i=new Kt.Group,n=new Kt.Group;e.add(t),t.add(i),i.add(n),this.root=e,this.dollyBend=t,this.poleHand=i,this.cameraNull=n}set depth(e){e!==this._depth&&(this._depth=e,this._depthChanged=!0)}get depth(){return this._depth}set dollyLength(e){if(e!==this._dollyLength){if(e<0)return this._dollyLength=0,void(this._dollyLengthChanged=!0);this._dollyLength=e,this._dollyLengthChanged=!0}}get dollyLength(){return this._dollyLength}set polePosition(e){e!==this._polePosition&&(this._polePosition=e,this._polePositionChanged=!0)}get polePosition(){return this._polePosition}set horizonAngle(e){e!==this._horizonAngle&&(this._horizonAngle=e,this._horizonAngleChanged=!0)}get horizonAngle(){return this._horizonAngle}set aroundAngle(e){e!==this._aroundAngle&&(this._aroundAngle=e,this._aroundAngleChanged=!0)}get aroundAngle(){return this._aroundAngle}set pitchAngle(e){e!==this._pitchAngle&&(this._pitchAngle=e,this._pitchAngleChanged=!0)}get pitchAngle(){return this._pitchAngle}set targetAroundAngle(e){e!==this._targetAroundAngle&&(this._targetAroundAngle=e,this._aroundAngleChanged=!0)}get targetAroundAngle(){return this._targetAroundAngle}set targetPitchAngle(e){e!==this._targetPitchAngle&&(this._targetPitchAngle=e,this._pitchAngleChanged=!0)}get targetPitchAngle(){return this._targetPitchAngle}invalidate(){this._depthChanged&&(this.root.position.z=-this._depth,this._depthChanged=!1),(this._dollyLengthChanged||this._horizonAngleChanged)&&(this.dollyBend.position.z=this._dollyLength,this.dollyBend.rotation.z=this._horizonAngle,this._dollyLengthChanged=!1,this._horizonAngleChanged=!1),this._polePositionChanged&&(this.poleHand.position.y=this._polePosition,this._polePositionChanged=!1),(this._aroundAngleChanged||this._targetAroundAngle!==this._aroundAngle)&&(Math.abs(this._targetAroundAngle-this._aroundAngle)<.001?this._aroundAngle=this._targetAroundAngle:this._aroundAngle+=.25*(this._targetAroundAngle-this._aroundAngle),this.root.rotation.y=this._aroundAngle,this._aroundAngleChanged=!1),(this._pitchAngleChanged||this._targetPitchAngle!==this._pitchAngle)&&(Math.abs(this._targetPitchAngle-this._pitchAngle)<.001?this._pitchAngle=this._targetPitchAngle:this._pitchAngle+=.25*(this._targetPitchAngle-this._pitchAngle),this.root.rotation.x=this._pitchAngle,this._pitchAngleChanged=!1)}};var li=class{constructor(){this.tween=null,this.rig=new oi}invalidate(e,t){null!==this.tween&&this.tween.invalidate(e,t),this.addMouseListeners(),this.rig.invalidate()}addMouseListeners(){if(this.hasMousemoveHandler)return;const{rig:e}=this,t=t=>{let i=t.pageX,n=t.pageY;i/=.5*window.innerWidth,i-=1,n/=.5*window.innerWidth,n-=1,e.targetAroundAngle=ai*i,e.targetPitchAngle=si*n};window.addEventListener("mousemove",t),this.mousemoveHandler=t,this.hasMousemoveHandler=!0}changeState(e,t,i,n=!1){return this.tween=((e,t,i,n,r=!1)=>{let a=parseInt(t.substring(5),10)-1;Number.isNaN(a)&&(a=0);let s=ii;return"stage5"===t?s=ni:"stage6"===t&&(s=0),r?(e.depth=a*Qt,e.polePosition=s,e.horizonAngle=a*ri,new ht(e,{dollyLength:ei},1.5,n)):new ht(e,{depth:a*Qt,dollyLength:ei,polePosition:s,horizonAngle:a*ri},1.5,n)})(this.rig,e,0,()=>{this.tween=null,"function"==typeof i&&i.call(null)},n),this.tween}};const ci={top:"stage1",about:"stage2",numbers:"stage3",show:"stage4",mc:"stage5",map:"stage6",tickets:"stage6"},hi={top:"default",about:"default",numbers:"default",show:"default",mc:"off",map:"off",tickets:"off"},ui={screenName:"top",slideId:-1},di=e=>{const{screenName:t,slideId:i}=e.detail;void 0!==t&&(ui.screenName=t),void 0!==i&&i>-1&&(ui.slideId=i)};document.body.addEventListener("screenChanged",di);var pi=class{constructor(){const e=window.innerWidth<1025&&window.innerHeight<1025,t=new Yt({isLightMode:e});if(qe()){if((e=>{let t,i=0;t=e.stage1,t.position.z=-i*Qt,t.rotation.z=i*ri,t.stagePoleG.position.y=ii,i=1,t=e.stage2,t.position.z=-i*Qt,t.rotation.z=i*ri,t.stagePoleG.position.y=ii,i=2,t=e.stage3,t.position.z=-i*Qt,t.rotation.z=i*ri,t.stagePoleG.position.y=ii,i=4,t=e.stage5,t.position.z=-i*Qt+ei,t.rotation.z=i*ri,t.stagePoleG.position.y=ni})(t),t.installAddOn(new li),e){const e=new Jt;this.bgView=e,t.setRenderFunction(()=>{t.renderer.render(e.scene,e.camera),t.renderer.autoClear=!1,t.renderer.render(t.scene,t.camera),t.renderer.autoClear=!0})}else{const e=new ct(t.renderer,t.scene,t.camera);t.setRenderFunction(()=>{e.render()}),this.composerController=e}i=t,n=document.querySelector(".animation-screen"),i.renderer&&n.appendChild(i.renderer.domElement),this.view3d=t}var i,n}async load(){const{view3d:e}=this;await e.load()}start(){const{view3d:e}=this;this.addListeners(),document.body.removeEventListener("screenChanged",di),e.start()}addListeners(){const{view3d:e,composerController:t}=this;e.setState(ci[ui.screenName],ui.slideId),document.body.addEventListener("screenChanged",t=>{di(t),e.setState(ci[ui.screenName],ui.slideId)}),t.setState(hi[ui.screenName]),document.body.addEventListener("screenChanged",e=>{t.setState(hi[e.detail.screenName],-1)})}};const mi=new class{constructor(){this.menu=new pe,this.slider=new me,this.modalTriggers=new fe,this.ticketsSlider=new ge,this.scrollers=new ve,this.poster=new He({canvas:"#poster-canvas",bgCanvas:"#poster-bg-canvas"}),this.poster.drawBg(),this.fullPageScroll=new _e(this),this.view3d=new pi,this.view3d.load().then(()=>{this.view3d.start()}),this.whaleScene=new Ue({canvas:"#whale-canvas"}),this.cart=new Me({cart:".page-header__cart",currentContainer:".swiper-slide-active",ticketsBlock:".tickets-block",ticket:".tickets-form__ticket",form:".tickets-block__form",number:".page-header__cart-number"}),this.initEventListeners()}initEventListeners(){window.addEventListener("resize",()=>{this.poster.updateSize(),this.whaleScene.updateSceneSizing(),this.poster.drawBg(),this.poster.draw(),this.whaleScene.drawScene()})}};window.APP=mi}]);
//# sourceMappingURL=script.js.map